    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::NYTProf version 3.11
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en-us" />
    <title>Profile of /usr/lib/perl5/DBI.pm</title>
<link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="js/jquery-min.js"></script> 

    <script type="text/javascript" src="js/jquery-tablesorter-min.js"></script> 
    <link rel="stylesheet" type="text/css" href="js/style-tablesorter.css" />
    <script type="text/javascript">
    // when a column is first clicked on to sort it, use descending order
    // XXX doesn't seem to work (and not just because the tablesorter formatSortingOrder() is broken)
    $.tablesorter.defaults.sortInitialOrder = "desc";
    // add parser through the tablesorter addParser method 
    $.tablesorter.addParser({
        id: 'fmt_time',   // name of this parser
        is: function(s) { 
            return false; // return false so this parser is not auto detected 
        }, 
        format: function(orig) { // format data for normalization 
            // console.log(orig);
            val = orig.replace(/ns/,'');
            if (val != orig) { return val / (1000*1000*1000); } 
            val = orig.replace(/Âµs/,''); /* XXX use &micro; ? */
            if (val != orig) { return val / (1000*1000); } 
            var val = orig.replace(/ms/,'');
            if (val != orig) { return val / (1000); }
            var val = orig.replace(/s/,'');
            if (val != orig) { return val; }
            if (orig == '0') { return orig; } 
            console.log('no match for fmt_time of '.concat(orig));
            return orig;
        },
        type: 'numeric' // set type, either numeric or text 
    }); 
    </script> 
</head>
<body > 
<div class="header" style="position: relative; overflow-x: hidden; overflow-y: hidden; z-index: 0; ">
<div class="header_back">
            <a href="index.html">&larr; Index</a>
        </div>
<div class="headerForeground" style="float: left">
    <span class="siteTitle">NYTProf Performance Profile</span>
    <span class="siteSubtitle">&emsp;&emsp;<span>&laquo;&emsp;<span class="mode_btn mode_btn_selected">block view</span>&emsp;&bull;&emsp;<span class="mode_btn"><a href="DBI-pm-line.html">line view</a></span>&emsp;&bull;&emsp;<span class="mode_btn"><a href="DBI-pm-sub.html">sub view</a></span>&emsp;&raquo;</span><br />
            For /www/svn/logzilla/scripts/db_inse.pl
        </span>
</div>
<div class="headerForeground" style="float: right; text-align: right">
    <span class="siteTitle">&nbsp;</span>
    <span class="siteSubtitle">Run on Thu Apr 22 13:48:10 2010<br />Reported on Thu Apr 22 13:57:47 2010</span>
</div>
<div style="position: absolute; left: 0px; top: 0%; width: 100%; height: 101%; z-index: -1; background-color: rgb(17, 136, 255); "></div>
<div style="position: absolute; left: 0px; top: 2%; width: 100%; height: 99%; z-index: -1; background-color: rgb(16, 134, 253); "></div>
<div style="position: absolute; left: 0px; top: 4%; width: 100%; height: 97%; z-index: -1; background-color: rgb(16, 133, 252); "></div>
<div style="position: absolute; left: 0px; top: 6%; width: 100%; height: 95%; z-index: -1; background-color: rgb(15, 131, 250); "></div>
<div style="position: absolute; left: 0px; top: 8%; width: 100%; height: 93%; z-index: -1; background-color: rgb(15, 130, 249); "></div>
<div style="position: absolute; left: 0px; top: 10%; width: 100%; height: 91%; z-index: -1; background-color: rgb(15, 129, 248); "></div>
<div style="position: absolute; left: 0px; top: 12%; width: 100%; height: 89%; z-index: -1; background-color: rgb(14, 127, 246); "></div>
<div style="position: absolute; left: 0px; top: 14%; width: 100%; height: 87%; z-index: -1; background-color: rgb(14, 126, 245); "></div>
<div style="position: absolute; left: 0px; top: 16%; width: 100%; height: 85%; z-index: -1; background-color: rgb(14, 125, 244); "></div>
<div style="position: absolute; left: 0px; top: 18%; width: 100%; height: 83%; z-index: -1; background-color: rgb(13, 123, 242); "></div>
<div style="position: absolute; left: 0px; top: 20%; width: 100%; height: 81%; z-index: -1; background-color: rgb(13, 122, 241); "></div>
<div style="position: absolute; left: 0px; top: 22%; width: 100%; height: 79%; z-index: -1; background-color: rgb(13, 121, 240); "></div>
<div style="position: absolute; left: 0px; top: 24%; width: 100%; height: 77%; z-index: -1; background-color: rgb(12, 119, 238); "></div>
<div style="position: absolute; left: 0px; top: 26%; width: 100%; height: 75%; z-index: -1; background-color: rgb(12, 118, 237); "></div>
<div style="position: absolute; left: 0px; top: 28%; width: 100%; height: 73%; z-index: -1; background-color: rgb(12, 116, 235); "></div>
<div style="position: absolute; left: 0px; top: 30%; width: 100%; height: 71%; z-index: -1; background-color: rgb(11, 115, 234); "></div>
<div style="position: absolute; left: 0px; top: 32%; width: 100%; height: 69%; z-index: -1; background-color: rgb(11, 114, 233); "></div>
<div style="position: absolute; left: 0px; top: 34%; width: 100%; height: 67%; z-index: -1; background-color: rgb(11, 112, 231); "></div>
<div style="position: absolute; left: 0px; top: 36%; width: 100%; height: 65%; z-index: -1; background-color: rgb(10, 111, 230); "></div>
<div style="position: absolute; left: 0px; top: 38%; width: 100%; height: 63%; z-index: -1; background-color: rgb(10, 110, 229); "></div>
<div style="position: absolute; left: 0px; top: 40%; width: 100%; height: 61%; z-index: -1; background-color: rgb(10, 108, 227); "></div>
<div style="position: absolute; left: 0px; top: 42%; width: 100%; height: 59%; z-index: -1; background-color: rgb(9, 107, 226); "></div>
<div style="position: absolute; left: 0px; top: 44%; width: 100%; height: 57%; z-index: -1; background-color: rgb(9, 106, 225); "></div>
<div style="position: absolute; left: 0px; top: 46%; width: 100%; height: 55%; z-index: -1; background-color: rgb(9, 104, 223); "></div>
<div style="position: absolute; left: 0px; top: 48%; width: 100%; height: 53%; z-index: -1; background-color: rgb(8, 103, 222); "></div>
<div style="position: absolute; left: 0px; top: 50%; width: 100%; height: 51%; z-index: -1; background-color: rgb(8, 102, 221); "></div>
<div style="position: absolute; left: 0px; top: 52%; width: 100%; height: 49%; z-index: -1; background-color: rgb(8, 100, 219); "></div>
<div style="position: absolute; left: 0px; top: 54%; width: 100%; height: 47%; z-index: -1; background-color: rgb(7, 99, 218); "></div>
<div style="position: absolute; left: 0px; top: 56%; width: 100%; height: 45%; z-index: -1; background-color: rgb(7, 97, 216); "></div>
<div style="position: absolute; left: 0px; top: 58%; width: 100%; height: 43%; z-index: -1; background-color: rgb(7, 96, 215); "></div>
<div style="position: absolute; left: 0px; top: 60%; width: 100%; height: 41%; z-index: -1; background-color: rgb(6, 95, 214); "></div>
<div style="position: absolute; left: 0px; top: 62%; width: 100%; height: 39%; z-index: -1; background-color: rgb(6, 93, 212); "></div>
<div style="position: absolute; left: 0px; top: 64%; width: 100%; height: 37%; z-index: -1; background-color: rgb(6, 92, 211); "></div>
<div style="position: absolute; left: 0px; top: 66%; width: 100%; height: 35%; z-index: -1; background-color: rgb(5, 91, 210); "></div>
<div style="position: absolute; left: 0px; top: 68%; width: 100%; height: 33%; z-index: -1; background-color: rgb(5, 89, 208); "></div>
<div style="position: absolute; left: 0px; top: 70%; width: 100%; height: 31%; z-index: -1; background-color: rgb(5, 88, 207); "></div>
<div style="position: absolute; left: 0px; top: 72%; width: 100%; height: 29%; z-index: -1; background-color: rgb(4, 87, 206); "></div>
<div style="position: absolute; left: 0px; top: 74%; width: 100%; height: 27%; z-index: -1; background-color: rgb(4, 85, 204); "></div>
<div style="position: absolute; left: 0px; top: 76%; width: 100%; height: 25%; z-index: -1; background-color: rgb(4, 84, 203); "></div>
<div style="position: absolute; left: 0px; top: 78%; width: 100%; height: 23%; z-index: -1; background-color: rgb(3, 82, 201); "></div>
<div style="position: absolute; left: 0px; top: 80%; width: 100%; height: 21%; z-index: -1; background-color: rgb(3, 81, 200); "></div>
<div style="position: absolute; left: 0px; top: 82%; width: 100%; height: 19%; z-index: -1; background-color: rgb(3, 80, 199); "></div>
<div style="position: absolute; left: 0px; top: 84%; width: 100%; height: 17%; z-index: -1; background-color: rgb(2, 78, 197); "></div>
<div style="position: absolute; left: 0px; top: 86%; width: 100%; height: 15%; z-index: -1; background-color: rgb(2, 77, 196); "></div>
<div style="position: absolute; left: 0px; top: 88%; width: 100%; height: 13%; z-index: -1; background-color: rgb(2, 76, 195); "></div>
<div style="position: absolute; left: 0px; top: 90%; width: 100%; height: 11%; z-index: -1; background-color: rgb(1, 74, 193); "></div>
<div style="position: absolute; left: 0px; top: 92%; width: 100%; height: 9%; z-index: -1; background-color: rgb(1, 73, 192); "></div>
<div style="position: absolute; left: 0px; top: 94%; width: 100%; height: 7%; z-index: -1; background-color: rgb(1, 72, 191); "></div>
<div style="position: absolute; left: 0px; top: 96%; width: 100%; height: 5%; z-index: -1; background-color: rgb(0, 70, 189); "></div>
<div style="position: absolute; left: 0px; top: 98%; width: 100%; height: 3%; z-index: -1; background-color: rgb(0, 69, 188); "></div>
<div style="position: absolute; left: 0px; top: 100%; width: 100%; height: 1%; z-index: -1; background-color: rgb(0, 68, 187); "></div>
</div>

<div class="body_content">
<br />
<table>
<tr>
<td class="h" align="right">File</td>
<td align="left">/usr/lib/perl5/DBI.pm</td>
</tr>
<tr>
<td class="h" align="right">Statements Executed</td>
<td align="left">796</td>
</tr>
<tr>
<td class="h" align="right">Statement Execution Time</td>
<td align="left">14.5ms</td>
</tr>
</table>

        
        <table id="subs_table" border="1" cellpadding="0" class="tablesorter">
        <caption>Subroutines &mdash; ordered by exclusive time</caption>
        <thead>
        <tr>
        <th>Calls</th>
        <th><span title="Number of Places sub is called from">P</span></th>
        <th><span title="Number of Files sub is called from">F</span></th>
        <th>Exclusive<br />Time</th>
        <th>Inclusive<br />Time</th>
        <th>Subroutine</th>
        </tr>
        </thead>
    <tbody>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">7.41ms</span></td><td class="c0"><span title="0.0%">9.94ms</span></td><td class="sub_name"><span style="display: none;">DBI::::install_driver</span>            DBI::<a href="DBI-pm-block.html#727">install_driver</a></span></td></tr>
<tr><td class="c0">88</td><td class="c3">1</td><td class="c1">2</td><td class="c1"><span title="0.0%">339&micro;s</span></td><td class="c3"><span title="0.0%">339&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::_install_method</span>            DBI::<a href="DBI-pm-block.html#DBI___install_method">_install_method</a>&nbsp;(xsub)</span></td></tr>
<tr><td class="c0">18</td><td class="c0">3</td><td class="c1">2</td><td class="c1"><span title="0.0%">317&micro;s</span></td><td class="c3"><span title="0.0%">317&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::_new_handle</span>            DBI::<a href="DBI-pm-block.html#DBI___new_handle">_new_handle</a>&nbsp;(xsub)</span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c1">2</td><td class="c2"><span title="0.0%">256&micro;s</span></td><td class="c3"><span title="0.0%">256&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::bootstrap</span>            DBI::<a href="DBI-pm-block.html#DBI__bootstrap">bootstrap</a>&nbsp;(xsub)</span></td></tr>
<tr><td class="c3">2</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">169&micro;s</span></td><td class="c0"><span title="0.0%">4.07ms</span></td><td class="sub_name"><span style="display: none;">DBI::::__ANON__[:704]</span>            DBI::<a href="DBI-pm-block.html#631">__ANON__[:704]</a></span></td></tr>
<tr><td class="c3">2</td><td class="c1">2</td><td class="c3">1</td><td class="c3"><span title="0.0%">149&micro;s</span></td><td class="c0"><span title="0.0%">14.2ms</span></td><td class="sub_name"><span style="display: none;">DBI::::connect</span>            DBI::<a href="DBI-pm-block.html#551">connect</a></span></td></tr>
<tr><td class="c3">2</td><td class="c1">2</td><td class="c3">1</td><td class="c3"><span title="0.0%">148&micro;s</span></td><td class="c3"><span title="0.0%">172&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::setup_driver</span>            DBI::<a href="DBI-pm-block.html#805">setup_driver</a></span></td></tr>
<tr><td class="c0">15</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">125&micro;s</span></td><td class="c3"><span title="0.0%">339&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::_new_sth</span>            DBI::<a href="DBI-pm-block.html#1245">_new_sth</a></span></td></tr>
<tr><td class="c0">117</td><td class="c3">1</td><td class="c1">2</td><td class="c3"><span title="0.0%">75&micro;s</span></td><td class="c3"><span title="0.0%">75&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::CORE:match</span>            DBI::<a href="DBI-pm-block.html#DBI__CORE_match">CORE:match</a>&nbsp;(opcode)</span></td></tr>
<tr><td class="c3">2</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">32&micro;s</span></td><td class="c3"><span title="0.0%">88&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::_new_dbh</span>            DBI::<a href="DBI-pm-block.html#1232">_new_dbh</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">24&micro;s</span></td><td class="c3"><span title="0.0%">71&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::_new_drh</span>            DBI::<a href="DBI-pm-block.html#1197">_new_drh</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">15&micro;s</span></td><td class="c3"><span title="0.0%">26&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::disconnect_all</span>            DBI::<a href="DBI-pm-block.html#714">disconnect_all</a></span></td></tr>
<tr><td class="c1">3</td><td class="c1">2</td><td class="c1">2</td><td class="c3"><span title="0.0%">11&micro;s</span></td><td class="c3"><span title="0.0%">11&micro;s</span></td><td class="sub_name"><span style="display: none;">DBI::::CORE:subst</span>            DBI::<a href="DBI-pm-block.html#DBI__CORE_subst">CORE:subst</a>&nbsp;(opcode)</span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c1">2</td><td class="c3"><span title="0.0%">9&micro;s</span></td><td class="c3"><span title="0.0%">9&micro;s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::trace_msg</span> DBD::_::common::<a href="DBI-pm-block.html#DBD_____common__trace_msg">trace_msg</a>&nbsp;(xsub)</span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::Switch::dr::::CLONE</span>DBD::Switch::dr::<a href="DBI-pm-block.html#1283">CLONE</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::Switch::dr::::FETCH</span>DBD::Switch::dr::<a href="DBI-pm-block.html#1287">FETCH</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::Switch::dr::::STORE</span>DBD::Switch::dr::<a href="DBI-pm-block.html#1294">STORE</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::Switch::dr::::driver</span>DBD::Switch::dr::<a href="DBI-pm-block.html#1271">driver</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::BEGIN</span> DBD::_::common::<a href="DBI-pm-block.html#1315">BEGIN</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::CLEAR</span> DBD::_::common::<a href="DBI-pm-block.html#1329">CLEAR</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::EXISTS</span> DBD::_::common::<a href="DBI-pm-block.html#1328">EXISTS</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::FETCH_many</span> DBD::_::common::<a href="DBI-pm-block.html#1331">FETCH_many</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::FIRSTKEY</span> DBD::_::common::<a href="DBI-pm-block.html#1326">FIRSTKEY</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::NEXTKEY</span> DBD::_::common::<a href="DBI-pm-block.html#1327">NEXTKEY</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::_not_impl</span> DBD::_::common::<a href="DBI-pm-block.html#1319">_not_impl</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::install_method</span> DBD::_::common::<a href="DBI-pm-block.html#1338">install_method</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::parse_trace_flag</span> DBD::_::common::<a href="DBI-pm-block.html#1387">parse_trace_flag</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::parse_trace_flags</span> DBD::_::common::<a href="DBI-pm-block.html#1361">parse_trace_flags</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::common::::private_attribute_info</span> DBD::_::common::<a href="DBI-pm-block.html#1394">private_attribute_info</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::BEGIN</span>     DBD::_::db::<a href="DBI-pm-block.html#1465">BEGIN</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::_do_selectrow</span>     DBD::_::db::<a href="DBI-pm-block.html#1567">_do_selectrow</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::begin_work</span>     DBD::_::db::<a href="DBI-pm-block.html#1670">begin_work</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::clone</span>     DBD::_::db::<a href="DBI-pm-block.html#1467">clone</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::data_sources</span>     DBD::_::db::<a href="DBI-pm-block.html#1759">data_sources</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::do</span>     DBD::_::db::<a href="DBI-pm-block.html#1559">do</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::ping</span>     DBD::_::db::<a href="DBI-pm-block.html#1662">ping</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::prepare_cached</span>     DBD::_::db::<a href="DBI-pm-block.html#1636">prepare_cached</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::primary_key</span>     DBD::_::db::<a href="DBI-pm-block.html#1679">primary_key</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::quote</span>     DBD::_::db::<a href="DBI-pm-block.html#1527">quote</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::quote_identifier</span>     DBD::_::db::<a href="DBI-pm-block.html#1496">quote_identifier</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::rows</span>     DBD::_::db::<a href="DBI-pm-block.html#1557">rows</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectall_arrayref</span>     DBD::_::db::<a href="DBI-pm-block.html#1590">selectall_arrayref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectall_hashref</span>     DBD::_::db::<a href="DBI-pm-block.html#1607">selectall_hashref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectcol_arrayref</span>     DBD::_::db::<a href="DBI-pm-block.html#1615">selectcol_arrayref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectrow_array</span>     DBD::_::db::<a href="DBI-pm-block.html#1582">selectrow_array</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectrow_arrayref</span>     DBD::_::db::<a href="DBI-pm-block.html#1581">selectrow_arrayref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::selectrow_hashref</span>     DBD::_::db::<a href="DBI-pm-block.html#1578">selectrow_hashref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::tables</span>     DBD::_::db::<a href="DBI-pm-block.html#1689">tables</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::db::::type_info</span>     DBD::_::db::<a href="DBI-pm-block.html#1712">type_info</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::dr::::BEGIN</span>     DBD::_::dr::<a href="DBI-pm-block.html#1404">BEGIN</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::dr::::connect</span>     DBD::_::dr::<a href="DBI-pm-block.html#1413">connect</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::dr::::connect_cached</span>     DBD::_::dr::<a href="DBI-pm-block.html#1426">connect_cached</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::dr::::default_user</span>     DBD::_::dr::<a href="DBI-pm-block.html#1406">default_user</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::BEGIN</span>     DBD::_::st::<a href="DBI-pm-block.html#1771">BEGIN</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::__ANON__[:1887]</span>     DBD::_::st::<a href="DBI-pm-block.html#1887">__ANON__[:1887]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::__ANON__[:1921]</span>     DBD::_::st::<a href="DBI-pm-block.html#1913">__ANON__[:1921]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::bind_columns</span>     DBD::_::st::<a href="DBI-pm-block.html#1826">bind_columns</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::bind_param</span>     DBD::_::st::<a href="DBI-pm-block.html#1773">bind_param</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::bind_param_array</span>     DBD::_::st::<a href="DBI-pm-block.html#1788">bind_param_array</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::bind_param_inout_array</span>     DBD::_::st::<a href="DBI-pm-block.html#1817">bind_param_inout_array</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::blob_copy_to_file</span>     DBD::_::st::<a href="DBI-pm-block.html#2034">blob_copy_to_file</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::execute_array</span>     DBD::_::st::<a href="DBI-pm-block.html#1848">execute_array</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::execute_for_fetch</span>     DBD::_::st::<a href="DBI-pm-block.html#1927">execute_for_fetch</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::fetchall_arrayref</span>     DBD::_::st::<a href="DBI-pm-block.html#1955">fetchall_arrayref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::fetchall_hashref</span>     DBD::_::st::<a href="DBI-pm-block.html#2005">fetchall_hashref</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBD::_::st::::more_results</span>     DBD::_::st::<a href="DBI-pm-block.html#2052">more_results</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::BEGIN</span>            DBI::<a href="DBI-pm-block.html#1002">BEGIN</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::CLONE</span>            DBI::<a href="DBI-pm-block.html#513">CLONE</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::DBI_tie::::STORE</span>   DBI::DBI_tie::<a href="DBI-pm-block.html#308">STORE</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::DBI_tie::::TIEHASH</span>   DBI::DBI_tie::<a href="DBI-pm-block.html#307">TIEHASH</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::END</span>            DBI::<a href="DBI-pm-block.html#503">END</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::__ANON__[:1089]</span>            DBI::<a href="DBI-pm-block.html#1089">__ANON__[:1089]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::__ANON__[:1123]</span>            DBI::<a href="DBI-pm-block.html#1123">__ANON__[:1123]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::__ANON__[:1124]</span>            DBI::<a href="DBI-pm-block.html#1124">__ANON__[:1124]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::__ANON__[:998]</span>            DBI::<a href="DBI-pm-block.html#998">__ANON__[:998]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::_dbtype_names</span>            DBI::<a href="DBI-pm-block.html#870">_dbtype_names</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::_load_class</span>            DBI::<a href="DBI-pm-block.html#933">_load_class</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::_rebless</span>            DBI::<a href="DBI-pm-block.html#821">_rebless</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::_rebless_dbtype_subclass</span>            DBI::<a href="DBI-pm-block.html#855">_rebless_dbtype_subclass</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::_set_isa</span>            DBI::<a href="DBI-pm-block.html#830">_set_isa</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::available_drivers</span>            DBI::<a href="DBI-pm-block.html#955">available_drivers</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::connect_cached</span>            DBI::<a href="DBI-pm-block.html#538">connect_cached</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::connect_test_perf</span>            DBI::<a href="DBI-pm-block.html#1142">connect_test_perf</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::data_diff</span>            DBI::<a href="DBI-pm-block.html#1056">data_diff</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::data_sources</span>            DBI::<a href="DBI-pm-block.html#1022">data_sources</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::data_string_desc</span>            DBI::<a href="DBI-pm-block.html#1117">data_string_desc</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::data_string_diff</span>            DBI::<a href="DBI-pm-block.html#1073">data_string_diff</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::disconnect</span>            DBI::<a href="DBI-pm-block.html#722">disconnect</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::dump_dbd_registry</span>            DBI::<a href="DBI-pm-block.html#362">dump_dbd_registry</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::dump_results</span>            DBI::<a href="DBI-pm-block.html#1038">dump_results</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::err</span>            DBI::<a href="DBI-pm-block.html#1181">err</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::errstr</span>            DBI::<a href="DBI-pm-block.html#1182">errstr</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::init_rootclass</span>            DBI::<a href="DBI-pm-block.html#947">init_rootclass</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::installed_drivers</span>            DBI::<a href="DBI-pm-block.html#292">installed_drivers</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::installed_methods</span>            DBI::<a href="DBI-pm-block.html#294">installed_methods</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::installed_versions</span>            DBI::<a href="DBI-pm-block.html#989">installed_versions</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::neat_list</span>            DBI::<a href="DBI-pm-block.html#1030">neat_list</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::::parse_dsn</span>            DBI::<a href="DBI-pm-block.html#526">parse_dsn</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::var::::STORE</span>       DBI::var::<a href="DBI-pm-block.html#304">STORE</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">DBI::var::::TIESCALAR</span>       DBI::var::<a href="DBI-pm-block.html#303">TIESCALAR</a></span></td></tr>

        </tbody>
        </table>
    
        Call graph for these subroutines as a <a href="http://en.wikipedia.org/wiki/Graphviz">Graphviz</a> <a href="usr-lib-perl5-DBI-pm.dot">dot language file</a>.
      <table border="1" cellpadding="0">
      <thead>
      <tr><th>Line</th>
      <th><span title="Number of statements executed">State<br />ments</span></th>
      <th><span title="Time spend executing statements on the line,
        excluding time spent executing statements in any called subroutines">Time<br />on line</span></th>
      <th><span title="Number of subroutines calls">Calls</span></th>
      <th><span title="Time spent in subroutines called">Time<br />in subs</span></th>
      <th class="left_indent_header">Code</th>
      </tr>

      </thead>
      <tbody>
    <tr><td class="h"><a name="1"></a>1</td><td></td><td></td><td></td><td></td><td class="s"># $Id: DBI.pm 11570 2008-07-22 21:45:16Z timbo $</td></tr>
<tr><td class="h"><a name="2"></a>2</td><td></td><td></td><td></td><td></td><td class="s"># vim: ts=8:sw=4:noet</td></tr>
<tr><td class="h"><a name="3"></a>3</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="4"></a>4</td><td></td><td></td><td></td><td></td><td class="s"># Copyright (c) 1994-2008  Tim Bunce  Ireland</td></tr>
<tr><td class="h"><a name="5"></a>5</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="6"></a>6</td><td></td><td></td><td></td><td></td><td class="s"># See COPYRIGHT section in pod text below for usage and distribution rights.</td></tr>
<tr><td class="h"><a name="7"></a>7</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="8"></a>8</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="9"></a>9</td><td class="c3">1</td><td class="c2"><span title="Avg 23&micro;s">23&micro;s</span></td><td></td><td></td><td class="s">require 5.006_00;</td></tr>
<tr><td class="h"><a name="10"></a>10</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="11"></a>11</td><td></td><td></td><td></td><td></td><td class="s">BEGIN {</td></tr>
<tr><td class="h"><a name="12"></a>12</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">$DBI::VERSION = &quot;1.607&quot;; # ==&gt; ALSO update the version in the pod text below!</td></tr>
<tr><td class="h"><a name="13"></a>13</td><td class="c3">1</td><td class="c0"><span title="Avg 52&micro;s">52&micro;s</span></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="14"></a>14</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="15"></a>15</td><td></td><td></td><td></td><td></td><td class="s">=head1 NAME</td></tr>
<tr><td class="h"><a name="16"></a>16</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="17"></a>17</td><td></td><td></td><td></td><td></td><td class="s">DBI - Database independent interface for Perl</td></tr>
<tr><td class="h"><a name="18"></a>18</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="19"></a>19</td><td></td><td></td><td></td><td></td><td class="s">=head1 SYNOPSIS</td></tr>
<tr><td class="h"><a name="20"></a>20</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="21"></a>21</td><td></td><td></td><td></td><td></td><td class="s">  use DBI;</td></tr>
<tr><td class="h"><a name="22"></a>22</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="23"></a>23</td><td></td><td></td><td></td><td></td><td class="s">  @driver_names = DBI-&gt;available_drivers;</td></tr>
<tr><td class="h"><a name="24"></a>24</td><td></td><td></td><td></td><td></td><td class="s">  %drivers      = DBI-&gt;installed_drivers;</td></tr>
<tr><td class="h"><a name="25"></a>25</td><td></td><td></td><td></td><td></td><td class="s">  @data_sources = DBI-&gt;data_sources($driver_name, \%attr);</td></tr>
<tr><td class="h"><a name="26"></a>26</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="27"></a>27</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($data_source, $username, $auth, \%attr);</td></tr>
<tr><td class="h"><a name="28"></a>28</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="29"></a>29</td><td></td><td></td><td></td><td></td><td class="s">  $rv  = $dbh-&gt;do($statement);</td></tr>
<tr><td class="h"><a name="30"></a>30</td><td></td><td></td><td></td><td></td><td class="s">  $rv  = $dbh-&gt;do($statement, \%attr);</td></tr>
<tr><td class="h"><a name="31"></a>31</td><td></td><td></td><td></td><td></td><td class="s">  $rv  = $dbh-&gt;do($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="32"></a>32</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="33"></a>33</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $dbh-&gt;selectall_arrayref($statement);</td></tr>
<tr><td class="h"><a name="34"></a>34</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field);</td></tr>
<tr><td class="h"><a name="35"></a>35</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="36"></a>36</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $dbh-&gt;selectcol_arrayref($statement);</td></tr>
<tr><td class="h"><a name="37"></a>37</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $dbh-&gt;selectcol_arrayref($statement, \%attr);</td></tr>
<tr><td class="h"><a name="38"></a>38</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="39"></a>39</td><td></td><td></td><td></td><td></td><td class="s">  @row_ary  = $dbh-&gt;selectrow_array($statement);</td></tr>
<tr><td class="h"><a name="40"></a>40</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $dbh-&gt;selectrow_arrayref($statement);</td></tr>
<tr><td class="h"><a name="41"></a>41</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectrow_hashref($statement);</td></tr>
<tr><td class="h"><a name="42"></a>42</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="43"></a>43</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare($statement);</td></tr>
<tr><td class="h"><a name="44"></a>44</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare_cached($statement);</td></tr>
<tr><td class="h"><a name="45"></a>45</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="46"></a>46</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param($p_num, $bind_value);</td></tr>
<tr><td class="h"><a name="47"></a>47</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param($p_num, $bind_value, $bind_type);</td></tr>
<tr><td class="h"><a name="48"></a>48</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param($p_num, $bind_value, \%attr);</td></tr>
<tr><td class="h"><a name="49"></a>49</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="50"></a>50</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="51"></a>51</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;execute(@bind_values);</td></tr>
<tr><td class="h"><a name="52"></a>52</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;execute_array(\%attr, ...);</td></tr>
<tr><td class="h"><a name="53"></a>53</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="54"></a>54</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_col($col_num, \$col_variable);</td></tr>
<tr><td class="h"><a name="55"></a>55</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_columns(@list_of_refs_to_vars_to_bind);</td></tr>
<tr><td class="h"><a name="56"></a>56</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="57"></a>57</td><td></td><td></td><td></td><td></td><td class="s">  @row_ary  = $sth-&gt;fetchrow_array;</td></tr>
<tr><td class="h"><a name="58"></a>58</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $sth-&gt;fetchrow_arrayref;</td></tr>
<tr><td class="h"><a name="59"></a>59</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $sth-&gt;fetchrow_hashref;</td></tr>
<tr><td class="h"><a name="60"></a>60</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="61"></a>61</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $sth-&gt;fetchall_arrayref;</td></tr>
<tr><td class="h"><a name="62"></a>62</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref  = $sth-&gt;fetchall_arrayref( $slice, $max_rows );</td></tr>
<tr><td class="h"><a name="63"></a>63</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="64"></a>64</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $sth-&gt;fetchall_hashref( $key_field );</td></tr>
<tr><td class="h"><a name="65"></a>65</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="66"></a>66</td><td></td><td></td><td></td><td></td><td class="s">  $rv  = $sth-&gt;rows;</td></tr>
<tr><td class="h"><a name="67"></a>67</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="68"></a>68</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;begin_work;</td></tr>
<tr><td class="h"><a name="69"></a>69</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;commit;</td></tr>
<tr><td class="h"><a name="70"></a>70</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;rollback;</td></tr>
<tr><td class="h"><a name="71"></a>71</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="72"></a>72</td><td></td><td></td><td></td><td></td><td class="s">  $quoted_string = $dbh-&gt;quote($string);</td></tr>
<tr><td class="h"><a name="73"></a>73</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="74"></a>74</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $h-&gt;err;</td></tr>
<tr><td class="h"><a name="75"></a>75</td><td></td><td></td><td></td><td></td><td class="s">  $str = $h-&gt;errstr;</td></tr>
<tr><td class="h"><a name="76"></a>76</td><td></td><td></td><td></td><td></td><td class="s">  $rv  = $h-&gt;state;</td></tr>
<tr><td class="h"><a name="77"></a>77</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="78"></a>78</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;disconnect;</td></tr>
<tr><td class="h"><a name="79"></a>79</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="80"></a>80</td><td></td><td></td><td></td><td></td><td class="s">I&lt;The synopsis above only lists the major methods and parameters.&gt;</td></tr>
<tr><td class="h"><a name="81"></a>81</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="82"></a>82</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="83"></a>83</td><td></td><td></td><td></td><td></td><td class="s">=head2 GETTING HELP</td></tr>
<tr><td class="h"><a name="84"></a>84</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="85"></a>85</td><td></td><td></td><td></td><td></td><td class="s">If you have questions about DBI, or DBD driver modules, you can get</td></tr>
<tr><td class="h"><a name="86"></a>86</td><td></td><td></td><td></td><td></td><td class="s">help from the I&lt;dbi-users@perl.org&gt; mailing list.  You don't have to subscribe</td></tr>
<tr><td class="h"><a name="87"></a>87</td><td></td><td></td><td></td><td></td><td class="s">to the list in order to post, though I'd recommend it. You can get help on</td></tr>
<tr><td class="h"><a name="88"></a>88</td><td></td><td></td><td></td><td></td><td class="s">subscribing and using the list by emailing I&lt;dbi-users-help@perl.org&gt;.</td></tr>
<tr><td class="h"><a name="89"></a>89</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="90"></a>90</td><td></td><td></td><td></td><td></td><td class="s">I don't recommend the DBI cpanform (at http://www.cpanforum.com/dist/DBI)</td></tr>
<tr><td class="h"><a name="91"></a>91</td><td></td><td></td><td></td><td></td><td class="s">because relatively few people read it compared with dbi-users@perl.org.</td></tr>
<tr><td class="h"><a name="92"></a>92</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="93"></a>93</td><td></td><td></td><td></td><td></td><td class="s">To help you make the best use of the dbi-users mailing list,</td></tr>
<tr><td class="h"><a name="94"></a>94</td><td></td><td></td><td></td><td></td><td class="s">and any other lists or forums you may use, I I&lt;strongly&gt;</td></tr>
<tr><td class="h"><a name="95"></a>95</td><td></td><td></td><td></td><td></td><td class="s">recommend that you read &quot;How To Ask Questions The Smart Way&quot;</td></tr>
<tr><td class="h"><a name="96"></a>96</td><td></td><td></td><td></td><td></td><td class="s">by Eric Raymond: L&lt;http://www.catb.org/~esr/faqs/smart-questions.html&gt;.</td></tr>
<tr><td class="h"><a name="97"></a>97</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="98"></a>98</td><td></td><td></td><td></td><td></td><td class="s">If you think you've found a bug then please also read</td></tr>
<tr><td class="h"><a name="99"></a>99</td><td></td><td></td><td></td><td></td><td class="s">&quot;How to Report Bugs Effectively&quot; by Simon Tatham:</td></tr>
<tr><td class="h"><a name="100"></a>100</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://www.chiark.greenend.org.uk/~sgtatham/bugs.html&gt;.</td></tr>
<tr><td class="h"><a name="101"></a>101</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="102"></a>102</td><td></td><td></td><td></td><td></td><td class="s">The DBI home page at L&lt;http://dbi.perl.org/&gt; and the DBI FAQ</td></tr>
<tr><td class="h"><a name="103"></a>103</td><td></td><td></td><td></td><td></td><td class="s">at L&lt;http://faq.dbi-support.com/&gt; are always worth a visit.</td></tr>
<tr><td class="h"><a name="104"></a>104</td><td></td><td></td><td></td><td></td><td class="s">They include links to other resources.</td></tr>
<tr><td class="h"><a name="105"></a>105</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="106"></a>106</td><td></td><td></td><td></td><td></td><td class="s">Before asking any questions, reread this document, consult the</td></tr>
<tr><td class="h"><a name="107"></a>107</td><td></td><td></td><td></td><td></td><td class="s">archives and read the DBI FAQ. The archives are listed</td></tr>
<tr><td class="h"><a name="108"></a>108</td><td></td><td></td><td></td><td></td><td class="s">at the end of this document and on the DBI home page.</td></tr>
<tr><td class="h"><a name="109"></a>109</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="110"></a>110</td><td></td><td></td><td></td><td></td><td class="s">This document often uses terms like I&lt;references&gt;, I&lt;objects&gt;,</td></tr>
<tr><td class="h"><a name="111"></a>111</td><td></td><td></td><td></td><td></td><td class="s">I&lt;methods&gt;.  If you're not familar with those terms then it would</td></tr>
<tr><td class="h"><a name="112"></a>112</td><td></td><td></td><td></td><td></td><td class="s">be a good idea to read at least the following perl manuals first:</td></tr>
<tr><td class="h"><a name="113"></a>113</td><td></td><td></td><td></td><td></td><td class="s">L&lt;perlreftut&gt;, L&lt;perldsc&gt;, L&lt;perllol&gt;, and L&lt;perlboot&gt;.</td></tr>
<tr><td class="h"><a name="114"></a>114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="115"></a>115</td><td></td><td></td><td></td><td></td><td class="s">Please note that Tim Bunce does not maintain the mailing lists or the</td></tr>
<tr><td class="h"><a name="116"></a>116</td><td></td><td></td><td></td><td></td><td class="s">web page (generous volunteers do that).  So please don't send mail</td></tr>
<tr><td class="h"><a name="117"></a>117</td><td></td><td></td><td></td><td></td><td class="s">directly to him; he just doesn't have the time to answer questions</td></tr>
<tr><td class="h"><a name="118"></a>118</td><td></td><td></td><td></td><td></td><td class="s">personally. The I&lt;dbi-users&gt; mailing list has lots of experienced</td></tr>
<tr><td class="h"><a name="119"></a>119</td><td></td><td></td><td></td><td></td><td class="s">people who should be able to help you if you need it. If you do email</td></tr>
<tr><td class="h"><a name="120"></a>120</td><td></td><td></td><td></td><td></td><td class="s">Tim he's very likely to just forward it to the mailing list.</td></tr>
<tr><td class="h"><a name="121"></a>121</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="122"></a>122</td><td></td><td></td><td></td><td></td><td class="s">=head2 NOTES</td></tr>
<tr><td class="h"><a name="123"></a>123</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="124"></a>124</td><td></td><td></td><td></td><td></td><td class="s">This is the DBI specification that corresponds to the DBI version 1.607</td></tr>
<tr><td class="h"><a name="125"></a>125</td><td></td><td></td><td></td><td></td><td class="s">($Revision: 11570 $).</td></tr>
<tr><td class="h"><a name="126"></a>126</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="127"></a>127</td><td></td><td></td><td></td><td></td><td class="s">The DBI is evolving at a steady pace, so it's good to check that</td></tr>
<tr><td class="h"><a name="128"></a>128</td><td></td><td></td><td></td><td></td><td class="s">you have the latest copy.</td></tr>
<tr><td class="h"><a name="129"></a>129</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="130"></a>130</td><td></td><td></td><td></td><td></td><td class="s">The significant user-visible changes in each release are documented</td></tr>
<tr><td class="h"><a name="131"></a>131</td><td></td><td></td><td></td><td></td><td class="s">in the L&lt;DBI::Changes&gt; module so you can read them by executing</td></tr>
<tr><td class="h"><a name="132"></a>132</td><td></td><td></td><td></td><td></td><td class="s">C&lt;perldoc DBI::Changes&gt;.</td></tr>
<tr><td class="h"><a name="133"></a>133</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="134"></a>134</td><td></td><td></td><td></td><td></td><td class="s">Some DBI changes require changes in the drivers, but the drivers</td></tr>
<tr><td class="h"><a name="135"></a>135</td><td></td><td></td><td></td><td></td><td class="s">can take some time to catch up. Newer versions of the DBI have</td></tr>
<tr><td class="h"><a name="136"></a>136</td><td></td><td></td><td></td><td></td><td class="s">added features that may not yet be supported by the drivers you</td></tr>
<tr><td class="h"><a name="137"></a>137</td><td></td><td></td><td></td><td></td><td class="s">use.  Talk to the authors of your drivers if you need a new feature</td></tr>
<tr><td class="h"><a name="138"></a>138</td><td></td><td></td><td></td><td></td><td class="s">that's not yet supported.</td></tr>
<tr><td class="h"><a name="139"></a>139</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="140"></a>140</td><td></td><td></td><td></td><td></td><td class="s">Features added after DBI 1.21 (February 2002) are marked in the</td></tr>
<tr><td class="h"><a name="141"></a>141</td><td></td><td></td><td></td><td></td><td class="s">text with the version number of the DBI release they first appeared in.</td></tr>
<tr><td class="h"><a name="142"></a>142</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="143"></a>143</td><td></td><td></td><td></td><td></td><td class="s">Extensions to the DBI API often use the C&lt;DBIx::*&gt; namespace.</td></tr>
<tr><td class="h"><a name="144"></a>144</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/Naming Conventions and Name Space&gt;. DBI extension modules</td></tr>
<tr><td class="h"><a name="145"></a>145</td><td></td><td></td><td></td><td></td><td class="s">can be found at L&lt;http://search.cpan.org/search?mode=module&amp;query=DBIx&gt;.</td></tr>
<tr><td class="h"><a name="146"></a>146</td><td></td><td></td><td></td><td></td><td class="s">And all modules related to the DBI can be found at</td></tr>
<tr><td class="h"><a name="147"></a>147</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://search.cpan.org/search?query=DBI&amp;mode=all&gt;.</td></tr>
<tr><td class="h"><a name="148"></a>148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="149"></a>149</td><td></td><td></td><td></td><td></td><td class="s">=cut</td></tr>
<tr><td class="h"><a name="150"></a>150</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="151"></a>151</td><td></td><td></td><td></td><td></td><td class="s"># The POD text continues at the end of the file.</td></tr>
<tr><td class="h"><a name="152"></a>152</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="153"></a>153</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="154"></a>154</td><td></td><td></td><td></td><td></td><td class="s">package DBI;</td></tr>
<tr><td class="h"><a name="155"></a>155</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="156"></a>156</td><td class="c0">3</td><td class="c3"><span title="Avg 5&micro;s">14&micro;s</span></td><td></td><td></td><td class="s">use Carp();</td></tr>
<tr><td class="h"><a name="157"></a>157</td><td class="c0">3</td><td class="c0"><span title="Avg 32&micro;s">97&micro;s</span></td><td></td><td></td><td class="s">use DynaLoader ();</td></tr>
<tr><td class="h"><a name="158"></a>158</td><td class="c0">3</td><td class="c0"><span title="Avg 69&micro;s">208&micro;s</span></td><td></td><td></td><td class="s">use Exporter ();</td></tr>
<tr><td class="h"><a name="159"></a>159</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="160"></a>160</td><td></td><td></td><td></td><td></td><td class="s">BEGIN {</td></tr>
<tr><td class="h"><a name="161"></a>161</td><td class="c0">10</td><td class="c0"><span title="Avg 8&micro;s">80&micro;s</span></td><td></td><td></td><td class="s">@ISA = qw(Exporter DynaLoader);</td></tr>
<tr><td class="h"><a name="162"></a>162</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="163"></a>163</td><td></td><td></td><td></td><td></td><td class="s"># Make some utility functions available if asked for</td></tr>
<tr><td class="h"><a name="164"></a>164</td><td></td><td></td><td></td><td></td><td class="s">@EXPORT    = ();                    # we export nothing by default</td></tr>
<tr><td class="h"><a name="165"></a>165</td><td></td><td></td><td></td><td></td><td class="s">@EXPORT_OK = qw(%DBI %DBI_methods hash); # also populated by export_ok_tags:</td></tr>
<tr><td class="h"><a name="166"></a>166</td><td></td><td></td><td></td><td></td><td class="s">%EXPORT_TAGS = (</td></tr>
<tr><td class="h"><a name="167"></a>167</td><td></td><td></td><td></td><td></td><td class="s">   sql_types =&gt; [ qw(</td></tr>
<tr><td class="h"><a name="168"></a>168</td><td></td><td></td><td></td><td></td><td class="s">        SQL_GUID</td></tr>
<tr><td class="h"><a name="169"></a>169</td><td></td><td></td><td></td><td></td><td class="s">        SQL_WLONGVARCHAR</td></tr>
<tr><td class="h"><a name="170"></a>170</td><td></td><td></td><td></td><td></td><td class="s">        SQL_WVARCHAR</td></tr>
<tr><td class="h"><a name="171"></a>171</td><td></td><td></td><td></td><td></td><td class="s">        SQL_WCHAR</td></tr>
<tr><td class="h"><a name="172"></a>172</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BIGINT</td></tr>
<tr><td class="h"><a name="173"></a>173</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BIT</td></tr>
<tr><td class="h"><a name="174"></a>174</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TINYINT</td></tr>
<tr><td class="h"><a name="175"></a>175</td><td></td><td></td><td></td><td></td><td class="s">        SQL_LONGVARBINARY</td></tr>
<tr><td class="h"><a name="176"></a>176</td><td></td><td></td><td></td><td></td><td class="s">        SQL_VARBINARY</td></tr>
<tr><td class="h"><a name="177"></a>177</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BINARY</td></tr>
<tr><td class="h"><a name="178"></a>178</td><td></td><td></td><td></td><td></td><td class="s">        SQL_LONGVARCHAR</td></tr>
<tr><td class="h"><a name="179"></a>179</td><td></td><td></td><td></td><td></td><td class="s">        SQL_UNKNOWN_TYPE</td></tr>
<tr><td class="h"><a name="180"></a>180</td><td></td><td></td><td></td><td></td><td class="s">        SQL_ALL_TYPES</td></tr>
<tr><td class="h"><a name="181"></a>181</td><td></td><td></td><td></td><td></td><td class="s">        SQL_CHAR</td></tr>
<tr><td class="h"><a name="182"></a>182</td><td></td><td></td><td></td><td></td><td class="s">        SQL_NUMERIC</td></tr>
<tr><td class="h"><a name="183"></a>183</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DECIMAL</td></tr>
<tr><td class="h"><a name="184"></a>184</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTEGER</td></tr>
<tr><td class="h"><a name="185"></a>185</td><td></td><td></td><td></td><td></td><td class="s">        SQL_SMALLINT</td></tr>
<tr><td class="h"><a name="186"></a>186</td><td></td><td></td><td></td><td></td><td class="s">        SQL_FLOAT</td></tr>
<tr><td class="h"><a name="187"></a>187</td><td></td><td></td><td></td><td></td><td class="s">        SQL_REAL</td></tr>
<tr><td class="h"><a name="188"></a>188</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DOUBLE</td></tr>
<tr><td class="h"><a name="189"></a>189</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DATETIME</td></tr>
<tr><td class="h"><a name="190"></a>190</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DATE</td></tr>
<tr><td class="h"><a name="191"></a>191</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL</td></tr>
<tr><td class="h"><a name="192"></a>192</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TIME</td></tr>
<tr><td class="h"><a name="193"></a>193</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TIMESTAMP</td></tr>
<tr><td class="h"><a name="194"></a>194</td><td></td><td></td><td></td><td></td><td class="s">        SQL_VARCHAR</td></tr>
<tr><td class="h"><a name="195"></a>195</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BOOLEAN</td></tr>
<tr><td class="h"><a name="196"></a>196</td><td></td><td></td><td></td><td></td><td class="s">        SQL_UDT</td></tr>
<tr><td class="h"><a name="197"></a>197</td><td></td><td></td><td></td><td></td><td class="s">        SQL_UDT_LOCATOR</td></tr>
<tr><td class="h"><a name="198"></a>198</td><td></td><td></td><td></td><td></td><td class="s">        SQL_ROW</td></tr>
<tr><td class="h"><a name="199"></a>199</td><td></td><td></td><td></td><td></td><td class="s">        SQL_REF</td></tr>
<tr><td class="h"><a name="200"></a>200</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BLOB</td></tr>
<tr><td class="h"><a name="201"></a>201</td><td></td><td></td><td></td><td></td><td class="s">        SQL_BLOB_LOCATOR</td></tr>
<tr><td class="h"><a name="202"></a>202</td><td></td><td></td><td></td><td></td><td class="s">        SQL_CLOB</td></tr>
<tr><td class="h"><a name="203"></a>203</td><td></td><td></td><td></td><td></td><td class="s">        SQL_CLOB_LOCATOR</td></tr>
<tr><td class="h"><a name="204"></a>204</td><td></td><td></td><td></td><td></td><td class="s">        SQL_ARRAY</td></tr>
<tr><td class="h"><a name="205"></a>205</td><td></td><td></td><td></td><td></td><td class="s">        SQL_ARRAY_LOCATOR</td></tr>
<tr><td class="h"><a name="206"></a>206</td><td></td><td></td><td></td><td></td><td class="s">        SQL_MULTISET</td></tr>
<tr><td class="h"><a name="207"></a>207</td><td></td><td></td><td></td><td></td><td class="s">        SQL_MULTISET_LOCATOR</td></tr>
<tr><td class="h"><a name="208"></a>208</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TYPE_DATE</td></tr>
<tr><td class="h"><a name="209"></a>209</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TYPE_TIME</td></tr>
<tr><td class="h"><a name="210"></a>210</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TYPE_TIMESTAMP</td></tr>
<tr><td class="h"><a name="211"></a>211</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TYPE_TIME_WITH_TIMEZONE</td></tr>
<tr><td class="h"><a name="212"></a>212</td><td></td><td></td><td></td><td></td><td class="s">        SQL_TYPE_TIMESTAMP_WITH_TIMEZONE</td></tr>
<tr><td class="h"><a name="213"></a>213</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_YEAR</td></tr>
<tr><td class="h"><a name="214"></a>214</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_MONTH</td></tr>
<tr><td class="h"><a name="215"></a>215</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_DAY</td></tr>
<tr><td class="h"><a name="216"></a>216</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_HOUR</td></tr>
<tr><td class="h"><a name="217"></a>217</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_MINUTE</td></tr>
<tr><td class="h"><a name="218"></a>218</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_SECOND</td></tr>
<tr><td class="h"><a name="219"></a>219</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_YEAR_TO_MONTH</td></tr>
<tr><td class="h"><a name="220"></a>220</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_DAY_TO_HOUR</td></tr>
<tr><td class="h"><a name="221"></a>221</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_DAY_TO_MINUTE</td></tr>
<tr><td class="h"><a name="222"></a>222</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_DAY_TO_SECOND</td></tr>
<tr><td class="h"><a name="223"></a>223</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_HOUR_TO_MINUTE</td></tr>
<tr><td class="h"><a name="224"></a>224</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_HOUR_TO_SECOND</td></tr>
<tr><td class="h"><a name="225"></a>225</td><td></td><td></td><td></td><td></td><td class="s">        SQL_INTERVAL_MINUTE_TO_SECOND</td></tr>
<tr><td class="h"><a name="226"></a>226</td><td></td><td></td><td></td><td></td><td class="s">   ) ],</td></tr>
<tr><td class="h"><a name="227"></a>227</td><td></td><td></td><td></td><td></td><td class="s">   sql_cursor_types =&gt; [ qw(</td></tr>
<tr><td class="h"><a name="228"></a>228</td><td></td><td></td><td></td><td></td><td class="s">         SQL_CURSOR_FORWARD_ONLY</td></tr>
<tr><td class="h"><a name="229"></a>229</td><td></td><td></td><td></td><td></td><td class="s">         SQL_CURSOR_KEYSET_DRIVEN</td></tr>
<tr><td class="h"><a name="230"></a>230</td><td></td><td></td><td></td><td></td><td class="s">         SQL_CURSOR_DYNAMIC</td></tr>
<tr><td class="h"><a name="231"></a>231</td><td></td><td></td><td></td><td></td><td class="s">         SQL_CURSOR_STATIC</td></tr>
<tr><td class="h"><a name="232"></a>232</td><td></td><td></td><td></td><td></td><td class="s">         SQL_CURSOR_TYPE_DEFAULT</td></tr>
<tr><td class="h"><a name="233"></a>233</td><td></td><td></td><td></td><td></td><td class="s">   ) ], # for ODBC cursor types</td></tr>
<tr><td class="h"><a name="234"></a>234</td><td></td><td></td><td></td><td></td><td class="s">   utils     =&gt; [ qw(</td></tr>
<tr><td class="h"><a name="235"></a>235</td><td></td><td></td><td></td><td></td><td class="s">        neat neat_list $neat_maxlen dump_results looks_like_number</td></tr>
<tr><td class="h"><a name="236"></a>236</td><td></td><td></td><td></td><td></td><td class="s">        data_string_diff data_string_desc data_diff</td></tr>
<tr><td class="h"><a name="237"></a>237</td><td></td><td></td><td></td><td></td><td class="s">   ) ],</td></tr>
<tr><td class="h"><a name="238"></a>238</td><td></td><td></td><td></td><td></td><td class="s">   profile   =&gt; [ qw(</td></tr>
<tr><td class="h"><a name="239"></a>239</td><td></td><td></td><td></td><td></td><td class="s">        dbi_profile dbi_profile_merge dbi_profile_merge_nodes dbi_time</td></tr>
<tr><td class="h"><a name="240"></a>240</td><td></td><td></td><td></td><td></td><td class="s">   ) ], # notionally &quot;in&quot; DBI::Profile and normally imported from there</td></tr>
<tr><td class="h"><a name="241"></a>241</td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h"><a name="242"></a>242</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="243"></a>243</td><td></td><td></td><td></td><td></td><td class="s">$DBI::dbi_debug = 0;</td></tr>
<tr><td class="h"><a name="244"></a>244</td><td></td><td></td><td></td><td></td><td class="s">$DBI::neat_maxlen = 1000;</td></tr>
<tr><td class="h"><a name="245"></a>245</td><td></td><td></td><td></td><td></td><td class="s">$DBI::stderr = 2_000_000_000; # a very round number below 2**31</td></tr>
<tr><td class="h"><a name="246"></a>246</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="247"></a>247</td><td></td><td></td><td></td><td></td><td class="s"># If you get an error here like &quot;Can't find loadable object ...&quot;</td></tr>
<tr><td class="h"><a name="248"></a>248</td><td></td><td></td><td></td><td></td><td class="s"># then you haven't installed the DBI correctly. Read the README</td></tr>
<tr><td class="h"><a name="249"></a>249</td><td></td><td></td><td></td><td></td><td class="s"># then install it again.</td></tr>
<tr><td class="h"><a name="250"></a>250</td><td class="c3">1</td><td class="c3"><span title="Avg 6&micro;s">6&micro;s</span></td><td></td><td></td><td class="s">if ( $ENV{DBI_PUREPERL} ) {</td></tr>
<tr><td class="h"><a name="251"></a>251</td><td></td><td></td><td></td><td></td><td class="s">    eval { bootstrap DBI } if       $ENV{DBI_PUREPERL} == 1;</td></tr>
<tr><td class="h"><a name="252"></a>252</td><td></td><td></td><td></td><td></td><td class="s">    require DBI::PurePerl  if $@ or $ENV{DBI_PUREPERL} &gt;= 2;</td></tr>
<tr><td class="h"><a name="253"></a>253</td><td></td><td></td><td></td><td></td><td class="s">    $DBI::PurePerl ||= 0; # just to silence &quot;only used once&quot; warnings</td></tr>
<tr><td class="h"><a name="254"></a>254</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="255"></a>255</td><td></td><td></td><td></td><td></td><td class="s">else {</td></tr>
<tr><td class="h"><a name="256"></a>256</td><td></td><td></td><td></td><td></td><td class="s">    bootstrap DBI;<div class="calls"><div class="calls_out">    # spent   499&micro;s making 1 call to <a href="DynaLoader-pm-block.html#112">DynaLoader::bootstrap</a></div></div></td></tr>
<tr><td class="h"><a name="257"></a>257</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="258"></a>258</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="259"></a>259</td><td class="c0">117</td><td class="c0"><span title="Avg 2&micro;s">287&micro;s</span></td><td class="c0">117</td><td class="c0">75&micro;s</td><td class="s">$EXPORT_TAGS{preparse_flags} = [ grep { /^DBIpp_\w\w_/ } keys %{__PACKAGE__.&quot;::&quot;} ];<div class="calls"><div class="calls_out"># spent    75&micro;s making 117 calls to <a href="DBI-pm-block.html#DBI__CORE_match">DBI::CORE:match</a>, avg 638ns/call</div></div></td></tr>
<tr><td class="h"><a name="260"></a>260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="261"></a>261</td><td></td><td></td><td></td><td></td><td class="s">Exporter::export_ok_tags(keys %EXPORT_TAGS);<div class="calls"><div class="calls_out"># spent  1.83ms making 1 call to <a href="Exporter-pm-block.html#88">Exporter::export_ok_tags</a></div></div></td></tr>
<tr><td class="h"><a name="262"></a>262</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="263"></a>263</td><td class="c3">1</td><td class="c0"><span title="Avg 52&micro;s">52&micro;s</span></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="264"></a>264</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="265"></a>265</td><td></td><td></td><td></td><td></td><td class="s"># Alias some handle methods to also be DBI class methods</td></tr>
<tr><td class="h"><a name="266"></a>266</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">for (qw(trace_msg set_err parse_trace_flag parse_trace_flags)) {</td></tr>
<tr><td class="h"><a name="267"></a>267</td><td class="c0">3</td><td class="c0"><span title="Avg 14&micro;s">42&micro;s</span></td><td class="c3">1</td><td class="c3">5&micro;s</td><td class="s">  no strict;<div class="calls"><div class="calls_out">  # spent     5&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="268"></a>268</td><td class="c0">4</td><td class="c3"><span title="Avg 4&micro;s">15&micro;s</span></td><td></td><td></td><td class="s">  *$_ = \&amp;{&quot;DBD::_::common::$_&quot;};</td></tr>
<tr><td class="h"><a name="269"></a>269</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="270"></a>270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="271"></a>271</td><td class="c0">3</td><td class="c0"><span title="Avg 436&micro;s">1.31ms</span></td><td class="c3">1</td><td class="c3">4&micro;s</td><td class="s">use strict;<div class="calls"><div class="calls_out"># spent     4&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="272"></a>272</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="273"></a>273</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">DBI-&gt;trace(split /=/, $ENV{DBI_TRACE}, 2) if $ENV{DBI_TRACE};</td></tr>
<tr><td class="h"><a name="274"></a>274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="275"></a>275</td><td class="c3">1</td><td class="c3"><span title="Avg 500ns">500ns</span></td><td></td><td></td><td class="s">$DBI::connect_via ||= &quot;connect&quot;;</td></tr>
<tr><td class="h"><a name="276"></a>276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="277"></a>277</td><td></td><td></td><td></td><td></td><td class="s"># check if user wants a persistent database connection ( Apache + mod_perl )</td></tr>
<tr><td class="h"><a name="278"></a>278</td><td class="c3">1</td><td class="c3"><span title="Avg 400ns">400ns</span></td><td></td><td></td><td class="s">if ($INC{'Apache/DBI.pm'} &amp;&amp; $ENV{MOD_PERL}) {</td></tr>
<tr><td class="h"><a name="279"></a>279</td><td></td><td></td><td></td><td></td><td class="s">    $DBI::connect_via = &quot;Apache::DBI::connect&quot;;</td></tr>
<tr><td class="h"><a name="280"></a>280</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;trace_msg(&quot;DBI connect via $DBI::connect_via in $INC{'Apache/DBI.pm'}\n&quot;);</td></tr>
<tr><td class="h"><a name="281"></a>281</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="282"></a>282</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="283"></a>283</td><td></td><td></td><td></td><td></td><td class="s"># check for weaken support, used by ChildHandles</td></tr>
<tr><td class="h"><a name="284"></a>284</td><td class="c0">4</td><td class="c0"><span title="Avg 25&micro;s">99&micro;s</span></td><td></td><td></td><td class="s">my $HAS_WEAKEN = eval {</td></tr>
<tr><td class="h"><a name="285"></a>285</td><td></td><td></td><td></td><td></td><td class="s">    require Scalar::Util;</td></tr>
<tr><td class="h"><a name="286"></a>286</td><td></td><td></td><td></td><td></td><td class="s">    # this will croak() if this Scalar::Util doesn't have a working weaken().</td></tr>
<tr><td class="h"><a name="287"></a>287</td><td></td><td></td><td></td><td></td><td class="s">    Scalar::Util::weaken( \my $test ); # same test as in t/72childhandles.t<div class="calls"><div class="calls_out">    # spent     4&micro;s making 1 call to <a href="Scalar-Util-pm-block.html#Scalar__Util__weaken">Scalar::Util::weaken</a></div></div></td></tr>
<tr><td class="h"><a name="288"></a>288</td><td></td><td></td><td></td><td></td><td class="s">    1;</td></tr>
<tr><td class="h"><a name="289"></a>289</td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h"><a name="290"></a>290</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="291"></a>291</td><td class="c3">1</td><td class="c3"><span title="Avg 800ns">800ns</span></td><td></td><td></td><td class="s">%DBI::installed_drh = ();  # maps driver names to installed driver handles</td></tr>
<tr><td class="h"><a name="292"></a>292</td><td></td><td></td><td></td><td></td><td class="s">sub installed_drivers { %DBI::installed_drh }</td></tr>
<tr><td class="h"><a name="293"></a>293</td><td class="c3">1</td><td class="c3"><span title="Avg 300ns">300ns</span></td><td></td><td></td><td class="s">%DBI::installed_methods = (); # XXX undocumented, may change</td></tr>
<tr><td class="h"><a name="294"></a>294</td><td></td><td></td><td></td><td></td><td class="s">sub installed_methods { %DBI::installed_methods }</td></tr>
<tr><td class="h"><a name="295"></a>295</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="296"></a>296</td><td></td><td></td><td></td><td></td><td class="s"># Setup special DBI dynamic variables. See DBI::var::FETCH for details.</td></tr>
<tr><td class="h"><a name="297"></a>297</td><td></td><td></td><td></td><td></td><td class="s"># These are dynamically associated with the last handle used.</td></tr>
<tr><td class="h"><a name="298"></a>298</td><td class="c3">1</td><td class="c3"><span title="Avg 4&micro;s">4&micro;s</span></td><td></td><td></td><td class="s">tie $DBI::err,    'DBI::var', '*err';    # special case: referenced via IHA list</td></tr>
<tr><td class="h"><a name="299"></a>299</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">tie $DBI::state,  'DBI::var', '&quot;state';  # special case: referenced via IHA list</td></tr>
<tr><td class="h"><a name="300"></a>300</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">tie $DBI::lasth,  'DBI::var', '!lasth';  # special case: return boolean</td></tr>
<tr><td class="h"><a name="301"></a>301</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">tie $DBI::errstr, 'DBI::var', '&amp;errstr'; # call &amp;errstr in last used pkg</td></tr>
<tr><td class="h"><a name="302"></a>302</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">tie $DBI::rows,   'DBI::var', '&amp;rows';   # call &amp;rows   in last used pkg</td></tr>
<tr><td class="h"><a name="303"></a>303</td><td class="c0">10</td><td class="c3"><span title="Avg 1&micro;s">12&micro;s</span></td><td></td><td></td><td class="s">sub DBI::var::TIESCALAR{ my $var = $_[1]; bless \$var, 'DBI::var'; }</td></tr>
<tr><td class="h"><a name="304"></a>304</td><td></td><td></td><td></td><td></td><td class="s">sub DBI::var::STORE    { Carp::croak(&quot;Can't modify \$DBI::${$_[0]} special variable&quot;) }</td></tr>
<tr><td class="h"><a name="305"></a>305</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="306"></a>306</td><td></td><td></td><td></td><td></td><td class="s">{   # used to catch DBI-&gt;{Attrib} mistake</td></tr>
<tr><td class="h"><a name="307"></a>307</td><td class="c1">2</td><td class="c3"><span title="Avg 4&micro;s">8&micro;s</span></td><td></td><td></td><td class="s">    sub DBI::DBI_tie::TIEHASH { bless {} }</td></tr>
<tr><td class="h"><a name="308"></a>308</td><td></td><td></td><td></td><td></td><td class="s">    sub DBI::DBI_tie::STORE   { Carp::carp(&quot;DBI-&gt;{$_[1]} is invalid syntax (you probably want \$h-&gt;{$_[1]})&quot;);}</td></tr>
<tr><td class="h"><a name="309"></a>309</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">    *DBI::DBI_tie::FETCH = \&amp;DBI::DBI_tie::STORE;</td></tr>
<tr><td class="h"><a name="310"></a>310</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="311"></a>311</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">tie %DBI::DBI =&gt; 'DBI::DBI_tie';</td></tr>
<tr><td class="h"><a name="312"></a>312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="313"></a>313</td><td></td><td></td><td></td><td></td><td class="s"># --- Driver Specific Prefix Registry ---</td></tr>
<tr><td class="h"><a name="314"></a>314</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="315"></a>315</td><td class="c3">1</td><td class="c1"><span title="Avg 39&micro;s">39&micro;s</span></td><td></td><td></td><td class="s">my $dbd_prefix_registry = {</td></tr>
<tr><td class="h"><a name="316"></a>316</td><td></td><td></td><td></td><td></td><td class="s">  ad_      =&gt; { class =&gt; 'DBD::AnyData',        },</td></tr>
<tr><td class="h"><a name="317"></a>317</td><td></td><td></td><td></td><td></td><td class="s">  ado_     =&gt; { class =&gt; 'DBD::ADO',                },</td></tr>
<tr><td class="h"><a name="318"></a>318</td><td></td><td></td><td></td><td></td><td class="s">  amzn_    =&gt; { class =&gt; 'DBD::Amazon',                },</td></tr>
<tr><td class="h"><a name="319"></a>319</td><td></td><td></td><td></td><td></td><td class="s">  best_    =&gt; { class =&gt; 'DBD::BestWins',        },</td></tr>
<tr><td class="h"><a name="320"></a>320</td><td></td><td></td><td></td><td></td><td class="s">  csv_     =&gt; { class =&gt; 'DBD::CSV',                },</td></tr>
<tr><td class="h"><a name="321"></a>321</td><td></td><td></td><td></td><td></td><td class="s">  db2_     =&gt; { class =&gt; 'DBD::DB2',                },</td></tr>
<tr><td class="h"><a name="322"></a>322</td><td></td><td></td><td></td><td></td><td class="s">  dbi_     =&gt; { class =&gt; 'DBI',                        },</td></tr>
<tr><td class="h"><a name="323"></a>323</td><td></td><td></td><td></td><td></td><td class="s">  dbm_     =&gt; { class =&gt; 'DBD::DBM',                },</td></tr>
<tr><td class="h"><a name="324"></a>324</td><td></td><td></td><td></td><td></td><td class="s">  df_      =&gt; { class =&gt; 'DBD::DF',                },</td></tr>
<tr><td class="h"><a name="325"></a>325</td><td></td><td></td><td></td><td></td><td class="s">  f_       =&gt; { class =&gt; 'DBD::File',                },</td></tr>
<tr><td class="h"><a name="326"></a>326</td><td></td><td></td><td></td><td></td><td class="s">  file_    =&gt; { class =&gt; 'DBD::TextFile',        },</td></tr>
<tr><td class="h"><a name="327"></a>327</td><td></td><td></td><td></td><td></td><td class="s">  go_      =&gt; { class =&gt; 'DBD::Gofer',          },</td></tr>
<tr><td class="h"><a name="328"></a>328</td><td></td><td></td><td></td><td></td><td class="s">  ib_      =&gt; { class =&gt; 'DBD::InterBase',        },</td></tr>
<tr><td class="h"><a name="329"></a>329</td><td></td><td></td><td></td><td></td><td class="s">  ing_     =&gt; { class =&gt; 'DBD::Ingres',                },</td></tr>
<tr><td class="h"><a name="330"></a>330</td><td></td><td></td><td></td><td></td><td class="s">  ix_      =&gt; { class =&gt; 'DBD::Informix',        },</td></tr>
<tr><td class="h"><a name="331"></a>331</td><td></td><td></td><td></td><td></td><td class="s">  jdbc_    =&gt; { class =&gt; 'DBD::JDBC',                },</td></tr>
<tr><td class="h"><a name="332"></a>332</td><td></td><td></td><td></td><td></td><td class="s">  monetdb_ =&gt; { class =&gt; 'DBD::monetdb',        },</td></tr>
<tr><td class="h"><a name="333"></a>333</td><td></td><td></td><td></td><td></td><td class="s">  msql_    =&gt; { class =&gt; 'DBD::mSQL',                },</td></tr>
<tr><td class="h"><a name="334"></a>334</td><td></td><td></td><td></td><td></td><td class="s">  mvsftp_  =&gt; { class =&gt; 'DBD::MVS_FTPSQL',        },</td></tr>
<tr><td class="h"><a name="335"></a>335</td><td></td><td></td><td></td><td></td><td class="s">  mysql_   =&gt; { class =&gt; 'DBD::mysql',                },</td></tr>
<tr><td class="h"><a name="336"></a>336</td><td></td><td></td><td></td><td></td><td class="s">  mx_      =&gt; { class =&gt; 'DBD::Multiplex',        },</td></tr>
<tr><td class="h"><a name="337"></a>337</td><td></td><td></td><td></td><td></td><td class="s">  nullp_   =&gt; { class =&gt; 'DBD::NullP',                },</td></tr>
<tr><td class="h"><a name="338"></a>338</td><td></td><td></td><td></td><td></td><td class="s">  odbc_    =&gt; { class =&gt; 'DBD::ODBC',                },</td></tr>
<tr><td class="h"><a name="339"></a>339</td><td></td><td></td><td></td><td></td><td class="s">  ora_     =&gt; { class =&gt; 'DBD::Oracle',                },</td></tr>
<tr><td class="h"><a name="340"></a>340</td><td></td><td></td><td></td><td></td><td class="s">  pg_      =&gt; { class =&gt; 'DBD::Pg',                },</td></tr>
<tr><td class="h"><a name="341"></a>341</td><td></td><td></td><td></td><td></td><td class="s">  plb_     =&gt; { class =&gt; 'DBD::Plibdata',        },</td></tr>
<tr><td class="h"><a name="342"></a>342</td><td></td><td></td><td></td><td></td><td class="s">  proxy_   =&gt; { class =&gt; 'DBD::Proxy',                },</td></tr>
<tr><td class="h"><a name="343"></a>343</td><td></td><td></td><td></td><td></td><td class="s">  rdb_     =&gt; { class =&gt; 'DBD::RDB',                },</td></tr>
<tr><td class="h"><a name="344"></a>344</td><td></td><td></td><td></td><td></td><td class="s">  sapdb_   =&gt; { class =&gt; 'DBD::SAP_DB',                },</td></tr>
<tr><td class="h"><a name="345"></a>345</td><td></td><td></td><td></td><td></td><td class="s">  solid_   =&gt; { class =&gt; 'DBD::Solid',                },</td></tr>
<tr><td class="h"><a name="346"></a>346</td><td></td><td></td><td></td><td></td><td class="s">  sponge_  =&gt; { class =&gt; 'DBD::Sponge',                },</td></tr>
<tr><td class="h"><a name="347"></a>347</td><td></td><td></td><td></td><td></td><td class="s">  sql_     =&gt; { class =&gt; 'SQL::Statement',        },</td></tr>
<tr><td class="h"><a name="348"></a>348</td><td></td><td></td><td></td><td></td><td class="s">  syb_     =&gt; { class =&gt; 'DBD::Sybase',                },</td></tr>
<tr><td class="h"><a name="349"></a>349</td><td></td><td></td><td></td><td></td><td class="s">  tdat_    =&gt; { class =&gt; 'DBD::Teradata',        },</td></tr>
<tr><td class="h"><a name="350"></a>350</td><td></td><td></td><td></td><td></td><td class="s">  tmpl_    =&gt; { class =&gt; 'DBD::Template',        },</td></tr>
<tr><td class="h"><a name="351"></a>351</td><td></td><td></td><td></td><td></td><td class="s">  tmplss_  =&gt; { class =&gt; 'DBD::TemplateSS',        },</td></tr>
<tr><td class="h"><a name="352"></a>352</td><td></td><td></td><td></td><td></td><td class="s">  tuber_   =&gt; { class =&gt; 'DBD::Tuber',                },</td></tr>
<tr><td class="h"><a name="353"></a>353</td><td></td><td></td><td></td><td></td><td class="s">  uni_     =&gt; { class =&gt; 'DBD::Unify',                },</td></tr>
<tr><td class="h"><a name="354"></a>354</td><td></td><td></td><td></td><td></td><td class="s">  vt_      =&gt; { class =&gt; 'DBD::Vt',                },</td></tr>
<tr><td class="h"><a name="355"></a>355</td><td></td><td></td><td></td><td></td><td class="s">  wmi_     =&gt; { class =&gt; 'DBD::WMI',                },</td></tr>
<tr><td class="h"><a name="356"></a>356</td><td></td><td></td><td></td><td></td><td class="s">  x_       =&gt; { }, # for private use</td></tr>
<tr><td class="h"><a name="357"></a>357</td><td></td><td></td><td></td><td></td><td class="s">  xbase_   =&gt; { class =&gt; 'DBD::XBase',                },</td></tr>
<tr><td class="h"><a name="358"></a>358</td><td></td><td></td><td></td><td></td><td class="s">  xl_      =&gt; { class =&gt; 'DBD::Excel',                },</td></tr>
<tr><td class="h"><a name="359"></a>359</td><td></td><td></td><td></td><td></td><td class="s">  yaswi_   =&gt; { class =&gt; 'DBD::Yaswi',                },</td></tr>
<tr><td class="h"><a name="360"></a>360</td><td></td><td></td><td></td><td></td><td class="s">};</td></tr>
<tr><td class="h"><a name="361"></a>361</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="362"></a>362</td><td></td><td></td><td></td><td></td><td class="s">sub dump_dbd_registry {</td></tr>
<tr><td class="h"><a name="363"></a>363</td><td></td><td></td><td></td><td></td><td class="s">    require Data::Dumper;</td></tr>
<tr><td class="h"><a name="364"></a>364</td><td></td><td></td><td></td><td></td><td class="s">    local $Data::Dumper::Sortkeys=1;</td></tr>
<tr><td class="h"><a name="365"></a>365</td><td></td><td></td><td></td><td></td><td class="s">    local $Data::Dumper::Indent=1;</td></tr>
<tr><td class="h"><a name="366"></a>366</td><td></td><td></td><td></td><td></td><td class="s">    print Data::Dumper-&gt;Dump([$dbd_prefix_registry], [qw($dbd_prefix_registry)]);</td></tr>
<tr><td class="h"><a name="367"></a>367</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="368"></a>368</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="369"></a>369</td><td></td><td></td><td></td><td></td><td class="s"># --- Dynamically create the DBI Standard Interface</td></tr>
<tr><td class="h"><a name="370"></a>370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="371"></a>371</td><td class="c3">1</td><td class="c3"><span title="Avg 900ns">900ns</span></td><td></td><td></td><td class="s">my $keeperr = { O=&gt;0x0004 };</td></tr>
<tr><td class="h"><a name="372"></a>372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="373"></a>373</td><td class="c3">1</td><td class="c0"><span title="Avg 215&micro;s">215&micro;s</span></td><td></td><td></td><td class="s">%DBI::DBI_methods = ( # Define the DBI interface methods per class:</td></tr>
<tr><td class="h"><a name="374"></a>374</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="375"></a>375</td><td></td><td></td><td></td><td></td><td class="s">    common =&gt; {                # Interface methods common to all DBI handle classes</td></tr>
<tr><td class="h"><a name="376"></a>376</td><td></td><td></td><td></td><td></td><td class="s">        'DESTROY'        =&gt; { O=&gt;0x004|0x10000 },</td></tr>
<tr><td class="h"><a name="377"></a>377</td><td></td><td></td><td></td><td></td><td class="s">        'CLEAR'          =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="378"></a>378</td><td></td><td></td><td></td><td></td><td class="s">        'EXISTS'         =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="379"></a>379</td><td></td><td></td><td></td><td></td><td class="s">        'FETCH'                =&gt; { O=&gt;0x0404 },</td></tr>
<tr><td class="h"><a name="380"></a>380</td><td></td><td></td><td></td><td></td><td class="s">        'FETCH_many'        =&gt; { O=&gt;0x0404 },</td></tr>
<tr><td class="h"><a name="381"></a>381</td><td></td><td></td><td></td><td></td><td class="s">        'FIRSTKEY'        =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="382"></a>382</td><td></td><td></td><td></td><td></td><td class="s">        'NEXTKEY'        =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="383"></a>383</td><td></td><td></td><td></td><td></td><td class="s">        'STORE'                =&gt; { O=&gt;0x0418 | 0x4 },</td></tr>
<tr><td class="h"><a name="384"></a>384</td><td></td><td></td><td></td><td></td><td class="s">        _not_impl        =&gt; undef,</td></tr>
<tr><td class="h"><a name="385"></a>385</td><td></td><td></td><td></td><td></td><td class="s">        can                =&gt; { O=&gt;0x0100 }, # special case, see dispatch</td></tr>
<tr><td class="h"><a name="386"></a>386</td><td></td><td></td><td></td><td></td><td class="s">        debug                  =&gt; { U =&gt;[1,2,'[$debug_level]'],        O=&gt;0x0004 }, # old name for trace</td></tr>
<tr><td class="h"><a name="387"></a>387</td><td></td><td></td><td></td><td></td><td class="s">        dump_handle         =&gt; { U =&gt;[1,3,'[$message [, $level]]'],        O=&gt;0x0004 },</td></tr>
<tr><td class="h"><a name="388"></a>388</td><td></td><td></td><td></td><td></td><td class="s">        err                =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="389"></a>389</td><td></td><td></td><td></td><td></td><td class="s">        errstr                =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="390"></a>390</td><td></td><td></td><td></td><td></td><td class="s">        state                =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="391"></a>391</td><td></td><td></td><td></td><td></td><td class="s">        func                   =&gt; { O=&gt;0x0006        },</td></tr>
<tr><td class="h"><a name="392"></a>392</td><td></td><td></td><td></td><td></td><td class="s">        parse_trace_flag   =&gt; { U =&gt;[2,2,'$name'],        O=&gt;0x0404, T=&gt;8 },</td></tr>
<tr><td class="h"><a name="393"></a>393</td><td></td><td></td><td></td><td></td><td class="s">        parse_trace_flags  =&gt; { U =&gt;[2,2,'$flags'],        O=&gt;0x0404, T=&gt;8 },</td></tr>
<tr><td class="h"><a name="394"></a>394</td><td></td><td></td><td></td><td></td><td class="s">        private_data        =&gt; { U =&gt;[1,1],                        O=&gt;0x0004 },</td></tr>
<tr><td class="h"><a name="395"></a>395</td><td></td><td></td><td></td><td></td><td class="s">        set_err                =&gt; { U =&gt;[3,6,'$err, $errmsg [, $state, $method, $rv]'], O=&gt;0x0010 },</td></tr>
<tr><td class="h"><a name="396"></a>396</td><td></td><td></td><td></td><td></td><td class="s">        trace                =&gt; { U =&gt;[1,3,'[$trace_level, [$filename]]'],        O=&gt;0x0004 },</td></tr>
<tr><td class="h"><a name="397"></a>397</td><td></td><td></td><td></td><td></td><td class="s">        trace_msg        =&gt; { U =&gt;[2,3,'$message_text [, $min_level ]' ],        O=&gt;0x0004, T=&gt;8 },</td></tr>
<tr><td class="h"><a name="398"></a>398</td><td></td><td></td><td></td><td></td><td class="s">        swap_inner_handle =&gt; { U =&gt;[2,3,'$h [, $allow_reparent ]'] },</td></tr>
<tr><td class="h"><a name="399"></a>399</td><td></td><td></td><td></td><td></td><td class="s">        private_attribute_info =&gt; { },</td></tr>
<tr><td class="h"><a name="400"></a>400</td><td></td><td></td><td></td><td></td><td class="s">    },</td></tr>
<tr><td class="h"><a name="401"></a>401</td><td></td><td></td><td></td><td></td><td class="s">    dr =&gt; {                # Database Driver Interface</td></tr>
<tr><td class="h"><a name="402"></a>402</td><td></td><td></td><td></td><td></td><td class="s">        'connect'  =&gt;        { U =&gt;[1,5,'[$db [,$user [,$passwd [,\%attr]]]]'], H=&gt;3, O=&gt;0x8000 },</td></tr>
<tr><td class="h"><a name="403"></a>403</td><td></td><td></td><td></td><td></td><td class="s">        'connect_cached'=&gt;{U=&gt;[1,5,'[$db [,$user [,$passwd [,\%attr]]]]'], H=&gt;3, O=&gt;0x8000 },</td></tr>
<tr><td class="h"><a name="404"></a>404</td><td></td><td></td><td></td><td></td><td class="s">        'disconnect_all'=&gt;{ U =&gt;[1,1], O=&gt;0x0800 },</td></tr>
<tr><td class="h"><a name="405"></a>405</td><td></td><td></td><td></td><td></td><td class="s">        data_sources =&gt; { U =&gt;[1,2,'[\%attr]' ], O=&gt;0x0800 },</td></tr>
<tr><td class="h"><a name="406"></a>406</td><td></td><td></td><td></td><td></td><td class="s">        default_user =&gt; { U =&gt;[3,4,'$user, $pass [, \%attr]' ] },</td></tr>
<tr><td class="h"><a name="407"></a>407</td><td></td><td></td><td></td><td></td><td class="s">        dbixs_revision  =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="408"></a>408</td><td></td><td></td><td></td><td></td><td class="s">    },</td></tr>
<tr><td class="h"><a name="409"></a>409</td><td></td><td></td><td></td><td></td><td class="s">    db =&gt; {                # Database Session Class Interface</td></tr>
<tr><td class="h"><a name="410"></a>410</td><td></td><td></td><td></td><td></td><td class="s">        data_sources        =&gt; { U =&gt;[1,2,'[\%attr]' ], O=&gt;0x0200 },</td></tr>
<tr><td class="h"><a name="411"></a>411</td><td></td><td></td><td></td><td></td><td class="s">        take_imp_data        =&gt; { U =&gt;[1,1], O=&gt;0x10000 },</td></tr>
<tr><td class="h"><a name="412"></a>412</td><td></td><td></td><td></td><td></td><td class="s">        clone           =&gt; { U =&gt;[1,2,'[\%attr]'] },</td></tr>
<tr><td class="h"><a name="413"></a>413</td><td></td><td></td><td></td><td></td><td class="s">        connected           =&gt; { U =&gt;[1,0], O =&gt; 0x0004 },</td></tr>
<tr><td class="h"><a name="414"></a>414</td><td></td><td></td><td></td><td></td><td class="s">        begin_work           =&gt; { U =&gt;[1,2,'[ \%attr ]'], O=&gt;0x0400 },</td></tr>
<tr><td class="h"><a name="415"></a>415</td><td></td><td></td><td></td><td></td><td class="s">        commit             =&gt; { U =&gt;[1,1], O=&gt;0x0480|0x0800 },</td></tr>
<tr><td class="h"><a name="416"></a>416</td><td></td><td></td><td></td><td></td><td class="s">        rollback           =&gt; { U =&gt;[1,1], O=&gt;0x0480|0x0800 },</td></tr>
<tr><td class="h"><a name="417"></a>417</td><td></td><td></td><td></td><td></td><td class="s">        'do'               =&gt; { U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x3200 },</td></tr>
<tr><td class="h"><a name="418"></a>418</td><td></td><td></td><td></td><td></td><td class="s">        last_insert_id        =&gt; { U =&gt;[5,6,'$catalog, $schema, $table_name, $field_name [, \%attr ]'], O=&gt;0x2800 },</td></tr>
<tr><td class="h"><a name="419"></a>419</td><td></td><td></td><td></td><td></td><td class="s">        preparse            =&gt; {  }, # XXX</td></tr>
<tr><td class="h"><a name="420"></a>420</td><td></td><td></td><td></td><td></td><td class="s">        prepare            =&gt; { U =&gt;[2,3,'$statement [, \%attr]'],                    O=&gt;0xA200 },</td></tr>
<tr><td class="h"><a name="421"></a>421</td><td></td><td></td><td></td><td></td><td class="s">        prepare_cached        =&gt; { U =&gt;[2,4,'$statement [, \%attr [, $if_active ] ]'],   O=&gt;0xA200 },</td></tr>
<tr><td class="h"><a name="422"></a>422</td><td></td><td></td><td></td><td></td><td class="s">        selectrow_array        =&gt; { U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="423"></a>423</td><td></td><td></td><td></td><td></td><td class="s">        selectrow_arrayref=&gt;{U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="424"></a>424</td><td></td><td></td><td></td><td></td><td class="s">        selectrow_hashref=&gt;{ U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="425"></a>425</td><td></td><td></td><td></td><td></td><td class="s">        selectall_arrayref=&gt;{U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="426"></a>426</td><td></td><td></td><td></td><td></td><td class="s">        selectall_hashref=&gt;{ U =&gt;[3,0,'$statement, $keyfield [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="427"></a>427</td><td></td><td></td><td></td><td></td><td class="s">        selectcol_arrayref=&gt;{U =&gt;[2,0,'$statement [, \%attr [, @bind_params ] ]'], O=&gt;0x2000 },</td></tr>
<tr><td class="h"><a name="428"></a>428</td><td></td><td></td><td></td><td></td><td class="s">        ping               =&gt; { U =&gt;[1,1], O=&gt;0x0404 },</td></tr>
<tr><td class="h"><a name="429"></a>429</td><td></td><td></td><td></td><td></td><td class="s">        disconnect         =&gt; { U =&gt;[1,1], O=&gt;0x0400|0x0800|0x10000 },</td></tr>
<tr><td class="h"><a name="430"></a>430</td><td></td><td></td><td></td><td></td><td class="s">        quote              =&gt; { U =&gt;[2,3, '$string [, $data_type ]' ], O=&gt;0x0430 },</td></tr>
<tr><td class="h"><a name="431"></a>431</td><td></td><td></td><td></td><td></td><td class="s">        quote_identifier=&gt; { U =&gt;[2,6, '$name [, ...] [, \%attr ]' ],    O=&gt;0x0430 },</td></tr>
<tr><td class="h"><a name="432"></a>432</td><td></td><td></td><td></td><td></td><td class="s">        rows               =&gt; $keeperr,</td></tr>
<tr><td class="h"><a name="433"></a>433</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="434"></a>434</td><td></td><td></td><td></td><td></td><td class="s">        tables          =&gt; { U =&gt;[1,6,'$catalog, $schema, $table, $type [, \%attr ]' ], O=&gt;0x2200 },</td></tr>
<tr><td class="h"><a name="435"></a>435</td><td></td><td></td><td></td><td></td><td class="s">        table_info      =&gt; { U =&gt;[1,6,'$catalog, $schema, $table, $type [, \%attr ]' ],        O=&gt;0x2200|0x8800 },</td></tr>
<tr><td class="h"><a name="436"></a>436</td><td></td><td></td><td></td><td></td><td class="s">        column_info     =&gt; { U =&gt;[5,6,'$catalog, $schema, $table, $column [, \%attr ]'],O=&gt;0x2200|0x8800 },</td></tr>
<tr><td class="h"><a name="437"></a>437</td><td></td><td></td><td></td><td></td><td class="s">        primary_key_info=&gt; { U =&gt;[4,5,'$catalog, $schema, $table [, \%attr ]' ],        O=&gt;0x2200|0x8800 },</td></tr>
<tr><td class="h"><a name="438"></a>438</td><td></td><td></td><td></td><td></td><td class="s">        primary_key     =&gt; { U =&gt;[4,5,'$catalog, $schema, $table [, \%attr ]' ],        O=&gt;0x2200 },</td></tr>
<tr><td class="h"><a name="439"></a>439</td><td></td><td></td><td></td><td></td><td class="s">        foreign_key_info=&gt; { U =&gt;[7,8,'$pk_catalog, $pk_schema, $pk_table, $fk_catalog, $fk_schema, $fk_table [, \%attr ]' ], O=&gt;0x2200|0x8800 },</td></tr>
<tr><td class="h"><a name="440"></a>440</td><td></td><td></td><td></td><td></td><td class="s">        statistics_info =&gt; { U =&gt;[6,7,'$catalog, $schema, $table, $unique_only, $quick, [, \%attr ]' ], O=&gt;0x2200|0x8800 },</td></tr>
<tr><td class="h"><a name="441"></a>441</td><td></td><td></td><td></td><td></td><td class="s">        type_info_all        =&gt; { U =&gt;[1,1], O=&gt;0x2200|0x0800 },</td></tr>
<tr><td class="h"><a name="442"></a>442</td><td></td><td></td><td></td><td></td><td class="s">        type_info        =&gt; { U =&gt;[1,2,'$data_type'], O=&gt;0x2200 },</td></tr>
<tr><td class="h"><a name="443"></a>443</td><td></td><td></td><td></td><td></td><td class="s">        get_info        =&gt; { U =&gt;[2,2,'$info_type'], O=&gt;0x2200|0x0800 },</td></tr>
<tr><td class="h"><a name="444"></a>444</td><td></td><td></td><td></td><td></td><td class="s">    },</td></tr>
<tr><td class="h"><a name="445"></a>445</td><td></td><td></td><td></td><td></td><td class="s">    st =&gt; {                # Statement Class Interface</td></tr>
<tr><td class="h"><a name="446"></a>446</td><td></td><td></td><td></td><td></td><td class="s">        bind_col        =&gt; { U =&gt;[3,4,'$column, \\$var [, \%attr]'] },</td></tr>
<tr><td class="h"><a name="447"></a>447</td><td></td><td></td><td></td><td></td><td class="s">        bind_columns        =&gt; { U =&gt;[2,0,'\\$var1 [, \\$var2, ...]'] },</td></tr>
<tr><td class="h"><a name="448"></a>448</td><td></td><td></td><td></td><td></td><td class="s">        bind_param        =&gt; { U =&gt;[3,4,'$parameter, $var [, \%attr]'] },</td></tr>
<tr><td class="h"><a name="449"></a>449</td><td></td><td></td><td></td><td></td><td class="s">        bind_param_inout=&gt; { U =&gt;[4,5,'$parameter, \\$var, $maxlen, [, \%attr]'] },</td></tr>
<tr><td class="h"><a name="450"></a>450</td><td></td><td></td><td></td><td></td><td class="s">        execute                =&gt; { U =&gt;[1,0,'[@args]'], O=&gt;0x1040 },</td></tr>
<tr><td class="h"><a name="451"></a>451</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="452"></a>452</td><td></td><td></td><td></td><td></td><td class="s">        bind_param_array  =&gt; { U =&gt;[3,4,'$parameter, $var [, \%attr]'] },</td></tr>
<tr><td class="h"><a name="453"></a>453</td><td></td><td></td><td></td><td></td><td class="s">        bind_param_inout_array =&gt; { U =&gt;[4,5,'$parameter, \\@var, $maxlen, [, \%attr]'] },</td></tr>
<tr><td class="h"><a name="454"></a>454</td><td></td><td></td><td></td><td></td><td class="s">        execute_array     =&gt; { U =&gt;[2,0,'\\%attribs [, @args]'],         O=&gt;0x1040|0x4000 },</td></tr>
<tr><td class="h"><a name="455"></a>455</td><td></td><td></td><td></td><td></td><td class="s">        execute_for_fetch =&gt; { U =&gt;[2,3,'$fetch_sub [, $tuple_status]'], O=&gt;0x1040|0x4000 },</td></tr>
<tr><td class="h"><a name="456"></a>456</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="457"></a>457</td><td></td><td></td><td></td><td></td><td class="s">        fetch              =&gt; undef, # alias for fetchrow_arrayref</td></tr>
<tr><td class="h"><a name="458"></a>458</td><td></td><td></td><td></td><td></td><td class="s">        fetchrow_arrayref =&gt; undef,</td></tr>
<tr><td class="h"><a name="459"></a>459</td><td></td><td></td><td></td><td></td><td class="s">        fetchrow_hashref  =&gt; undef,</td></tr>
<tr><td class="h"><a name="460"></a>460</td><td></td><td></td><td></td><td></td><td class="s">        fetchrow_array    =&gt; undef,</td></tr>
<tr><td class="h"><a name="461"></a>461</td><td></td><td></td><td></td><td></td><td class="s">        fetchrow             =&gt; undef, # old alias for fetchrow_array</td></tr>
<tr><td class="h"><a name="462"></a>462</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="463"></a>463</td><td></td><td></td><td></td><td></td><td class="s">        fetchall_arrayref =&gt; { U =&gt;[1,3, '[ $slice [, $max_rows]]'] },</td></tr>
<tr><td class="h"><a name="464"></a>464</td><td></td><td></td><td></td><td></td><td class="s">        fetchall_hashref  =&gt; { U =&gt;[2,2,'$key_field'] },</td></tr>
<tr><td class="h"><a name="465"></a>465</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="466"></a>466</td><td></td><td></td><td></td><td></td><td class="s">        blob_read  =&gt;        { U =&gt;[4,5,'$field, $offset, $len [, \\$buf [, $bufoffset]]'] },</td></tr>
<tr><td class="h"><a name="467"></a>467</td><td></td><td></td><td></td><td></td><td class="s">        blob_copy_to_file =&gt; { U =&gt;[3,3,'$field, $filename_or_handleref'] },</td></tr>
<tr><td class="h"><a name="468"></a>468</td><td></td><td></td><td></td><td></td><td class="s">        dump_results =&gt; { U =&gt;[1,5,'$maxfieldlen, $linesep, $fieldsep, $filehandle'] },</td></tr>
<tr><td class="h"><a name="469"></a>469</td><td></td><td></td><td></td><td></td><td class="s">        more_results =&gt; { U =&gt;[1,1] },</td></tr>
<tr><td class="h"><a name="470"></a>470</td><td></td><td></td><td></td><td></td><td class="s">        finish     =&gt;         { U =&gt;[1,1] },</td></tr>
<tr><td class="h"><a name="471"></a>471</td><td></td><td></td><td></td><td></td><td class="s">        cancel     =&gt;         { U =&gt;[1,1], O=&gt;0x0800 },</td></tr>
<tr><td class="h"><a name="472"></a>472</td><td></td><td></td><td></td><td></td><td class="s">        rows       =&gt;        $keeperr,</td></tr>
<tr><td class="h"><a name="473"></a>473</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="474"></a>474</td><td></td><td></td><td></td><td></td><td class="s">        _get_fbav        =&gt; undef,</td></tr>
<tr><td class="h"><a name="475"></a>475</td><td></td><td></td><td></td><td></td><td class="s">        _set_fbav        =&gt; { T=&gt;6 },</td></tr>
<tr><td class="h"><a name="476"></a>476</td><td></td><td></td><td></td><td></td><td class="s">    },</td></tr>
<tr><td class="h"><a name="477"></a>477</td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h"><a name="478"></a>478</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="479"></a>479</td><td class="c0">9</td><td class="c3"><span title="Avg 1&micro;s">13&micro;s</span></td><td></td><td></td><td class="s">while ( my ($class, $meths) = each %DBI::DBI_methods ) {</td></tr>
<tr><td class="h"><a name="480"></a>480</td><td class="c3">1</td><td class="c3"><span title="Avg 5&micro;s">5&micro;s</span></td><td></td><td></td><td class="s">    my $ima_trace = 0+($ENV{DBI_IMA_TRACE}||0);</td></tr>
<tr><td class="h"><a name="481"></a>481</td><td class="c0">264</td><td class="c0"><span title="Avg 2&micro;s">590&micro;s</span></td><td></td><td></td><td class="s">    while ( my ($method, $info) = each %$meths ) {</td></tr>
<tr><td class="h"><a name="482"></a>482</td><td class="c3">1</td><td class="c0"><span title="Avg 126&micro;s">126&micro;s</span></td><td></td><td></td><td class="s">        my $fullmeth = &quot;DBI::${class}::$method&quot;;</td></tr>
<tr><td class="h"><a name="483"></a>483</td><td></td><td></td><td></td><td></td><td class="s">        if ($DBI::dbi_debug &gt;= 15) { # quick hack to list DBI methods</td></tr>
<tr><td class="h"><a name="484"></a>484</td><td></td><td></td><td></td><td></td><td class="s">            # and optionally filter by IMA flags</td></tr>
<tr><td class="h"><a name="485"></a>485</td><td></td><td></td><td></td><td></td><td class="s">            my $O = $info-&gt;{O}||0;</td></tr>
<tr><td class="h"><a name="486"></a>486</td><td></td><td></td><td></td><td></td><td class="s">            printf &quot;0x%04x %-20s\n&quot;, $O, $fullmeth</td></tr>
<tr><td class="h"><a name="487"></a>487</td><td></td><td></td><td></td><td></td><td class="s">                unless $ima_trace &amp;&amp; !($O &amp; $ima_trace);</td></tr>
<tr><td class="h"><a name="488"></a>488</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="489"></a>489</td><td></td><td></td><td></td><td></td><td class="s">        DBI-&gt;_install_method($fullmeth, 'DBI.pm', $info);<div class="calls"><div class="calls_out">        # spent   339&micro;s making 88 calls to <a href="DBI-pm-block.html#DBI___install_method">DBI::_install_method</a>, avg 4&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="490"></a>490</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="491"></a>491</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="492"></a>492</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="493"></a>493</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="494"></a>494</td><td class="c3">1</td><td class="c3"><span title="Avg 600ns">600ns</span></td><td></td><td></td><td class="s">    package DBI::common;</td></tr>
<tr><td class="h"><a name="495"></a>495</td><td class="c0">3</td><td class="c3"><span title="Avg 5&micro;s">15&micro;s</span></td><td></td><td></td><td class="s">    @DBI::dr::ISA = ('DBI::common');</td></tr>
<tr><td class="h"><a name="496"></a>496</td><td></td><td></td><td></td><td></td><td class="s">    @DBI::db::ISA = ('DBI::common');</td></tr>
<tr><td class="h"><a name="497"></a>497</td><td></td><td></td><td></td><td></td><td class="s">    @DBI::st::ISA = ('DBI::common');</td></tr>
<tr><td class="h"><a name="498"></a>498</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="499"></a>499</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="500"></a>500</td><td></td><td></td><td></td><td></td><td class="s"># End of init code</td></tr>
<tr><td class="h"><a name="501"></a>501</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="502"></a>502</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="503"></a>503</td><td></td><td></td><td></td><td></td><td class="s">END {</td></tr>
<tr><td class="h"><a name="504"></a>504</td><td class="c0">5</td><td class="c0"><span title="Avg 11&micro;s">57&micro;s</span></td><td></td><td></td><td class="s">    return unless defined &amp;DBI::trace_msg; # return unless bootstrap'd ok</td></tr>
<tr><td class="h"><a name="505"></a>505</td><td></td><td></td><td></td><td></td><td class="s">    local ($!,$?);</td></tr>
<tr><td class="h"><a name="506"></a>506</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;trace_msg(sprintf(&quot;    -- DBI::END (\$\@: %s, \$!: %s)\n&quot;, $@||'', $!||''), 2);<div class="calls"><div class="calls_out">    # spent     9&micro;s making 1 call to <a href="DBI-pm-block.html#DBD_____common__trace_msg">DBD::_::common::trace_msg</a></div></div></td></tr>
<tr><td class="h"><a name="507"></a>507</td><td></td><td></td><td></td><td></td><td class="s">    # Let drivers know why we are calling disconnect_all:</td></tr>
<tr><td class="h"><a name="508"></a>508</td><td></td><td></td><td></td><td></td><td class="s">    $DBI::PERL_ENDING = $DBI::PERL_ENDING = 1;        # avoid typo warning</td></tr>
<tr><td class="h"><a name="509"></a>509</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;disconnect_all() if %DBI::installed_drh;<div class="calls"><div class="calls_out">    # spent    26&micro;s making 1 call to <a href="DBI-pm-block.html#714">DBI::disconnect_all</a></div></div></td></tr>
<tr><td class="h"><a name="510"></a>510</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="511"></a>511</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="512"></a>512</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="513"></a>513</td><td></td><td></td><td></td><td></td><td class="s">sub CLONE {</td></tr>
<tr><td class="h"><a name="514"></a>514</td><td></td><td></td><td></td><td></td><td class="s">    my $olddbis = $DBI::_dbistate;</td></tr>
<tr><td class="h"><a name="515"></a>515</td><td></td><td></td><td></td><td></td><td class="s">    _clone_dbis() unless $DBI::PurePerl; # clone the DBIS structure</td></tr>
<tr><td class="h"><a name="516"></a>516</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;trace_msg(sprintf &quot;CLONE DBI for new thread %s\n&quot;,</td></tr>
<tr><td class="h"><a name="517"></a>517</td><td></td><td></td><td></td><td></td><td class="s">        $DBI::PurePerl ? &quot;&quot; : sprintf(&quot;(dbis %x -&gt; %x)&quot;,$olddbis, $DBI::_dbistate));</td></tr>
<tr><td class="h"><a name="518"></a>518</td><td></td><td></td><td></td><td></td><td class="s">    while ( my ($driver, $drh) = each %DBI::installed_drh) {</td></tr>
<tr><td class="h"><a name="519"></a>519</td><td class="c0">3</td><td class="c0"><span title="Avg 313&micro;s">939&micro;s</span></td><td class="c3">1</td><td class="c2">22&micro;s</td><td class="s">        no strict 'refs';<div class="calls"><div class="calls_out">        # spent    22&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="520"></a>520</td><td></td><td></td><td></td><td></td><td class="s">        next if defined &amp;{&quot;DBD::${driver}::CLONE&quot;};</td></tr>
<tr><td class="h"><a name="521"></a>521</td><td></td><td></td><td></td><td></td><td class="s">        warn(&quot;$driver has no driver CLONE() function so is unsafe threaded\n&quot;);</td></tr>
<tr><td class="h"><a name="522"></a>522</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="523"></a>523</td><td></td><td></td><td></td><td></td><td class="s">    %DBI::installed_drh = ();        # clear loaded drivers so they have a chance to reinitialize</td></tr>
<tr><td class="h"><a name="524"></a>524</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="525"></a>525</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="526"></a>526</td><td></td><td></td><td></td><td></td><td class="s">sub parse_dsn {</td></tr>
<tr><td class="h"><a name="527"></a>527</td><td></td><td></td><td></td><td></td><td class="s">    my ($class, $dsn) = @_;</td></tr>
<tr><td class="h"><a name="528"></a>528</td><td></td><td></td><td></td><td></td><td class="s">    $dsn =~ s/^(dbi):(\w*?)(?:\((.*?)\))?://i or return;</td></tr>
<tr><td class="h"><a name="529"></a>529</td><td></td><td></td><td></td><td></td><td class="s">    my ($scheme, $driver, $attr, $attr_hash) = (lc($1), $2, $3);</td></tr>
<tr><td class="h"><a name="530"></a>530</td><td></td><td></td><td></td><td></td><td class="s">    $driver ||= $ENV{DBI_DRIVER} || '';</td></tr>
<tr><td class="h"><a name="531"></a>531</td><td></td><td></td><td></td><td></td><td class="s">    $attr_hash = { split /\s*=&gt;?\s*|\s*,\s*/, $attr, -1 } if $attr;</td></tr>
<tr><td class="h"><a name="532"></a>532</td><td></td><td></td><td></td><td></td><td class="s">    return ($scheme, $driver, $attr, $attr_hash, $dsn);</td></tr>
<tr><td class="h"><a name="533"></a>533</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="534"></a>534</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="535"></a>535</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="536"></a>536</td><td></td><td></td><td></td><td></td><td class="s"># --- The DBI-&gt;connect Front Door methods</td></tr>
<tr><td class="h"><a name="537"></a>537</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="538"></a>538</td><td></td><td></td><td></td><td></td><td class="s">sub connect_cached {</td></tr>
<tr><td class="h"><a name="539"></a>539</td><td></td><td></td><td></td><td></td><td class="s">    # For library code using connect_cached() with mod_perl</td></tr>
<tr><td class="h"><a name="540"></a>540</td><td></td><td></td><td></td><td></td><td class="s">    # we redirect those calls to Apache::DBI::connect() as well</td></tr>
<tr><td class="h"><a name="541"></a>541</td><td></td><td></td><td></td><td></td><td class="s">    my ($class, $dsn, $user, $pass, $attr) = @_;</td></tr>
<tr><td class="h"><a name="542"></a>542</td><td></td><td></td><td></td><td></td><td class="s">    my $dbi_connect_method = ($DBI::connect_via eq &quot;Apache::DBI::connect&quot;)</td></tr>
<tr><td class="h"><a name="543"></a>543</td><td></td><td></td><td></td><td></td><td class="s">            ? 'Apache::DBI::connect' : 'connect_cached';</td></tr>
<tr><td class="h"><a name="544"></a>544</td><td></td><td></td><td></td><td></td><td class="s">    $attr = {</td></tr>
<tr><td class="h"><a name="545"></a>545</td><td></td><td></td><td></td><td></td><td class="s">        $attr ? %$attr : (), # clone, don't modify callers data</td></tr>
<tr><td class="h"><a name="546"></a>546</td><td></td><td></td><td></td><td></td><td class="s">        dbi_connect_method =&gt; $dbi_connect_method,</td></tr>
<tr><td class="h"><a name="547"></a>547</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="548"></a>548</td><td></td><td></td><td></td><td></td><td class="s">    return $class-&gt;connect($dsn, $user, $pass, $attr);</td></tr>
<tr><td class="h"><a name="549"></a>549</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="550"></a>550</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="551"></a>551</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 14.2ms (149&micro;s+14.0) within DBI::connect which was called 2 times, avg 7.09ms/call:
#    once (80&micro;s+13.2ms) by main::RUNTIME at <a href="www-svn-logzilla-scripts-db_inse-pl-block.html#112">line 112 of /www/svn/logzilla/scripts/db_inse.pl</a>
#    once (69&micro;s+857&micro;s) by main::RUNTIME at <a href="www-svn-logzilla-scripts-db_inse-pl-block.html#196">line 196 of /www/svn/logzilla/scripts/db_inse.pl</a></div></div>sub connect {</td></tr>
<tr><td class="h"><a name="552"></a>552</td><td class="c0">56</td><td class="c0"><span title="Avg 3&micro;s">161&micro;s</span></td><td></td><td></td><td class="s">    my $class = shift;</td></tr>
<tr><td class="h"><a name="553"></a>553</td><td></td><td></td><td></td><td></td><td class="s">    my ($dsn, $user, $pass, $attr, $old_driver) = my @orig_args = @_;</td></tr>
<tr><td class="h"><a name="554"></a>554</td><td></td><td></td><td></td><td></td><td class="s">    my $driver;</td></tr>
<tr><td class="h"><a name="555"></a>555</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="556"></a>556</td><td></td><td></td><td></td><td></td><td class="s">    if ($attr and !ref($attr)) { # switch $old_driver&lt;-&gt;$attr if called in old style</td></tr>
<tr><td class="h"><a name="557"></a>557</td><td></td><td></td><td></td><td></td><td class="s">        Carp::carp(&quot;DBI-&gt;connect using 'old-style' syntax is deprecated and will be an error in future versions&quot;);</td></tr>
<tr><td class="h"><a name="558"></a>558</td><td></td><td></td><td></td><td></td><td class="s">        ($old_driver, $attr) = ($attr, $old_driver);</td></tr>
<tr><td class="h"><a name="559"></a>559</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="560"></a>560</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="561"></a>561</td><td></td><td></td><td></td><td></td><td class="s">    my $connect_meth = $attr-&gt;{dbi_connect_method};</td></tr>
<tr><td class="h"><a name="562"></a>562</td><td></td><td></td><td></td><td></td><td class="s">    $connect_meth ||= $DBI::connect_via;        # fallback to default</td></tr>
<tr><td class="h"><a name="563"></a>563</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="564"></a>564</td><td></td><td></td><td></td><td></td><td class="s">    $dsn ||= $ENV{DBI_DSN} || $ENV{DBI_DBNAME} || '' unless $old_driver;</td></tr>
<tr><td class="h"><a name="565"></a>565</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="566"></a>566</td><td></td><td></td><td></td><td></td><td class="s">    if ($DBI::dbi_debug) {</td></tr>
<tr><td class="h"><a name="567"></a>567</td><td></td><td></td><td></td><td></td><td class="s">        local $^W = 0;</td></tr>
<tr><td class="h"><a name="568"></a>568</td><td></td><td></td><td></td><td></td><td class="s">        pop @_ if $connect_meth ne 'connect';</td></tr>
<tr><td class="h"><a name="569"></a>569</td><td></td><td></td><td></td><td></td><td class="s">        my @args = @_; $args[2] = '****'; # hide password</td></tr>
<tr><td class="h"><a name="570"></a>570</td><td></td><td></td><td></td><td></td><td class="s">        DBI-&gt;trace_msg(&quot;    -&gt; $class-&gt;$connect_meth(&quot;.join(&quot;, &quot;,@args).&quot;)\n&quot;);</td></tr>
<tr><td class="h"><a name="571"></a>571</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="572"></a>572</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak('Usage: $class-&gt;connect([$dsn [,$user [,$passwd [,\%attr]]]])')</td></tr>
<tr><td class="h"><a name="573"></a>573</td><td></td><td></td><td></td><td></td><td class="s">        if (ref $old_driver or ($attr and not ref $attr) or ref $pass);</td></tr>
<tr><td class="h"><a name="574"></a>574</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="575"></a>575</td><td></td><td></td><td></td><td></td><td class="s">    # extract dbi:driver prefix from $dsn into $1</td></tr>
<tr><td class="h"><a name="576"></a>576</td><td></td><td></td><td></td><td></td><td class="s">    $dsn =~ s/^dbi:(\w*?)(?:\((.*?)\))?://i<div class="calls"><div class="calls_out">    # spent    10&micro;s making 2 calls to <a href="DBI-pm-block.html#DBI__CORE_subst">DBI::CORE:subst</a>, avg 5&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="577"></a>577</td><td></td><td></td><td></td><td></td><td class="s">                        or '' =~ /()/; # ensure $1 etc are empty if match fails</td></tr>
<tr><td class="h"><a name="578"></a>578</td><td></td><td></td><td></td><td></td><td class="s">    my $driver_attrib_spec = $2 || '';</td></tr>
<tr><td class="h"><a name="579"></a>579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="580"></a>580</td><td></td><td></td><td></td><td></td><td class="s">    # Set $driver. Old style driver, if specified, overrides new dsn style.</td></tr>
<tr><td class="h"><a name="581"></a>581</td><td></td><td></td><td></td><td></td><td class="s">    $driver = $old_driver || $1 || $ENV{DBI_DRIVER}</td></tr>
<tr><td class="h"><a name="582"></a>582</td><td></td><td></td><td></td><td></td><td class="s">        or Carp::croak(&quot;Can't connect to data source '$dsn' &quot;</td></tr>
<tr><td class="h"><a name="583"></a>583</td><td></td><td></td><td></td><td></td><td class="s">            .&quot;because I can't work out what driver to use &quot;</td></tr>
<tr><td class="h"><a name="584"></a>584</td><td></td><td></td><td></td><td></td><td class="s">            .&quot;(it doesn't seem to contain a 'dbi:driver:' prefix &quot;</td></tr>
<tr><td class="h"><a name="585"></a>585</td><td></td><td></td><td></td><td></td><td class="s">            .&quot;and the DBI_DRIVER env var is not set)&quot;);</td></tr>
<tr><td class="h"><a name="586"></a>586</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="587"></a>587</td><td></td><td></td><td></td><td></td><td class="s">    my $proxy;</td></tr>
<tr><td class="h"><a name="588"></a>588</td><td></td><td></td><td></td><td></td><td class="s">    if ($ENV{DBI_AUTOPROXY} &amp;&amp; $driver ne 'Proxy' &amp;&amp; $driver ne 'Sponge' &amp;&amp; $driver ne 'Switch') {</td></tr>
<tr><td class="h"><a name="589"></a>589</td><td></td><td></td><td></td><td></td><td class="s">        my $dbi_autoproxy = $ENV{DBI_AUTOPROXY};</td></tr>
<tr><td class="h"><a name="590"></a>590</td><td></td><td></td><td></td><td></td><td class="s">        $proxy = 'Proxy';</td></tr>
<tr><td class="h"><a name="591"></a>591</td><td></td><td></td><td></td><td></td><td class="s">        if ($dbi_autoproxy =~ s/^dbi:(\w*?)(?:\((.*?)\))?://i) {</td></tr>
<tr><td class="h"><a name="592"></a>592</td><td></td><td></td><td></td><td></td><td class="s">            $proxy = $1;</td></tr>
<tr><td class="h"><a name="593"></a>593</td><td></td><td></td><td></td><td></td><td class="s">            $driver_attrib_spec = join &quot;,&quot;,</td></tr>
<tr><td class="h"><a name="594"></a>594</td><td></td><td></td><td></td><td></td><td class="s">                ($driver_attrib_spec) ? $driver_attrib_spec : (),</td></tr>
<tr><td class="h"><a name="595"></a>595</td><td></td><td></td><td></td><td></td><td class="s">                ($2                 ) ? $2                  : ();</td></tr>
<tr><td class="h"><a name="596"></a>596</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="597"></a>597</td><td></td><td></td><td></td><td></td><td class="s">        $dsn = &quot;$dbi_autoproxy;dsn=dbi:$driver:$dsn&quot;;</td></tr>
<tr><td class="h"><a name="598"></a>598</td><td></td><td></td><td></td><td></td><td class="s">        $driver = $proxy;</td></tr>
<tr><td class="h"><a name="599"></a>599</td><td></td><td></td><td></td><td></td><td class="s">        DBI-&gt;trace_msg(&quot;       DBI_AUTOPROXY: dbi:$driver($driver_attrib_spec):$dsn\n&quot;);</td></tr>
<tr><td class="h"><a name="600"></a>600</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="601"></a>601</td><td></td><td></td><td></td><td></td><td class="s">    # avoid recursion if proxy calls DBI-&gt;connect itself</td></tr>
<tr><td class="h"><a name="602"></a>602</td><td></td><td></td><td></td><td></td><td class="s">    local $ENV{DBI_AUTOPROXY};</td></tr>
<tr><td class="h"><a name="603"></a>603</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="604"></a>604</td><td></td><td></td><td></td><td></td><td class="s">    my %attributes;        # take a copy we can delete from</td></tr>
<tr><td class="h"><a name="605"></a>605</td><td class="c1">2</td><td class="c3"><span title="Avg 4&micro;s">8&micro;s</span></td><td></td><td></td><td class="s">    if ($old_driver) {</td></tr>
<tr><td class="h"><a name="606"></a>606</td><td></td><td></td><td></td><td></td><td class="s">        %attributes = %$attr if $attr;</td></tr>
<tr><td class="h"><a name="607"></a>607</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="608"></a>608</td><td></td><td></td><td></td><td></td><td class="s">    else {                # new-style connect so new default semantics</td></tr>
<tr><td class="h"><a name="609"></a>609</td><td></td><td></td><td></td><td></td><td class="s">        %attributes = (</td></tr>
<tr><td class="h"><a name="610"></a>610</td><td></td><td></td><td></td><td></td><td class="s">            PrintError =&gt; 1,</td></tr>
<tr><td class="h"><a name="611"></a>611</td><td></td><td></td><td></td><td></td><td class="s">            AutoCommit =&gt; 1,</td></tr>
<tr><td class="h"><a name="612"></a>612</td><td></td><td></td><td></td><td></td><td class="s">            ref $attr           ? %$attr : (),</td></tr>
<tr><td class="h"><a name="613"></a>613</td><td></td><td></td><td></td><td></td><td class="s">            # attributes in DSN take precedence over \%attr connect parameter</td></tr>
<tr><td class="h"><a name="614"></a>614</td><td></td><td></td><td></td><td></td><td class="s">            $driver_attrib_spec ? (split /\s*=&gt;?\s*|\s*,\s*/, $driver_attrib_spec, -1) : (),</td></tr>
<tr><td class="h"><a name="615"></a>615</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="616"></a>616</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="617"></a>617</td><td></td><td></td><td></td><td></td><td class="s">    $attr = \%attributes; # now set $attr to refer to our local copy</td></tr>
<tr><td class="h"><a name="618"></a>618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="619"></a>619</td><td></td><td></td><td></td><td></td><td class="s">    my $drh = $DBI::installed_drh{$driver} || $class-&gt;install_driver($driver)<div class="calls"><div class="calls_out">    # spent  9.94ms making 1 call to <a href="DBI-pm-block.html#727">DBI::install_driver</a></div></div></td></tr>
<tr><td class="h"><a name="620"></a>620</td><td></td><td></td><td></td><td></td><td class="s">        or die &quot;panic: $class-&gt;install_driver($driver) failed&quot;;</td></tr>
<tr><td class="h"><a name="621"></a>621</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="622"></a>622</td><td></td><td></td><td></td><td></td><td class="s">    # attributes in DSN take precedence over \%attr connect parameter</td></tr>
<tr><td class="h"><a name="623"></a>623</td><td></td><td></td><td></td><td></td><td class="s">    $user = $attr-&gt;{Username} if defined $attr-&gt;{Username};</td></tr>
<tr><td class="h"><a name="624"></a>624</td><td></td><td></td><td></td><td></td><td class="s">    $pass = $attr-&gt;{Password} if defined $attr-&gt;{Password};</td></tr>
<tr><td class="h"><a name="625"></a>625</td><td></td><td></td><td></td><td></td><td class="s">    delete $attr-&gt;{Password}; # always delete Password as closure stores it securely</td></tr>
<tr><td class="h"><a name="626"></a>626</td><td></td><td></td><td></td><td></td><td class="s">    if ( !(defined $user &amp;&amp; defined $pass) ) {</td></tr>
<tr><td class="h"><a name="627"></a>627</td><td></td><td></td><td></td><td></td><td class="s">        ($user, $pass) = $drh-&gt;default_user($user, $pass, $attr);</td></tr>
<tr><td class="h"><a name="628"></a>628</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="629"></a>629</td><td></td><td></td><td></td><td></td><td class="s">    $attr-&gt;{Username} = $user; # force the Username to be the actual one used</td></tr>
<tr><td class="h"><a name="630"></a>630</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="631"></a>631</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 4.07ms (169&micro;s+3.91) within DBI::__ANON__[/usr/lib/perl5/DBI.pm:704] which was called 2 times, avg 2.04ms/call:
# 2 times (169&micro;s+3.91ms) by DBI::connect at <a href="DBI-pm-block.html#706">line 706</a>, avg 2.04ms/call</div></div>    my $connect_closure = sub {</td></tr>
<tr><td class="h"><a name="632"></a>632</td><td class="c0">20</td><td class="c0"><span title="Avg 4&micro;s">77&micro;s</span></td><td></td><td></td><td class="s">        my ($old_dbh, $override_attr) = @_;</td></tr>
<tr><td class="h"><a name="633"></a>633</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="634"></a>634</td><td></td><td></td><td></td><td></td><td class="s">        #use Data::Dumper;</td></tr>
<tr><td class="h"><a name="635"></a>635</td><td></td><td></td><td></td><td></td><td class="s">        #warn &quot;connect_closure: &quot;.Data::Dumper::Dumper([$attr,\%attributes, $override_attr]);</td></tr>
<tr><td class="h"><a name="636"></a>636</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="637"></a>637</td><td></td><td></td><td></td><td></td><td class="s">        my $dbh;</td></tr>
<tr><td class="h"><a name="638"></a>638</td><td class="c3">1</td><td class="c3"><span title="Avg 17&micro;s">17&micro;s</span></td><td class="c1">2</td><td class="c0">3.53ms</td><td class="s">        unless ($dbh = $drh-&gt;$connect_meth($dsn, $user, $pass, $attr)) {<div class="calls"><div class="calls_out">        # spent  3.53ms making 2 calls to <a >DBI::dr::connect</a>, avg 1.77ms/call</div></div></td></tr>
<tr><td class="h"><a name="639"></a>639</td><td></td><td></td><td></td><td></td><td class="s">            $user = '' if !defined $user;</td></tr>
<tr><td class="h"><a name="640"></a>640</td><td></td><td></td><td></td><td></td><td class="s">            $dsn = '' if !defined $dsn;</td></tr>
<tr><td class="h"><a name="641"></a>641</td><td></td><td></td><td></td><td></td><td class="s">            # $drh-&gt;errstr isn't safe here because $dbh-&gt;DESTROY may not have</td></tr>
<tr><td class="h"><a name="642"></a>642</td><td></td><td></td><td></td><td></td><td class="s">            # been called yet and so the dbh errstr would not have been copied</td></tr>
<tr><td class="h"><a name="643"></a>643</td><td></td><td></td><td></td><td></td><td class="s">            # up to the drh errstr. Certainly true for connect_cached!</td></tr>
<tr><td class="h"><a name="644"></a>644</td><td></td><td></td><td></td><td></td><td class="s">            my $errstr = $DBI::errstr;</td></tr>
<tr><td class="h"><a name="645"></a>645</td><td></td><td></td><td></td><td></td><td class="s">            # Getting '(no error string)' here is a symptom of a ref loop</td></tr>
<tr><td class="h"><a name="646"></a>646</td><td></td><td></td><td></td><td></td><td class="s">            $errstr = '(no error string)' if !defined $errstr;</td></tr>
<tr><td class="h"><a name="647"></a>647</td><td></td><td></td><td></td><td></td><td class="s">            my $msg = &quot;$class connect('$dsn','$user',...) failed: $errstr&quot;;</td></tr>
<tr><td class="h"><a name="648"></a>648</td><td></td><td></td><td></td><td></td><td class="s">            DBI-&gt;trace_msg(&quot;       $msg\n&quot;);</td></tr>
<tr><td class="h"><a name="649"></a>649</td><td></td><td></td><td></td><td></td><td class="s">            # XXX HandleWarn</td></tr>
<tr><td class="h"><a name="650"></a>650</td><td></td><td></td><td></td><td></td><td class="s">            unless ($attr-&gt;{HandleError} &amp;&amp; $attr-&gt;{HandleError}-&gt;($msg, $drh, $dbh)) {</td></tr>
<tr><td class="h"><a name="651"></a>651</td><td></td><td></td><td></td><td></td><td class="s">                Carp::croak($msg) if $attr-&gt;{RaiseError};</td></tr>
<tr><td class="h"><a name="652"></a>652</td><td></td><td></td><td></td><td></td><td class="s">                Carp::carp ($msg) if $attr-&gt;{PrintError};</td></tr>
<tr><td class="h"><a name="653"></a>653</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="654"></a>654</td><td></td><td></td><td></td><td></td><td class="s">            $! = 0; # for the daft people who do DBI-&gt;connect(...) || die &quot;$!&quot;;</td></tr>
<tr><td class="h"><a name="655"></a>655</td><td></td><td></td><td></td><td></td><td class="s">            return $dbh; # normally undef, but HandleError could change it</td></tr>
<tr><td class="h"><a name="656"></a>656</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="657"></a>657</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="658"></a>658</td><td></td><td></td><td></td><td></td><td class="s">        # merge any attribute overrides but don't change $attr itself (for closure)</td></tr>
<tr><td class="h"><a name="659"></a>659</td><td></td><td></td><td></td><td></td><td class="s">        my $apply = { ($override_attr) ? (%$attr, %$override_attr ) : %$attr };</td></tr>
<tr><td class="h"><a name="660"></a>660</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="661"></a>661</td><td></td><td></td><td></td><td></td><td class="s">        # handle basic RootClass subclassing:</td></tr>
<tr><td class="h"><a name="662"></a>662</td><td></td><td></td><td></td><td></td><td class="s">        my $rebless_class = $apply-&gt;{RootClass} || ($class ne 'DBI' ? $class : '');</td></tr>
<tr><td class="h"><a name="663"></a>663</td><td></td><td></td><td></td><td></td><td class="s">        if ($rebless_class) {</td></tr>
<tr><td class="h"><a name="664"></a>664</td><td class="c0">3</td><td class="c0"><span title="Avg 255&micro;s">764&micro;s</span></td><td class="c3">1</td><td class="c3">16&micro;s</td><td class="s">            no strict 'refs';<div class="calls"><div class="calls_out">            # spent    16&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="665"></a>665</td><td></td><td></td><td></td><td></td><td class="s">            if ($apply-&gt;{RootClass}) { # explicit attribute (ie not static methd call class)</td></tr>
<tr><td class="h"><a name="666"></a>666</td><td></td><td></td><td></td><td></td><td class="s">                delete $apply-&gt;{RootClass};</td></tr>
<tr><td class="h"><a name="667"></a>667</td><td></td><td></td><td></td><td></td><td class="s">                DBI::_load_class($rebless_class, 0);</td></tr>
<tr><td class="h"><a name="668"></a>668</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="669"></a>669</td><td></td><td></td><td></td><td></td><td class="s">            unless (@{&quot;$rebless_class\::db::ISA&quot;} &amp;&amp; @{&quot;$rebless_class\::st::ISA&quot;}) {</td></tr>
<tr><td class="h"><a name="670"></a>670</td><td></td><td></td><td></td><td></td><td class="s">                Carp::carp(&quot;DBI subclasses '$rebless_class\::db' and ::st are not setup, RootClass ignored&quot;);</td></tr>
<tr><td class="h"><a name="671"></a>671</td><td></td><td></td><td></td><td></td><td class="s">                $rebless_class = undef;</td></tr>
<tr><td class="h"><a name="672"></a>672</td><td></td><td></td><td></td><td></td><td class="s">                $class = 'DBI';</td></tr>
<tr><td class="h"><a name="673"></a>673</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="674"></a>674</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="675"></a>675</td><td></td><td></td><td></td><td></td><td class="s">                $dbh-&gt;{RootClass} = $rebless_class; # $dbh-&gt;STORE called via plain DBI::db</td></tr>
<tr><td class="h"><a name="676"></a>676</td><td></td><td></td><td></td><td></td><td class="s">                DBI::_set_isa([$rebless_class], 'DBI');     # sets up both '::db' and '::st'</td></tr>
<tr><td class="h"><a name="677"></a>677</td><td></td><td></td><td></td><td></td><td class="s">                DBI::_rebless($dbh, $rebless_class);        # appends '::db'</td></tr>
<tr><td class="h"><a name="678"></a>678</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="679"></a>679</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="680"></a>680</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="681"></a>681</td><td class="c0">8</td><td class="c3"><span title="Avg 2&micro;s">14&micro;s</span></td><td></td><td></td><td class="s">        if (%$apply) {</td></tr>
<tr><td class="h"><a name="682"></a>682</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="683"></a>683</td><td></td><td></td><td></td><td></td><td class="s">            if ($apply-&gt;{DbTypeSubclass}) {</td></tr>
<tr><td class="h"><a name="684"></a>684</td><td></td><td></td><td></td><td></td><td class="s">                my $DbTypeSubclass = delete $apply-&gt;{DbTypeSubclass};</td></tr>
<tr><td class="h"><a name="685"></a>685</td><td></td><td></td><td></td><td></td><td class="s">                DBI::_rebless_dbtype_subclass($dbh, $rebless_class||$class, $DbTypeSubclass);</td></tr>
<tr><td class="h"><a name="686"></a>686</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="687"></a>687</td><td></td><td></td><td></td><td></td><td class="s">            my $a;</td></tr>
<tr><td class="h"><a name="688"></a>688</td><td></td><td></td><td></td><td></td><td class="s">            foreach $a (qw(Profile RaiseError PrintError AutoCommit)) { # do these first</td></tr>
<tr><td class="h"><a name="689"></a>689</td><td class="c0">12</td><td class="c0"><span title="Avg 33&micro;s">395&micro;s</span></td><td></td><td></td><td class="s">                next unless  exists $apply-&gt;{$a};</td></tr>
<tr><td class="h"><a name="690"></a>690</td><td></td><td></td><td></td><td></td><td class="s">                $dbh-&gt;{$a} = delete $apply-&gt;{$a};<div class="calls"><div class="calls_out">                # spent   342&micro;s making 4 calls to <a >DBI::common::STORE</a>, avg 86&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="691"></a>691</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="692"></a>692</td><td class="c1">2</td><td class="c1"><span title="Avg 14&micro;s">29&micro;s</span></td><td></td><td></td><td class="s">            while ( my ($a, $v) = each %$apply) {</td></tr>
<tr><td class="h"><a name="693"></a>693</td><td class="c1">2</td><td class="c1"><span title="Avg 18&micro;s">37&micro;s</span></td><td class="c0">4</td><td class="c2">22&micro;s</td><td class="s">                eval { $dbh-&gt;{$a} = $v } or $@ &amp;&amp; warn $@;<div class="calls"><div class="calls_out">                # spent    16&micro;s making 2 calls to <a >DBI::common::STORE</a>, avg 8&micro;s/call
                # spent     6&micro;s making 2 calls to <a >DBI::common::FETCH</a>, avg 3&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="694"></a>694</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="695"></a>695</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="696"></a>696</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="697"></a>697</td><td></td><td></td><td></td><td></td><td class="s">        # confirm to driver (ie if subclassed) that we've connected sucessfully</td></tr>
<tr><td class="h"><a name="698"></a>698</td><td></td><td></td><td></td><td></td><td class="s">        # and finished the attribute setup. pass in the original arguments</td></tr>
<tr><td class="h"><a name="699"></a>699</td><td></td><td></td><td></td><td></td><td class="s">        $dbh-&gt;connected(@orig_args); #if ref $dbh ne 'DBI::db' or $proxy;<div class="calls"><div class="calls_out">        # spent     8&micro;s making 2 calls to <a >DBI::db::connected</a>, avg 4&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="700"></a>700</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="701"></a>701</td><td></td><td></td><td></td><td></td><td class="s">        DBI-&gt;trace_msg(&quot;    &lt;- connect= $dbh\n&quot;) if $DBI::dbi_debug;</td></tr>
<tr><td class="h"><a name="702"></a>702</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="703"></a>703</td><td></td><td></td><td></td><td></td><td class="s">        return $dbh;</td></tr>
<tr><td class="h"><a name="704"></a>704</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="705"></a>705</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="706"></a>706</td><td></td><td></td><td></td><td></td><td class="s">    my $dbh = &amp;$connect_closure(undef, undef);<div class="calls"><div class="calls_out">    # spent  4.07ms making 2 calls to <a href="DBI-pm-block.html#631">DBI::__ANON__[DBI.pm:704]</a>, avg 2.04ms/call</div></div></td></tr>
<tr><td class="h"><a name="707"></a>707</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="708"></a>708</td><td></td><td></td><td></td><td></td><td class="s">    $dbh-&gt;{dbi_connect_closure} = $connect_closure if $dbh;<div class="calls"><div class="calls_out">    # spent    11&micro;s making 2 calls to <a >DBI::common::STORE</a>, avg 5&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="709"></a>709</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="710"></a>710</td><td></td><td></td><td></td><td></td><td class="s">    return $dbh;</td></tr>
<tr><td class="h"><a name="711"></a>711</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="712"></a>712</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="713"></a>713</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="714"></a>714</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 26&micro;s (15+11) within DBI::disconnect_all which was called
#    once (15&micro;s+11&micro;s) by DBI::END at <a href="DBI-pm-block.html#509">line 509</a></div></div>sub disconnect_all {</td></tr>
<tr><td class="h"><a name="715"></a>715</td><td class="c1">2</td><td class="c1"><span title="Avg 14&micro;s">28&micro;s</span></td><td></td><td></td><td class="s">    keys %DBI::installed_drh; # reset iterator</td></tr>
<tr><td class="h"><a name="716"></a>716</td><td></td><td></td><td></td><td></td><td class="s">    while ( my ($name, $drh) = each %DBI::installed_drh ) {<div class="calls"><div class="calls_out">    # spent    11&micro;s making 1 call to <a >DBI::dr::disconnect_all</a></div></div></td></tr>
<tr><td class="h"><a name="717"></a>717</td><td></td><td></td><td></td><td></td><td class="s">        $drh-&gt;disconnect_all() if ref $drh;</td></tr>
<tr><td class="h"><a name="718"></a>718</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="719"></a>719</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="720"></a>720</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="721"></a>721</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="722"></a>722</td><td></td><td></td><td></td><td></td><td class="s">sub disconnect {                # a regular beginners bug</td></tr>
<tr><td class="h"><a name="723"></a>723</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;DBI-&gt;disconnect is not a DBI method (read the DBI manual)&quot;);</td></tr>
<tr><td class="h"><a name="724"></a>724</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="725"></a>725</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="726"></a>726</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="727"></a>727</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9.94ms (7.41+2.52) within DBI::install_driver which was called
#    once (7.41ms+2.52ms) by DBI::connect at <a href="DBI-pm-block.html#619">line 619</a></div></div>sub install_driver {                # croaks on failure</td></tr>
<tr><td class="h"><a name="728"></a>728</td><td class="c0">18</td><td class="c0"><span title="Avg 3&micro;s">54&micro;s</span></td><td></td><td></td><td class="s">    my $class = shift;</td></tr>
<tr><td class="h"><a name="729"></a>729</td><td></td><td></td><td></td><td></td><td class="s">    my($driver, $attr) = @_;</td></tr>
<tr><td class="h"><a name="730"></a>730</td><td></td><td></td><td></td><td></td><td class="s">    my $drh;</td></tr>
<tr><td class="h"><a name="731"></a>731</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="732"></a>732</td><td></td><td></td><td></td><td></td><td class="s">    $driver ||= $ENV{DBI_DRIVER} || '';</td></tr>
<tr><td class="h"><a name="733"></a>733</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="734"></a>734</td><td></td><td></td><td></td><td></td><td class="s">    # allow driver to be specified as a 'dbi:driver:' string</td></tr>
<tr><td class="h"><a name="735"></a>735</td><td></td><td></td><td></td><td></td><td class="s">    $driver = $1 if $driver =~ s/^DBI:(.*?)://i;<div class="calls"><div class="calls_out">    # spent     1&micro;s making 1 call to <a href="DBI-pm-block.html#DBI__CORE_subst">DBI::CORE:subst</a></div></div></td></tr>
<tr><td class="h"><a name="736"></a>736</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="737"></a>737</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;usage: $class-&gt;install_driver(\$driver [, \%attr])&quot;)</td></tr>
<tr><td class="h"><a name="738"></a>738</td><td></td><td></td><td></td><td></td><td class="s">                unless ($driver and @_&lt;=3);</td></tr>
<tr><td class="h"><a name="739"></a>739</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="740"></a>740</td><td></td><td></td><td></td><td></td><td class="s">    # already installed</td></tr>
<tr><td class="h"><a name="741"></a>741</td><td></td><td></td><td></td><td></td><td class="s">    return $drh if $drh = $DBI::installed_drh{$driver};</td></tr>
<tr><td class="h"><a name="742"></a>742</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="743"></a>743</td><td></td><td></td><td></td><td></td><td class="s">    $class-&gt;trace_msg(&quot;    -&gt; $class-&gt;install_driver($driver&quot;</td></tr>
<tr><td class="h"><a name="744"></a>744</td><td></td><td></td><td></td><td></td><td class="s">                        .&quot;) for $^O perl=$] pid=$$ ruid=$&lt; euid=$&gt;\n&quot;)</td></tr>
<tr><td class="h"><a name="745"></a>745</td><td></td><td></td><td></td><td></td><td class="s">        if $DBI::dbi_debug;</td></tr>
<tr><td class="h"><a name="746"></a>746</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="747"></a>747</td><td></td><td></td><td></td><td></td><td class="s">    # --- load the code</td></tr>
<tr><td class="h"><a name="748"></a>748</td><td></td><td></td><td></td><td></td><td class="s">    my $driver_class = &quot;DBD::$driver&quot;;</td></tr>
<tr><td class="h"><a name="749"></a>749</td><td class="c3">1</td><td class="c0"><span title="Avg 76&micro;s">76&micro;s</span></td><td></td><td></td><td class="s">    eval qq{package                        # hide from PAUSE</td></tr>
<tr><td class="h"><a name="750"></a>750</td><td></td><td></td><td></td><td></td><td class="s">                DBI::_firesafe;                # just in case</td></tr>
<tr><td class="h"><a name="751"></a>751</td><td></td><td></td><td></td><td></td><td class="s">            require $driver_class;        # load the driver</td></tr>
<tr><td class="h"><a name="752"></a>752</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="753"></a>753</td><td></td><td></td><td></td><td></td><td class="s">    if ($@) {</td></tr>
<tr><td class="h"><a name="754"></a>754</td><td></td><td></td><td></td><td></td><td class="s">        my $err = $@;</td></tr>
<tr><td class="h"><a name="755"></a>755</td><td></td><td></td><td></td><td></td><td class="s">        my $advice = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="756"></a>756</td><td></td><td></td><td></td><td></td><td class="s">        if ($err =~ /Can't find loadable object/) {</td></tr>
<tr><td class="h"><a name="757"></a>757</td><td></td><td></td><td></td><td></td><td class="s">            $advice = &quot;Perhaps DBD::$driver was statically linked into a new perl binary.&quot;</td></tr>
<tr><td class="h"><a name="758"></a>758</td><td></td><td></td><td></td><td></td><td class="s">                 .&quot;\nIn which case you need to use that new perl binary.&quot;</td></tr>
<tr><td class="h"><a name="759"></a>759</td><td></td><td></td><td></td><td></td><td class="s">                 .&quot;\nOr perhaps only the .pm file was installed but not the shared object file.&quot;</td></tr>
<tr><td class="h"><a name="760"></a>760</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="761"></a>761</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($err =~ /Can't locate.*?DBD\/$driver\.pm in \@INC/) {</td></tr>
<tr><td class="h"><a name="762"></a>762</td><td></td><td></td><td></td><td></td><td class="s">            my @drv = $class-&gt;available_drivers(1);</td></tr>
<tr><td class="h"><a name="763"></a>763</td><td></td><td></td><td></td><td></td><td class="s">            $advice = &quot;Perhaps the DBD::$driver perl module hasn't been fully installed,\n&quot;</td></tr>
<tr><td class="h"><a name="764"></a>764</td><td></td><td></td><td></td><td></td><td class="s">                     .&quot;or perhaps the capitalisation of '$driver' isn't right.\n&quot;</td></tr>
<tr><td class="h"><a name="765"></a>765</td><td></td><td></td><td></td><td></td><td class="s">                     .&quot;Available drivers: &quot;.join(&quot;, &quot;, @drv).&quot;.&quot;;</td></tr>
<tr><td class="h"><a name="766"></a>766</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="767"></a>767</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($err =~ /Can't load .*? for module DBD::/) {</td></tr>
<tr><td class="h"><a name="768"></a>768</td><td></td><td></td><td></td><td></td><td class="s">            $advice = &quot;Perhaps a required shared library or dll isn't installed where expected&quot;;</td></tr>
<tr><td class="h"><a name="769"></a>769</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="770"></a>770</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($err =~ /Can't locate .*? in \@INC/) {</td></tr>
<tr><td class="h"><a name="771"></a>771</td><td></td><td></td><td></td><td></td><td class="s">            $advice = &quot;Perhaps a module that DBD::$driver requires hasn't been fully installed&quot;;</td></tr>
<tr><td class="h"><a name="772"></a>772</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="773"></a>773</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;install_driver($driver) failed: $err$advice\n&quot;);</td></tr>
<tr><td class="h"><a name="774"></a>774</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="775"></a>775</td><td></td><td></td><td></td><td></td><td class="s">    if ($DBI::dbi_debug) {</td></tr>
<tr><td class="h"><a name="776"></a>776</td><td class="c0">3</td><td class="c0"><span title="Avg 109&micro;s">326&micro;s</span></td><td class="c3">1</td><td class="c3">15&micro;s</td><td class="s">        no strict 'refs';<div class="calls"><div class="calls_out">        # spent    15&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="777"></a>777</td><td></td><td></td><td></td><td></td><td class="s">        (my $driver_file = $driver_class) =~ s/::/\//g;</td></tr>
<tr><td class="h"><a name="778"></a>778</td><td></td><td></td><td></td><td></td><td class="s">        my $dbd_ver = ${&quot;$driver_class\::VERSION&quot;} || &quot;undef&quot;;</td></tr>
<tr><td class="h"><a name="779"></a>779</td><td></td><td></td><td></td><td></td><td class="s">        $class-&gt;trace_msg(&quot;       install_driver: $driver_class version $dbd_ver&quot;</td></tr>
<tr><td class="h"><a name="780"></a>780</td><td></td><td></td><td></td><td></td><td class="s">                .&quot; loaded from $INC{qq($driver_file.pm)}\n&quot;);</td></tr>
<tr><td class="h"><a name="781"></a>781</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="782"></a>782</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="783"></a>783</td><td></td><td></td><td></td><td></td><td class="s">    # --- do some behind-the-scenes checks and setups on the driver</td></tr>
<tr><td class="h"><a name="784"></a>784</td><td></td><td></td><td></td><td></td><td class="s">    $class-&gt;setup_driver($driver_class);<div class="calls"><div class="calls_out">    # spent    86&micro;s making 1 call to <a href="DBI-pm-block.html#805">DBI::setup_driver</a></div></div></td></tr>
<tr><td class="h"><a name="785"></a>785</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="786"></a>786</td><td></td><td></td><td></td><td></td><td class="s">    # --- run the driver function</td></tr>
<tr><td class="h"><a name="787"></a>787</td><td class="c3">1</td><td class="c3"><span title="Avg 3&micro;s">3&micro;s</span></td><td class="c3">1</td><td class="c0">82&micro;s</td><td class="s">    $drh = eval { $driver_class-&gt;driver($attr || {}) };<div class="calls"><div class="calls_out">    # spent    82&micro;s making 1 call to <a href="DBD-mysql-pm-block.html#21">DBD::mysql::driver</a></div></div></td></tr>
<tr><td class="h"><a name="788"></a>788</td><td></td><td></td><td></td><td></td><td class="s">    unless ($drh &amp;&amp; ref $drh &amp;&amp; !$@) {</td></tr>
<tr><td class="h"><a name="789"></a>789</td><td></td><td></td><td></td><td></td><td class="s">        my $advice = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="790"></a>790</td><td></td><td></td><td></td><td></td><td class="s">        $@ ||= &quot;$driver_class-&gt;driver didn't return a handle&quot;;</td></tr>
<tr><td class="h"><a name="791"></a>791</td><td></td><td></td><td></td><td></td><td class="s">        # catch people on case in-sensitive systems using the wrong case</td></tr>
<tr><td class="h"><a name="792"></a>792</td><td></td><td></td><td></td><td></td><td class="s">        $advice = &quot;\nPerhaps the capitalisation of DBD '$driver' isn't right.&quot;</td></tr>
<tr><td class="h"><a name="793"></a>793</td><td></td><td></td><td></td><td></td><td class="s">                if $@ =~ /locate object method/;</td></tr>
<tr><td class="h"><a name="794"></a>794</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;$driver_class initialisation failed: $@$advice&quot;);</td></tr>
<tr><td class="h"><a name="795"></a>795</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="796"></a>796</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="797"></a>797</td><td></td><td></td><td></td><td></td><td class="s">    $DBI::installed_drh{$driver} = $drh;</td></tr>
<tr><td class="h"><a name="798"></a>798</td><td></td><td></td><td></td><td></td><td class="s">    $class-&gt;trace_msg(&quot;    &lt;- install_driver= $drh\n&quot;) if $DBI::dbi_debug;</td></tr>
<tr><td class="h"><a name="799"></a>799</td><td></td><td></td><td></td><td></td><td class="s">    $drh;</td></tr>
<tr><td class="h"><a name="800"></a>800</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="801"></a>801</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="802"></a>802</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">*driver = \&amp;install_driver;        # currently an alias, may change</td></tr>
<tr><td class="h"><a name="803"></a>803</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="804"></a>804</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="805"></a>805</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 172&micro;s (148+24) within DBI::setup_driver which was called 2 times, avg 86&micro;s/call:
#    once (76&micro;s+10&micro;s) by main::BEGIN at <a href="DBI-pm-block.html#1265">line 1265</a>
#    once (72&micro;s+13&micro;s) by DBI::install_driver at <a href="DBI-pm-block.html#784">line 784</a></div></div>sub setup_driver {</td></tr>
<tr><td class="h"><a name="806"></a>806</td><td class="c0">6</td><td class="c3"><span title="Avg 3&micro;s">16&micro;s</span></td><td></td><td></td><td class="s">    my ($class, $driver_class) = @_;</td></tr>
<tr><td class="h"><a name="807"></a>807</td><td></td><td></td><td></td><td></td><td class="s">    my $type;</td></tr>
<tr><td class="h"><a name="808"></a>808</td><td></td><td></td><td></td><td></td><td class="s">    foreach $type (qw(dr db st)){</td></tr>
<tr><td class="h"><a name="809"></a>809</td><td class="c0">24</td><td class="c0"><span title="Avg 7&micro;s">158&micro;s</span></td><td></td><td></td><td class="s">        my $class = $driver_class.&quot;::$type&quot;;</td></tr>
<tr><td class="h"><a name="810"></a>810</td><td class="c0">3</td><td class="c0"><span title="Avg 72&micro;s">216&micro;s</span></td><td class="c3">1</td><td class="c3">16&micro;s</td><td class="s">        no strict 'refs';<div class="calls"><div class="calls_out">        # spent    16&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="811"></a>811</td><td></td><td></td><td></td><td></td><td class="s">        push @{&quot;${class}::ISA&quot;},     &quot;DBD::_::$type&quot;<div class="calls"><div class="calls_out">        # spent    16&micro;s making 6 calls to <a >UNIVERSAL::isa</a>, avg 3&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="812"></a>812</td><td></td><td></td><td></td><td></td><td class="s">            unless UNIVERSAL::isa($class, &quot;DBD::_::$type&quot;);</td></tr>
<tr><td class="h"><a name="813"></a>813</td><td></td><td></td><td></td><td></td><td class="s">        my $mem_class = &quot;DBD::_mem::$type&quot;;</td></tr>
<tr><td class="h"><a name="814"></a>814</td><td></td><td></td><td></td><td></td><td class="s">        push @{&quot;${class}_mem::ISA&quot;}, $mem_class<div class="calls"><div class="calls_out">        # spent     8&micro;s making 6 calls to <a >UNIVERSAL::isa</a>, avg 1&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="815"></a>815</td><td></td><td></td><td></td><td></td><td class="s">            unless UNIVERSAL::isa(&quot;${class}_mem&quot;, $mem_class)</td></tr>
<tr><td class="h"><a name="816"></a>816</td><td></td><td></td><td></td><td></td><td class="s">            or $DBI::PurePerl;</td></tr>
<tr><td class="h"><a name="817"></a>817</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="818"></a>818</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="819"></a>819</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="820"></a>820</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="821"></a>821</td><td></td><td></td><td></td><td></td><td class="s">sub _rebless {</td></tr>
<tr><td class="h"><a name="822"></a>822</td><td></td><td></td><td></td><td></td><td class="s">    my $dbh = shift;</td></tr>
<tr><td class="h"><a name="823"></a>823</td><td></td><td></td><td></td><td></td><td class="s">    my ($outer, $inner) = DBI::_handles($dbh);</td></tr>
<tr><td class="h"><a name="824"></a>824</td><td></td><td></td><td></td><td></td><td class="s">    my $class = shift(@_).'::db';</td></tr>
<tr><td class="h"><a name="825"></a>825</td><td></td><td></td><td></td><td></td><td class="s">    bless $inner =&gt; $class;</td></tr>
<tr><td class="h"><a name="826"></a>826</td><td></td><td></td><td></td><td></td><td class="s">    bless $outer =&gt; $class; # outer last for return</td></tr>
<tr><td class="h"><a name="827"></a>827</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="828"></a>828</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="829"></a>829</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="830"></a>830</td><td></td><td></td><td></td><td></td><td class="s">sub _set_isa {</td></tr>
<tr><td class="h"><a name="831"></a>831</td><td></td><td></td><td></td><td></td><td class="s">    my ($classes, $topclass) = @_;</td></tr>
<tr><td class="h"><a name="832"></a>832</td><td></td><td></td><td></td><td></td><td class="s">    my $trace = DBI-&gt;trace_msg(&quot;       _set_isa([@$classes])\n&quot;);</td></tr>
<tr><td class="h"><a name="833"></a>833</td><td></td><td></td><td></td><td></td><td class="s">    foreach my $suffix ('::db','::st') {</td></tr>
<tr><td class="h"><a name="834"></a>834</td><td></td><td></td><td></td><td></td><td class="s">        my $previous = $topclass || 'DBI'; # trees are rooted here</td></tr>
<tr><td class="h"><a name="835"></a>835</td><td></td><td></td><td></td><td></td><td class="s">        foreach my $class (@$classes) {</td></tr>
<tr><td class="h"><a name="836"></a>836</td><td></td><td></td><td></td><td></td><td class="s">            my $base_class = $previous.$suffix;</td></tr>
<tr><td class="h"><a name="837"></a>837</td><td></td><td></td><td></td><td></td><td class="s">            my $sub_class  = $class.$suffix;</td></tr>
<tr><td class="h"><a name="838"></a>838</td><td></td><td></td><td></td><td></td><td class="s">            my $sub_class_isa  = &quot;${sub_class}::ISA&quot;;</td></tr>
<tr><td class="h"><a name="839"></a>839</td><td class="c0">3</td><td class="c0"><span title="Avg 187&micro;s">561&micro;s</span></td><td class="c3">1</td><td class="c3">18&micro;s</td><td class="s">            no strict 'refs';<div class="calls"><div class="calls_out">            # spent    18&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="840"></a>840</td><td></td><td></td><td></td><td></td><td class="s">            if (@$sub_class_isa) {</td></tr>
<tr><td class="h"><a name="841"></a>841</td><td></td><td></td><td></td><td></td><td class="s">                DBI-&gt;trace_msg(&quot;       $sub_class_isa skipped (already set to @$sub_class_isa)\n&quot;)</td></tr>
<tr><td class="h"><a name="842"></a>842</td><td></td><td></td><td></td><td></td><td class="s">                    if $trace;</td></tr>
<tr><td class="h"><a name="843"></a>843</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="844"></a>844</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="845"></a>845</td><td></td><td></td><td></td><td></td><td class="s">                @$sub_class_isa = ($base_class) unless @$sub_class_isa;</td></tr>
<tr><td class="h"><a name="846"></a>846</td><td></td><td></td><td></td><td></td><td class="s">                DBI-&gt;trace_msg(&quot;       $sub_class_isa = $base_class\n&quot;)</td></tr>
<tr><td class="h"><a name="847"></a>847</td><td></td><td></td><td></td><td></td><td class="s">                    if $trace;</td></tr>
<tr><td class="h"><a name="848"></a>848</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="849"></a>849</td><td></td><td></td><td></td><td></td><td class="s">            $previous = $class;</td></tr>
<tr><td class="h"><a name="850"></a>850</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="851"></a>851</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="852"></a>852</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="853"></a>853</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="854"></a>854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="855"></a>855</td><td></td><td></td><td></td><td></td><td class="s">sub _rebless_dbtype_subclass {</td></tr>
<tr><td class="h"><a name="856"></a>856</td><td></td><td></td><td></td><td></td><td class="s">    my ($dbh, $rootclass, $DbTypeSubclass) = @_;</td></tr>
<tr><td class="h"><a name="857"></a>857</td><td></td><td></td><td></td><td></td><td class="s">    # determine the db type names for class hierarchy</td></tr>
<tr><td class="h"><a name="858"></a>858</td><td></td><td></td><td></td><td></td><td class="s">    my @hierarchy = DBI::_dbtype_names($dbh, $DbTypeSubclass);</td></tr>
<tr><td class="h"><a name="859"></a>859</td><td></td><td></td><td></td><td></td><td class="s">    # add the rootclass prefix to each ('DBI::' or 'MyDBI::' etc)</td></tr>
<tr><td class="h"><a name="860"></a>860</td><td></td><td></td><td></td><td></td><td class="s">    $_ = $rootclass.'::'.$_ foreach (@hierarchy);</td></tr>
<tr><td class="h"><a name="861"></a>861</td><td></td><td></td><td></td><td></td><td class="s">    # load the modules from the 'top down'</td></tr>
<tr><td class="h"><a name="862"></a>862</td><td></td><td></td><td></td><td></td><td class="s">    DBI::_load_class($_, 1) foreach (reverse @hierarchy);</td></tr>
<tr><td class="h"><a name="863"></a>863</td><td></td><td></td><td></td><td></td><td class="s">    # setup class hierarchy if needed, does both '::db' and '::st'</td></tr>
<tr><td class="h"><a name="864"></a>864</td><td></td><td></td><td></td><td></td><td class="s">    DBI::_set_isa(\@hierarchy, $rootclass);</td></tr>
<tr><td class="h"><a name="865"></a>865</td><td></td><td></td><td></td><td></td><td class="s">    # finally bless the handle into the subclass</td></tr>
<tr><td class="h"><a name="866"></a>866</td><td></td><td></td><td></td><td></td><td class="s">    DBI::_rebless($dbh, $hierarchy[0]);</td></tr>
<tr><td class="h"><a name="867"></a>867</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="868"></a>868</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="869"></a>869</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="870"></a>870</td><td></td><td></td><td></td><td></td><td class="s">sub _dbtype_names { # list dbtypes for hierarchy, ie Informix=&gt;ADO=&gt;ODBC</td></tr>
<tr><td class="h"><a name="871"></a>871</td><td></td><td></td><td></td><td></td><td class="s">    my ($dbh, $DbTypeSubclass) = @_;</td></tr>
<tr><td class="h"><a name="872"></a>872</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="873"></a>873</td><td></td><td></td><td></td><td></td><td class="s">    if ($DbTypeSubclass &amp;&amp; $DbTypeSubclass ne '1' &amp;&amp; ref $DbTypeSubclass ne 'CODE') {</td></tr>
<tr><td class="h"><a name="874"></a>874</td><td></td><td></td><td></td><td></td><td class="s">        # treat $DbTypeSubclass as a comma separated list of names</td></tr>
<tr><td class="h"><a name="875"></a>875</td><td></td><td></td><td></td><td></td><td class="s">        my @dbtypes = split /\s*,\s*/, $DbTypeSubclass;</td></tr>
<tr><td class="h"><a name="876"></a>876</td><td></td><td></td><td></td><td></td><td class="s">        $dbh-&gt;trace_msg(&quot;    DbTypeSubclass($DbTypeSubclass)=@dbtypes (explicit)\n&quot;);</td></tr>
<tr><td class="h"><a name="877"></a>877</td><td></td><td></td><td></td><td></td><td class="s">        return @dbtypes;</td></tr>
<tr><td class="h"><a name="878"></a>878</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="879"></a>879</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="880"></a>880</td><td></td><td></td><td></td><td></td><td class="s">    # XXX will call $dbh-&gt;get_info(17) (=SQL_DBMS_NAME) in future?</td></tr>
<tr><td class="h"><a name="881"></a>881</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="882"></a>882</td><td></td><td></td><td></td><td></td><td class="s">    my $driver = $dbh-&gt;{Driver}-&gt;{Name};</td></tr>
<tr><td class="h"><a name="883"></a>883</td><td></td><td></td><td></td><td></td><td class="s">    if ( $driver eq 'Proxy' ) {</td></tr>
<tr><td class="h"><a name="884"></a>884</td><td></td><td></td><td></td><td></td><td class="s">        # XXX Looking into the internals of DBD::Proxy is questionable!</td></tr>
<tr><td class="h"><a name="885"></a>885</td><td></td><td></td><td></td><td></td><td class="s">        ($driver) = $dbh-&gt;{proxy_client}-&gt;{application} =~ /^DBI:(.+?):/i</td></tr>
<tr><td class="h"><a name="886"></a>886</td><td></td><td></td><td></td><td></td><td class="s">                or die &quot;Can't determine driver name from proxy&quot;;</td></tr>
<tr><td class="h"><a name="887"></a>887</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="888"></a>888</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="889"></a>889</td><td></td><td></td><td></td><td></td><td class="s">    my @dbtypes = (ucfirst($driver));</td></tr>
<tr><td class="h"><a name="890"></a>890</td><td></td><td></td><td></td><td></td><td class="s">    if ($driver eq 'ODBC' || $driver eq 'ADO') {</td></tr>
<tr><td class="h"><a name="891"></a>891</td><td></td><td></td><td></td><td></td><td class="s">        # XXX will move these out and make extensible later:</td></tr>
<tr><td class="h"><a name="892"></a>892</td><td></td><td></td><td></td><td></td><td class="s">        my $_dbtype_name_regexp = 'Oracle'; # eg 'Oracle|Foo|Bar'</td></tr>
<tr><td class="h"><a name="893"></a>893</td><td></td><td></td><td></td><td></td><td class="s">        my %_dbtype_name_map = (</td></tr>
<tr><td class="h"><a name="894"></a>894</td><td></td><td></td><td></td><td></td><td class="s">             'Microsoft SQL Server'        =&gt; 'MSSQL',</td></tr>
<tr><td class="h"><a name="895"></a>895</td><td></td><td></td><td></td><td></td><td class="s">             'SQL Server'                =&gt; 'Sybase',</td></tr>
<tr><td class="h"><a name="896"></a>896</td><td></td><td></td><td></td><td></td><td class="s">             'Adaptive Server Anywhere'        =&gt; 'ASAny',</td></tr>
<tr><td class="h"><a name="897"></a>897</td><td></td><td></td><td></td><td></td><td class="s">             'ADABAS D'                        =&gt; 'AdabasD',</td></tr>
<tr><td class="h"><a name="898"></a>898</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="899"></a>899</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="900"></a>900</td><td></td><td></td><td></td><td></td><td class="s">        my $name;</td></tr>
<tr><td class="h"><a name="901"></a>901</td><td></td><td></td><td></td><td></td><td class="s">        $name = $dbh-&gt;func(17, 'GetInfo') # SQL_DBMS_NAME</td></tr>
<tr><td class="h"><a name="902"></a>902</td><td></td><td></td><td></td><td></td><td class="s">                if $driver eq 'ODBC';</td></tr>
<tr><td class="h"><a name="903"></a>903</td><td></td><td></td><td></td><td></td><td class="s">        $name = $dbh-&gt;{ado_conn}-&gt;Properties-&gt;Item('DBMS Name')-&gt;Value</td></tr>
<tr><td class="h"><a name="904"></a>904</td><td></td><td></td><td></td><td></td><td class="s">                if $driver eq 'ADO';</td></tr>
<tr><td class="h"><a name="905"></a>905</td><td></td><td></td><td></td><td></td><td class="s">        die &quot;Can't determine driver name! ($DBI::errstr)\n&quot;</td></tr>
<tr><td class="h"><a name="906"></a>906</td><td></td><td></td><td></td><td></td><td class="s">                unless $name;</td></tr>
<tr><td class="h"><a name="907"></a>907</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="908"></a>908</td><td></td><td></td><td></td><td></td><td class="s">        my $dbtype;</td></tr>
<tr><td class="h"><a name="909"></a>909</td><td></td><td></td><td></td><td></td><td class="s">        if ($_dbtype_name_map{$name}) {</td></tr>
<tr><td class="h"><a name="910"></a>910</td><td></td><td></td><td></td><td></td><td class="s">            $dbtype = $_dbtype_name_map{$name};</td></tr>
<tr><td class="h"><a name="911"></a>911</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="912"></a>912</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="913"></a>913</td><td></td><td></td><td></td><td></td><td class="s">            if ($name =~ /($_dbtype_name_regexp)/) {</td></tr>
<tr><td class="h"><a name="914"></a>914</td><td></td><td></td><td></td><td></td><td class="s">                $dbtype = lc($1);</td></tr>
<tr><td class="h"><a name="915"></a>915</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="916"></a>916</td><td></td><td></td><td></td><td></td><td class="s">            else { # generic mangling for other names:</td></tr>
<tr><td class="h"><a name="917"></a>917</td><td></td><td></td><td></td><td></td><td class="s">                $dbtype = lc($name);</td></tr>
<tr><td class="h"><a name="918"></a>918</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="919"></a>919</td><td></td><td></td><td></td><td></td><td class="s">            $dbtype =~ s/\b(\w)/\U$1/g;</td></tr>
<tr><td class="h"><a name="920"></a>920</td><td></td><td></td><td></td><td></td><td class="s">            $dbtype =~ s/\W+/_/g;</td></tr>
<tr><td class="h"><a name="921"></a>921</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="922"></a>922</td><td></td><td></td><td></td><td></td><td class="s">        # add ODBC 'behind' ADO</td></tr>
<tr><td class="h"><a name="923"></a>923</td><td></td><td></td><td></td><td></td><td class="s">        push    @dbtypes, 'ODBC' if $driver eq 'ADO';</td></tr>
<tr><td class="h"><a name="924"></a>924</td><td></td><td></td><td></td><td></td><td class="s">        # add discovered dbtype in front of ADO/ODBC</td></tr>
<tr><td class="h"><a name="925"></a>925</td><td></td><td></td><td></td><td></td><td class="s">        unshift @dbtypes, $dbtype;</td></tr>
<tr><td class="h"><a name="926"></a>926</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="927"></a>927</td><td></td><td></td><td></td><td></td><td class="s">    @dbtypes = &amp;$DbTypeSubclass($dbh, \@dbtypes)</td></tr>
<tr><td class="h"><a name="928"></a>928</td><td></td><td></td><td></td><td></td><td class="s">        if (ref $DbTypeSubclass eq 'CODE');</td></tr>
<tr><td class="h"><a name="929"></a>929</td><td></td><td></td><td></td><td></td><td class="s">    $dbh-&gt;trace_msg(&quot;    DbTypeSubclass($DbTypeSubclass)=@dbtypes\n&quot;);</td></tr>
<tr><td class="h"><a name="930"></a>930</td><td></td><td></td><td></td><td></td><td class="s">    return @dbtypes;</td></tr>
<tr><td class="h"><a name="931"></a>931</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="932"></a>932</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="933"></a>933</td><td></td><td></td><td></td><td></td><td class="s">sub _load_class {</td></tr>
<tr><td class="h"><a name="934"></a>934</td><td></td><td></td><td></td><td></td><td class="s">    my ($load_class, $missing_ok) = @_;</td></tr>
<tr><td class="h"><a name="935"></a>935</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;trace_msg(&quot;    _load_class($load_class, $missing_ok)\n&quot;, 2);</td></tr>
<tr><td class="h"><a name="936"></a>936</td><td class="c0">3</td><td class="c0"><span title="Avg 168&micro;s">504&micro;s</span></td><td class="c3">1</td><td class="c3">16&micro;s</td><td class="s">    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    16&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="937"></a>937</td><td></td><td></td><td></td><td></td><td class="s">    return 1 if @{&quot;$load_class\::ISA&quot;};        # already loaded/exists</td></tr>
<tr><td class="h"><a name="938"></a>938</td><td></td><td></td><td></td><td></td><td class="s">    (my $module = $load_class) =~ s!::!/!g;</td></tr>
<tr><td class="h"><a name="939"></a>939</td><td></td><td></td><td></td><td></td><td class="s">    DBI-&gt;trace_msg(&quot;    _load_class require $module\n&quot;, 2);</td></tr>
<tr><td class="h"><a name="940"></a>940</td><td></td><td></td><td></td><td></td><td class="s">    eval { require &quot;$module.pm&quot;; };</td></tr>
<tr><td class="h"><a name="941"></a>941</td><td></td><td></td><td></td><td></td><td class="s">    return 1 unless $@;</td></tr>
<tr><td class="h"><a name="942"></a>942</td><td></td><td></td><td></td><td></td><td class="s">    return 0 if $missing_ok &amp;&amp; $@ =~ /^Can't locate \Q$module.pm\E/;</td></tr>
<tr><td class="h"><a name="943"></a>943</td><td></td><td></td><td></td><td></td><td class="s">    die $@;</td></tr>
<tr><td class="h"><a name="944"></a>944</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="945"></a>945</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="946"></a>946</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="947"></a>947</td><td></td><td></td><td></td><td></td><td class="s">sub init_rootclass {        # deprecated</td></tr>
<tr><td class="h"><a name="948"></a>948</td><td></td><td></td><td></td><td></td><td class="s">    return 1;</td></tr>
<tr><td class="h"><a name="949"></a>949</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="950"></a>950</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="951"></a>951</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="952"></a>952</td><td class="c3">1</td><td class="c3"><span title="Avg 800ns">800ns</span></td><td></td><td></td><td class="s">*internal = \&amp;DBD::Switch::dr::driver;</td></tr>
<tr><td class="h"><a name="953"></a>953</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="954"></a>954</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="955"></a>955</td><td></td><td></td><td></td><td></td><td class="s">sub available_drivers {</td></tr>
<tr><td class="h"><a name="956"></a>956</td><td></td><td></td><td></td><td></td><td class="s">    my($quiet) = @_;</td></tr>
<tr><td class="h"><a name="957"></a>957</td><td></td><td></td><td></td><td></td><td class="s">    my(@drivers, $d, $f);</td></tr>
<tr><td class="h"><a name="958"></a>958</td><td></td><td></td><td></td><td></td><td class="s">    local(*DBI::DIR, $@);</td></tr>
<tr><td class="h"><a name="959"></a>959</td><td></td><td></td><td></td><td></td><td class="s">    my(%seen_dir, %seen_dbd);</td></tr>
<tr><td class="h"><a name="960"></a>960</td><td></td><td></td><td></td><td></td><td class="s">    my $haveFileSpec = eval { require File::Spec };</td></tr>
<tr><td class="h"><a name="961"></a>961</td><td></td><td></td><td></td><td></td><td class="s">    foreach $d (@INC){</td></tr>
<tr><td class="h"><a name="962"></a>962</td><td></td><td></td><td></td><td></td><td class="s">        chomp($d); # Perl 5 beta 3 bug in #!./perl -Ilib from Test::Harness</td></tr>
<tr><td class="h"><a name="963"></a>963</td><td></td><td></td><td></td><td></td><td class="s">        my $dbd_dir =</td></tr>
<tr><td class="h"><a name="964"></a>964</td><td></td><td></td><td></td><td></td><td class="s">            ($haveFileSpec ? File::Spec-&gt;catdir($d, 'DBD') : &quot;$d/DBD&quot;);</td></tr>
<tr><td class="h"><a name="965"></a>965</td><td></td><td></td><td></td><td></td><td class="s">        next unless -d $dbd_dir;</td></tr>
<tr><td class="h"><a name="966"></a>966</td><td></td><td></td><td></td><td></td><td class="s">        next if $seen_dir{$d};</td></tr>
<tr><td class="h"><a name="967"></a>967</td><td></td><td></td><td></td><td></td><td class="s">        $seen_dir{$d} = 1;</td></tr>
<tr><td class="h"><a name="968"></a>968</td><td></td><td></td><td></td><td></td><td class="s">        # XXX we have a problem here with case insensitive file systems</td></tr>
<tr><td class="h"><a name="969"></a>969</td><td></td><td></td><td></td><td></td><td class="s">        # XXX since we can't tell what case must be used when loading.</td></tr>
<tr><td class="h"><a name="970"></a>970</td><td></td><td></td><td></td><td></td><td class="s">        opendir(DBI::DIR, $dbd_dir) || Carp::carp &quot;opendir $dbd_dir: $!\n&quot;;</td></tr>
<tr><td class="h"><a name="971"></a>971</td><td></td><td></td><td></td><td></td><td class="s">        foreach $f (readdir(DBI::DIR)){</td></tr>
<tr><td class="h"><a name="972"></a>972</td><td></td><td></td><td></td><td></td><td class="s">            next unless $f =~ s/\.pm$//;</td></tr>
<tr><td class="h"><a name="973"></a>973</td><td></td><td></td><td></td><td></td><td class="s">            next if $f eq 'NullP';</td></tr>
<tr><td class="h"><a name="974"></a>974</td><td></td><td></td><td></td><td></td><td class="s">            if ($seen_dbd{$f}){</td></tr>
<tr><td class="h"><a name="975"></a>975</td><td></td><td></td><td></td><td></td><td class="s">                Carp::carp &quot;DBD::$f in $d is hidden by DBD::$f in $seen_dbd{$f}\n&quot;</td></tr>
<tr><td class="h"><a name="976"></a>976</td><td></td><td></td><td></td><td></td><td class="s">                    unless $quiet;</td></tr>
<tr><td class="h"><a name="977"></a>977</td><td></td><td></td><td></td><td></td><td class="s">            } else {</td></tr>
<tr><td class="h"><a name="978"></a>978</td><td></td><td></td><td></td><td></td><td class="s">                push(@drivers, $f);</td></tr>
<tr><td class="h"><a name="979"></a>979</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="980"></a>980</td><td></td><td></td><td></td><td></td><td class="s">            $seen_dbd{$f} = $d;</td></tr>
<tr><td class="h"><a name="981"></a>981</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="982"></a>982</td><td></td><td></td><td></td><td></td><td class="s">        closedir(DBI::DIR);</td></tr>
<tr><td class="h"><a name="983"></a>983</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="984"></a>984</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="985"></a>985</td><td></td><td></td><td></td><td></td><td class="s">    # &quot;return sort @drivers&quot; will not DWIM in scalar context.</td></tr>
<tr><td class="h"><a name="986"></a>986</td><td></td><td></td><td></td><td></td><td class="s">    return wantarray ? sort @drivers : @drivers;</td></tr>
<tr><td class="h"><a name="987"></a>987</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="988"></a>988</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="989"></a>989</td><td></td><td></td><td></td><td></td><td class="s">sub installed_versions {</td></tr>
<tr><td class="h"><a name="990"></a>990</td><td></td><td></td><td></td><td></td><td class="s">    my ($class, $quiet) = @_;</td></tr>
<tr><td class="h"><a name="991"></a>991</td><td></td><td></td><td></td><td></td><td class="s">    my %error;</td></tr>
<tr><td class="h"><a name="992"></a>992</td><td></td><td></td><td></td><td></td><td class="s">    my %version = ( DBI =&gt; $DBI::VERSION );</td></tr>
<tr><td class="h"><a name="993"></a>993</td><td></td><td></td><td></td><td></td><td class="s">    $version{&quot;DBI::PurePerl&quot;} = $DBI::PurePerl::VERSION</td></tr>
<tr><td class="h"><a name="994"></a>994</td><td></td><td></td><td></td><td></td><td class="s">        if $DBI::PurePerl;</td></tr>
<tr><td class="h"><a name="995"></a>995</td><td></td><td></td><td></td><td></td><td class="s">    for my $driver ($class-&gt;available_drivers($quiet)) {</td></tr>
<tr><td class="h"><a name="996"></a>996</td><td></td><td></td><td></td><td></td><td class="s">        next if $DBI::PurePerl &amp;&amp; grep { -d &quot;$_/auto/DBD/$driver&quot; } @INC;</td></tr>
<tr><td class="h"><a name="997"></a>997</td><td></td><td></td><td></td><td></td><td class="s">        my $drh = eval {</td></tr>
<tr><td class="h"><a name="998"></a>998</td><td></td><td></td><td></td><td></td><td class="s">            local $SIG{__WARN__} = sub {};</td></tr>
<tr><td class="h"><a name="999"></a>999</td><td></td><td></td><td></td><td></td><td class="s">            $class-&gt;install_driver($driver);</td></tr>
<tr><td class="h"><a name="1000"></a>1000</td><td></td><td></td><td></td><td></td><td class="s">        };</td></tr>
<tr><td class="h"><a name="1001"></a>1001</td><td></td><td></td><td></td><td></td><td class="s">        ($error{&quot;DBD::$driver&quot;}=$@),next if $@;</td></tr>
<tr><td class="h"><a name="1002"></a>1002</td><td class="c0">3</td><td class="c0"><span title="Avg 660&micro;s">1.98ms</span></td><td class="c3">1</td><td class="c3">15&micro;s</td><td class="s">        no strict 'refs';<div class="calls"><div class="calls_out">        # spent    15&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="1003"></a>1003</td><td></td><td></td><td></td><td></td><td class="s">        my $vers = ${&quot;DBD::$driver&quot; . '::VERSION'};</td></tr>
<tr><td class="h"><a name="1004"></a>1004</td><td></td><td></td><td></td><td></td><td class="s">        $version{&quot;DBD::$driver&quot;} = $vers || '?';</td></tr>
<tr><td class="h"><a name="1005"></a>1005</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1006"></a>1006</td><td></td><td></td><td></td><td></td><td class="s">    if (wantarray) {</td></tr>
<tr><td class="h"><a name="1007"></a>1007</td><td></td><td></td><td></td><td></td><td class="s">       return map { m/^DBD::(\w+)/ ? ($1) : () } sort keys %version;</td></tr>
<tr><td class="h"><a name="1008"></a>1008</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1009"></a>1009</td><td></td><td></td><td></td><td></td><td class="s">    if (!defined wantarray) {        # void context</td></tr>
<tr><td class="h"><a name="1010"></a>1010</td><td></td><td></td><td></td><td></td><td class="s">        require Config;                # add more detail</td></tr>
<tr><td class="h"><a name="1011"></a>1011</td><td></td><td></td><td></td><td></td><td class="s">        $version{OS}   = &quot;$^O\t($Config::Config{osvers})&quot;;</td></tr>
<tr><td class="h"><a name="1012"></a>1012</td><td></td><td></td><td></td><td></td><td class="s">        $version{Perl} = &quot;$]\t($Config::Config{archname})&quot;;</td></tr>
<tr><td class="h"><a name="1013"></a>1013</td><td></td><td></td><td></td><td></td><td class="s">        $version{$_}   = (($error{$_} =~ s/ \(\@INC.*//s),$error{$_})</td></tr>
<tr><td class="h"><a name="1014"></a>1014</td><td></td><td></td><td></td><td></td><td class="s">            for keys %error;</td></tr>
<tr><td class="h"><a name="1015"></a>1015</td><td></td><td></td><td></td><td></td><td class="s">        printf &quot;  %-16s: %s\n&quot;,$_,$version{$_}</td></tr>
<tr><td class="h"><a name="1016"></a>1016</td><td></td><td></td><td></td><td></td><td class="s">            for reverse sort keys %version;</td></tr>
<tr><td class="h"><a name="1017"></a>1017</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1018"></a>1018</td><td></td><td></td><td></td><td></td><td class="s">    return \%version;</td></tr>
<tr><td class="h"><a name="1019"></a>1019</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1020"></a>1020</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1021"></a>1021</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1022"></a>1022</td><td></td><td></td><td></td><td></td><td class="s">sub data_sources {</td></tr>
<tr><td class="h"><a name="1023"></a>1023</td><td></td><td></td><td></td><td></td><td class="s">    my ($class, $driver, @other) = @_;</td></tr>
<tr><td class="h"><a name="1024"></a>1024</td><td></td><td></td><td></td><td></td><td class="s">    my $drh = $class-&gt;install_driver($driver);</td></tr>
<tr><td class="h"><a name="1025"></a>1025</td><td></td><td></td><td></td><td></td><td class="s">    my @ds = $drh-&gt;data_sources(@other);</td></tr>
<tr><td class="h"><a name="1026"></a>1026</td><td></td><td></td><td></td><td></td><td class="s">    return @ds;</td></tr>
<tr><td class="h"><a name="1027"></a>1027</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1028"></a>1028</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1029"></a>1029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1030"></a>1030</td><td></td><td></td><td></td><td></td><td class="s">sub neat_list {</td></tr>
<tr><td class="h"><a name="1031"></a>1031</td><td></td><td></td><td></td><td></td><td class="s">    my ($listref, $maxlen, $sep) = @_;</td></tr>
<tr><td class="h"><a name="1032"></a>1032</td><td></td><td></td><td></td><td></td><td class="s">    $maxlen = 0 unless defined $maxlen;        # 0 == use internal default</td></tr>
<tr><td class="h"><a name="1033"></a>1033</td><td></td><td></td><td></td><td></td><td class="s">    $sep = &quot;, &quot; unless defined $sep;</td></tr>
<tr><td class="h"><a name="1034"></a>1034</td><td></td><td></td><td></td><td></td><td class="s">    join($sep, map { neat($_,$maxlen) } @$listref);</td></tr>
<tr><td class="h"><a name="1035"></a>1035</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1036"></a>1036</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1037"></a>1037</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1038"></a>1038</td><td></td><td></td><td></td><td></td><td class="s">sub dump_results {        # also aliased as a method in DBD::_::st</td></tr>
<tr><td class="h"><a name="1039"></a>1039</td><td></td><td></td><td></td><td></td><td class="s">    my ($sth, $maxlen, $lsep, $fsep, $fh) = @_;</td></tr>
<tr><td class="h"><a name="1040"></a>1040</td><td></td><td></td><td></td><td></td><td class="s">    return 0 unless $sth;</td></tr>
<tr><td class="h"><a name="1041"></a>1041</td><td></td><td></td><td></td><td></td><td class="s">    $maxlen ||= 35;</td></tr>
<tr><td class="h"><a name="1042"></a>1042</td><td></td><td></td><td></td><td></td><td class="s">    $lsep   ||= &quot;\n&quot;;</td></tr>
<tr><td class="h"><a name="1043"></a>1043</td><td></td><td></td><td></td><td></td><td class="s">    $fh ||= \*STDOUT;</td></tr>
<tr><td class="h"><a name="1044"></a>1044</td><td></td><td></td><td></td><td></td><td class="s">    my $rows = 0;</td></tr>
<tr><td class="h"><a name="1045"></a>1045</td><td></td><td></td><td></td><td></td><td class="s">    my $ref;</td></tr>
<tr><td class="h"><a name="1046"></a>1046</td><td></td><td></td><td></td><td></td><td class="s">    while($ref = $sth-&gt;fetch) {</td></tr>
<tr><td class="h"><a name="1047"></a>1047</td><td></td><td></td><td></td><td></td><td class="s">        print $fh $lsep if $rows++ and $lsep;</td></tr>
<tr><td class="h"><a name="1048"></a>1048</td><td></td><td></td><td></td><td></td><td class="s">        my $str = neat_list($ref,$maxlen,$fsep);</td></tr>
<tr><td class="h"><a name="1049"></a>1049</td><td></td><td></td><td></td><td></td><td class="s">        print $fh $str;        # done on two lines to avoid 5.003 errors</td></tr>
<tr><td class="h"><a name="1050"></a>1050</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1051"></a>1051</td><td></td><td></td><td></td><td></td><td class="s">    print $fh &quot;\n$rows rows&quot;.($DBI::err ? &quot; ($DBI::err: $DBI::errstr)&quot; : &quot;&quot;).&quot;\n&quot;;</td></tr>
<tr><td class="h"><a name="1052"></a>1052</td><td></td><td></td><td></td><td></td><td class="s">    $rows;</td></tr>
<tr><td class="h"><a name="1053"></a>1053</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1054"></a>1054</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1055"></a>1055</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1056"></a>1056</td><td></td><td></td><td></td><td></td><td class="s">sub data_diff {</td></tr>
<tr><td class="h"><a name="1057"></a>1057</td><td></td><td></td><td></td><td></td><td class="s">    my ($a, $b, $logical) = @_;</td></tr>
<tr><td class="h"><a name="1058"></a>1058</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1059"></a>1059</td><td></td><td></td><td></td><td></td><td class="s">    my $diff   = data_string_diff($a, $b);</td></tr>
<tr><td class="h"><a name="1060"></a>1060</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;&quot; if $logical and !$diff;</td></tr>
<tr><td class="h"><a name="1061"></a>1061</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1062"></a>1062</td><td></td><td></td><td></td><td></td><td class="s">    my $a_desc = data_string_desc($a);</td></tr>
<tr><td class="h"><a name="1063"></a>1063</td><td></td><td></td><td></td><td></td><td class="s">    my $b_desc = data_string_desc($b);</td></tr>
<tr><td class="h"><a name="1064"></a>1064</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;&quot; if !$diff and $a_desc eq $b_desc;</td></tr>
<tr><td class="h"><a name="1065"></a>1065</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1066"></a>1066</td><td></td><td></td><td></td><td></td><td class="s">    $diff ||= &quot;Strings contain the same sequence of characters&quot;</td></tr>
<tr><td class="h"><a name="1067"></a>1067</td><td></td><td></td><td></td><td></td><td class="s">            if length($a);</td></tr>
<tr><td class="h"><a name="1068"></a>1068</td><td></td><td></td><td></td><td></td><td class="s">    $diff .= &quot;\n&quot; if $diff;</td></tr>
<tr><td class="h"><a name="1069"></a>1069</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;a: $a_desc\nb: $b_desc\n$diff&quot;;</td></tr>
<tr><td class="h"><a name="1070"></a>1070</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1071"></a>1071</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1072"></a>1072</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1073"></a>1073</td><td></td><td></td><td></td><td></td><td class="s">sub data_string_diff {</td></tr>
<tr><td class="h"><a name="1074"></a>1074</td><td></td><td></td><td></td><td></td><td class="s">    # Compares 'logical' characters, not bytes, so a latin1 string and an</td></tr>
<tr><td class="h"><a name="1075"></a>1075</td><td></td><td></td><td></td><td></td><td class="s">    # an equivalent unicode string will compare as equal even though their</td></tr>
<tr><td class="h"><a name="1076"></a>1076</td><td></td><td></td><td></td><td></td><td class="s">    # byte encodings are different.</td></tr>
<tr><td class="h"><a name="1077"></a>1077</td><td></td><td></td><td></td><td></td><td class="s">    my ($a, $b) = @_;</td></tr>
<tr><td class="h"><a name="1078"></a>1078</td><td></td><td></td><td></td><td></td><td class="s">    unless (defined $a and defined $b) {             # one undef</td></tr>
<tr><td class="h"><a name="1079"></a>1079</td><td></td><td></td><td></td><td></td><td class="s">        return &quot;&quot;</td></tr>
<tr><td class="h"><a name="1080"></a>1080</td><td></td><td></td><td></td><td></td><td class="s">                if !defined $a and !defined $b;</td></tr>
<tr><td class="h"><a name="1081"></a>1081</td><td></td><td></td><td></td><td></td><td class="s">        return &quot;String a is undef, string b has &quot;.length($b).&quot; characters&quot;</td></tr>
<tr><td class="h"><a name="1082"></a>1082</td><td></td><td></td><td></td><td></td><td class="s">                if !defined $a;</td></tr>
<tr><td class="h"><a name="1083"></a>1083</td><td></td><td></td><td></td><td></td><td class="s">        return &quot;String b is undef, string a has &quot;.length($a).&quot; characters&quot;</td></tr>
<tr><td class="h"><a name="1084"></a>1084</td><td></td><td></td><td></td><td></td><td class="s">                if !defined $b;</td></tr>
<tr><td class="h"><a name="1085"></a>1085</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1086"></a>1086</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1087"></a>1087</td><td></td><td></td><td></td><td></td><td class="s">    require utf8;</td></tr>
<tr><td class="h"><a name="1088"></a>1088</td><td></td><td></td><td></td><td></td><td class="s">    # hack to cater for perl 5.6</td></tr>
<tr><td class="h"><a name="1089"></a>1089</td><td></td><td></td><td></td><td></td><td class="s">    *utf8::is_utf8 = sub { (DBI::neat(shift)=~/^&quot;/) } unless defined &amp;utf8::is_utf8;</td></tr>
<tr><td class="h"><a name="1090"></a>1090</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1091"></a>1091</td><td></td><td></td><td></td><td></td><td class="s">    my @a_chars = (utf8::is_utf8($a)) ? unpack(&quot;U*&quot;, $a) : unpack(&quot;C*&quot;, $a);</td></tr>
<tr><td class="h"><a name="1092"></a>1092</td><td></td><td></td><td></td><td></td><td class="s">    my @b_chars = (utf8::is_utf8($b)) ? unpack(&quot;U*&quot;, $b) : unpack(&quot;C*&quot;, $b);</td></tr>
<tr><td class="h"><a name="1093"></a>1093</td><td></td><td></td><td></td><td></td><td class="s">    my $i = 0;</td></tr>
<tr><td class="h"><a name="1094"></a>1094</td><td></td><td></td><td></td><td></td><td class="s">    while (@a_chars &amp;&amp; @b_chars) {</td></tr>
<tr><td class="h"><a name="1095"></a>1095</td><td></td><td></td><td></td><td></td><td class="s">        ++$i, shift(@a_chars), shift(@b_chars), next</td></tr>
<tr><td class="h"><a name="1096"></a>1096</td><td></td><td></td><td></td><td></td><td class="s">            if $a_chars[0] == $b_chars[0];# compare ordinal values</td></tr>
<tr><td class="h"><a name="1097"></a>1097</td><td></td><td></td><td></td><td></td><td class="s">        my @desc = map {</td></tr>
<tr><td class="h"><a name="1098"></a>1098</td><td></td><td></td><td></td><td></td><td class="s">            $_ &gt; 255 ?                    # if wide character...</td></tr>
<tr><td class="h"><a name="1099"></a>1099</td><td></td><td></td><td></td><td></td><td class="s">              sprintf(&quot;\\x{%04X}&quot;, $_) :  # \x{...}</td></tr>
<tr><td class="h"><a name="1100"></a>1100</td><td></td><td></td><td></td><td></td><td class="s">              chr($_) =~ /[[:cntrl:]]/ ?  # else if control character ...</td></tr>
<tr><td class="h"><a name="1101"></a>1101</td><td></td><td></td><td></td><td></td><td class="s">              sprintf(&quot;\\x%02X&quot;, $_) :    # \x..</td></tr>
<tr><td class="h"><a name="1102"></a>1102</td><td></td><td></td><td></td><td></td><td class="s">              chr($_)                     # else as themselves</td></tr>
<tr><td class="h"><a name="1103"></a>1103</td><td></td><td></td><td></td><td></td><td class="s">        } ($a_chars[0], $b_chars[0]);</td></tr>
<tr><td class="h"><a name="1104"></a>1104</td><td></td><td></td><td></td><td></td><td class="s">        # highlight probable double-encoding?</td></tr>
<tr><td class="h"><a name="1105"></a>1105</td><td></td><td></td><td></td><td></td><td class="s">        foreach my $c ( @desc ) {</td></tr>
<tr><td class="h"><a name="1106"></a>1106</td><td></td><td></td><td></td><td></td><td class="s">            next unless $c =~ m/\\x\{08(..)}/;</td></tr>
<tr><td class="h"><a name="1107"></a>1107</td><td></td><td></td><td></td><td></td><td class="s">            $c .= &quot;='&quot; .chr(hex($1)) .&quot;'&quot;</td></tr>
<tr><td class="h"><a name="1108"></a>1108</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1109"></a>1109</td><td></td><td></td><td></td><td></td><td class="s">        return sprintf &quot;Strings differ at index $i: a[$i]=$desc[0], b[$i]=$desc[1]&quot;;</td></tr>
<tr><td class="h"><a name="1110"></a>1110</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1111"></a>1111</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;String a truncated after $i characters&quot; if @b_chars;</td></tr>
<tr><td class="h"><a name="1112"></a>1112</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;String b truncated after $i characters&quot; if @a_chars;</td></tr>
<tr><td class="h"><a name="1113"></a>1113</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;&quot;;</td></tr>
<tr><td class="h"><a name="1114"></a>1114</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1115"></a>1115</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1116"></a>1116</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1117"></a>1117</td><td></td><td></td><td></td><td></td><td class="s">sub data_string_desc {        # describe a data string</td></tr>
<tr><td class="h"><a name="1118"></a>1118</td><td></td><td></td><td></td><td></td><td class="s">    my ($a) = @_;</td></tr>
<tr><td class="h"><a name="1119"></a>1119</td><td></td><td></td><td></td><td></td><td class="s">    require bytes;</td></tr>
<tr><td class="h"><a name="1120"></a>1120</td><td></td><td></td><td></td><td></td><td class="s">    require utf8;</td></tr>
<tr><td class="h"><a name="1121"></a>1121</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1122"></a>1122</td><td></td><td></td><td></td><td></td><td class="s">    # hacks to cater for perl 5.6</td></tr>
<tr><td class="h"><a name="1123"></a>1123</td><td></td><td></td><td></td><td></td><td class="s">    *utf8::is_utf8 = sub { (DBI::neat(shift)=~/^&quot;/) } unless defined &amp;utf8::is_utf8;</td></tr>
<tr><td class="h"><a name="1124"></a>1124</td><td></td><td></td><td></td><td></td><td class="s">    *utf8::valid   = sub {                        1 } unless defined &amp;utf8::valid;</td></tr>
<tr><td class="h"><a name="1125"></a>1125</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1126"></a>1126</td><td></td><td></td><td></td><td></td><td class="s">    # Give sufficient info to help diagnose at least these kinds of situations:</td></tr>
<tr><td class="h"><a name="1127"></a>1127</td><td></td><td></td><td></td><td></td><td class="s">    # - valid UTF8 byte sequence but UTF8 flag not set</td></tr>
<tr><td class="h"><a name="1128"></a>1128</td><td></td><td></td><td></td><td></td><td class="s">    #   (might be ascii so also need to check for hibit to make it worthwhile)</td></tr>
<tr><td class="h"><a name="1129"></a>1129</td><td></td><td></td><td></td><td></td><td class="s">    # - UTF8 flag set but invalid UTF8 byte sequence</td></tr>
<tr><td class="h"><a name="1130"></a>1130</td><td></td><td></td><td></td><td></td><td class="s">    # could do better here, but this'll do for now</td></tr>
<tr><td class="h"><a name="1131"></a>1131</td><td></td><td></td><td></td><td></td><td class="s">    my $utf8 = sprintf &quot;UTF8 %s%s&quot;,</td></tr>
<tr><td class="h"><a name="1132"></a>1132</td><td></td><td></td><td></td><td></td><td class="s">        utf8::is_utf8($a) ? &quot;on&quot; : &quot;off&quot;,</td></tr>
<tr><td class="h"><a name="1133"></a>1133</td><td></td><td></td><td></td><td></td><td class="s">        utf8::valid($a||'') ? &quot;&quot; : &quot; but INVALID encoding&quot;;</td></tr>
<tr><td class="h"><a name="1134"></a>1134</td><td></td><td></td><td></td><td></td><td class="s">    return &quot;$utf8, undef&quot; unless defined $a;</td></tr>
<tr><td class="h"><a name="1135"></a>1135</td><td></td><td></td><td></td><td></td><td class="s">    my $is_ascii = $a =~ m/^[\000-\177]*$/;</td></tr>
<tr><td class="h"><a name="1136"></a>1136</td><td></td><td></td><td></td><td></td><td class="s">    return sprintf &quot;%s, %s, %d characters %d bytes&quot;,</td></tr>
<tr><td class="h"><a name="1137"></a>1137</td><td></td><td></td><td></td><td></td><td class="s">        $utf8, $is_ascii ? &quot;ASCII&quot; : &quot;non-ASCII&quot;,</td></tr>
<tr><td class="h"><a name="1138"></a>1138</td><td></td><td></td><td></td><td></td><td class="s">        length($a), bytes::length($a);</td></tr>
<tr><td class="h"><a name="1139"></a>1139</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1140"></a>1140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1141"></a>1141</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1142"></a>1142</td><td></td><td></td><td></td><td></td><td class="s">sub connect_test_perf {</td></tr>
<tr><td class="h"><a name="1143"></a>1143</td><td></td><td></td><td></td><td></td><td class="s">    my($class, $dsn,$dbuser,$dbpass, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1144"></a>1144</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;connect_test_perf needs hash ref as fourth arg&quot;) unless ref $attr;</td></tr>
<tr><td class="h"><a name="1145"></a>1145</td><td></td><td></td><td></td><td></td><td class="s">    # these are non standard attributes just for this special method</td></tr>
<tr><td class="h"><a name="1146"></a>1146</td><td></td><td></td><td></td><td></td><td class="s">    my $loops ||= $attr-&gt;{dbi_loops} || 5;</td></tr>
<tr><td class="h"><a name="1147"></a>1147</td><td></td><td></td><td></td><td></td><td class="s">    my $par   ||= $attr-&gt;{dbi_par}   || 1;        # parallelism</td></tr>
<tr><td class="h"><a name="1148"></a>1148</td><td></td><td></td><td></td><td></td><td class="s">    my $verb  ||= $attr-&gt;{dbi_verb}  || 1;</td></tr>
<tr><td class="h"><a name="1149"></a>1149</td><td></td><td></td><td></td><td></td><td class="s">    my $meth  ||= $attr-&gt;{dbi_meth}  || 'connect';</td></tr>
<tr><td class="h"><a name="1150"></a>1150</td><td></td><td></td><td></td><td></td><td class="s">    print &quot;$dsn: testing $loops sets of $par connections:\n&quot;;</td></tr>
<tr><td class="h"><a name="1151"></a>1151</td><td></td><td></td><td></td><td></td><td class="s">    require &quot;FileHandle.pm&quot;;        # don't let toke.c create empty FileHandle package</td></tr>
<tr><td class="h"><a name="1152"></a>1152</td><td></td><td></td><td></td><td></td><td class="s">    local $| = 1;</td></tr>
<tr><td class="h"><a name="1153"></a>1153</td><td></td><td></td><td></td><td></td><td class="s">    my $drh = $class-&gt;install_driver($dsn) or Carp::croak(&quot;Can't install $dsn driver\n&quot;);</td></tr>
<tr><td class="h"><a name="1154"></a>1154</td><td></td><td></td><td></td><td></td><td class="s">    # test the connection and warm up caches etc</td></tr>
<tr><td class="h"><a name="1155"></a>1155</td><td></td><td></td><td></td><td></td><td class="s">    $drh-&gt;connect($dsn,$dbuser,$dbpass) or Carp::croak(&quot;connect failed: $DBI::errstr&quot;);</td></tr>
<tr><td class="h"><a name="1156"></a>1156</td><td></td><td></td><td></td><td></td><td class="s">    my $t1 = dbi_time();</td></tr>
<tr><td class="h"><a name="1157"></a>1157</td><td></td><td></td><td></td><td></td><td class="s">    my $loop;</td></tr>
<tr><td class="h"><a name="1158"></a>1158</td><td></td><td></td><td></td><td></td><td class="s">    for $loop (1..$loops) {</td></tr>
<tr><td class="h"><a name="1159"></a>1159</td><td></td><td></td><td></td><td></td><td class="s">        my @cons;</td></tr>
<tr><td class="h"><a name="1160"></a>1160</td><td></td><td></td><td></td><td></td><td class="s">        print &quot;Connecting... &quot; if $verb;</td></tr>
<tr><td class="h"><a name="1161"></a>1161</td><td></td><td></td><td></td><td></td><td class="s">        for (1..$par) {</td></tr>
<tr><td class="h"><a name="1162"></a>1162</td><td></td><td></td><td></td><td></td><td class="s">            print &quot;$_ &quot;;</td></tr>
<tr><td class="h"><a name="1163"></a>1163</td><td></td><td></td><td></td><td></td><td class="s">            push @cons, ($drh-&gt;connect($dsn,$dbuser,$dbpass)</td></tr>
<tr><td class="h"><a name="1164"></a>1164</td><td></td><td></td><td></td><td></td><td class="s">                    or Carp::croak(&quot;connect failed: $DBI::errstr\n&quot;));</td></tr>
<tr><td class="h"><a name="1165"></a>1165</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1166"></a>1166</td><td></td><td></td><td></td><td></td><td class="s">        print &quot;\nDisconnecting...\n&quot; if $verb;</td></tr>
<tr><td class="h"><a name="1167"></a>1167</td><td></td><td></td><td></td><td></td><td class="s">        for (@cons) {</td></tr>
<tr><td class="h"><a name="1168"></a>1168</td><td></td><td></td><td></td><td></td><td class="s">            $_-&gt;disconnect or warn &quot;disconnect failed: $DBI::errstr&quot;</td></tr>
<tr><td class="h"><a name="1169"></a>1169</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1170"></a>1170</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1171"></a>1171</td><td></td><td></td><td></td><td></td><td class="s">    my $t2 = dbi_time();</td></tr>
<tr><td class="h"><a name="1172"></a>1172</td><td></td><td></td><td></td><td></td><td class="s">    my $td = $t2 - $t1;</td></tr>
<tr><td class="h"><a name="1173"></a>1173</td><td></td><td></td><td></td><td></td><td class="s">    printf &quot;$meth %d and disconnect them, %d times: %.4fs / %d = %.4fs\n&quot;,</td></tr>
<tr><td class="h"><a name="1174"></a>1174</td><td></td><td></td><td></td><td></td><td class="s">        $par, $loops, $td, $loops*$par, $td/($loops*$par);</td></tr>
<tr><td class="h"><a name="1175"></a>1175</td><td></td><td></td><td></td><td></td><td class="s">    return $td;</td></tr>
<tr><td class="h"><a name="1176"></a>1176</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1177"></a>1177</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1178"></a>1178</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1179"></a>1179</td><td></td><td></td><td></td><td></td><td class="s"># Help people doing DBI-&gt;errstr, might even document it one day</td></tr>
<tr><td class="h"><a name="1180"></a>1180</td><td></td><td></td><td></td><td></td><td class="s"># XXX probably best moved to cheaper XS code if this gets documented</td></tr>
<tr><td class="h"><a name="1181"></a>1181</td><td></td><td></td><td></td><td></td><td class="s">sub err    { $DBI::err    }</td></tr>
<tr><td class="h"><a name="1182"></a>1182</td><td></td><td></td><td></td><td></td><td class="s">sub errstr { $DBI::errstr }</td></tr>
<tr><td class="h"><a name="1183"></a>1183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1184"></a>1184</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1185"></a>1185</td><td></td><td></td><td></td><td></td><td class="s"># --- Private Internal Function for Creating New DBI Handles</td></tr>
<tr><td class="h"><a name="1186"></a>1186</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1187"></a>1187</td><td></td><td></td><td></td><td></td><td class="s"># XXX move to PurePerl?</td></tr>
<tr><td class="h"><a name="1188"></a>1188</td><td class="c3">1</td><td class="c3"><span title="Avg 500ns">500ns</span></td><td></td><td></td><td class="s">*DBI::dr::TIEHASH = \&amp;DBI::st::TIEHASH;</td></tr>
<tr><td class="h"><a name="1189"></a>1189</td><td class="c3">1</td><td class="c3"><span title="Avg 500ns">500ns</span></td><td></td><td></td><td class="s">*DBI::db::TIEHASH = \&amp;DBI::st::TIEHASH;</td></tr>
<tr><td class="h"><a name="1190"></a>1190</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1191"></a>1191</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1192"></a>1192</td><td></td><td></td><td></td><td></td><td class="s"># These three special constructors are called by the drivers</td></tr>
<tr><td class="h"><a name="1193"></a>1193</td><td></td><td></td><td></td><td></td><td class="s"># The way they are called is likely to change.</td></tr>
<tr><td class="h"><a name="1194"></a>1194</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1195"></a>1195</td><td class="c3">1</td><td class="c3"><span title="Avg 200ns">200ns</span></td><td></td><td></td><td class="s">our $shared_profile;</td></tr>
<tr><td class="h"><a name="1196"></a>1196</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1197"></a>1197</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 71&micro;s (24+47) within DBI::_new_drh which was called
#    once (24&micro;s+47&micro;s) by DBD::mysql::driver at <a href="DBD-mysql-pm-block.html#28">line 28 of DBD/mysql.pm</a></div></div>sub _new_drh {        # called by DBD::&lt;drivername&gt;::driver()</td></tr>
<tr><td class="h"><a name="1198"></a>1198</td><td class="c0">6</td><td class="c0"><span title="Avg 12&micro;s">72&micro;s</span></td><td></td><td></td><td class="s">    my ($class, $initial_attr, $imp_data) = @_;</td></tr>
<tr><td class="h"><a name="1199"></a>1199</td><td></td><td></td><td></td><td></td><td class="s">    # Provide default storage for State,Err and Errstr.</td></tr>
<tr><td class="h"><a name="1200"></a>1200</td><td></td><td></td><td></td><td></td><td class="s">    # Note that these are shared by all child handles by default! XXX</td></tr>
<tr><td class="h"><a name="1201"></a>1201</td><td></td><td></td><td></td><td></td><td class="s">    # State must be undef to get automatic faking in DBI::var::FETCH</td></tr>
<tr><td class="h"><a name="1202"></a>1202</td><td></td><td></td><td></td><td></td><td class="s">    my ($h_state_store, $h_err_store, $h_errstr_store) = (undef, 0, '');</td></tr>
<tr><td class="h"><a name="1203"></a>1203</td><td></td><td></td><td></td><td></td><td class="s">    my $attr = {</td></tr>
<tr><td class="h"><a name="1204"></a>1204</td><td></td><td></td><td></td><td></td><td class="s">        # these attributes get copied down to child handles by default</td></tr>
<tr><td class="h"><a name="1205"></a>1205</td><td></td><td></td><td></td><td></td><td class="s">        'State'                =&gt; \$h_state_store,  # Holder for DBI::state</td></tr>
<tr><td class="h"><a name="1206"></a>1206</td><td></td><td></td><td></td><td></td><td class="s">        'Err'                =&gt; \$h_err_store,    # Holder for DBI::err</td></tr>
<tr><td class="h"><a name="1207"></a>1207</td><td></td><td></td><td></td><td></td><td class="s">        'Errstr'        =&gt; \$h_errstr_store, # Holder for DBI::errstr</td></tr>
<tr><td class="h"><a name="1208"></a>1208</td><td></td><td></td><td></td><td></td><td class="s">        'TraceLevel'         =&gt; 0,</td></tr>
<tr><td class="h"><a name="1209"></a>1209</td><td></td><td></td><td></td><td></td><td class="s">        FetchHashKeyName=&gt; 'NAME',</td></tr>
<tr><td class="h"><a name="1210"></a>1210</td><td></td><td></td><td></td><td></td><td class="s">        %$initial_attr,</td></tr>
<tr><td class="h"><a name="1211"></a>1211</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="1212"></a>1212</td><td></td><td></td><td></td><td></td><td class="s">    my ($h, $i) = _new_handle('DBI::dr', '', $attr, $imp_data, $class);<div class="calls"><div class="calls_out">    # spent    47&micro;s making 1 call to <a href="DBI-pm-block.html#DBI___new_handle">DBI::_new_handle</a></div></div></td></tr>
<tr><td class="h"><a name="1213"></a>1213</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1214"></a>1214</td><td></td><td></td><td></td><td></td><td class="s">    # XXX DBI_PROFILE unless DBI::PurePerl because for some reason</td></tr>
<tr><td class="h"><a name="1215"></a>1215</td><td></td><td></td><td></td><td></td><td class="s">    # it kills the t/zz_*_pp.t tests (they silently exit early)</td></tr>
<tr><td class="h"><a name="1216"></a>1216</td><td></td><td></td><td></td><td></td><td class="s">    if ($ENV{DBI_PROFILE} &amp;&amp; !$DBI::PurePerl) {</td></tr>
<tr><td class="h"><a name="1217"></a>1217</td><td></td><td></td><td></td><td></td><td class="s">        # The profile object created here when the first driver is loaded</td></tr>
<tr><td class="h"><a name="1218"></a>1218</td><td></td><td></td><td></td><td></td><td class="s">        # is shared by all drivers so we end up with just one set of profile</td></tr>
<tr><td class="h"><a name="1219"></a>1219</td><td></td><td></td><td></td><td></td><td class="s">        # data and thus the 'total time in DBI' is really the true total.</td></tr>
<tr><td class="h"><a name="1220"></a>1220</td><td></td><td></td><td></td><td></td><td class="s">        if (!$shared_profile) {        # first time</td></tr>
<tr><td class="h"><a name="1221"></a>1221</td><td></td><td></td><td></td><td></td><td class="s">            $h-&gt;{Profile} = $ENV{DBI_PROFILE};</td></tr>
<tr><td class="h"><a name="1222"></a>1222</td><td></td><td></td><td></td><td></td><td class="s">            $shared_profile = $h-&gt;{Profile};</td></tr>
<tr><td class="h"><a name="1223"></a>1223</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1224"></a>1224</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="1225"></a>1225</td><td></td><td></td><td></td><td></td><td class="s">            $h-&gt;{Profile} = $shared_profile;</td></tr>
<tr><td class="h"><a name="1226"></a>1226</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1227"></a>1227</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1228"></a>1228</td><td></td><td></td><td></td><td></td><td class="s">    return $h unless wantarray;</td></tr>
<tr><td class="h"><a name="1229"></a>1229</td><td></td><td></td><td></td><td></td><td class="s">    ($h, $i);</td></tr>
<tr><td class="h"><a name="1230"></a>1230</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1231"></a>1231</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1232"></a>1232</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 88&micro;s (32+56) within DBI::_new_dbh which was called 2 times, avg 44&micro;s/call:
# 2 times (32&micro;s+56&micro;s) by DBI::dr::connect at <a href="DBD-mysql-pm-block.html#133">line 133 of DBD/mysql.pm</a>, avg 44&micro;s/call</div></div>sub _new_dbh {        # called by DBD::&lt;drivername&gt;::dr::connect()</td></tr>
<tr><td class="h"><a name="1233"></a>1233</td><td class="c0">18</td><td class="c0"><span title="Avg 5&micro;s">88&micro;s</span></td><td></td><td></td><td class="s">    my ($drh, $attr, $imp_data) = @_;</td></tr>
<tr><td class="h"><a name="1234"></a>1234</td><td></td><td></td><td></td><td></td><td class="s">    my $imp_class = $drh-&gt;{ImplementorClass}</td></tr>
<tr><td class="h"><a name="1235"></a>1235</td><td></td><td></td><td></td><td></td><td class="s">        or Carp::croak(&quot;DBI _new_dbh: $drh has no ImplementorClass&quot;);</td></tr>
<tr><td class="h"><a name="1236"></a>1236</td><td></td><td></td><td></td><td></td><td class="s">    substr($imp_class,-4,4) = '::db';</td></tr>
<tr><td class="h"><a name="1237"></a>1237</td><td></td><td></td><td></td><td></td><td class="s">    my $app_class = ref $drh;</td></tr>
<tr><td class="h"><a name="1238"></a>1238</td><td></td><td></td><td></td><td></td><td class="s">    substr($app_class,-4,4) = '::db';</td></tr>
<tr><td class="h"><a name="1239"></a>1239</td><td></td><td></td><td></td><td></td><td class="s">    $attr-&gt;{Err}    ||= \my $err;</td></tr>
<tr><td class="h"><a name="1240"></a>1240</td><td></td><td></td><td></td><td></td><td class="s">    $attr-&gt;{Errstr} ||= \my $errstr;</td></tr>
<tr><td class="h"><a name="1241"></a>1241</td><td></td><td></td><td></td><td></td><td class="s">    $attr-&gt;{State}  ||= \my $state;</td></tr>
<tr><td class="h"><a name="1242"></a>1242</td><td></td><td></td><td></td><td></td><td class="s">    _new_handle($app_class, $drh, $attr, $imp_data, $imp_class);<div class="calls"><div class="calls_out">    # spent    56&micro;s making 2 calls to <a href="DBI-pm-block.html#DBI___new_handle">DBI::_new_handle</a>, avg 28&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="1243"></a>1243</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1244"></a>1244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1245"></a>1245</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 339&micro;s (125+214) within DBI::_new_sth which was called 15 times, avg 23&micro;s/call:
# 15 times (125&micro;s+214&micro;s) by DBI::db::prepare at <a href="DBD-mysql-pm-block.html#221">line 221 of DBD/mysql.pm</a>, avg 23&micro;s/call</div></div>sub _new_sth {        # called by DBD::&lt;drivername&gt;::db::prepare)</td></tr>
<tr><td class="h"><a name="1246"></a>1246</td><td class="c0">90</td><td class="c0"><span title="Avg 4&micro;s">342&micro;s</span></td><td></td><td></td><td class="s">    my ($dbh, $attr, $imp_data) = @_;</td></tr>
<tr><td class="h"><a name="1247"></a>1247</td><td></td><td></td><td></td><td></td><td class="s">    my $imp_class = $dbh-&gt;{ImplementorClass}</td></tr>
<tr><td class="h"><a name="1248"></a>1248</td><td></td><td></td><td></td><td></td><td class="s">        or Carp::croak(&quot;DBI _new_sth: $dbh has no ImplementorClass&quot;);</td></tr>
<tr><td class="h"><a name="1249"></a>1249</td><td></td><td></td><td></td><td></td><td class="s">    substr($imp_class,-4,4) = '::st';</td></tr>
<tr><td class="h"><a name="1250"></a>1250</td><td></td><td></td><td></td><td></td><td class="s">    my $app_class = ref $dbh;</td></tr>
<tr><td class="h"><a name="1251"></a>1251</td><td></td><td></td><td></td><td></td><td class="s">    substr($app_class,-4,4) = '::st';</td></tr>
<tr><td class="h"><a name="1252"></a>1252</td><td></td><td></td><td></td><td></td><td class="s">    _new_handle($app_class, $dbh, $attr, $imp_data, $imp_class);<div class="calls"><div class="calls_out">    # spent   214&micro;s making 15 calls to <a href="DBI-pm-block.html#DBI___new_handle">DBI::_new_handle</a>, avg 14&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="1253"></a>1253</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1254"></a>1254</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1255"></a>1255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1256"></a>1256</td><td></td><td></td><td></td><td></td><td class="s"># end of DBI package</td></tr>
<tr><td class="h"><a name="1257"></a>1257</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1258"></a>1258</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1259"></a>1259</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1260"></a>1260</td><td></td><td></td><td></td><td></td><td class="s"># --------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1261"></a>1261</td><td></td><td></td><td></td><td></td><td class="s"># === The internal DBI Switch pseudo 'driver' class ===</td></tr>
<tr><td class="h"><a name="1262"></a>1262</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1263"></a>1263</td><td class="c3">1</td><td class="c3"><span title="Avg 300ns">300ns</span></td><td></td><td></td><td class="s">{   package        # hide from PAUSE</td></tr>
<tr><td class="h"><a name="1264"></a>1264</td><td></td><td></td><td></td><td></td><td class="s">        DBD::Switch::dr;</td></tr>
<tr><td class="h"><a name="1265"></a>1265</td><td class="c0">4</td><td class="c3"><span title="Avg 975ns">4&micro;s</span></td><td class="c3">1</td><td class="c0">86&micro;s</td><td class="s">    DBI-&gt;setup_driver('DBD::Switch');        # sets up @ISA<div class="calls"><div class="calls_out">    # spent    86&micro;s making 1 call to <a href="DBI-pm-block.html#805">DBI::setup_driver</a></div></div></td></tr>
<tr><td class="h"><a name="1266"></a>1266</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1267"></a>1267</td><td></td><td></td><td></td><td></td><td class="s">    $DBD::Switch::dr::imp_data_size = 0;</td></tr>
<tr><td class="h"><a name="1268"></a>1268</td><td></td><td></td><td></td><td></td><td class="s">    $DBD::Switch::dr::imp_data_size = 0;        # avoid typo warning</td></tr>
<tr><td class="h"><a name="1269"></a>1269</td><td></td><td></td><td></td><td></td><td class="s">    my $drh;</td></tr>
<tr><td class="h"><a name="1270"></a>1270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1271"></a>1271</td><td></td><td></td><td></td><td></td><td class="s">    sub driver {</td></tr>
<tr><td class="h"><a name="1272"></a>1272</td><td></td><td></td><td></td><td></td><td class="s">        return $drh if $drh;        # a package global</td></tr>
<tr><td class="h"><a name="1273"></a>1273</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1274"></a>1274</td><td></td><td></td><td></td><td></td><td class="s">        my $inner;</td></tr>
<tr><td class="h"><a name="1275"></a>1275</td><td></td><td></td><td></td><td></td><td class="s">        ($drh, $inner) = DBI::_new_drh('DBD::Switch::dr', {</td></tr>
<tr><td class="h"><a name="1276"></a>1276</td><td></td><td></td><td></td><td></td><td class="s">                'Name'    =&gt; 'Switch',</td></tr>
<tr><td class="h"><a name="1277"></a>1277</td><td></td><td></td><td></td><td></td><td class="s">                'Version' =&gt; $DBI::VERSION,</td></tr>
<tr><td class="h"><a name="1278"></a>1278</td><td></td><td></td><td></td><td></td><td class="s">                'Attribution' =&gt; &quot;DBI $DBI::VERSION by Tim Bunce&quot;,</td></tr>
<tr><td class="h"><a name="1279"></a>1279</td><td></td><td></td><td></td><td></td><td class="s">            });</td></tr>
<tr><td class="h"><a name="1280"></a>1280</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;DBD::Switch init failed!&quot;) unless ($drh &amp;&amp; $inner);</td></tr>
<tr><td class="h"><a name="1281"></a>1281</td><td></td><td></td><td></td><td></td><td class="s">        return $drh;</td></tr>
<tr><td class="h"><a name="1282"></a>1282</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1283"></a>1283</td><td></td><td></td><td></td><td></td><td class="s">    sub CLONE {</td></tr>
<tr><td class="h"><a name="1284"></a>1284</td><td></td><td></td><td></td><td></td><td class="s">        undef $drh;</td></tr>
<tr><td class="h"><a name="1285"></a>1285</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1286"></a>1286</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1287"></a>1287</td><td></td><td></td><td></td><td></td><td class="s">    sub FETCH {</td></tr>
<tr><td class="h"><a name="1288"></a>1288</td><td></td><td></td><td></td><td></td><td class="s">        my($drh, $key) = @_;</td></tr>
<tr><td class="h"><a name="1289"></a>1289</td><td></td><td></td><td></td><td></td><td class="s">        return DBI-&gt;trace if $key eq 'DebugDispatch';</td></tr>
<tr><td class="h"><a name="1290"></a>1290</td><td></td><td></td><td></td><td></td><td class="s">        return undef if $key eq 'DebugLog';        # not worth fetching, sorry</td></tr>
<tr><td class="h"><a name="1291"></a>1291</td><td></td><td></td><td></td><td></td><td class="s">        return $drh-&gt;DBD::_::dr::FETCH($key);</td></tr>
<tr><td class="h"><a name="1292"></a>1292</td><td></td><td></td><td></td><td></td><td class="s">        undef;</td></tr>
<tr><td class="h"><a name="1293"></a>1293</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1294"></a>1294</td><td></td><td></td><td></td><td></td><td class="s">    sub STORE {</td></tr>
<tr><td class="h"><a name="1295"></a>1295</td><td></td><td></td><td></td><td></td><td class="s">        my($drh, $key, $value) = @_;</td></tr>
<tr><td class="h"><a name="1296"></a>1296</td><td></td><td></td><td></td><td></td><td class="s">        if ($key eq 'DebugDispatch') {</td></tr>
<tr><td class="h"><a name="1297"></a>1297</td><td></td><td></td><td></td><td></td><td class="s">            DBI-&gt;trace($value);</td></tr>
<tr><td class="h"><a name="1298"></a>1298</td><td></td><td></td><td></td><td></td><td class="s">        } elsif ($key eq 'DebugLog') {</td></tr>
<tr><td class="h"><a name="1299"></a>1299</td><td></td><td></td><td></td><td></td><td class="s">            DBI-&gt;trace(-1, $value);</td></tr>
<tr><td class="h"><a name="1300"></a>1300</td><td></td><td></td><td></td><td></td><td class="s">        } else {</td></tr>
<tr><td class="h"><a name="1301"></a>1301</td><td></td><td></td><td></td><td></td><td class="s">            $drh-&gt;DBD::_::dr::STORE($key, $value);</td></tr>
<tr><td class="h"><a name="1302"></a>1302</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1303"></a>1303</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1304"></a>1304</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1305"></a>1305</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1306"></a>1306</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1307"></a>1307</td><td></td><td></td><td></td><td></td><td class="s"># --------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1308"></a>1308</td><td></td><td></td><td></td><td></td><td class="s"># === OPTIONAL MINIMAL BASE CLASSES FOR DBI SUBCLASSES ===</td></tr>
<tr><td class="h"><a name="1309"></a>1309</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1310"></a>1310</td><td></td><td></td><td></td><td></td><td class="s"># We only define default methods for harmless functions.</td></tr>
<tr><td class="h"><a name="1311"></a>1311</td><td></td><td></td><td></td><td></td><td class="s"># We don't, for example, define a DBD::_::st::prepare()</td></tr>
<tr><td class="h"><a name="1312"></a>1312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1313"></a>1313</td><td class="c3">1</td><td class="c3"><span title="Avg 500ns">500ns</span></td><td></td><td></td><td class="s">{   package                # hide from PAUSE</td></tr>
<tr><td class="h"><a name="1314"></a>1314</td><td></td><td></td><td></td><td></td><td class="s">        DBD::_::common; # ====== Common base class methods ======</td></tr>
<tr><td class="h"><a name="1315"></a>1315</td><td class="c0">3</td><td class="c0"><span title="Avg 186&micro;s">558&micro;s</span></td><td class="c3">1</td><td class="c3">5&micro;s</td><td class="s">    use strict;<div class="calls"><div class="calls_out">    # spent     5&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="1316"></a>1316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1317"></a>1317</td><td></td><td></td><td></td><td></td><td class="s">    # methods common to all handle types:</td></tr>
<tr><td class="h"><a name="1318"></a>1318</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1319"></a>1319</td><td></td><td></td><td></td><td></td><td class="s">    sub _not_impl {</td></tr>
<tr><td class="h"><a name="1320"></a>1320</td><td></td><td></td><td></td><td></td><td class="s">        my ($h, $method) = @_;</td></tr>
<tr><td class="h"><a name="1321"></a>1321</td><td></td><td></td><td></td><td></td><td class="s">        $h-&gt;trace_msg(&quot;Driver does not implement the $method method.\n&quot;);</td></tr>
<tr><td class="h"><a name="1322"></a>1322</td><td></td><td></td><td></td><td></td><td class="s">        return;        # empty list / undef</td></tr>
<tr><td class="h"><a name="1323"></a>1323</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1324"></a>1324</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1325"></a>1325</td><td></td><td></td><td></td><td></td><td class="s">    # generic TIEHASH default methods:</td></tr>
<tr><td class="h"><a name="1326"></a>1326</td><td></td><td></td><td></td><td></td><td class="s">    sub FIRSTKEY { }</td></tr>
<tr><td class="h"><a name="1327"></a>1327</td><td></td><td></td><td></td><td></td><td class="s">    sub NEXTKEY  { }</td></tr>
<tr><td class="h"><a name="1328"></a>1328</td><td></td><td></td><td></td><td></td><td class="s">    sub EXISTS   { defined($_[0]-&gt;FETCH($_[1])) } # XXX undef?</td></tr>
<tr><td class="h"><a name="1329"></a>1329</td><td></td><td></td><td></td><td></td><td class="s">    sub CLEAR    { Carp::carp &quot;Can't CLEAR $_[0] (DBI)&quot; }</td></tr>
<tr><td class="h"><a name="1330"></a>1330</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1331"></a>1331</td><td></td><td></td><td></td><td></td><td class="s">    sub FETCH_many {    # XXX should move to C one day</td></tr>
<tr><td class="h"><a name="1332"></a>1332</td><td></td><td></td><td></td><td></td><td class="s">        my $h = shift;</td></tr>
<tr><td class="h"><a name="1333"></a>1333</td><td></td><td></td><td></td><td></td><td class="s">        return map { $h-&gt;FETCH($_) } @_;</td></tr>
<tr><td class="h"><a name="1334"></a>1334</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1335"></a>1335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1336"></a>1336</td><td class="c3">1</td><td class="c3"><span title="Avg 1&micro;s">1&micro;s</span></td><td></td><td></td><td class="s">    *dump_handle = \&amp;DBI::dump_handle;</td></tr>
<tr><td class="h"><a name="1337"></a>1337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1338"></a>1338</td><td></td><td></td><td></td><td></td><td class="s">    sub install_method {</td></tr>
<tr><td class="h"><a name="1339"></a>1339</td><td></td><td></td><td></td><td></td><td class="s">        # special class method called directly by apps and/or drivers</td></tr>
<tr><td class="h"><a name="1340"></a>1340</td><td></td><td></td><td></td><td></td><td class="s">        # to install new methods into the DBI dispatcher</td></tr>
<tr><td class="h"><a name="1341"></a>1341</td><td></td><td></td><td></td><td></td><td class="s">        # DBD::Foo::db-&gt;install_method(&quot;foo_mumble&quot;, { usage =&gt; [...], options =&gt; '...' });</td></tr>
<tr><td class="h"><a name="1342"></a>1342</td><td></td><td></td><td></td><td></td><td class="s">        my ($class, $method, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1343"></a>1343</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;Class '$class' must begin with DBD:: and end with ::db or ::st&quot;)</td></tr>
<tr><td class="h"><a name="1344"></a>1344</td><td></td><td></td><td></td><td></td><td class="s">            unless $class =~ /^DBD::(\w+)::(dr|db|st)$/;</td></tr>
<tr><td class="h"><a name="1345"></a>1345</td><td></td><td></td><td></td><td></td><td class="s">        my ($driver, $subtype) = ($1, $2);</td></tr>
<tr><td class="h"><a name="1346"></a>1346</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;invalid method name '$method'&quot;)</td></tr>
<tr><td class="h"><a name="1347"></a>1347</td><td></td><td></td><td></td><td></td><td class="s">            unless $method =~ m/^([a-z]+_)\w+$/;</td></tr>
<tr><td class="h"><a name="1348"></a>1348</td><td></td><td></td><td></td><td></td><td class="s">        my $prefix = $1;</td></tr>
<tr><td class="h"><a name="1349"></a>1349</td><td></td><td></td><td></td><td></td><td class="s">        my $reg_info = $dbd_prefix_registry-&gt;{$prefix};</td></tr>
<tr><td class="h"><a name="1350"></a>1350</td><td></td><td></td><td></td><td></td><td class="s">        Carp::carp(&quot;method name prefix '$prefix' is not associated with a registered driver&quot;) unless $reg_info;</td></tr>
<tr><td class="h"><a name="1351"></a>1351</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1352"></a>1352</td><td></td><td></td><td></td><td></td><td class="s">        my $full_method = &quot;DBI::${subtype}::$method&quot;;</td></tr>
<tr><td class="h"><a name="1353"></a>1353</td><td></td><td></td><td></td><td></td><td class="s">        $DBI::installed_methods{$full_method} = $attr;</td></tr>
<tr><td class="h"><a name="1354"></a>1354</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1355"></a>1355</td><td></td><td></td><td></td><td></td><td class="s">        my (undef, $filename, $line) = caller;</td></tr>
<tr><td class="h"><a name="1356"></a>1356</td><td></td><td></td><td></td><td></td><td class="s">        # XXX reformat $attr as needed for _install_method</td></tr>
<tr><td class="h"><a name="1357"></a>1357</td><td></td><td></td><td></td><td></td><td class="s">        my %attr = %{$attr||{}}; # copy so we can edit</td></tr>
<tr><td class="h"><a name="1358"></a>1358</td><td></td><td></td><td></td><td></td><td class="s">        DBI-&gt;_install_method(&quot;DBI::${subtype}::$method&quot;, &quot;$filename at line $line&quot;, \%attr);</td></tr>
<tr><td class="h"><a name="1359"></a>1359</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1360"></a>1360</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1361"></a>1361</td><td></td><td></td><td></td><td></td><td class="s">    sub parse_trace_flags {</td></tr>
<tr><td class="h"><a name="1362"></a>1362</td><td></td><td></td><td></td><td></td><td class="s">        my ($h, $spec) = @_;</td></tr>
<tr><td class="h"><a name="1363"></a>1363</td><td></td><td></td><td></td><td></td><td class="s">        my $level = 0;</td></tr>
<tr><td class="h"><a name="1364"></a>1364</td><td></td><td></td><td></td><td></td><td class="s">        my $flags = 0;</td></tr>
<tr><td class="h"><a name="1365"></a>1365</td><td></td><td></td><td></td><td></td><td class="s">        my @unknown;</td></tr>
<tr><td class="h"><a name="1366"></a>1366</td><td></td><td></td><td></td><td></td><td class="s">        for my $word (split /\s*[|&amp;,]\s*/, $spec) {</td></tr>
<tr><td class="h"><a name="1367"></a>1367</td><td></td><td></td><td></td><td></td><td class="s">            if (DBI::looks_like_number($word) &amp;&amp; $word &lt;= 0xF &amp;&amp; $word &gt;= 0) {</td></tr>
<tr><td class="h"><a name="1368"></a>1368</td><td></td><td></td><td></td><td></td><td class="s">                $level = $word;</td></tr>
<tr><td class="h"><a name="1369"></a>1369</td><td></td><td></td><td></td><td></td><td class="s">            } elsif ($word eq 'ALL') {</td></tr>
<tr><td class="h"><a name="1370"></a>1370</td><td></td><td></td><td></td><td></td><td class="s">                $flags = 0x7FFFFFFF; # XXX last bit causes negative headaches</td></tr>
<tr><td class="h"><a name="1371"></a>1371</td><td></td><td></td><td></td><td></td><td class="s">                last;</td></tr>
<tr><td class="h"><a name="1372"></a>1372</td><td></td><td></td><td></td><td></td><td class="s">            } elsif (my $flag = $h-&gt;parse_trace_flag($word)) {</td></tr>
<tr><td class="h"><a name="1373"></a>1373</td><td></td><td></td><td></td><td></td><td class="s">                $flags |= $flag;</td></tr>
<tr><td class="h"><a name="1374"></a>1374</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1375"></a>1375</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="1376"></a>1376</td><td></td><td></td><td></td><td></td><td class="s">                push @unknown, $word;</td></tr>
<tr><td class="h"><a name="1377"></a>1377</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1378"></a>1378</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1379"></a>1379</td><td></td><td></td><td></td><td></td><td class="s">        if (@unknown &amp;&amp; (ref $h ? $h-&gt;FETCH('Warn') : 1)) {</td></tr>
<tr><td class="h"><a name="1380"></a>1380</td><td></td><td></td><td></td><td></td><td class="s">            Carp::carp(&quot;$h-&gt;parse_trace_flags($spec) ignored unknown trace flags: &quot;.</td></tr>
<tr><td class="h"><a name="1381"></a>1381</td><td></td><td></td><td></td><td></td><td class="s">                join(&quot; &quot;, map { DBI::neat($_) } @unknown));</td></tr>
<tr><td class="h"><a name="1382"></a>1382</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1383"></a>1383</td><td></td><td></td><td></td><td></td><td class="s">        $flags |= $level;</td></tr>
<tr><td class="h"><a name="1384"></a>1384</td><td></td><td></td><td></td><td></td><td class="s">        return $flags;</td></tr>
<tr><td class="h"><a name="1385"></a>1385</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1386"></a>1386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1387"></a>1387</td><td></td><td></td><td></td><td></td><td class="s">    sub parse_trace_flag {</td></tr>
<tr><td class="h"><a name="1388"></a>1388</td><td></td><td></td><td></td><td></td><td class="s">        my ($h, $name) = @_;</td></tr>
<tr><td class="h"><a name="1389"></a>1389</td><td></td><td></td><td></td><td></td><td class="s">        #      0xddDDDDrL (driver, DBI, reserved, Level)</td></tr>
<tr><td class="h"><a name="1390"></a>1390</td><td></td><td></td><td></td><td></td><td class="s">        return 0x00000100 if $name eq 'SQL';</td></tr>
<tr><td class="h"><a name="1391"></a>1391</td><td></td><td></td><td></td><td></td><td class="s">        return;</td></tr>
<tr><td class="h"><a name="1392"></a>1392</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1393"></a>1393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1394"></a>1394</td><td></td><td></td><td></td><td></td><td class="s">    sub private_attribute_info {</td></tr>
<tr><td class="h"><a name="1395"></a>1395</td><td></td><td></td><td></td><td></td><td class="s">        return undef;</td></tr>
<tr><td class="h"><a name="1396"></a>1396</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1397"></a>1397</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1398"></a>1398</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1399"></a>1399</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1400"></a>1400</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1401"></a>1401</td><td class="c3">1</td><td class="c3"><span title="Avg 600ns">600ns</span></td><td></td><td></td><td class="s">{   package                # hide from PAUSE</td></tr>
<tr><td class="h"><a name="1402"></a>1402</td><td></td><td></td><td></td><td></td><td class="s">        DBD::_::dr;        # ====== DRIVER ======</td></tr>
<tr><td class="h"><a name="1403"></a>1403</td><td class="c3">1</td><td class="c3"><span title="Avg 7&micro;s">7&micro;s</span></td><td></td><td></td><td class="s">    @DBD::_::dr::ISA = qw(DBD::_::common);</td></tr>
<tr><td class="h"><a name="1404"></a>1404</td><td class="c0">3</td><td class="c0"><span title="Avg 115&micro;s">346&micro;s</span></td><td class="c3">1</td><td class="c3">4&micro;s</td><td class="s">    use strict;<div class="calls"><div class="calls_out">    # spent     4&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="1405"></a>1405</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1406"></a>1406</td><td></td><td></td><td></td><td></td><td class="s">    sub default_user {</td></tr>
<tr><td class="h"><a name="1407"></a>1407</td><td></td><td></td><td></td><td></td><td class="s">        my ($drh, $user, $pass, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1408"></a>1408</td><td></td><td></td><td></td><td></td><td class="s">        $user = $ENV{DBI_USER} unless defined $user;</td></tr>
<tr><td class="h"><a name="1409"></a>1409</td><td></td><td></td><td></td><td></td><td class="s">        $pass = $ENV{DBI_PASS} unless defined $pass;</td></tr>
<tr><td class="h"><a name="1410"></a>1410</td><td></td><td></td><td></td><td></td><td class="s">        return ($user, $pass);</td></tr>
<tr><td class="h"><a name="1411"></a>1411</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1412"></a>1412</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1413"></a>1413</td><td></td><td></td><td></td><td></td><td class="s">    sub connect { # normally overridden, but a handy default</td></tr>
<tr><td class="h"><a name="1414"></a>1414</td><td></td><td></td><td></td><td></td><td class="s">        my ($drh, $dsn, $user, $auth) = @_;</td></tr>
<tr><td class="h"><a name="1415"></a>1415</td><td></td><td></td><td></td><td></td><td class="s">        my ($this) = DBI::_new_dbh($drh, {</td></tr>
<tr><td class="h"><a name="1416"></a>1416</td><td></td><td></td><td></td><td></td><td class="s">            'Name' =&gt; $dsn,</td></tr>
<tr><td class="h"><a name="1417"></a>1417</td><td></td><td></td><td></td><td></td><td class="s">        });</td></tr>
<tr><td class="h"><a name="1418"></a>1418</td><td></td><td></td><td></td><td></td><td class="s">        # XXX debatable as there's no &quot;server side&quot; here</td></tr>
<tr><td class="h"><a name="1419"></a>1419</td><td></td><td></td><td></td><td></td><td class="s">        # (and now many uses would trigger warnings on DESTROY)</td></tr>
<tr><td class="h"><a name="1420"></a>1420</td><td></td><td></td><td></td><td></td><td class="s">        # $this-&gt;STORE(Active =&gt; 1);</td></tr>
<tr><td class="h"><a name="1421"></a>1421</td><td></td><td></td><td></td><td></td><td class="s">        # so drivers should set it in their own connect</td></tr>
<tr><td class="h"><a name="1422"></a>1422</td><td></td><td></td><td></td><td></td><td class="s">        $this;</td></tr>
<tr><td class="h"><a name="1423"></a>1423</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1424"></a>1424</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1425"></a>1425</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1426"></a>1426</td><td></td><td></td><td></td><td></td><td class="s">    sub connect_cached {</td></tr>
<tr><td class="h"><a name="1427"></a>1427</td><td></td><td></td><td></td><td></td><td class="s">        my $drh = shift;</td></tr>
<tr><td class="h"><a name="1428"></a>1428</td><td></td><td></td><td></td><td></td><td class="s">        my ($dsn, $user, $auth, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1429"></a>1429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1430"></a>1430</td><td></td><td></td><td></td><td></td><td class="s">        my $cache = $drh-&gt;{CachedKids} ||= {};</td></tr>
<tr><td class="h"><a name="1431"></a>1431</td><td></td><td></td><td></td><td></td><td class="s">        my $key = do { local $^W;</td></tr>
<tr><td class="h"><a name="1432"></a>1432</td><td></td><td></td><td></td><td></td><td class="s">            join &quot;!\001&quot;, $dsn, $user, $auth, DBI::_concat_hash_sorted($attr, &quot;=\001&quot;, &quot;,\001&quot;, 0, 0)</td></tr>
<tr><td class="h"><a name="1433"></a>1433</td><td></td><td></td><td></td><td></td><td class="s">        };</td></tr>
<tr><td class="h"><a name="1434"></a>1434</td><td></td><td></td><td></td><td></td><td class="s">        my $dbh = $cache-&gt;{$key};</td></tr>
<tr><td class="h"><a name="1435"></a>1435</td><td></td><td></td><td></td><td></td><td class="s">        $drh-&gt;trace_msg(sprintf(&quot;    connect_cached: key '$key', cached dbh $dbh\n&quot;, DBI::neat($key), DBI::neat($dbh)))</td></tr>
<tr><td class="h"><a name="1436"></a>1436</td><td></td><td></td><td></td><td></td><td class="s">            if $DBI::dbi_debug &gt;= 4;</td></tr>
<tr><td class="h"><a name="1437"></a>1437</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1438"></a>1438</td><td></td><td></td><td></td><td></td><td class="s">        my $cb = $attr-&gt;{Callbacks}; # take care not to autovivify</td></tr>
<tr><td class="h"><a name="1439"></a>1439</td><td></td><td></td><td></td><td></td><td class="s">        if ($dbh &amp;&amp; $dbh-&gt;FETCH('Active') &amp;&amp; eval { $dbh-&gt;ping }) {</td></tr>
<tr><td class="h"><a name="1440"></a>1440</td><td></td><td></td><td></td><td></td><td class="s">            # If the caller has provided a callback then call it</td></tr>
<tr><td class="h"><a name="1441"></a>1441</td><td></td><td></td><td></td><td></td><td class="s">            if ($cb and $cb = $cb-&gt;{&quot;connect_cached.reused&quot;}) {</td></tr>
<tr><td class="h"><a name="1442"></a>1442</td><td></td><td></td><td></td><td></td><td class="s">                local $_ = &quot;connect_cached.reused&quot;;</td></tr>
<tr><td class="h"><a name="1443"></a>1443</td><td></td><td></td><td></td><td></td><td class="s">                $cb-&gt;($dbh, $dsn, $user, $auth, $attr);</td></tr>
<tr><td class="h"><a name="1444"></a>1444</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1445"></a>1445</td><td></td><td></td><td></td><td></td><td class="s">            return $dbh;</td></tr>
<tr><td class="h"><a name="1446"></a>1446</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1447"></a>1447</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1448"></a>1448</td><td></td><td></td><td></td><td></td><td class="s">        # If the caller has provided a callback then call it</td></tr>
<tr><td class="h"><a name="1449"></a>1449</td><td></td><td></td><td></td><td></td><td class="s">        if ($cb and $cb = $cb-&gt;{&quot;connect_cached.new&quot;}) {</td></tr>
<tr><td class="h"><a name="1450"></a>1450</td><td></td><td></td><td></td><td></td><td class="s">            local $_ = &quot;connect_cached.new&quot;;</td></tr>
<tr><td class="h"><a name="1451"></a>1451</td><td></td><td></td><td></td><td></td><td class="s">            $cb-&gt;($dbh, $dsn, $user, $auth, $attr);</td></tr>
<tr><td class="h"><a name="1452"></a>1452</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1453"></a>1453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1454"></a>1454</td><td></td><td></td><td></td><td></td><td class="s">        $dbh = $drh-&gt;connect(@_);</td></tr>
<tr><td class="h"><a name="1455"></a>1455</td><td></td><td></td><td></td><td></td><td class="s">        $cache-&gt;{$key} = $dbh;        # replace prev entry, even if connect failed</td></tr>
<tr><td class="h"><a name="1456"></a>1456</td><td></td><td></td><td></td><td></td><td class="s">        return $dbh;</td></tr>
<tr><td class="h"><a name="1457"></a>1457</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1458"></a>1458</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1459"></a>1459</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1460"></a>1460</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1461"></a>1461</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1462"></a>1462</td><td class="c3">1</td><td class="c3"><span title="Avg 700ns">700ns</span></td><td></td><td></td><td class="s">{   package                # hide from PAUSE</td></tr>
<tr><td class="h"><a name="1463"></a>1463</td><td></td><td></td><td></td><td></td><td class="s">        DBD::_::db;        # ====== DATABASE ======</td></tr>
<tr><td class="h"><a name="1464"></a>1464</td><td class="c3">1</td><td class="c3"><span title="Avg 4&micro;s">4&micro;s</span></td><td></td><td></td><td class="s">    @DBD::_::db::ISA = qw(DBD::_::common);</td></tr>
<tr><td class="h"><a name="1465"></a>1465</td><td class="c0">3</td><td class="c0"><span title="Avg 544&micro;s">1.63ms</span></td><td class="c3">1</td><td class="c3">4&micro;s</td><td class="s">    use strict;<div class="calls"><div class="calls_out">    # spent     4&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="1466"></a>1466</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1467"></a>1467</td><td></td><td></td><td></td><td></td><td class="s">    sub clone {</td></tr>
<tr><td class="h"><a name="1468"></a>1468</td><td></td><td></td><td></td><td></td><td class="s">        my ($old_dbh, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1469"></a>1469</td><td></td><td></td><td></td><td></td><td class="s">        my $closure = $old_dbh-&gt;{dbi_connect_closure} or return;</td></tr>
<tr><td class="h"><a name="1470"></a>1470</td><td></td><td></td><td></td><td></td><td class="s">        unless ($attr) {</td></tr>
<tr><td class="h"><a name="1471"></a>1471</td><td></td><td></td><td></td><td></td><td class="s">            # copy attributes visible in the attribute cache</td></tr>
<tr><td class="h"><a name="1472"></a>1472</td><td></td><td></td><td></td><td></td><td class="s">            keys %$old_dbh;        # reset iterator</td></tr>
<tr><td class="h"><a name="1473"></a>1473</td><td></td><td></td><td></td><td></td><td class="s">            while ( my ($k, $v) = each %$old_dbh ) {</td></tr>
<tr><td class="h"><a name="1474"></a>1474</td><td></td><td></td><td></td><td></td><td class="s">                # ignore non-code refs, i.e., caches, handles, Err etc</td></tr>
<tr><td class="h"><a name="1475"></a>1475</td><td></td><td></td><td></td><td></td><td class="s">                next if ref $v &amp;&amp; ref $v ne 'CODE'; # HandleError etc</td></tr>
<tr><td class="h"><a name="1476"></a>1476</td><td></td><td></td><td></td><td></td><td class="s">                $attr-&gt;{$k} = $v;</td></tr>
<tr><td class="h"><a name="1477"></a>1477</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1478"></a>1478</td><td></td><td></td><td></td><td></td><td class="s">            # explicitly set attributes which are unlikely to be in the</td></tr>
<tr><td class="h"><a name="1479"></a>1479</td><td></td><td></td><td></td><td></td><td class="s">            # attribute cache, i.e., boolean's and some others</td></tr>
<tr><td class="h"><a name="1480"></a>1480</td><td></td><td></td><td></td><td></td><td class="s">            $attr-&gt;{$_} = $old_dbh-&gt;FETCH($_) for (qw(</td></tr>
<tr><td class="h"><a name="1481"></a>1481</td><td></td><td></td><td></td><td></td><td class="s">                AutoCommit ChopBlanks InactiveDestroy</td></tr>
<tr><td class="h"><a name="1482"></a>1482</td><td></td><td></td><td></td><td></td><td class="s">                LongTruncOk PrintError PrintWarn Profile RaiseError</td></tr>
<tr><td class="h"><a name="1483"></a>1483</td><td></td><td></td><td></td><td></td><td class="s">                ShowErrorStatement TaintIn TaintOut</td></tr>
<tr><td class="h"><a name="1484"></a>1484</td><td></td><td></td><td></td><td></td><td class="s">            ));</td></tr>
<tr><td class="h"><a name="1485"></a>1485</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1486"></a>1486</td><td></td><td></td><td></td><td></td><td class="s">        # use Data::Dumper; warn Dumper([$old_dbh, $attr]);</td></tr>
<tr><td class="h"><a name="1487"></a>1487</td><td></td><td></td><td></td><td></td><td class="s">        my $new_dbh = &amp;$closure($old_dbh, $attr);</td></tr>
<tr><td class="h"><a name="1488"></a>1488</td><td></td><td></td><td></td><td></td><td class="s">        unless ($new_dbh) {</td></tr>
<tr><td class="h"><a name="1489"></a>1489</td><td></td><td></td><td></td><td></td><td class="s">            # need to copy err/errstr from driver back into $old_dbh</td></tr>
<tr><td class="h"><a name="1490"></a>1490</td><td></td><td></td><td></td><td></td><td class="s">            my $drh = $old_dbh-&gt;{Driver};</td></tr>
<tr><td class="h"><a name="1491"></a>1491</td><td></td><td></td><td></td><td></td><td class="s">            return $old_dbh-&gt;set_err($drh-&gt;err, $drh-&gt;errstr, $drh-&gt;state);</td></tr>
<tr><td class="h"><a name="1492"></a>1492</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1493"></a>1493</td><td></td><td></td><td></td><td></td><td class="s">        return $new_dbh;</td></tr>
<tr><td class="h"><a name="1494"></a>1494</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1495"></a>1495</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1496"></a>1496</td><td></td><td></td><td></td><td></td><td class="s">    sub quote_identifier {</td></tr>
<tr><td class="h"><a name="1497"></a>1497</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, @id) = @_;</td></tr>
<tr><td class="h"><a name="1498"></a>1498</td><td></td><td></td><td></td><td></td><td class="s">        my $attr = (@id &gt; 3 &amp;&amp; ref($id[-1])) ? pop @id : undef;</td></tr>
<tr><td class="h"><a name="1499"></a>1499</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1500"></a>1500</td><td></td><td></td><td></td><td></td><td class="s">        my $info = $dbh-&gt;{dbi_quote_identifier_cache} ||= [</td></tr>
<tr><td class="h"><a name="1501"></a>1501</td><td></td><td></td><td></td><td></td><td class="s">            $dbh-&gt;get_info(29)  || '&quot;',        # SQL_IDENTIFIER_QUOTE_CHAR</td></tr>
<tr><td class="h"><a name="1502"></a>1502</td><td></td><td></td><td></td><td></td><td class="s">            $dbh-&gt;get_info(41)  || '.',        # SQL_CATALOG_NAME_SEPARATOR</td></tr>
<tr><td class="h"><a name="1503"></a>1503</td><td></td><td></td><td></td><td></td><td class="s">            $dbh-&gt;get_info(114) ||   1,        # SQL_CATALOG_LOCATION</td></tr>
<tr><td class="h"><a name="1504"></a>1504</td><td></td><td></td><td></td><td></td><td class="s">        ];</td></tr>
<tr><td class="h"><a name="1505"></a>1505</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1506"></a>1506</td><td></td><td></td><td></td><td></td><td class="s">        my $quote = $info-&gt;[0];</td></tr>
<tr><td class="h"><a name="1507"></a>1507</td><td></td><td></td><td></td><td></td><td class="s">        foreach (@id) {                        # quote the elements</td></tr>
<tr><td class="h"><a name="1508"></a>1508</td><td></td><td></td><td></td><td></td><td class="s">            next unless defined;</td></tr>
<tr><td class="h"><a name="1509"></a>1509</td><td></td><td></td><td></td><td></td><td class="s">            s/$quote/$quote$quote/g;        # escape embedded quotes</td></tr>
<tr><td class="h"><a name="1510"></a>1510</td><td></td><td></td><td></td><td></td><td class="s">            $_ = qq{$quote$_$quote};</td></tr>
<tr><td class="h"><a name="1511"></a>1511</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1512"></a>1512</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1513"></a>1513</td><td></td><td></td><td></td><td></td><td class="s">        # strip out catalog if present for special handling</td></tr>
<tr><td class="h"><a name="1514"></a>1514</td><td></td><td></td><td></td><td></td><td class="s">        my $catalog = (@id &gt;= 3) ? shift @id : undef;</td></tr>
<tr><td class="h"><a name="1515"></a>1515</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1516"></a>1516</td><td></td><td></td><td></td><td></td><td class="s">        # join the dots, ignoring any null/undef elements (ie schema)</td></tr>
<tr><td class="h"><a name="1517"></a>1517</td><td></td><td></td><td></td><td></td><td class="s">        my $quoted_id = join '.', grep { defined } @id;</td></tr>
<tr><td class="h"><a name="1518"></a>1518</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1519"></a>1519</td><td></td><td></td><td></td><td></td><td class="s">        if ($catalog) {                        # add catalog correctly</td></tr>
<tr><td class="h"><a name="1520"></a>1520</td><td></td><td></td><td></td><td></td><td class="s">            $quoted_id = ($info-&gt;[2] == 2)        # SQL_CL_END</td></tr>
<tr><td class="h"><a name="1521"></a>1521</td><td></td><td></td><td></td><td></td><td class="s">                    ? $quoted_id . $info-&gt;[1] . $catalog</td></tr>
<tr><td class="h"><a name="1522"></a>1522</td><td></td><td></td><td></td><td></td><td class="s">                    : $catalog   . $info-&gt;[1] . $quoted_id;</td></tr>
<tr><td class="h"><a name="1523"></a>1523</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1524"></a>1524</td><td></td><td></td><td></td><td></td><td class="s">        return $quoted_id;</td></tr>
<tr><td class="h"><a name="1525"></a>1525</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1526"></a>1526</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1527"></a>1527</td><td></td><td></td><td></td><td></td><td class="s">    sub quote {</td></tr>
<tr><td class="h"><a name="1528"></a>1528</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $str, $data_type) = @_;</td></tr>
<tr><td class="h"><a name="1529"></a>1529</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1530"></a>1530</td><td></td><td></td><td></td><td></td><td class="s">        return &quot;NULL&quot; unless defined $str;</td></tr>
<tr><td class="h"><a name="1531"></a>1531</td><td></td><td></td><td></td><td></td><td class="s">        unless ($data_type) {</td></tr>
<tr><td class="h"><a name="1532"></a>1532</td><td></td><td></td><td></td><td></td><td class="s">            $str =~ s/'/''/g;                # ISO SQL2</td></tr>
<tr><td class="h"><a name="1533"></a>1533</td><td></td><td></td><td></td><td></td><td class="s">            return &quot;'$str'&quot;;</td></tr>
<tr><td class="h"><a name="1534"></a>1534</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1535"></a>1535</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1536"></a>1536</td><td></td><td></td><td></td><td></td><td class="s">        my $dbi_literal_quote_cache = $dbh-&gt;{'dbi_literal_quote_cache'} ||= [ {} , {} ];</td></tr>
<tr><td class="h"><a name="1537"></a>1537</td><td></td><td></td><td></td><td></td><td class="s">        my ($prefixes, $suffixes) = @$dbi_literal_quote_cache;</td></tr>
<tr><td class="h"><a name="1538"></a>1538</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1539"></a>1539</td><td></td><td></td><td></td><td></td><td class="s">        my $lp = $prefixes-&gt;{$data_type};</td></tr>
<tr><td class="h"><a name="1540"></a>1540</td><td></td><td></td><td></td><td></td><td class="s">        my $ls = $suffixes-&gt;{$data_type};</td></tr>
<tr><td class="h"><a name="1541"></a>1541</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1542"></a>1542</td><td></td><td></td><td></td><td></td><td class="s">        if ( ! defined $lp || ! defined $ls ) {</td></tr>
<tr><td class="h"><a name="1543"></a>1543</td><td></td><td></td><td></td><td></td><td class="s">            my $ti = $dbh-&gt;type_info($data_type);</td></tr>
<tr><td class="h"><a name="1544"></a>1544</td><td></td><td></td><td></td><td></td><td class="s">            $lp = $prefixes-&gt;{$data_type} = $ti ? $ti-&gt;{LITERAL_PREFIX} || &quot;&quot; : &quot;'&quot;;</td></tr>
<tr><td class="h"><a name="1545"></a>1545</td><td></td><td></td><td></td><td></td><td class="s">            $ls = $suffixes-&gt;{$data_type} = $ti ? $ti-&gt;{LITERAL_SUFFIX} || &quot;&quot; : &quot;'&quot;;</td></tr>
<tr><td class="h"><a name="1546"></a>1546</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1547"></a>1547</td><td></td><td></td><td></td><td></td><td class="s">        return $str unless $lp || $ls; # no quoting required</td></tr>
<tr><td class="h"><a name="1548"></a>1548</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1549"></a>1549</td><td></td><td></td><td></td><td></td><td class="s">        # XXX don't know what the standard says about escaping</td></tr>
<tr><td class="h"><a name="1550"></a>1550</td><td></td><td></td><td></td><td></td><td class="s">        # in the 'general case' (where $lp != &quot;'&quot;).</td></tr>
<tr><td class="h"><a name="1551"></a>1551</td><td></td><td></td><td></td><td></td><td class="s">        # So we just do this and hope:</td></tr>
<tr><td class="h"><a name="1552"></a>1552</td><td></td><td></td><td></td><td></td><td class="s">        $str =~ s/$lp/$lp$lp/g</td></tr>
<tr><td class="h"><a name="1553"></a>1553</td><td></td><td></td><td></td><td></td><td class="s">                if $lp &amp;&amp; $lp eq $ls &amp;&amp; ($lp eq &quot;'&quot; || $lp eq '&quot;');</td></tr>
<tr><td class="h"><a name="1554"></a>1554</td><td></td><td></td><td></td><td></td><td class="s">        return &quot;$lp$str$ls&quot;;</td></tr>
<tr><td class="h"><a name="1555"></a>1555</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1556"></a>1556</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1557"></a>1557</td><td></td><td></td><td></td><td></td><td class="s">    sub rows { -1 }        # here so $DBI::rows 'works' after using $dbh</td></tr>
<tr><td class="h"><a name="1558"></a>1558</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1559"></a>1559</td><td></td><td></td><td></td><td></td><td class="s">    sub do {</td></tr>
<tr><td class="h"><a name="1560"></a>1560</td><td></td><td></td><td></td><td></td><td class="s">        my($dbh, $statement, $attr, @params) = @_;</td></tr>
<tr><td class="h"><a name="1561"></a>1561</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = $dbh-&gt;prepare($statement, $attr) or return undef;</td></tr>
<tr><td class="h"><a name="1562"></a>1562</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute(@params) or return undef;</td></tr>
<tr><td class="h"><a name="1563"></a>1563</td><td></td><td></td><td></td><td></td><td class="s">        my $rows = $sth-&gt;rows;</td></tr>
<tr><td class="h"><a name="1564"></a>1564</td><td></td><td></td><td></td><td></td><td class="s">        ($rows == 0) ? &quot;0E0&quot; : $rows;</td></tr>
<tr><td class="h"><a name="1565"></a>1565</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1566"></a>1566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1567"></a>1567</td><td></td><td></td><td></td><td></td><td class="s">    sub _do_selectrow {</td></tr>
<tr><td class="h"><a name="1568"></a>1568</td><td></td><td></td><td></td><td></td><td class="s">        my ($method, $dbh, $stmt, $attr, @bind) = @_;</td></tr>
<tr><td class="h"><a name="1569"></a>1569</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = ((ref $stmt) ? $stmt : $dbh-&gt;prepare($stmt, $attr))</td></tr>
<tr><td class="h"><a name="1570"></a>1570</td><td></td><td></td><td></td><td></td><td class="s">            or return;</td></tr>
<tr><td class="h"><a name="1571"></a>1571</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute(@bind)</td></tr>
<tr><td class="h"><a name="1572"></a>1572</td><td></td><td></td><td></td><td></td><td class="s">            or return;</td></tr>
<tr><td class="h"><a name="1573"></a>1573</td><td></td><td></td><td></td><td></td><td class="s">        my $row = $sth-&gt;$method()</td></tr>
<tr><td class="h"><a name="1574"></a>1574</td><td></td><td></td><td></td><td></td><td class="s">            and $sth-&gt;finish;</td></tr>
<tr><td class="h"><a name="1575"></a>1575</td><td></td><td></td><td></td><td></td><td class="s">        return $row;</td></tr>
<tr><td class="h"><a name="1576"></a>1576</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1577"></a>1577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1578"></a>1578</td><td></td><td></td><td></td><td></td><td class="s">    sub selectrow_hashref {  return _do_selectrow('fetchrow_hashref',  @_); }</td></tr>
<tr><td class="h"><a name="1579"></a>1579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1580"></a>1580</td><td></td><td></td><td></td><td></td><td class="s">    # XXX selectrow_array/ref also have C implementations in Driver.xst</td></tr>
<tr><td class="h"><a name="1581"></a>1581</td><td></td><td></td><td></td><td></td><td class="s">    sub selectrow_arrayref { return _do_selectrow('fetchrow_arrayref', @_); }</td></tr>
<tr><td class="h"><a name="1582"></a>1582</td><td></td><td></td><td></td><td></td><td class="s">    sub selectrow_array {</td></tr>
<tr><td class="h"><a name="1583"></a>1583</td><td></td><td></td><td></td><td></td><td class="s">        my $row = _do_selectrow('fetchrow_arrayref', @_) or return;</td></tr>
<tr><td class="h"><a name="1584"></a>1584</td><td></td><td></td><td></td><td></td><td class="s">        return $row-&gt;[0] unless wantarray;</td></tr>
<tr><td class="h"><a name="1585"></a>1585</td><td></td><td></td><td></td><td></td><td class="s">        return @$row;</td></tr>
<tr><td class="h"><a name="1586"></a>1586</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1587"></a>1587</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1588"></a>1588</td><td></td><td></td><td></td><td></td><td class="s">    # XXX selectall_arrayref also has C implementation in Driver.xst</td></tr>
<tr><td class="h"><a name="1589"></a>1589</td><td></td><td></td><td></td><td></td><td class="s">    # which fallsback to this if a slice is given</td></tr>
<tr><td class="h"><a name="1590"></a>1590</td><td></td><td></td><td></td><td></td><td class="s">    sub selectall_arrayref {</td></tr>
<tr><td class="h"><a name="1591"></a>1591</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $stmt, $attr, @bind) = @_;</td></tr>
<tr><td class="h"><a name="1592"></a>1592</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = (ref $stmt) ? $stmt : $dbh-&gt;prepare($stmt, $attr)</td></tr>
<tr><td class="h"><a name="1593"></a>1593</td><td></td><td></td><td></td><td></td><td class="s">            or return;</td></tr>
<tr><td class="h"><a name="1594"></a>1594</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute(@bind) || return;</td></tr>
<tr><td class="h"><a name="1595"></a>1595</td><td></td><td></td><td></td><td></td><td class="s">        my $slice = $attr-&gt;{Slice}; # typically undef, else hash or array ref</td></tr>
<tr><td class="h"><a name="1596"></a>1596</td><td></td><td></td><td></td><td></td><td class="s">        if (!$slice and $slice=$attr-&gt;{Columns}) {</td></tr>
<tr><td class="h"><a name="1597"></a>1597</td><td></td><td></td><td></td><td></td><td class="s">            if (ref $slice eq 'ARRAY') { # map col idx to perl array idx</td></tr>
<tr><td class="h"><a name="1598"></a>1598</td><td></td><td></td><td></td><td></td><td class="s">                $slice = [ @{$attr-&gt;{Columns}} ];        # take a copy</td></tr>
<tr><td class="h"><a name="1599"></a>1599</td><td></td><td></td><td></td><td></td><td class="s">                for (@$slice) { $_-- }</td></tr>
<tr><td class="h"><a name="1600"></a>1600</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1601"></a>1601</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1602"></a>1602</td><td></td><td></td><td></td><td></td><td class="s">        my $rows = $sth-&gt;fetchall_arrayref($slice, my $MaxRows = $attr-&gt;{MaxRows});</td></tr>
<tr><td class="h"><a name="1603"></a>1603</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;finish if defined $MaxRows;</td></tr>
<tr><td class="h"><a name="1604"></a>1604</td><td></td><td></td><td></td><td></td><td class="s">        return $rows;</td></tr>
<tr><td class="h"><a name="1605"></a>1605</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1606"></a>1606</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1607"></a>1607</td><td></td><td></td><td></td><td></td><td class="s">    sub selectall_hashref {</td></tr>
<tr><td class="h"><a name="1608"></a>1608</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $stmt, $key_field, $attr, @bind) = @_;</td></tr>
<tr><td class="h"><a name="1609"></a>1609</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = (ref $stmt) ? $stmt : $dbh-&gt;prepare($stmt, $attr);</td></tr>
<tr><td class="h"><a name="1610"></a>1610</td><td></td><td></td><td></td><td></td><td class="s">        return unless $sth;</td></tr>
<tr><td class="h"><a name="1611"></a>1611</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute(@bind) || return;</td></tr>
<tr><td class="h"><a name="1612"></a>1612</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;fetchall_hashref($key_field);</td></tr>
<tr><td class="h"><a name="1613"></a>1613</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1614"></a>1614</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1615"></a>1615</td><td></td><td></td><td></td><td></td><td class="s">    sub selectcol_arrayref {</td></tr>
<tr><td class="h"><a name="1616"></a>1616</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $stmt, $attr, @bind) = @_;</td></tr>
<tr><td class="h"><a name="1617"></a>1617</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = (ref $stmt) ? $stmt : $dbh-&gt;prepare($stmt, $attr);</td></tr>
<tr><td class="h"><a name="1618"></a>1618</td><td></td><td></td><td></td><td></td><td class="s">        return unless $sth;</td></tr>
<tr><td class="h"><a name="1619"></a>1619</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute(@bind) || return;</td></tr>
<tr><td class="h"><a name="1620"></a>1620</td><td></td><td></td><td></td><td></td><td class="s">        my @columns = ($attr-&gt;{Columns}) ? @{$attr-&gt;{Columns}} : (1);</td></tr>
<tr><td class="h"><a name="1621"></a>1621</td><td></td><td></td><td></td><td></td><td class="s">        my @values  = (undef) x @columns;</td></tr>
<tr><td class="h"><a name="1622"></a>1622</td><td></td><td></td><td></td><td></td><td class="s">        my $idx = 0;</td></tr>
<tr><td class="h"><a name="1623"></a>1623</td><td></td><td></td><td></td><td></td><td class="s">        for (@columns) {</td></tr>
<tr><td class="h"><a name="1624"></a>1624</td><td></td><td></td><td></td><td></td><td class="s">            $sth-&gt;bind_col($_, \$values[$idx++]) || return;</td></tr>
<tr><td class="h"><a name="1625"></a>1625</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1626"></a>1626</td><td></td><td></td><td></td><td></td><td class="s">        my @col;</td></tr>
<tr><td class="h"><a name="1627"></a>1627</td><td></td><td></td><td></td><td></td><td class="s">        if (my $max = $attr-&gt;{MaxRows}) {</td></tr>
<tr><td class="h"><a name="1628"></a>1628</td><td></td><td></td><td></td><td></td><td class="s">            push @col, @values while @col&lt;$max &amp;&amp; $sth-&gt;fetch;</td></tr>
<tr><td class="h"><a name="1629"></a>1629</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1630"></a>1630</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="1631"></a>1631</td><td></td><td></td><td></td><td></td><td class="s">            push @col, @values while $sth-&gt;fetch;</td></tr>
<tr><td class="h"><a name="1632"></a>1632</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1633"></a>1633</td><td></td><td></td><td></td><td></td><td class="s">        return \@col;</td></tr>
<tr><td class="h"><a name="1634"></a>1634</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1635"></a>1635</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1636"></a>1636</td><td></td><td></td><td></td><td></td><td class="s">    sub prepare_cached {</td></tr>
<tr><td class="h"><a name="1637"></a>1637</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $statement, $attr, $if_active) = @_;</td></tr>
<tr><td class="h"><a name="1638"></a>1638</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1639"></a>1639</td><td></td><td></td><td></td><td></td><td class="s">        # Needs support at dbh level to clear cache before complaining about</td></tr>
<tr><td class="h"><a name="1640"></a>1640</td><td></td><td></td><td></td><td></td><td class="s">        # active children. The XS template code does this. Drivers not using</td></tr>
<tr><td class="h"><a name="1641"></a>1641</td><td></td><td></td><td></td><td></td><td class="s">        # the template must handle clearing the cache themselves.</td></tr>
<tr><td class="h"><a name="1642"></a>1642</td><td></td><td></td><td></td><td></td><td class="s">        my $cache = $dbh-&gt;{CachedKids} ||= {};</td></tr>
<tr><td class="h"><a name="1643"></a>1643</td><td></td><td></td><td></td><td></td><td class="s">        my $key = do { local $^W;</td></tr>
<tr><td class="h"><a name="1644"></a>1644</td><td></td><td></td><td></td><td></td><td class="s">            join &quot;!\001&quot;, $statement, DBI::_concat_hash_sorted($attr, &quot;=\001&quot;, &quot;,\001&quot;, 0, 0)</td></tr>
<tr><td class="h"><a name="1645"></a>1645</td><td></td><td></td><td></td><td></td><td class="s">        };</td></tr>
<tr><td class="h"><a name="1646"></a>1646</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = $cache-&gt;{$key};</td></tr>
<tr><td class="h"><a name="1647"></a>1647</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1648"></a>1648</td><td></td><td></td><td></td><td></td><td class="s">        if ($sth) {</td></tr>
<tr><td class="h"><a name="1649"></a>1649</td><td></td><td></td><td></td><td></td><td class="s">            return $sth unless $sth-&gt;FETCH('Active');</td></tr>
<tr><td class="h"><a name="1650"></a>1650</td><td></td><td></td><td></td><td></td><td class="s">            Carp::carp(&quot;prepare_cached($statement) statement handle $sth still Active&quot;)</td></tr>
<tr><td class="h"><a name="1651"></a>1651</td><td></td><td></td><td></td><td></td><td class="s">                unless ($if_active ||= 0);</td></tr>
<tr><td class="h"><a name="1652"></a>1652</td><td></td><td></td><td></td><td></td><td class="s">            $sth-&gt;finish if $if_active &lt;= 1;</td></tr>
<tr><td class="h"><a name="1653"></a>1653</td><td></td><td></td><td></td><td></td><td class="s">            return $sth  if $if_active &lt;= 2;</td></tr>
<tr><td class="h"><a name="1654"></a>1654</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1655"></a>1655</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1656"></a>1656</td><td></td><td></td><td></td><td></td><td class="s">        $sth = $dbh-&gt;prepare($statement, $attr);</td></tr>
<tr><td class="h"><a name="1657"></a>1657</td><td></td><td></td><td></td><td></td><td class="s">        $cache-&gt;{$key} = $sth if $sth;</td></tr>
<tr><td class="h"><a name="1658"></a>1658</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1659"></a>1659</td><td></td><td></td><td></td><td></td><td class="s">        return $sth;</td></tr>
<tr><td class="h"><a name="1660"></a>1660</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1661"></a>1661</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1662"></a>1662</td><td></td><td></td><td></td><td></td><td class="s">    sub ping {</td></tr>
<tr><td class="h"><a name="1663"></a>1663</td><td></td><td></td><td></td><td></td><td class="s">        my $dbh = shift;</td></tr>
<tr><td class="h"><a name="1664"></a>1664</td><td></td><td></td><td></td><td></td><td class="s">        $dbh-&gt;_not_impl('ping');</td></tr>
<tr><td class="h"><a name="1665"></a>1665</td><td></td><td></td><td></td><td></td><td class="s">        # &quot;0 but true&quot; is a special kind of true 0 that is used here so</td></tr>
<tr><td class="h"><a name="1666"></a>1666</td><td></td><td></td><td></td><td></td><td class="s">        # applications can check if the ping was a real ping or not</td></tr>
<tr><td class="h"><a name="1667"></a>1667</td><td></td><td></td><td></td><td></td><td class="s">        ($dbh-&gt;FETCH('Active')) ?  &quot;0 but true&quot; : 0;</td></tr>
<tr><td class="h"><a name="1668"></a>1668</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1669"></a>1669</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1670"></a>1670</td><td></td><td></td><td></td><td></td><td class="s">    sub begin_work {</td></tr>
<tr><td class="h"><a name="1671"></a>1671</td><td></td><td></td><td></td><td></td><td class="s">        my $dbh = shift;</td></tr>
<tr><td class="h"><a name="1672"></a>1672</td><td></td><td></td><td></td><td></td><td class="s">        return $dbh-&gt;set_err($DBI::stderr, &quot;Already in a transaction&quot;)</td></tr>
<tr><td class="h"><a name="1673"></a>1673</td><td></td><td></td><td></td><td></td><td class="s">                unless $dbh-&gt;FETCH('AutoCommit');</td></tr>
<tr><td class="h"><a name="1674"></a>1674</td><td></td><td></td><td></td><td></td><td class="s">        $dbh-&gt;STORE('AutoCommit', 0); # will croak if driver doesn't support it</td></tr>
<tr><td class="h"><a name="1675"></a>1675</td><td></td><td></td><td></td><td></td><td class="s">        $dbh-&gt;STORE('BegunWork',  1); # trigger post commit/rollback action</td></tr>
<tr><td class="h"><a name="1676"></a>1676</td><td></td><td></td><td></td><td></td><td class="s">        return 1;</td></tr>
<tr><td class="h"><a name="1677"></a>1677</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1678"></a>1678</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1679"></a>1679</td><td></td><td></td><td></td><td></td><td class="s">    sub primary_key {</td></tr>
<tr><td class="h"><a name="1680"></a>1680</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, @args) = @_;</td></tr>
<tr><td class="h"><a name="1681"></a>1681</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = $dbh-&gt;primary_key_info(@args) or return;</td></tr>
<tr><td class="h"><a name="1682"></a>1682</td><td></td><td></td><td></td><td></td><td class="s">        my ($row, @col);</td></tr>
<tr><td class="h"><a name="1683"></a>1683</td><td></td><td></td><td></td><td></td><td class="s">        push @col, $row-&gt;[3] while ($row = $sth-&gt;fetch);</td></tr>
<tr><td class="h"><a name="1684"></a>1684</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;primary_key method not called in list context&quot;)</td></tr>
<tr><td class="h"><a name="1685"></a>1685</td><td></td><td></td><td></td><td></td><td class="s">                unless wantarray; # leave us some elbow room</td></tr>
<tr><td class="h"><a name="1686"></a>1686</td><td></td><td></td><td></td><td></td><td class="s">        return @col;</td></tr>
<tr><td class="h"><a name="1687"></a>1687</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1688"></a>1688</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1689"></a>1689</td><td></td><td></td><td></td><td></td><td class="s">    sub tables {</td></tr>
<tr><td class="h"><a name="1690"></a>1690</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, @args) = @_;</td></tr>
<tr><td class="h"><a name="1691"></a>1691</td><td></td><td></td><td></td><td></td><td class="s">        my $sth    = $dbh-&gt;table_info(@args[0,1,2,3,4]) or return;</td></tr>
<tr><td class="h"><a name="1692"></a>1692</td><td></td><td></td><td></td><td></td><td class="s">        my $tables = $sth-&gt;fetchall_arrayref or return;</td></tr>
<tr><td class="h"><a name="1693"></a>1693</td><td></td><td></td><td></td><td></td><td class="s">        my @tables;</td></tr>
<tr><td class="h"><a name="1694"></a>1694</td><td></td><td></td><td></td><td></td><td class="s">        if ($dbh-&gt;get_info(29)) { # SQL_IDENTIFIER_QUOTE_CHAR</td></tr>
<tr><td class="h"><a name="1695"></a>1695</td><td></td><td></td><td></td><td></td><td class="s">            @tables = map { $dbh-&gt;quote_identifier( @{$_}[0,1,2] ) } @$tables;</td></tr>
<tr><td class="h"><a name="1696"></a>1696</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1697"></a>1697</td><td></td><td></td><td></td><td></td><td class="s">        else {                # temporary old style hack (yeach)</td></tr>
<tr><td class="h"><a name="1698"></a>1698</td><td></td><td></td><td></td><td></td><td class="s">            @tables = map {</td></tr>
<tr><td class="h"><a name="1699"></a>1699</td><td></td><td></td><td></td><td></td><td class="s">                my $name = $_-&gt;[2];</td></tr>
<tr><td class="h"><a name="1700"></a>1700</td><td></td><td></td><td></td><td></td><td class="s">                if ($_-&gt;[1]) {</td></tr>
<tr><td class="h"><a name="1701"></a>1701</td><td></td><td></td><td></td><td></td><td class="s">                    my $schema = $_-&gt;[1];</td></tr>
<tr><td class="h"><a name="1702"></a>1702</td><td></td><td></td><td></td><td></td><td class="s">                    # a sad hack (mostly for Informix I recall)</td></tr>
<tr><td class="h"><a name="1703"></a>1703</td><td></td><td></td><td></td><td></td><td class="s">                    my $quote = ($schema eq uc($schema)) ? '' : '&quot;';</td></tr>
<tr><td class="h"><a name="1704"></a>1704</td><td></td><td></td><td></td><td></td><td class="s">                    $name = &quot;$quote$schema$quote.$name&quot;</td></tr>
<tr><td class="h"><a name="1705"></a>1705</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="1706"></a>1706</td><td></td><td></td><td></td><td></td><td class="s">                $name;</td></tr>
<tr><td class="h"><a name="1707"></a>1707</td><td></td><td></td><td></td><td></td><td class="s">            } @$tables;</td></tr>
<tr><td class="h"><a name="1708"></a>1708</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1709"></a>1709</td><td></td><td></td><td></td><td></td><td class="s">        return @tables;</td></tr>
<tr><td class="h"><a name="1710"></a>1710</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1711"></a>1711</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1712"></a>1712</td><td></td><td></td><td></td><td></td><td class="s">    sub type_info {        # this should be sufficient for all drivers</td></tr>
<tr><td class="h"><a name="1713"></a>1713</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, $data_type) = @_;</td></tr>
<tr><td class="h"><a name="1714"></a>1714</td><td></td><td></td><td></td><td></td><td class="s">        my $idx_hash;</td></tr>
<tr><td class="h"><a name="1715"></a>1715</td><td></td><td></td><td></td><td></td><td class="s">        my $tia = $dbh-&gt;{dbi_type_info_row_cache};</td></tr>
<tr><td class="h"><a name="1716"></a>1716</td><td></td><td></td><td></td><td></td><td class="s">        if ($tia) {</td></tr>
<tr><td class="h"><a name="1717"></a>1717</td><td></td><td></td><td></td><td></td><td class="s">            $idx_hash = $dbh-&gt;{dbi_type_info_idx_cache};</td></tr>
<tr><td class="h"><a name="1718"></a>1718</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1719"></a>1719</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="1720"></a>1720</td><td></td><td></td><td></td><td></td><td class="s">            my $temp = $dbh-&gt;type_info_all;</td></tr>
<tr><td class="h"><a name="1721"></a>1721</td><td></td><td></td><td></td><td></td><td class="s">            return unless $temp &amp;&amp; @$temp;</td></tr>
<tr><td class="h"><a name="1722"></a>1722</td><td></td><td></td><td></td><td></td><td class="s">            # we cache here because type_info_all may be expensive to call</td></tr>
<tr><td class="h"><a name="1723"></a>1723</td><td></td><td></td><td></td><td></td><td class="s">            # (and we take a copy so the following shift can't corrupt</td></tr>
<tr><td class="h"><a name="1724"></a>1724</td><td></td><td></td><td></td><td></td><td class="s">            # the data that may be returned by future calls to type_info_all)</td></tr>
<tr><td class="h"><a name="1725"></a>1725</td><td></td><td></td><td></td><td></td><td class="s">            $tia      = $dbh-&gt;{dbi_type_info_row_cache} = [ @$temp ];</td></tr>
<tr><td class="h"><a name="1726"></a>1726</td><td></td><td></td><td></td><td></td><td class="s">            $idx_hash = $dbh-&gt;{dbi_type_info_idx_cache} = shift @$tia;</td></tr>
<tr><td class="h"><a name="1727"></a>1727</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1728"></a>1728</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1729"></a>1729</td><td></td><td></td><td></td><td></td><td class="s">        my $dt_idx   = $idx_hash-&gt;{DATA_TYPE} || $idx_hash-&gt;{data_type};</td></tr>
<tr><td class="h"><a name="1730"></a>1730</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;type_info_all returned non-standard DATA_TYPE index value ($dt_idx != 1)&quot;)</td></tr>
<tr><td class="h"><a name="1731"></a>1731</td><td></td><td></td><td></td><td></td><td class="s">            if $dt_idx &amp;&amp; $dt_idx != 1;</td></tr>
<tr><td class="h"><a name="1732"></a>1732</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1733"></a>1733</td><td></td><td></td><td></td><td></td><td class="s">        # --- simple DATA_TYPE match filter</td></tr>
<tr><td class="h"><a name="1734"></a>1734</td><td></td><td></td><td></td><td></td><td class="s">        my @ti;</td></tr>
<tr><td class="h"><a name="1735"></a>1735</td><td></td><td></td><td></td><td></td><td class="s">        my @data_type_list = (ref $data_type) ? @$data_type : ($data_type);</td></tr>
<tr><td class="h"><a name="1736"></a>1736</td><td></td><td></td><td></td><td></td><td class="s">        foreach $data_type (@data_type_list) {</td></tr>
<tr><td class="h"><a name="1737"></a>1737</td><td></td><td></td><td></td><td></td><td class="s">            if (defined($data_type) &amp;&amp; $data_type != DBI::SQL_ALL_TYPES()) {</td></tr>
<tr><td class="h"><a name="1738"></a>1738</td><td></td><td></td><td></td><td></td><td class="s">                push @ti, grep { $_-&gt;[$dt_idx] == $data_type } @$tia;</td></tr>
<tr><td class="h"><a name="1739"></a>1739</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1740"></a>1740</td><td></td><td></td><td></td><td></td><td class="s">            else {        # SQL_ALL_TYPES</td></tr>
<tr><td class="h"><a name="1741"></a>1741</td><td></td><td></td><td></td><td></td><td class="s">                push @ti, @$tia;</td></tr>
<tr><td class="h"><a name="1742"></a>1742</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1743"></a>1743</td><td></td><td></td><td></td><td></td><td class="s">            last if @ti;        # found at least one match</td></tr>
<tr><td class="h"><a name="1744"></a>1744</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1745"></a>1745</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1746"></a>1746</td><td></td><td></td><td></td><td></td><td class="s">        # --- format results into list of hash refs</td></tr>
<tr><td class="h"><a name="1747"></a>1747</td><td></td><td></td><td></td><td></td><td class="s">        my $idx_fields = keys %$idx_hash;</td></tr>
<tr><td class="h"><a name="1748"></a>1748</td><td></td><td></td><td></td><td></td><td class="s">        my @idx_names  = map { uc($_) } keys %$idx_hash;</td></tr>
<tr><td class="h"><a name="1749"></a>1749</td><td></td><td></td><td></td><td></td><td class="s">        my @idx_values = values %$idx_hash;</td></tr>
<tr><td class="h"><a name="1750"></a>1750</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak &quot;type_info_all result has $idx_fields keys but &quot;.(@{$ti[0]}).&quot; fields&quot;</td></tr>
<tr><td class="h"><a name="1751"></a>1751</td><td></td><td></td><td></td><td></td><td class="s">                if @ti &amp;&amp; @{$ti[0]} != $idx_fields;</td></tr>
<tr><td class="h"><a name="1752"></a>1752</td><td></td><td></td><td></td><td></td><td class="s">        my @out = map {</td></tr>
<tr><td class="h"><a name="1753"></a>1753</td><td></td><td></td><td></td><td></td><td class="s">            my %h; @h{@idx_names} = @{$_}[ @idx_values ]; \%h;</td></tr>
<tr><td class="h"><a name="1754"></a>1754</td><td></td><td></td><td></td><td></td><td class="s">        } @ti;</td></tr>
<tr><td class="h"><a name="1755"></a>1755</td><td></td><td></td><td></td><td></td><td class="s">        return $out[0] unless wantarray;</td></tr>
<tr><td class="h"><a name="1756"></a>1756</td><td></td><td></td><td></td><td></td><td class="s">        return @out;</td></tr>
<tr><td class="h"><a name="1757"></a>1757</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1758"></a>1758</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1759"></a>1759</td><td></td><td></td><td></td><td></td><td class="s">    sub data_sources {</td></tr>
<tr><td class="h"><a name="1760"></a>1760</td><td></td><td></td><td></td><td></td><td class="s">        my ($dbh, @other) = @_;</td></tr>
<tr><td class="h"><a name="1761"></a>1761</td><td></td><td></td><td></td><td></td><td class="s">        my $drh = $dbh-&gt;{Driver}; # XXX proxy issues?</td></tr>
<tr><td class="h"><a name="1762"></a>1762</td><td></td><td></td><td></td><td></td><td class="s">        return $drh-&gt;data_sources(@other);</td></tr>
<tr><td class="h"><a name="1763"></a>1763</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1764"></a>1764</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1765"></a>1765</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1766"></a>1766</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1767"></a>1767</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1768"></a>1768</td><td class="c3">1</td><td class="c3"><span title="Avg 300ns">300ns</span></td><td></td><td></td><td class="s">{   package                # hide from PAUSE</td></tr>
<tr><td class="h"><a name="1769"></a>1769</td><td></td><td></td><td></td><td></td><td class="s">        DBD::_::st;        # ====== STATEMENT ======</td></tr>
<tr><td class="h"><a name="1770"></a>1770</td><td class="c1">2</td><td class="c3"><span title="Avg 3&micro;s">6&micro;s</span></td><td></td><td></td><td class="s">    @DBD::_::st::ISA = qw(DBD::_::common);</td></tr>
<tr><td class="h"><a name="1771"></a>1771</td><td class="c0">3</td><td class="c0"><span title="Avg 521&micro;s">1.56ms</span></td><td class="c3">1</td><td class="c3">5&micro;s</td><td class="s">    use strict;<div class="calls"><div class="calls_out">    # spent     5&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="1772"></a>1772</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1773"></a>1773</td><td></td><td></td><td></td><td></td><td class="s">    sub bind_param { Carp::croak(&quot;Can't bind_param, not implement by driver&quot;) }</td></tr>
<tr><td class="h"><a name="1774"></a>1774</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1775"></a>1775</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="1776"></a>1776</td><td></td><td></td><td></td><td></td><td class="s"># ********************************************************</td></tr>
<tr><td class="h"><a name="1777"></a>1777</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="1778"></a>1778</td><td></td><td></td><td></td><td></td><td class="s">#        BEGIN ARRAY BINDING</td></tr>
<tr><td class="h"><a name="1779"></a>1779</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="1780"></a>1780</td><td></td><td></td><td></td><td></td><td class="s">#        Array binding support for drivers which don't support</td></tr>
<tr><td class="h"><a name="1781"></a>1781</td><td></td><td></td><td></td><td></td><td class="s">#        array binding, but have sufficient interfaces to fake it.</td></tr>
<tr><td class="h"><a name="1782"></a>1782</td><td></td><td></td><td></td><td></td><td class="s">#        NOTE: mixing scalars and arrayrefs requires using bind_param_array</td></tr>
<tr><td class="h"><a name="1783"></a>1783</td><td></td><td></td><td></td><td></td><td class="s">#        for *all* params...unless we modify bind_param for the default</td></tr>
<tr><td class="h"><a name="1784"></a>1784</td><td></td><td></td><td></td><td></td><td class="s">#        case...</td></tr>
<tr><td class="h"><a name="1785"></a>1785</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="1786"></a>1786</td><td></td><td></td><td></td><td></td><td class="s">#        2002-Apr-10        D. Arnold</td></tr>
<tr><td class="h"><a name="1787"></a>1787</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1788"></a>1788</td><td></td><td></td><td></td><td></td><td class="s">    sub bind_param_array {</td></tr>
<tr><td class="h"><a name="1789"></a>1789</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = shift;</td></tr>
<tr><td class="h"><a name="1790"></a>1790</td><td></td><td></td><td></td><td></td><td class="s">        my ($p_id, $value_array, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1791"></a>1791</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1792"></a>1792</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;Value for parameter $p_id must be a scalar or an arrayref, not a &quot;.ref($value_array))</td></tr>
<tr><td class="h"><a name="1793"></a>1793</td><td></td><td></td><td></td><td></td><td class="s">            if defined $value_array and ref $value_array and ref $value_array ne 'ARRAY';</td></tr>
<tr><td class="h"><a name="1794"></a>1794</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1795"></a>1795</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;Can't use named placeholder '$p_id' for non-driver supported bind_param_array&quot;)</td></tr>
<tr><td class="h"><a name="1796"></a>1796</td><td></td><td></td><td></td><td></td><td class="s">            unless DBI::looks_like_number($p_id); # because we rely on execute(@ary) here</td></tr>
<tr><td class="h"><a name="1797"></a>1797</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1798"></a>1798</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;Placeholder '$p_id' is out of range&quot;)</td></tr>
<tr><td class="h"><a name="1799"></a>1799</td><td></td><td></td><td></td><td></td><td class="s">            if $p_id &lt;= 0; # can't easily/reliably test for too big</td></tr>
<tr><td class="h"><a name="1800"></a>1800</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1801"></a>1801</td><td></td><td></td><td></td><td></td><td class="s">        # get/create arrayref to hold params</td></tr>
<tr><td class="h"><a name="1802"></a>1802</td><td></td><td></td><td></td><td></td><td class="s">        my $hash_of_arrays = $sth-&gt;{ParamArrays} ||= { };</td></tr>
<tr><td class="h"><a name="1803"></a>1803</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1804"></a>1804</td><td></td><td></td><td></td><td></td><td class="s">        # If the bind has attribs then we rely on the driver conforming to</td></tr>
<tr><td class="h"><a name="1805"></a>1805</td><td></td><td></td><td></td><td></td><td class="s">        # the DBI spec in that a single bind_param() call with those attribs</td></tr>
<tr><td class="h"><a name="1806"></a>1806</td><td></td><td></td><td></td><td></td><td class="s">        # makes them 'sticky' and apply to all later execute(@values) calls.</td></tr>
<tr><td class="h"><a name="1807"></a>1807</td><td></td><td></td><td></td><td></td><td class="s">        # Since we only call bind_param() if we're given attribs then</td></tr>
<tr><td class="h"><a name="1808"></a>1808</td><td></td><td></td><td></td><td></td><td class="s">        # applications using drivers that don't support bind_param can still</td></tr>
<tr><td class="h"><a name="1809"></a>1809</td><td></td><td></td><td></td><td></td><td class="s">        # use bind_param_array() so long as they don't pass any attribs.</td></tr>
<tr><td class="h"><a name="1810"></a>1810</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1811"></a>1811</td><td></td><td></td><td></td><td></td><td class="s">        $$hash_of_arrays{$p_id} = $value_array;</td></tr>
<tr><td class="h"><a name="1812"></a>1812</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;bind_param($p_id, undef, $attr)</td></tr>
<tr><td class="h"><a name="1813"></a>1813</td><td></td><td></td><td></td><td></td><td class="s">                if $attr;</td></tr>
<tr><td class="h"><a name="1814"></a>1814</td><td></td><td></td><td></td><td></td><td class="s">        1;</td></tr>
<tr><td class="h"><a name="1815"></a>1815</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1816"></a>1816</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1817"></a>1817</td><td></td><td></td><td></td><td></td><td class="s">    sub bind_param_inout_array {</td></tr>
<tr><td class="h"><a name="1818"></a>1818</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = shift;</td></tr>
<tr><td class="h"><a name="1819"></a>1819</td><td></td><td></td><td></td><td></td><td class="s">        # XXX not supported so we just call bind_param_array instead</td></tr>
<tr><td class="h"><a name="1820"></a>1820</td><td></td><td></td><td></td><td></td><td class="s">        # and then return an error</td></tr>
<tr><td class="h"><a name="1821"></a>1821</td><td></td><td></td><td></td><td></td><td class="s">        my ($p_num, $value_array, $attr) = @_;</td></tr>
<tr><td class="h"><a name="1822"></a>1822</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;bind_param_array($p_num, $value_array, $attr);</td></tr>
<tr><td class="h"><a name="1823"></a>1823</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;bind_param_inout_array not supported&quot;);</td></tr>
<tr><td class="h"><a name="1824"></a>1824</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1825"></a>1825</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1826"></a>1826</td><td></td><td></td><td></td><td></td><td class="s">    sub bind_columns {</td></tr>
<tr><td class="h"><a name="1827"></a>1827</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = shift;</td></tr>
<tr><td class="h"><a name="1828"></a>1828</td><td></td><td></td><td></td><td></td><td class="s">        my $fields = $sth-&gt;FETCH('NUM_OF_FIELDS') || 0;</td></tr>
<tr><td class="h"><a name="1829"></a>1829</td><td></td><td></td><td></td><td></td><td class="s">        if ($fields &lt;= 0 &amp;&amp; !$sth-&gt;{Active}) {</td></tr>
<tr><td class="h"><a name="1830"></a>1830</td><td></td><td></td><td></td><td></td><td class="s">            return $sth-&gt;set_err($DBI::stderr, &quot;Statement has no result columns to bind&quot;</td></tr>
<tr><td class="h"><a name="1831"></a>1831</td><td></td><td></td><td></td><td></td><td class="s">                    .&quot; (perhaps you need to successfully call execute first)&quot;);</td></tr>
<tr><td class="h"><a name="1832"></a>1832</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1833"></a>1833</td><td></td><td></td><td></td><td></td><td class="s">        # Backwards compatibility for old-style call with attribute hash</td></tr>
<tr><td class="h"><a name="1834"></a>1834</td><td></td><td></td><td></td><td></td><td class="s">        # ref as first arg. Skip arg if undef or a hash ref.</td></tr>
<tr><td class="h"><a name="1835"></a>1835</td><td></td><td></td><td></td><td></td><td class="s">        my $attr;</td></tr>
<tr><td class="h"><a name="1836"></a>1836</td><td></td><td></td><td></td><td></td><td class="s">        $attr = shift if !defined $_[0] or ref($_[0]) eq 'HASH';</td></tr>
<tr><td class="h"><a name="1837"></a>1837</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1838"></a>1838</td><td></td><td></td><td></td><td></td><td class="s">        my $idx = 0;</td></tr>
<tr><td class="h"><a name="1839"></a>1839</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;bind_col(++$idx, shift, $attr) or return</td></tr>
<tr><td class="h"><a name="1840"></a>1840</td><td></td><td></td><td></td><td></td><td class="s">            while (@_ and $idx &lt; $fields);</td></tr>
<tr><td class="h"><a name="1841"></a>1841</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1842"></a>1842</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;bind_columns called with &quot;.($idx+@_).&quot; values but $fields are needed&quot;)</td></tr>
<tr><td class="h"><a name="1843"></a>1843</td><td></td><td></td><td></td><td></td><td class="s">            if @_ or $idx != $fields;</td></tr>
<tr><td class="h"><a name="1844"></a>1844</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1845"></a>1845</td><td></td><td></td><td></td><td></td><td class="s">        return 1;</td></tr>
<tr><td class="h"><a name="1846"></a>1846</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1847"></a>1847</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1848"></a>1848</td><td></td><td></td><td></td><td></td><td class="s">    sub execute_array {</td></tr>
<tr><td class="h"><a name="1849"></a>1849</td><td></td><td></td><td></td><td></td><td class="s">        my $sth = shift;</td></tr>
<tr><td class="h"><a name="1850"></a>1850</td><td></td><td></td><td></td><td></td><td class="s">        my ($attr, @array_of_arrays) = @_;</td></tr>
<tr><td class="h"><a name="1851"></a>1851</td><td></td><td></td><td></td><td></td><td class="s">        my $NUM_OF_PARAMS = $sth-&gt;FETCH('NUM_OF_PARAMS'); # may be undef at this point</td></tr>
<tr><td class="h"><a name="1852"></a>1852</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1853"></a>1853</td><td></td><td></td><td></td><td></td><td class="s">        # get tuple status array or hash attribute</td></tr>
<tr><td class="h"><a name="1854"></a>1854</td><td></td><td></td><td></td><td></td><td class="s">        my $tuple_sts = $attr-&gt;{ArrayTupleStatus};</td></tr>
<tr><td class="h"><a name="1855"></a>1855</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;ArrayTupleStatus attribute must be an arrayref&quot;)</td></tr>
<tr><td class="h"><a name="1856"></a>1856</td><td></td><td></td><td></td><td></td><td class="s">                if $tuple_sts and ref $tuple_sts ne 'ARRAY';</td></tr>
<tr><td class="h"><a name="1857"></a>1857</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1858"></a>1858</td><td></td><td></td><td></td><td></td><td class="s">        # bind all supplied arrays</td></tr>
<tr><td class="h"><a name="1859"></a>1859</td><td></td><td></td><td></td><td></td><td class="s">        if (@array_of_arrays) {</td></tr>
<tr><td class="h"><a name="1860"></a>1860</td><td></td><td></td><td></td><td></td><td class="s">            $sth-&gt;{ParamArrays} = { };        # clear out old params</td></tr>
<tr><td class="h"><a name="1861"></a>1861</td><td></td><td></td><td></td><td></td><td class="s">            return $sth-&gt;set_err($DBI::stderr,</td></tr>
<tr><td class="h"><a name="1862"></a>1862</td><td></td><td></td><td></td><td></td><td class="s">                    @array_of_arrays.&quot; bind values supplied but $NUM_OF_PARAMS expected&quot;)</td></tr>
<tr><td class="h"><a name="1863"></a>1863</td><td></td><td></td><td></td><td></td><td class="s">                if defined ($NUM_OF_PARAMS) &amp;&amp; @array_of_arrays != $NUM_OF_PARAMS;</td></tr>
<tr><td class="h"><a name="1864"></a>1864</td><td></td><td></td><td></td><td></td><td class="s">            $sth-&gt;bind_param_array($_, $array_of_arrays[$_-1]) or return</td></tr>
<tr><td class="h"><a name="1865"></a>1865</td><td></td><td></td><td></td><td></td><td class="s">                foreach (1..@array_of_arrays);</td></tr>
<tr><td class="h"><a name="1866"></a>1866</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1867"></a>1867</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1868"></a>1868</td><td></td><td></td><td></td><td></td><td class="s">        my $fetch_tuple_sub;</td></tr>
<tr><td class="h"><a name="1869"></a>1869</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1870"></a>1870</td><td></td><td></td><td></td><td></td><td class="s">        if ($fetch_tuple_sub = $attr-&gt;{ArrayTupleFetch}) {        # fetch on demand</td></tr>
<tr><td class="h"><a name="1871"></a>1871</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1872"></a>1872</td><td></td><td></td><td></td><td></td><td class="s">            return $sth-&gt;set_err($DBI::stderr,</td></tr>
<tr><td class="h"><a name="1873"></a>1873</td><td></td><td></td><td></td><td></td><td class="s">                    &quot;Can't use both ArrayTupleFetch and explicit bind values&quot;)</td></tr>
<tr><td class="h"><a name="1874"></a>1874</td><td></td><td></td><td></td><td></td><td class="s">                if @array_of_arrays; # previous bind_param_array calls will simply be ignored</td></tr>
<tr><td class="h"><a name="1875"></a>1875</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1876"></a>1876</td><td></td><td></td><td></td><td></td><td class="s">            if (UNIVERSAL::isa($fetch_tuple_sub,'DBI::st')) {</td></tr>
<tr><td class="h"><a name="1877"></a>1877</td><td></td><td></td><td></td><td></td><td class="s">                my $fetch_sth = $fetch_tuple_sub;</td></tr>
<tr><td class="h"><a name="1878"></a>1878</td><td></td><td></td><td></td><td></td><td class="s">                return $sth-&gt;set_err($DBI::stderr,</td></tr>
<tr><td class="h"><a name="1879"></a>1879</td><td></td><td></td><td></td><td></td><td class="s">                        &quot;ArrayTupleFetch sth is not Active, need to execute() it first&quot;)</td></tr>
<tr><td class="h"><a name="1880"></a>1880</td><td></td><td></td><td></td><td></td><td class="s">                    unless $fetch_sth-&gt;{Active};</td></tr>
<tr><td class="h"><a name="1881"></a>1881</td><td></td><td></td><td></td><td></td><td class="s">                # check column count match to give more friendly message</td></tr>
<tr><td class="h"><a name="1882"></a>1882</td><td></td><td></td><td></td><td></td><td class="s">                my $NUM_OF_FIELDS = $fetch_sth-&gt;{NUM_OF_FIELDS};</td></tr>
<tr><td class="h"><a name="1883"></a>1883</td><td></td><td></td><td></td><td></td><td class="s">                return $sth-&gt;set_err($DBI::stderr,</td></tr>
<tr><td class="h"><a name="1884"></a>1884</td><td></td><td></td><td></td><td></td><td class="s">                        &quot;$NUM_OF_FIELDS columns from ArrayTupleFetch sth but $NUM_OF_PARAMS expected&quot;)</td></tr>
<tr><td class="h"><a name="1885"></a>1885</td><td></td><td></td><td></td><td></td><td class="s">                    if defined($NUM_OF_FIELDS) &amp;&amp; defined($NUM_OF_PARAMS)</td></tr>
<tr><td class="h"><a name="1886"></a>1886</td><td></td><td></td><td></td><td></td><td class="s">                    &amp;&amp; $NUM_OF_FIELDS != $NUM_OF_PARAMS;</td></tr>
<tr><td class="h"><a name="1887"></a>1887</td><td></td><td></td><td></td><td></td><td class="s">                $fetch_tuple_sub = sub { $fetch_sth-&gt;fetchrow_arrayref };</td></tr>
<tr><td class="h"><a name="1888"></a>1888</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1889"></a>1889</td><td></td><td></td><td></td><td></td><td class="s">            elsif (!UNIVERSAL::isa($fetch_tuple_sub,'CODE')) {</td></tr>
<tr><td class="h"><a name="1890"></a>1890</td><td></td><td></td><td></td><td></td><td class="s">                return $sth-&gt;set_err($DBI::stderr, &quot;ArrayTupleFetch '$fetch_tuple_sub' is not a code ref or statement handle&quot;);</td></tr>
<tr><td class="h"><a name="1891"></a>1891</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1892"></a>1892</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1893"></a>1893</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1894"></a>1894</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="1895"></a>1895</td><td></td><td></td><td></td><td></td><td class="s">            my $NUM_OF_PARAMS_given = keys %{ $sth-&gt;{ParamArrays} || {} };</td></tr>
<tr><td class="h"><a name="1896"></a>1896</td><td></td><td></td><td></td><td></td><td class="s">            return $sth-&gt;set_err($DBI::stderr,</td></tr>
<tr><td class="h"><a name="1897"></a>1897</td><td></td><td></td><td></td><td></td><td class="s">                    &quot;$NUM_OF_PARAMS_given bind values supplied but $NUM_OF_PARAMS expected&quot;)</td></tr>
<tr><td class="h"><a name="1898"></a>1898</td><td></td><td></td><td></td><td></td><td class="s">                if defined($NUM_OF_PARAMS) &amp;&amp; $NUM_OF_PARAMS != $NUM_OF_PARAMS_given;</td></tr>
<tr><td class="h"><a name="1899"></a>1899</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1900"></a>1900</td><td></td><td></td><td></td><td></td><td class="s">            # get the length of a bound array</td></tr>
<tr><td class="h"><a name="1901"></a>1901</td><td></td><td></td><td></td><td></td><td class="s">            my $maxlen;</td></tr>
<tr><td class="h"><a name="1902"></a>1902</td><td></td><td></td><td></td><td></td><td class="s">            my %hash_of_arrays = %{$sth-&gt;{ParamArrays}};</td></tr>
<tr><td class="h"><a name="1903"></a>1903</td><td></td><td></td><td></td><td></td><td class="s">            foreach (keys(%hash_of_arrays)) {</td></tr>
<tr><td class="h"><a name="1904"></a>1904</td><td></td><td></td><td></td><td></td><td class="s">                my $ary = $hash_of_arrays{$_};</td></tr>
<tr><td class="h"><a name="1905"></a>1905</td><td></td><td></td><td></td><td></td><td class="s">                next unless ref $ary eq 'ARRAY';</td></tr>
<tr><td class="h"><a name="1906"></a>1906</td><td></td><td></td><td></td><td></td><td class="s">                $maxlen = @$ary if !$maxlen || @$ary &gt; $maxlen;</td></tr>
<tr><td class="h"><a name="1907"></a>1907</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1908"></a>1908</td><td></td><td></td><td></td><td></td><td class="s">            # if there are no arrays then execute scalars once</td></tr>
<tr><td class="h"><a name="1909"></a>1909</td><td></td><td></td><td></td><td></td><td class="s">            $maxlen = 1 unless defined $maxlen;</td></tr>
<tr><td class="h"><a name="1910"></a>1910</td><td></td><td></td><td></td><td></td><td class="s">            my @bind_ids = 1..keys(%hash_of_arrays);</td></tr>
<tr><td class="h"><a name="1911"></a>1911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1912"></a>1912</td><td></td><td></td><td></td><td></td><td class="s">            my $tuple_idx = 0;</td></tr>
<tr><td class="h"><a name="1913"></a>1913</td><td></td><td></td><td></td><td></td><td class="s">            $fetch_tuple_sub = sub {</td></tr>
<tr><td class="h"><a name="1914"></a>1914</td><td></td><td></td><td></td><td></td><td class="s">                return if $tuple_idx &gt;= $maxlen;</td></tr>
<tr><td class="h"><a name="1915"></a>1915</td><td></td><td></td><td></td><td></td><td class="s">                my @tuple = map {</td></tr>
<tr><td class="h"><a name="1916"></a>1916</td><td></td><td></td><td></td><td></td><td class="s">                    my $a = $hash_of_arrays{$_};</td></tr>
<tr><td class="h"><a name="1917"></a>1917</td><td></td><td></td><td></td><td></td><td class="s">                    ref($a) ? $a-&gt;[$tuple_idx] : $a</td></tr>
<tr><td class="h"><a name="1918"></a>1918</td><td></td><td></td><td></td><td></td><td class="s">                } @bind_ids;</td></tr>
<tr><td class="h"><a name="1919"></a>1919</td><td></td><td></td><td></td><td></td><td class="s">                ++$tuple_idx;</td></tr>
<tr><td class="h"><a name="1920"></a>1920</td><td></td><td></td><td></td><td></td><td class="s">                return \@tuple;</td></tr>
<tr><td class="h"><a name="1921"></a>1921</td><td></td><td></td><td></td><td></td><td class="s">            };</td></tr>
<tr><td class="h"><a name="1922"></a>1922</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1923"></a>1923</td><td></td><td></td><td></td><td></td><td class="s">        # pass thru the callers scalar or list context</td></tr>
<tr><td class="h"><a name="1924"></a>1924</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;execute_for_fetch($fetch_tuple_sub, $tuple_sts);</td></tr>
<tr><td class="h"><a name="1925"></a>1925</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1926"></a>1926</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1927"></a>1927</td><td></td><td></td><td></td><td></td><td class="s">    sub execute_for_fetch {</td></tr>
<tr><td class="h"><a name="1928"></a>1928</td><td></td><td></td><td></td><td></td><td class="s">        my ($sth, $fetch_tuple_sub, $tuple_status) = @_;</td></tr>
<tr><td class="h"><a name="1929"></a>1929</td><td></td><td></td><td></td><td></td><td class="s">        # start with empty status array</td></tr>
<tr><td class="h"><a name="1930"></a>1930</td><td></td><td></td><td></td><td></td><td class="s">        ($tuple_status) ? @$tuple_status = () : $tuple_status = [];</td></tr>
<tr><td class="h"><a name="1931"></a>1931</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1932"></a>1932</td><td></td><td></td><td></td><td></td><td class="s">        my $rc_total = 0;</td></tr>
<tr><td class="h"><a name="1933"></a>1933</td><td></td><td></td><td></td><td></td><td class="s">        my $err_count;</td></tr>
<tr><td class="h"><a name="1934"></a>1934</td><td></td><td></td><td></td><td></td><td class="s">        while ( my $tuple = &amp;$fetch_tuple_sub() ) {</td></tr>
<tr><td class="h"><a name="1935"></a>1935</td><td></td><td></td><td></td><td></td><td class="s">            if ( my $rc = $sth-&gt;execute(@$tuple) ) {</td></tr>
<tr><td class="h"><a name="1936"></a>1936</td><td></td><td></td><td></td><td></td><td class="s">                push @$tuple_status, $rc;</td></tr>
<tr><td class="h"><a name="1937"></a>1937</td><td></td><td></td><td></td><td></td><td class="s">                $rc_total = ($rc &gt;= 0 &amp;&amp; $rc_total &gt;= 0) ? $rc_total + $rc : -1;</td></tr>
<tr><td class="h"><a name="1938"></a>1938</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1939"></a>1939</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="1940"></a>1940</td><td></td><td></td><td></td><td></td><td class="s">                $err_count++;</td></tr>
<tr><td class="h"><a name="1941"></a>1941</td><td></td><td></td><td></td><td></td><td class="s">                push @$tuple_status, [ $sth-&gt;err, $sth-&gt;errstr, $sth-&gt;state ];</td></tr>
<tr><td class="h"><a name="1942"></a>1942</td><td></td><td></td><td></td><td></td><td class="s">                # XXX drivers implementing execute_for_fetch could opt to &quot;last;&quot; here</td></tr>
<tr><td class="h"><a name="1943"></a>1943</td><td></td><td></td><td></td><td></td><td class="s">                # if they know the error code means no further executes will work.</td></tr>
<tr><td class="h"><a name="1944"></a>1944</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1945"></a>1945</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1946"></a>1946</td><td></td><td></td><td></td><td></td><td class="s">        my $tuples = @$tuple_status;</td></tr>
<tr><td class="h"><a name="1947"></a>1947</td><td></td><td></td><td></td><td></td><td class="s">        return $sth-&gt;set_err($DBI::stderr, &quot;executing $tuples generated $err_count errors&quot;)</td></tr>
<tr><td class="h"><a name="1948"></a>1948</td><td></td><td></td><td></td><td></td><td class="s">            if $err_count;</td></tr>
<tr><td class="h"><a name="1949"></a>1949</td><td></td><td></td><td></td><td></td><td class="s">        $tuples ||= &quot;0E0&quot;;</td></tr>
<tr><td class="h"><a name="1950"></a>1950</td><td></td><td></td><td></td><td></td><td class="s">        return $tuples unless wantarray;</td></tr>
<tr><td class="h"><a name="1951"></a>1951</td><td></td><td></td><td></td><td></td><td class="s">        return ($tuples, $rc_total);</td></tr>
<tr><td class="h"><a name="1952"></a>1952</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1953"></a>1953</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1954"></a>1954</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1955"></a>1955</td><td></td><td></td><td></td><td></td><td class="s">    sub fetchall_arrayref {        # ALSO IN Driver.xst</td></tr>
<tr><td class="h"><a name="1956"></a>1956</td><td></td><td></td><td></td><td></td><td class="s">        my ($sth, $slice, $max_rows) = @_;</td></tr>
<tr><td class="h"><a name="1957"></a>1957</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1958"></a>1958</td><td></td><td></td><td></td><td></td><td class="s">        # when batch fetching with $max_rows were very likely to try to</td></tr>
<tr><td class="h"><a name="1959"></a>1959</td><td></td><td></td><td></td><td></td><td class="s">        # fetch the 'next batch' after the previous batch returned</td></tr>
<tr><td class="h"><a name="1960"></a>1960</td><td></td><td></td><td></td><td></td><td class="s">        # &lt;=$max_rows. So don't treat that as an error.</td></tr>
<tr><td class="h"><a name="1961"></a>1961</td><td></td><td></td><td></td><td></td><td class="s">        return undef if $max_rows and not $sth-&gt;FETCH('Active');</td></tr>
<tr><td class="h"><a name="1962"></a>1962</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1963"></a>1963</td><td></td><td></td><td></td><td></td><td class="s">        my $mode = ref($slice) || 'ARRAY';</td></tr>
<tr><td class="h"><a name="1964"></a>1964</td><td></td><td></td><td></td><td></td><td class="s">        my @rows;</td></tr>
<tr><td class="h"><a name="1965"></a>1965</td><td></td><td></td><td></td><td></td><td class="s">        my $row;</td></tr>
<tr><td class="h"><a name="1966"></a>1966</td><td></td><td></td><td></td><td></td><td class="s">        if ($mode eq 'ARRAY') {</td></tr>
<tr><td class="h"><a name="1967"></a>1967</td><td></td><td></td><td></td><td></td><td class="s">            # we copy the array here because fetch (currently) always</td></tr>
<tr><td class="h"><a name="1968"></a>1968</td><td></td><td></td><td></td><td></td><td class="s">            # returns the same array ref. XXX</td></tr>
<tr><td class="h"><a name="1969"></a>1969</td><td></td><td></td><td></td><td></td><td class="s">            if ($slice &amp;&amp; @$slice) {</td></tr>
<tr><td class="h"><a name="1970"></a>1970</td><td></td><td></td><td></td><td></td><td class="s">                $max_rows = -1 unless defined $max_rows;</td></tr>
<tr><td class="h"><a name="1971"></a>1971</td><td></td><td></td><td></td><td></td><td class="s">                push @rows, [ @{$row}[ @$slice] ]</td></tr>
<tr><td class="h"><a name="1972"></a>1972</td><td></td><td></td><td></td><td></td><td class="s">                    while($max_rows-- and $row = $sth-&gt;fetch);</td></tr>
<tr><td class="h"><a name="1973"></a>1973</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1974"></a>1974</td><td></td><td></td><td></td><td></td><td class="s">            elsif (defined $max_rows) {</td></tr>
<tr><td class="h"><a name="1975"></a>1975</td><td></td><td></td><td></td><td></td><td class="s">                push @rows, [ @$row ]</td></tr>
<tr><td class="h"><a name="1976"></a>1976</td><td></td><td></td><td></td><td></td><td class="s">                    while($max_rows-- and $row = $sth-&gt;fetch);</td></tr>
<tr><td class="h"><a name="1977"></a>1977</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1978"></a>1978</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="1979"></a>1979</td><td></td><td></td><td></td><td></td><td class="s">                push @rows, [ @$row ] while($row = $sth-&gt;fetch);</td></tr>
<tr><td class="h"><a name="1980"></a>1980</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1981"></a>1981</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="1982"></a>1982</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($mode eq 'HASH') {</td></tr>
<tr><td class="h"><a name="1983"></a>1983</td><td></td><td></td><td></td><td></td><td class="s">            $max_rows = -1 unless defined $max_rows;</td></tr>
<tr><td class="h"><a name="1984"></a>1984</td><td></td><td></td><td></td><td></td><td class="s">            if (keys %$slice) {</td></tr>
<tr><td class="h"><a name="1985"></a>1985</td><td></td><td></td><td></td><td></td><td class="s">                my @o_keys = keys %$slice;</td></tr>
<tr><td class="h"><a name="1986"></a>1986</td><td></td><td></td><td></td><td></td><td class="s">                my @i_keys = map { lc } keys %$slice;</td></tr>
<tr><td class="h"><a name="1987"></a>1987</td><td></td><td></td><td></td><td></td><td class="s">                # XXX this could be made faster by pre-binding a local hash</td></tr>
<tr><td class="h"><a name="1988"></a>1988</td><td></td><td></td><td></td><td></td><td class="s">                # using bind_columns and then copying it per row</td></tr>
<tr><td class="h"><a name="1989"></a>1989</td><td></td><td></td><td></td><td></td><td class="s">                while ($max_rows-- and $row = $sth-&gt;fetchrow_hashref('NAME_lc')) {</td></tr>
<tr><td class="h"><a name="1990"></a>1990</td><td></td><td></td><td></td><td></td><td class="s">                    my %hash;</td></tr>
<tr><td class="h"><a name="1991"></a>1991</td><td></td><td></td><td></td><td></td><td class="s">                    @hash{@o_keys} = @{$row}{@i_keys};</td></tr>
<tr><td class="h"><a name="1992"></a>1992</td><td></td><td></td><td></td><td></td><td class="s">                    push @rows, \%hash;</td></tr>
<tr><td class="h"><a name="1993"></a>1993</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="1994"></a>1994</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="1995"></a>1995</td><td></td><td></td><td></td><td></td><td class="s">            else {</td></tr>
<tr><td class="h"><a name="1996"></a>1996</td><td></td><td></td><td></td><td></td><td class="s">                # XXX assumes new ref each fetchhash</td></tr>
<tr><td class="h"><a name="1997"></a>1997</td><td></td><td></td><td></td><td></td><td class="s">                push @rows, $row</td></tr>
<tr><td class="h"><a name="1998"></a>1998</td><td></td><td></td><td></td><td></td><td class="s">                    while ($max_rows-- and $row = $sth-&gt;fetchrow_hashref());</td></tr>
<tr><td class="h"><a name="1999"></a>1999</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="2000"></a>2000</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="2001"></a>2001</td><td></td><td></td><td></td><td></td><td class="s">        else { Carp::croak(&quot;fetchall_arrayref($mode) invalid&quot;) }</td></tr>
<tr><td class="h"><a name="2002"></a>2002</td><td></td><td></td><td></td><td></td><td class="s">        return \@rows;</td></tr>
<tr><td class="h"><a name="2003"></a>2003</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2004"></a>2004</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2005"></a>2005</td><td></td><td></td><td></td><td></td><td class="s">    sub fetchall_hashref {</td></tr>
<tr><td class="h"><a name="2006"></a>2006</td><td></td><td></td><td></td><td></td><td class="s">        my ($sth, $key_field) = @_;</td></tr>
<tr><td class="h"><a name="2007"></a>2007</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2008"></a>2008</td><td></td><td></td><td></td><td></td><td class="s">        my $hash_key_name = $sth-&gt;{FetchHashKeyName} || 'NAME';</td></tr>
<tr><td class="h"><a name="2009"></a>2009</td><td></td><td></td><td></td><td></td><td class="s">        my $names_hash = $sth-&gt;FETCH(&quot;${hash_key_name}_hash&quot;);</td></tr>
<tr><td class="h"><a name="2010"></a>2010</td><td></td><td></td><td></td><td></td><td class="s">        my @key_fields = (ref $key_field) ? @$key_field : ($key_field);</td></tr>
<tr><td class="h"><a name="2011"></a>2011</td><td></td><td></td><td></td><td></td><td class="s">        my @key_indexes;</td></tr>
<tr><td class="h"><a name="2012"></a>2012</td><td></td><td></td><td></td><td></td><td class="s">        my $num_of_fields = $sth-&gt;FETCH('NUM_OF_FIELDS');</td></tr>
<tr><td class="h"><a name="2013"></a>2013</td><td></td><td></td><td></td><td></td><td class="s">        foreach (@key_fields) {</td></tr>
<tr><td class="h"><a name="2014"></a>2014</td><td></td><td></td><td></td><td></td><td class="s">           my $index = $names_hash-&gt;{$_};  # perl index not column</td></tr>
<tr><td class="h"><a name="2015"></a>2015</td><td></td><td></td><td></td><td></td><td class="s">           $index = $_ - 1 if !defined $index &amp;&amp; DBI::looks_like_number($_) &amp;&amp; $_&gt;=1 &amp;&amp; $_ &lt;= $num_of_fields;</td></tr>
<tr><td class="h"><a name="2016"></a>2016</td><td></td><td></td><td></td><td></td><td class="s">           return $sth-&gt;set_err($DBI::stderr, &quot;Field '$_' does not exist (not one of @{[keys %$names_hash]})&quot;)</td></tr>
<tr><td class="h"><a name="2017"></a>2017</td><td></td><td></td><td></td><td></td><td class="s">                unless defined $index;</td></tr>
<tr><td class="h"><a name="2018"></a>2018</td><td></td><td></td><td></td><td></td><td class="s">           push @key_indexes, $index;</td></tr>
<tr><td class="h"><a name="2019"></a>2019</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="2020"></a>2020</td><td></td><td></td><td></td><td></td><td class="s">        my $rows = {};</td></tr>
<tr><td class="h"><a name="2021"></a>2021</td><td></td><td></td><td></td><td></td><td class="s">        my $NAME = $sth-&gt;FETCH($hash_key_name);</td></tr>
<tr><td class="h"><a name="2022"></a>2022</td><td></td><td></td><td></td><td></td><td class="s">        my @row = (undef) x $num_of_fields;</td></tr>
<tr><td class="h"><a name="2023"></a>2023</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;bind_columns(\(@row));</td></tr>
<tr><td class="h"><a name="2024"></a>2024</td><td></td><td></td><td></td><td></td><td class="s">        while ($sth-&gt;fetch) {</td></tr>
<tr><td class="h"><a name="2025"></a>2025</td><td></td><td></td><td></td><td></td><td class="s">            my $ref = $rows;</td></tr>
<tr><td class="h"><a name="2026"></a>2026</td><td></td><td></td><td></td><td></td><td class="s">            $ref = $ref-&gt;{$row[$_]} ||= {} for @key_indexes;</td></tr>
<tr><td class="h"><a name="2027"></a>2027</td><td></td><td></td><td></td><td></td><td class="s">            @{$ref}{@$NAME} = @row;</td></tr>
<tr><td class="h"><a name="2028"></a>2028</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="2029"></a>2029</td><td></td><td></td><td></td><td></td><td class="s">        return $rows;</td></tr>
<tr><td class="h"><a name="2030"></a>2030</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2031"></a>2031</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2032"></a>2032</td><td></td><td></td><td></td><td></td><td class="s">    *dump_results = \&amp;DBI::dump_results;</td></tr>
<tr><td class="h"><a name="2033"></a>2033</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2034"></a>2034</td><td></td><td></td><td></td><td></td><td class="s">    sub blob_copy_to_file {        # returns length or undef on error</td></tr>
<tr><td class="h"><a name="2035"></a>2035</td><td></td><td></td><td></td><td></td><td class="s">        my($self, $field, $filename_or_handleref, $blocksize) = @_;</td></tr>
<tr><td class="h"><a name="2036"></a>2036</td><td></td><td></td><td></td><td></td><td class="s">        my $fh = $filename_or_handleref;</td></tr>
<tr><td class="h"><a name="2037"></a>2037</td><td></td><td></td><td></td><td></td><td class="s">        my($len, $buf) = (0, &quot;&quot;);</td></tr>
<tr><td class="h"><a name="2038"></a>2038</td><td></td><td></td><td></td><td></td><td class="s">        $blocksize ||= 512;        # not too ambitious</td></tr>
<tr><td class="h"><a name="2039"></a>2039</td><td></td><td></td><td></td><td></td><td class="s">        local(*FH);</td></tr>
<tr><td class="h"><a name="2040"></a>2040</td><td></td><td></td><td></td><td></td><td class="s">        unless(ref $fh) {</td></tr>
<tr><td class="h"><a name="2041"></a>2041</td><td></td><td></td><td></td><td></td><td class="s">            open(FH, &quot;&gt;$fh&quot;) || return undef;</td></tr>
<tr><td class="h"><a name="2042"></a>2042</td><td></td><td></td><td></td><td></td><td class="s">            $fh = \*FH;</td></tr>
<tr><td class="h"><a name="2043"></a>2043</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="2044"></a>2044</td><td></td><td></td><td></td><td></td><td class="s">        while(defined($self-&gt;blob_read($field, $len, $blocksize, \$buf))) {</td></tr>
<tr><td class="h"><a name="2045"></a>2045</td><td></td><td></td><td></td><td></td><td class="s">            print $fh $buf;</td></tr>
<tr><td class="h"><a name="2046"></a>2046</td><td></td><td></td><td></td><td></td><td class="s">            $len += length $buf;</td></tr>
<tr><td class="h"><a name="2047"></a>2047</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="2048"></a>2048</td><td></td><td></td><td></td><td></td><td class="s">        close(FH);</td></tr>
<tr><td class="h"><a name="2049"></a>2049</td><td></td><td></td><td></td><td></td><td class="s">        $len;</td></tr>
<tr><td class="h"><a name="2050"></a>2050</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2051"></a>2051</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2052"></a>2052</td><td></td><td></td><td></td><td></td><td class="s">    sub more_results {</td></tr>
<tr><td class="h"><a name="2053"></a>2053</td><td></td><td></td><td></td><td></td><td class="s">        shift-&gt;{syb_more_results};        # handy grandfathering</td></tr>
<tr><td class="h"><a name="2054"></a>2054</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2055"></a>2055</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2056"></a>2056</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2057"></a>2057</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2058"></a>2058</td><td class="c0">4</td><td class="c3"><span title="Avg 600ns">2&micro;s</span></td><td></td><td></td><td class="s">unless ($DBI::PurePerl) {   # See install_driver</td></tr>
<tr><td class="h"><a name="2059"></a>2059</td><td class="c3">1</td><td class="c3"><span title="Avg 12&micro;s">12&micro;s</span></td><td></td><td></td><td class="s">    { @DBD::_mem::dr::ISA = qw(DBD::_mem::common);        }</td></tr>
<tr><td class="h"><a name="2060"></a>2060</td><td class="c3">1</td><td class="c3"><span title="Avg 5&micro;s">5&micro;s</span></td><td></td><td></td><td class="s">    { @DBD::_mem::db::ISA = qw(DBD::_mem::common);        }</td></tr>
<tr><td class="h"><a name="2061"></a>2061</td><td class="c3">1</td><td class="c3"><span title="Avg 4&micro;s">4&micro;s</span></td><td></td><td></td><td class="s">    { @DBD::_mem::st::ISA = qw(DBD::_mem::common);        }</td></tr>
<tr><td class="h"><a name="2062"></a>2062</td><td></td><td></td><td></td><td></td><td class="s">    # DBD::_mem::common::DESTROY is implemented in DBI.xs</td></tr>
<tr><td class="h"><a name="2063"></a>2063</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2064"></a>2064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2065"></a>2065</td><td class="c3">1</td><td class="c0"><span title="Avg 118&micro;s">118&micro;s</span></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h"><a name="2066"></a>2066</td><td></td><td></td><td></td><td></td><td class="s">__END__</td></tr>
<tr><td class="h"><a name="2067"></a>2067</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2068"></a>2068</td><td></td><td></td><td></td><td></td><td class="s">=head1 DESCRIPTION</td></tr>
<tr><td class="h"><a name="2069"></a>2069</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2070"></a>2070</td><td></td><td></td><td></td><td></td><td class="s">The DBI is a database access module for the Perl programming language.  It defines</td></tr>
<tr><td class="h"><a name="2071"></a>2071</td><td></td><td></td><td></td><td></td><td class="s">a set of methods, variables, and conventions that provide a consistent</td></tr>
<tr><td class="h"><a name="2072"></a>2072</td><td></td><td></td><td></td><td></td><td class="s">database interface, independent of the actual database being used.</td></tr>
<tr><td class="h"><a name="2073"></a>2073</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2074"></a>2074</td><td></td><td></td><td></td><td></td><td class="s">It is important to remember that the DBI is just an interface.</td></tr>
<tr><td class="h"><a name="2075"></a>2075</td><td></td><td></td><td></td><td></td><td class="s">The DBI is a layer</td></tr>
<tr><td class="h"><a name="2076"></a>2076</td><td></td><td></td><td></td><td></td><td class="s">of &quot;glue&quot; between an application and one or more database I&lt;driver&gt;</td></tr>
<tr><td class="h"><a name="2077"></a>2077</td><td></td><td></td><td></td><td></td><td class="s">modules.  It is the driver modules which do most of the real work. The DBI</td></tr>
<tr><td class="h"><a name="2078"></a>2078</td><td></td><td></td><td></td><td></td><td class="s">provides a standard interface and framework for the drivers to operate</td></tr>
<tr><td class="h"><a name="2079"></a>2079</td><td></td><td></td><td></td><td></td><td class="s">within.</td></tr>
<tr><td class="h"><a name="2080"></a>2080</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2081"></a>2081</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2082"></a>2082</td><td></td><td></td><td></td><td></td><td class="s">=head2 Architecture of a DBI Application</td></tr>
<tr><td class="h"><a name="2083"></a>2083</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2084"></a>2084</td><td></td><td></td><td></td><td></td><td class="s">             |&lt;- Scope of DBI -&gt;|</td></tr>
<tr><td class="h"><a name="2085"></a>2085</td><td></td><td></td><td></td><td></td><td class="s">                  .-.   .--------------.   .-------------.</td></tr>
<tr><td class="h"><a name="2086"></a>2086</td><td></td><td></td><td></td><td></td><td class="s">  .-------.       | |---| XYZ Driver   |---| XYZ Engine  |</td></tr>
<tr><td class="h"><a name="2087"></a>2087</td><td></td><td></td><td></td><td></td><td class="s">  | Perl  |       | |   `--------------'   `-------------'</td></tr>
<tr><td class="h"><a name="2088"></a>2088</td><td></td><td></td><td></td><td></td><td class="s">  | script|  |A|  |D|   .--------------.   .-------------.</td></tr>
<tr><td class="h"><a name="2089"></a>2089</td><td></td><td></td><td></td><td></td><td class="s">  | using |--|P|--|B|---|Oracle Driver |---|Oracle Engine|</td></tr>
<tr><td class="h"><a name="2090"></a>2090</td><td></td><td></td><td></td><td></td><td class="s">  | DBI   |  |I|  |I|   `--------------'   `-------------'</td></tr>
<tr><td class="h"><a name="2091"></a>2091</td><td></td><td></td><td></td><td></td><td class="s">  | API   |       | |...</td></tr>
<tr><td class="h"><a name="2092"></a>2092</td><td></td><td></td><td></td><td></td><td class="s">  |methods|       | |... Other drivers</td></tr>
<tr><td class="h"><a name="2093"></a>2093</td><td></td><td></td><td></td><td></td><td class="s">  `-------'       | |...</td></tr>
<tr><td class="h"><a name="2094"></a>2094</td><td></td><td></td><td></td><td></td><td class="s">                  `-'</td></tr>
<tr><td class="h"><a name="2095"></a>2095</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2096"></a>2096</td><td></td><td></td><td></td><td></td><td class="s">The API, or Application Programming Interface, defines the</td></tr>
<tr><td class="h"><a name="2097"></a>2097</td><td></td><td></td><td></td><td></td><td class="s">call interface and variables for Perl scripts to use. The API</td></tr>
<tr><td class="h"><a name="2098"></a>2098</td><td></td><td></td><td></td><td></td><td class="s">is implemented by the Perl DBI extension.</td></tr>
<tr><td class="h"><a name="2099"></a>2099</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2100"></a>2100</td><td></td><td></td><td></td><td></td><td class="s">The DBI &quot;dispatches&quot; the method calls to the appropriate driver for</td></tr>
<tr><td class="h"><a name="2101"></a>2101</td><td></td><td></td><td></td><td></td><td class="s">actual execution.  The DBI is also responsible for the dynamic loading</td></tr>
<tr><td class="h"><a name="2102"></a>2102</td><td></td><td></td><td></td><td></td><td class="s">of drivers, error checking and handling, providing default</td></tr>
<tr><td class="h"><a name="2103"></a>2103</td><td></td><td></td><td></td><td></td><td class="s">implementations for methods, and many other non-database specific duties.</td></tr>
<tr><td class="h"><a name="2104"></a>2104</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2105"></a>2105</td><td></td><td></td><td></td><td></td><td class="s">Each driver</td></tr>
<tr><td class="h"><a name="2106"></a>2106</td><td></td><td></td><td></td><td></td><td class="s">contains implementations of the DBI methods using the</td></tr>
<tr><td class="h"><a name="2107"></a>2107</td><td></td><td></td><td></td><td></td><td class="s">private interface functions of the corresponding database engine.  Only authors</td></tr>
<tr><td class="h"><a name="2108"></a>2108</td><td></td><td></td><td></td><td></td><td class="s">of sophisticated/multi-database applications or generic library</td></tr>
<tr><td class="h"><a name="2109"></a>2109</td><td></td><td></td><td></td><td></td><td class="s">functions need be concerned with drivers.</td></tr>
<tr><td class="h"><a name="2110"></a>2110</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2111"></a>2111</td><td></td><td></td><td></td><td></td><td class="s">=head2 Notation and Conventions</td></tr>
<tr><td class="h"><a name="2112"></a>2112</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2113"></a>2113</td><td></td><td></td><td></td><td></td><td class="s">The following conventions are used in this document:</td></tr>
<tr><td class="h"><a name="2114"></a>2114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2115"></a>2115</td><td></td><td></td><td></td><td></td><td class="s">  $dbh    Database handle object</td></tr>
<tr><td class="h"><a name="2116"></a>2116</td><td></td><td></td><td></td><td></td><td class="s">  $sth    Statement handle object</td></tr>
<tr><td class="h"><a name="2117"></a>2117</td><td></td><td></td><td></td><td></td><td class="s">  $drh    Driver handle object (rarely seen or used in applications)</td></tr>
<tr><td class="h"><a name="2118"></a>2118</td><td></td><td></td><td></td><td></td><td class="s">  $h      Any of the handle types above ($dbh, $sth, or $drh)</td></tr>
<tr><td class="h"><a name="2119"></a>2119</td><td></td><td></td><td></td><td></td><td class="s">  $rc     General Return Code  (boolean: true=ok, false=error)</td></tr>
<tr><td class="h"><a name="2120"></a>2120</td><td></td><td></td><td></td><td></td><td class="s">  $rv     General Return Value (typically an integer)</td></tr>
<tr><td class="h"><a name="2121"></a>2121</td><td></td><td></td><td></td><td></td><td class="s">  @ary    List of values returned from the database, typically a row of data</td></tr>
<tr><td class="h"><a name="2122"></a>2122</td><td></td><td></td><td></td><td></td><td class="s">  $rows   Number of rows processed (if available, else -1)</td></tr>
<tr><td class="h"><a name="2123"></a>2123</td><td></td><td></td><td></td><td></td><td class="s">  $fh     A filehandle</td></tr>
<tr><td class="h"><a name="2124"></a>2124</td><td></td><td></td><td></td><td></td><td class="s">  undef   NULL values are represented by undefined values in Perl</td></tr>
<tr><td class="h"><a name="2125"></a>2125</td><td></td><td></td><td></td><td></td><td class="s">  \%attr  Reference to a hash of attribute values passed to methods</td></tr>
<tr><td class="h"><a name="2126"></a>2126</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2127"></a>2127</td><td></td><td></td><td></td><td></td><td class="s">Note that Perl will automatically destroy database and statement handle objects</td></tr>
<tr><td class="h"><a name="2128"></a>2128</td><td></td><td></td><td></td><td></td><td class="s">if all references to them are deleted.</td></tr>
<tr><td class="h"><a name="2129"></a>2129</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2130"></a>2130</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2131"></a>2131</td><td></td><td></td><td></td><td></td><td class="s">=head2 Outline Usage</td></tr>
<tr><td class="h"><a name="2132"></a>2132</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2133"></a>2133</td><td></td><td></td><td></td><td></td><td class="s">To use DBI,</td></tr>
<tr><td class="h"><a name="2134"></a>2134</td><td></td><td></td><td></td><td></td><td class="s">first you need to load the DBI module:</td></tr>
<tr><td class="h"><a name="2135"></a>2135</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2136"></a>2136</td><td></td><td></td><td></td><td></td><td class="s">  use DBI;</td></tr>
<tr><td class="h"><a name="2137"></a>2137</td><td></td><td></td><td></td><td></td><td class="s">  use strict;</td></tr>
<tr><td class="h"><a name="2138"></a>2138</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2139"></a>2139</td><td></td><td></td><td></td><td></td><td class="s">(The C&lt;use strict;&gt; isn't required but is strongly recommended.)</td></tr>
<tr><td class="h"><a name="2140"></a>2140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2141"></a>2141</td><td></td><td></td><td></td><td></td><td class="s">Then you need to L&lt;/connect&gt; to your data source and get a I&lt;handle&gt; for that</td></tr>
<tr><td class="h"><a name="2142"></a>2142</td><td></td><td></td><td></td><td></td><td class="s">connection:</td></tr>
<tr><td class="h"><a name="2143"></a>2143</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2144"></a>2144</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($dsn, $user, $password,</td></tr>
<tr><td class="h"><a name="2145"></a>2145</td><td></td><td></td><td></td><td></td><td class="s">                      { RaiseError =&gt; 1, AutoCommit =&gt; 0 });</td></tr>
<tr><td class="h"><a name="2146"></a>2146</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2147"></a>2147</td><td></td><td></td><td></td><td></td><td class="s">Since connecting can be expensive, you generally just connect at the</td></tr>
<tr><td class="h"><a name="2148"></a>2148</td><td></td><td></td><td></td><td></td><td class="s">start of your program and disconnect at the end.</td></tr>
<tr><td class="h"><a name="2149"></a>2149</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2150"></a>2150</td><td></td><td></td><td></td><td></td><td class="s">Explicitly defining the required C&lt;AutoCommit&gt; behaviour is strongly</td></tr>
<tr><td class="h"><a name="2151"></a>2151</td><td></td><td></td><td></td><td></td><td class="s">recommended and may become mandatory in a later version.  This</td></tr>
<tr><td class="h"><a name="2152"></a>2152</td><td></td><td></td><td></td><td></td><td class="s">determines whether changes are automatically committed to the</td></tr>
<tr><td class="h"><a name="2153"></a>2153</td><td></td><td></td><td></td><td></td><td class="s">database when executed, or need to be explicitly committed later.</td></tr>
<tr><td class="h"><a name="2154"></a>2154</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2155"></a>2155</td><td></td><td></td><td></td><td></td><td class="s">The DBI allows an application to &quot;prepare&quot; statements for later</td></tr>
<tr><td class="h"><a name="2156"></a>2156</td><td></td><td></td><td></td><td></td><td class="s">execution.  A prepared statement is identified by a statement handle</td></tr>
<tr><td class="h"><a name="2157"></a>2157</td><td></td><td></td><td></td><td></td><td class="s">held in a Perl variable.</td></tr>
<tr><td class="h"><a name="2158"></a>2158</td><td></td><td></td><td></td><td></td><td class="s">We'll call the Perl variable C&lt;$sth&gt; in our examples.</td></tr>
<tr><td class="h"><a name="2159"></a>2159</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2160"></a>2160</td><td></td><td></td><td></td><td></td><td class="s">The typical method call sequence for a C&lt;SELECT&gt; statement is:</td></tr>
<tr><td class="h"><a name="2161"></a>2161</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2162"></a>2162</td><td></td><td></td><td></td><td></td><td class="s">  prepare,</td></tr>
<tr><td class="h"><a name="2163"></a>2163</td><td></td><td></td><td></td><td></td><td class="s">    execute, fetch, fetch, ...</td></tr>
<tr><td class="h"><a name="2164"></a>2164</td><td></td><td></td><td></td><td></td><td class="s">    execute, fetch, fetch, ...</td></tr>
<tr><td class="h"><a name="2165"></a>2165</td><td></td><td></td><td></td><td></td><td class="s">    execute, fetch, fetch, ...</td></tr>
<tr><td class="h"><a name="2166"></a>2166</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2167"></a>2167</td><td></td><td></td><td></td><td></td><td class="s">for example:</td></tr>
<tr><td class="h"><a name="2168"></a>2168</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2169"></a>2169</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;SELECT foo, bar FROM table WHERE baz=?&quot;);</td></tr>
<tr><td class="h"><a name="2170"></a>2170</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2171"></a>2171</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute( $baz );</td></tr>
<tr><td class="h"><a name="2172"></a>2172</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2173"></a>2173</td><td></td><td></td><td></td><td></td><td class="s">  while ( @row = $sth-&gt;fetchrow_array ) {</td></tr>
<tr><td class="h"><a name="2174"></a>2174</td><td></td><td></td><td></td><td></td><td class="s">    print &quot;@row\n&quot;;</td></tr>
<tr><td class="h"><a name="2175"></a>2175</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2176"></a>2176</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2177"></a>2177</td><td></td><td></td><td></td><td></td><td class="s">The typical method call sequence for a I&lt;non&gt;-C&lt;SELECT&gt; statement is:</td></tr>
<tr><td class="h"><a name="2178"></a>2178</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2179"></a>2179</td><td></td><td></td><td></td><td></td><td class="s">  prepare,</td></tr>
<tr><td class="h"><a name="2180"></a>2180</td><td></td><td></td><td></td><td></td><td class="s">    execute,</td></tr>
<tr><td class="h"><a name="2181"></a>2181</td><td></td><td></td><td></td><td></td><td class="s">    execute,</td></tr>
<tr><td class="h"><a name="2182"></a>2182</td><td></td><td></td><td></td><td></td><td class="s">    execute.</td></tr>
<tr><td class="h"><a name="2183"></a>2183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2184"></a>2184</td><td></td><td></td><td></td><td></td><td class="s">for example:</td></tr>
<tr><td class="h"><a name="2185"></a>2185</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2186"></a>2186</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;INSERT INTO table(foo,bar,baz) VALUES (?,?,?)&quot;);</td></tr>
<tr><td class="h"><a name="2187"></a>2187</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2188"></a>2188</td><td></td><td></td><td></td><td></td><td class="s">  while(&lt;CSV&gt;) {</td></tr>
<tr><td class="h"><a name="2189"></a>2189</td><td></td><td></td><td></td><td></td><td class="s">    chomp;</td></tr>
<tr><td class="h"><a name="2190"></a>2190</td><td></td><td></td><td></td><td></td><td class="s">    my ($foo,$bar,$baz) = split /,/;</td></tr>
<tr><td class="h"><a name="2191"></a>2191</td><td></td><td></td><td></td><td></td><td class="s">        $sth-&gt;execute( $foo, $bar, $baz );</td></tr>
<tr><td class="h"><a name="2192"></a>2192</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2193"></a>2193</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2194"></a>2194</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;do()&gt; method can be used for non repeated I&lt;non&gt;-C&lt;SELECT&gt; statement</td></tr>
<tr><td class="h"><a name="2195"></a>2195</td><td></td><td></td><td></td><td></td><td class="s">(or with drivers that don't support placeholders):</td></tr>
<tr><td class="h"><a name="2196"></a>2196</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2197"></a>2197</td><td></td><td></td><td></td><td></td><td class="s">  $rows_affected = $dbh-&gt;do(&quot;UPDATE your_table SET foo = foo + 1&quot;);</td></tr>
<tr><td class="h"><a name="2198"></a>2198</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2199"></a>2199</td><td></td><td></td><td></td><td></td><td class="s">To commit your changes to the database (when L&lt;/AutoCommit&gt; is off):</td></tr>
<tr><td class="h"><a name="2200"></a>2200</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2201"></a>2201</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;commit;  # or call $dbh-&gt;rollback; to undo changes</td></tr>
<tr><td class="h"><a name="2202"></a>2202</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2203"></a>2203</td><td></td><td></td><td></td><td></td><td class="s">Finally, when you have finished working with the data source, you should</td></tr>
<tr><td class="h"><a name="2204"></a>2204</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/disconnect&gt; from it:</td></tr>
<tr><td class="h"><a name="2205"></a>2205</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2206"></a>2206</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;disconnect;</td></tr>
<tr><td class="h"><a name="2207"></a>2207</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2208"></a>2208</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2209"></a>2209</td><td></td><td></td><td></td><td></td><td class="s">=head2 General Interface Rules &amp; Caveats</td></tr>
<tr><td class="h"><a name="2210"></a>2210</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2211"></a>2211</td><td></td><td></td><td></td><td></td><td class="s">The DBI does not have a concept of a &quot;current session&quot;. Every session</td></tr>
<tr><td class="h"><a name="2212"></a>2212</td><td></td><td></td><td></td><td></td><td class="s">has a handle object (i.e., a C&lt;$dbh&gt;) returned from the C&lt;connect&gt; method.</td></tr>
<tr><td class="h"><a name="2213"></a>2213</td><td></td><td></td><td></td><td></td><td class="s">That handle object is used to invoke database related methods.</td></tr>
<tr><td class="h"><a name="2214"></a>2214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2215"></a>2215</td><td></td><td></td><td></td><td></td><td class="s">Most data is returned to the Perl script as strings. (Null values are</td></tr>
<tr><td class="h"><a name="2216"></a>2216</td><td></td><td></td><td></td><td></td><td class="s">returned as C&lt;undef&gt;.)  This allows arbitrary precision numeric data to be</td></tr>
<tr><td class="h"><a name="2217"></a>2217</td><td></td><td></td><td></td><td></td><td class="s">handled without loss of accuracy.  Beware that Perl may not preserve</td></tr>
<tr><td class="h"><a name="2218"></a>2218</td><td></td><td></td><td></td><td></td><td class="s">the same accuracy when the string is used as a number.</td></tr>
<tr><td class="h"><a name="2219"></a>2219</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2220"></a>2220</td><td></td><td></td><td></td><td></td><td class="s">Dates and times are returned as character strings in the current</td></tr>
<tr><td class="h"><a name="2221"></a>2221</td><td></td><td></td><td></td><td></td><td class="s">default format of the corresponding database engine.  Time zone effects</td></tr>
<tr><td class="h"><a name="2222"></a>2222</td><td></td><td></td><td></td><td></td><td class="s">are database/driver dependent.</td></tr>
<tr><td class="h"><a name="2223"></a>2223</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2224"></a>2224</td><td></td><td></td><td></td><td></td><td class="s">Perl supports binary data in Perl strings, and the DBI will pass binary</td></tr>
<tr><td class="h"><a name="2225"></a>2225</td><td></td><td></td><td></td><td></td><td class="s">data to and from the driver without change. It is up to the driver</td></tr>
<tr><td class="h"><a name="2226"></a>2226</td><td></td><td></td><td></td><td></td><td class="s">implementors to decide how they wish to handle such binary data.</td></tr>
<tr><td class="h"><a name="2227"></a>2227</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2228"></a>2228</td><td></td><td></td><td></td><td></td><td class="s">Perl supports two kinds of strings: unicode (utf8 internally) and non-unicode</td></tr>
<tr><td class="h"><a name="2229"></a>2229</td><td></td><td></td><td></td><td></td><td class="s">(defaults to iso-8859-1 if forced to assume an encoding).  Drivers should</td></tr>
<tr><td class="h"><a name="2230"></a>2230</td><td></td><td></td><td></td><td></td><td class="s">accept both kinds of strings and, if required, convert them to the character</td></tr>
<tr><td class="h"><a name="2231"></a>2231</td><td></td><td></td><td></td><td></td><td class="s">set of the database being used. Similarly, when fetching from the database</td></tr>
<tr><td class="h"><a name="2232"></a>2232</td><td></td><td></td><td></td><td></td><td class="s">character data that isn't iso-8859-1 the driver should convert it into utf8.</td></tr>
<tr><td class="h"><a name="2233"></a>2233</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2234"></a>2234</td><td></td><td></td><td></td><td></td><td class="s">Multiple SQL statements may not be combined in a single statement</td></tr>
<tr><td class="h"><a name="2235"></a>2235</td><td></td><td></td><td></td><td></td><td class="s">handle (C&lt;$sth&gt;), although some databases and drivers do support this</td></tr>
<tr><td class="h"><a name="2236"></a>2236</td><td></td><td></td><td></td><td></td><td class="s">(notably Sybase and SQL Server).</td></tr>
<tr><td class="h"><a name="2237"></a>2237</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2238"></a>2238</td><td></td><td></td><td></td><td></td><td class="s">Non-sequential record reads are not supported in this version of the DBI.</td></tr>
<tr><td class="h"><a name="2239"></a>2239</td><td></td><td></td><td></td><td></td><td class="s">In other words, records can only be fetched in the order that the</td></tr>
<tr><td class="h"><a name="2240"></a>2240</td><td></td><td></td><td></td><td></td><td class="s">database returned them, and once fetched they are forgotten.</td></tr>
<tr><td class="h"><a name="2241"></a>2241</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2242"></a>2242</td><td></td><td></td><td></td><td></td><td class="s">Positioned updates and deletes are not directly supported by the DBI.</td></tr>
<tr><td class="h"><a name="2243"></a>2243</td><td></td><td></td><td></td><td></td><td class="s">See the description of the C&lt;CursorName&gt; attribute for an alternative.</td></tr>
<tr><td class="h"><a name="2244"></a>2244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2245"></a>2245</td><td></td><td></td><td></td><td></td><td class="s">Individual driver implementors are free to provide any private</td></tr>
<tr><td class="h"><a name="2246"></a>2246</td><td></td><td></td><td></td><td></td><td class="s">functions and/or handle attributes that they feel are useful.</td></tr>
<tr><td class="h"><a name="2247"></a>2247</td><td></td><td></td><td></td><td></td><td class="s">Private driver functions can be invoked using the DBI C&lt;func()&gt; method.</td></tr>
<tr><td class="h"><a name="2248"></a>2248</td><td></td><td></td><td></td><td></td><td class="s">Private driver attributes are accessed just like standard attributes.</td></tr>
<tr><td class="h"><a name="2249"></a>2249</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2250"></a>2250</td><td></td><td></td><td></td><td></td><td class="s">Many methods have an optional C&lt;\%attr&gt; parameter which can be used to</td></tr>
<tr><td class="h"><a name="2251"></a>2251</td><td></td><td></td><td></td><td></td><td class="s">pass information to the driver implementing the method. Except where</td></tr>
<tr><td class="h"><a name="2252"></a>2252</td><td></td><td></td><td></td><td></td><td class="s">specifically documented, the C&lt;\%attr&gt; parameter can only be used to pass</td></tr>
<tr><td class="h"><a name="2253"></a>2253</td><td></td><td></td><td></td><td></td><td class="s">driver specific hints. In general, you can ignore C&lt;\%attr&gt; parameters</td></tr>
<tr><td class="h"><a name="2254"></a>2254</td><td></td><td></td><td></td><td></td><td class="s">or pass it as C&lt;undef&gt;.</td></tr>
<tr><td class="h"><a name="2255"></a>2255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2256"></a>2256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2257"></a>2257</td><td></td><td></td><td></td><td></td><td class="s">=head2 Naming Conventions and Name Space</td></tr>
<tr><td class="h"><a name="2258"></a>2258</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2259"></a>2259</td><td></td><td></td><td></td><td></td><td class="s">The DBI package and all packages below it (C&lt;DBI::*&gt;) are reserved for</td></tr>
<tr><td class="h"><a name="2260"></a>2260</td><td></td><td></td><td></td><td></td><td class="s">use by the DBI. Extensions and related modules use the C&lt;DBIx::&gt;</td></tr>
<tr><td class="h"><a name="2261"></a>2261</td><td></td><td></td><td></td><td></td><td class="s">namespace (see L&lt;http://www.perl.com/CPAN/modules/by-module/DBIx/&gt;).</td></tr>
<tr><td class="h"><a name="2262"></a>2262</td><td></td><td></td><td></td><td></td><td class="s">Package names beginning with C&lt;DBD::&gt; are reserved for use</td></tr>
<tr><td class="h"><a name="2263"></a>2263</td><td></td><td></td><td></td><td></td><td class="s">by DBI database drivers.  All environment variables used by the DBI</td></tr>
<tr><td class="h"><a name="2264"></a>2264</td><td></td><td></td><td></td><td></td><td class="s">or by individual DBDs begin with &quot;C&lt;DBI_&gt;&quot; or &quot;C&lt;DBD_&gt;&quot;.</td></tr>
<tr><td class="h"><a name="2265"></a>2265</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2266"></a>2266</td><td></td><td></td><td></td><td></td><td class="s">The letter case used for attribute names is significant and plays an</td></tr>
<tr><td class="h"><a name="2267"></a>2267</td><td></td><td></td><td></td><td></td><td class="s">important part in the portability of DBI scripts.  The case of the</td></tr>
<tr><td class="h"><a name="2268"></a>2268</td><td></td><td></td><td></td><td></td><td class="s">attribute name is used to signify who defined the meaning of that name</td></tr>
<tr><td class="h"><a name="2269"></a>2269</td><td></td><td></td><td></td><td></td><td class="s">and its values.</td></tr>
<tr><td class="h"><a name="2270"></a>2270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2271"></a>2271</td><td></td><td></td><td></td><td></td><td class="s">  Case of name  Has a meaning defined by</td></tr>
<tr><td class="h"><a name="2272"></a>2272</td><td></td><td></td><td></td><td></td><td class="s">  ------------  ------------------------</td></tr>
<tr><td class="h"><a name="2273"></a>2273</td><td></td><td></td><td></td><td></td><td class="s">  UPPER_CASE    Standards, e.g.,  X/Open, ISO SQL92 etc (portable)</td></tr>
<tr><td class="h"><a name="2274"></a>2274</td><td></td><td></td><td></td><td></td><td class="s">  MixedCase     DBI API (portable), underscores are not used.</td></tr>
<tr><td class="h"><a name="2275"></a>2275</td><td></td><td></td><td></td><td></td><td class="s">  lower_case    Driver or database engine specific (non-portable)</td></tr>
<tr><td class="h"><a name="2276"></a>2276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2277"></a>2277</td><td></td><td></td><td></td><td></td><td class="s">It is of the utmost importance that Driver developers only use</td></tr>
<tr><td class="h"><a name="2278"></a>2278</td><td></td><td></td><td></td><td></td><td class="s">lowercase attribute names when defining private attributes. Private</td></tr>
<tr><td class="h"><a name="2279"></a>2279</td><td></td><td></td><td></td><td></td><td class="s">attribute names must be prefixed with the driver name or suitable</td></tr>
<tr><td class="h"><a name="2280"></a>2280</td><td></td><td></td><td></td><td></td><td class="s">abbreviation (e.g., &quot;C&lt;ora_&gt;&quot; for Oracle, &quot;C&lt;ing_&gt;&quot; for Ingres, etc).</td></tr>
<tr><td class="h"><a name="2281"></a>2281</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2282"></a>2282</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2283"></a>2283</td><td></td><td></td><td></td><td></td><td class="s">=head2 SQL - A Query Language</td></tr>
<tr><td class="h"><a name="2284"></a>2284</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2285"></a>2285</td><td></td><td></td><td></td><td></td><td class="s">Most DBI drivers require applications to use a dialect of SQL</td></tr>
<tr><td class="h"><a name="2286"></a>2286</td><td></td><td></td><td></td><td></td><td class="s">(Structured Query Language) to interact with the database engine.</td></tr>
<tr><td class="h"><a name="2287"></a>2287</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/&quot;Standards Reference Information&quot;&gt; section provides links</td></tr>
<tr><td class="h"><a name="2288"></a>2288</td><td></td><td></td><td></td><td></td><td class="s">to useful information about SQL.</td></tr>
<tr><td class="h"><a name="2289"></a>2289</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2290"></a>2290</td><td></td><td></td><td></td><td></td><td class="s">The DBI itself does not mandate or require any particular language to</td></tr>
<tr><td class="h"><a name="2291"></a>2291</td><td></td><td></td><td></td><td></td><td class="s">be used; it is language independent. In ODBC terms, the DBI is in</td></tr>
<tr><td class="h"><a name="2292"></a>2292</td><td></td><td></td><td></td><td></td><td class="s">&quot;pass-thru&quot; mode, although individual drivers might not be. The only requirement</td></tr>
<tr><td class="h"><a name="2293"></a>2293</td><td></td><td></td><td></td><td></td><td class="s">is that queries and other statements must be expressed as a single</td></tr>
<tr><td class="h"><a name="2294"></a>2294</td><td></td><td></td><td></td><td></td><td class="s">string of characters passed as the first argument to the L&lt;/prepare&gt; or</td></tr>
<tr><td class="h"><a name="2295"></a>2295</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/do&gt; methods.</td></tr>
<tr><td class="h"><a name="2296"></a>2296</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2297"></a>2297</td><td></td><td></td><td></td><td></td><td class="s">For an interesting diversion on the I&lt;real&gt; history of RDBMS and SQL,</td></tr>
<tr><td class="h"><a name="2298"></a>2298</td><td></td><td></td><td></td><td></td><td class="s">from the people who made it happen, see:</td></tr>
<tr><td class="h"><a name="2299"></a>2299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2300"></a>2300</td><td></td><td></td><td></td><td></td><td class="s">  http://ftp.digital.com/pub/DEC/SRC/technical-notes/SRC-1997-018-html/sqlr95.html</td></tr>
<tr><td class="h"><a name="2301"></a>2301</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2302"></a>2302</td><td></td><td></td><td></td><td></td><td class="s">Follow the &quot;Full Contents&quot; then &quot;Intergalactic dataspeak&quot; links for the</td></tr>
<tr><td class="h"><a name="2303"></a>2303</td><td></td><td></td><td></td><td></td><td class="s">SQL history.</td></tr>
<tr><td class="h"><a name="2304"></a>2304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2305"></a>2305</td><td></td><td></td><td></td><td></td><td class="s">=head2 Placeholders and Bind Values</td></tr>
<tr><td class="h"><a name="2306"></a>2306</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2307"></a>2307</td><td></td><td></td><td></td><td></td><td class="s">Some drivers support placeholders and bind values.</td></tr>
<tr><td class="h"><a name="2308"></a>2308</td><td></td><td></td><td></td><td></td><td class="s">I&lt;Placeholders&gt;, also called parameter markers, are used to indicate</td></tr>
<tr><td class="h"><a name="2309"></a>2309</td><td></td><td></td><td></td><td></td><td class="s">values in a database statement that will be supplied later,</td></tr>
<tr><td class="h"><a name="2310"></a>2310</td><td></td><td></td><td></td><td></td><td class="s">before the prepared statement is executed.  For example, an application</td></tr>
<tr><td class="h"><a name="2311"></a>2311</td><td></td><td></td><td></td><td></td><td class="s">might use the following to insert a row of data into the SALES table:</td></tr>
<tr><td class="h"><a name="2312"></a>2312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2313"></a>2313</td><td></td><td></td><td></td><td></td><td class="s">  INSERT INTO sales (product_code, qty, price) VALUES (?, ?, ?)</td></tr>
<tr><td class="h"><a name="2314"></a>2314</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2315"></a>2315</td><td></td><td></td><td></td><td></td><td class="s">or the following, to select the description for a product:</td></tr>
<tr><td class="h"><a name="2316"></a>2316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2317"></a>2317</td><td></td><td></td><td></td><td></td><td class="s">  SELECT description FROM products WHERE product_code = ?</td></tr>
<tr><td class="h"><a name="2318"></a>2318</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2319"></a>2319</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;?&gt; characters are the placeholders.  The association of actual</td></tr>
<tr><td class="h"><a name="2320"></a>2320</td><td></td><td></td><td></td><td></td><td class="s">values with placeholders is known as I&lt;binding&gt;, and the values are</td></tr>
<tr><td class="h"><a name="2321"></a>2321</td><td></td><td></td><td></td><td></td><td class="s">referred to as I&lt;bind values&gt;.</td></tr>
<tr><td class="h"><a name="2322"></a>2322</td><td></td><td></td><td></td><td></td><td class="s">Note that the C&lt;?&gt; is not enclosed in quotation marks, even when the</td></tr>
<tr><td class="h"><a name="2323"></a>2323</td><td></td><td></td><td></td><td></td><td class="s">placeholder represents a string.</td></tr>
<tr><td class="h"><a name="2324"></a>2324</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2325"></a>2325</td><td></td><td></td><td></td><td></td><td class="s">Some drivers also allow placeholders like C&lt;:&gt;I&lt;name&gt; and C&lt;:&gt;I&lt;N&gt; (e.g.,</td></tr>
<tr><td class="h"><a name="2326"></a>2326</td><td></td><td></td><td></td><td></td><td class="s">C&lt;:1&gt;, C&lt;:2&gt;, and so on) in addition to C&lt;?&gt;, but their use is not portable.</td></tr>
<tr><td class="h"><a name="2327"></a>2327</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2328"></a>2328</td><td></td><td></td><td></td><td></td><td class="s">If the C&lt;:&gt;I&lt;N&gt; form of placeholder is supported by the driver you're using,</td></tr>
<tr><td class="h"><a name="2329"></a>2329</td><td></td><td></td><td></td><td></td><td class="s">then you should be able to use either L&lt;/bind_param&gt; or L&lt;/execute&gt; to bind</td></tr>
<tr><td class="h"><a name="2330"></a>2330</td><td></td><td></td><td></td><td></td><td class="s">values. Check your driver documentation.</td></tr>
<tr><td class="h"><a name="2331"></a>2331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2332"></a>2332</td><td></td><td></td><td></td><td></td><td class="s">With most drivers, placeholders can't be used for any element of a</td></tr>
<tr><td class="h"><a name="2333"></a>2333</td><td></td><td></td><td></td><td></td><td class="s">statement that would prevent the database server from validating the</td></tr>
<tr><td class="h"><a name="2334"></a>2334</td><td></td><td></td><td></td><td></td><td class="s">statement and creating a query execution plan for it. For example:</td></tr>
<tr><td class="h"><a name="2335"></a>2335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2336"></a>2336</td><td></td><td></td><td></td><td></td><td class="s">  &quot;SELECT name, age FROM ?&quot;         # wrong (will probably fail)</td></tr>
<tr><td class="h"><a name="2337"></a>2337</td><td></td><td></td><td></td><td></td><td class="s">  &quot;SELECT name, ?   FROM people&quot;    # wrong (but may not 'fail')</td></tr>
<tr><td class="h"><a name="2338"></a>2338</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2339"></a>2339</td><td></td><td></td><td></td><td></td><td class="s">Also, placeholders can only represent single scalar values.</td></tr>
<tr><td class="h"><a name="2340"></a>2340</td><td></td><td></td><td></td><td></td><td class="s">For example, the following</td></tr>
<tr><td class="h"><a name="2341"></a>2341</td><td></td><td></td><td></td><td></td><td class="s">statement won't work as expected for more than one value:</td></tr>
<tr><td class="h"><a name="2342"></a>2342</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2343"></a>2343</td><td></td><td></td><td></td><td></td><td class="s">  &quot;SELECT name, age FROM people WHERE name IN (?)&quot;    # wrong</td></tr>
<tr><td class="h"><a name="2344"></a>2344</td><td></td><td></td><td></td><td></td><td class="s">  &quot;SELECT name, age FROM people WHERE name IN (?,?)&quot;  # two names</td></tr>
<tr><td class="h"><a name="2345"></a>2345</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2346"></a>2346</td><td></td><td></td><td></td><td></td><td class="s">When using placeholders with the SQL C&lt;LIKE&gt; qualifier, you must</td></tr>
<tr><td class="h"><a name="2347"></a>2347</td><td></td><td></td><td></td><td></td><td class="s">remember that the placeholder substitutes for the whole string.</td></tr>
<tr><td class="h"><a name="2348"></a>2348</td><td></td><td></td><td></td><td></td><td class="s">So you should use &quot;C&lt;... LIKE ? ...&gt;&quot; and include any wildcard</td></tr>
<tr><td class="h"><a name="2349"></a>2349</td><td></td><td></td><td></td><td></td><td class="s">characters in the value that you bind to the placeholder.</td></tr>
<tr><td class="h"><a name="2350"></a>2350</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2351"></a>2351</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NULL Values&gt;</td></tr>
<tr><td class="h"><a name="2352"></a>2352</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2353"></a>2353</td><td></td><td></td><td></td><td></td><td class="s">Undefined values, or C&lt;undef&gt;, are used to indicate NULL values.</td></tr>
<tr><td class="h"><a name="2354"></a>2354</td><td></td><td></td><td></td><td></td><td class="s">You can insert and update columns with a NULL value as you would a</td></tr>
<tr><td class="h"><a name="2355"></a>2355</td><td></td><td></td><td></td><td></td><td class="s">non-NULL value.  These examples insert and update the column</td></tr>
<tr><td class="h"><a name="2356"></a>2356</td><td></td><td></td><td></td><td></td><td class="s">C&lt;age&gt; with a NULL value:</td></tr>
<tr><td class="h"><a name="2357"></a>2357</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2358"></a>2358</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(qq{</td></tr>
<tr><td class="h"><a name="2359"></a>2359</td><td></td><td></td><td></td><td></td><td class="s">    INSERT INTO people (fullname, age) VALUES (?, ?)</td></tr>
<tr><td class="h"><a name="2360"></a>2360</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="2361"></a>2361</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute(&quot;Joe Bloggs&quot;, undef);</td></tr>
<tr><td class="h"><a name="2362"></a>2362</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2363"></a>2363</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(qq{</td></tr>
<tr><td class="h"><a name="2364"></a>2364</td><td></td><td></td><td></td><td></td><td class="s">    UPDATE people SET age = ? WHERE fullname = ?</td></tr>
<tr><td class="h"><a name="2365"></a>2365</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="2366"></a>2366</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute(undef, &quot;Joe Bloggs&quot;);</td></tr>
<tr><td class="h"><a name="2367"></a>2367</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2368"></a>2368</td><td></td><td></td><td></td><td></td><td class="s">However, care must be taken when trying to use NULL values in a</td></tr>
<tr><td class="h"><a name="2369"></a>2369</td><td></td><td></td><td></td><td></td><td class="s">C&lt;WHERE&gt; clause.  Consider:</td></tr>
<tr><td class="h"><a name="2370"></a>2370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2371"></a>2371</td><td></td><td></td><td></td><td></td><td class="s">  SELECT fullname FROM people WHERE age = ?</td></tr>
<tr><td class="h"><a name="2372"></a>2372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2373"></a>2373</td><td></td><td></td><td></td><td></td><td class="s">Binding an C&lt;undef&gt; (NULL) to the placeholder will I&lt;not&gt; select rows</td></tr>
<tr><td class="h"><a name="2374"></a>2374</td><td></td><td></td><td></td><td></td><td class="s">which have a NULL C&lt;age&gt;!  At least for database engines that</td></tr>
<tr><td class="h"><a name="2375"></a>2375</td><td></td><td></td><td></td><td></td><td class="s">conform to the SQL standard.  Refer to the SQL manual for your database</td></tr>
<tr><td class="h"><a name="2376"></a>2376</td><td></td><td></td><td></td><td></td><td class="s">engine or any SQL book for the reasons for this.  To explicitly select</td></tr>
<tr><td class="h"><a name="2377"></a>2377</td><td></td><td></td><td></td><td></td><td class="s">NULLs you have to say &quot;C&lt;WHERE age IS NULL&gt;&quot;.</td></tr>
<tr><td class="h"><a name="2378"></a>2378</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2379"></a>2379</td><td></td><td></td><td></td><td></td><td class="s">A common issue is to have a code fragment handle a value that could be</td></tr>
<tr><td class="h"><a name="2380"></a>2380</td><td></td><td></td><td></td><td></td><td class="s">either C&lt;defined&gt; or C&lt;undef&gt; (non-NULL or NULL) at runtime.</td></tr>
<tr><td class="h"><a name="2381"></a>2381</td><td></td><td></td><td></td><td></td><td class="s">A simple technique is to prepare the appropriate statement as needed,</td></tr>
<tr><td class="h"><a name="2382"></a>2382</td><td></td><td></td><td></td><td></td><td class="s">and substitute the placeholder for non-NULL cases:</td></tr>
<tr><td class="h"><a name="2383"></a>2383</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2384"></a>2384</td><td></td><td></td><td></td><td></td><td class="s">  $sql_clause = defined $age? &quot;age = ?&quot; : &quot;age IS NULL&quot;;</td></tr>
<tr><td class="h"><a name="2385"></a>2385</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(qq{</td></tr>
<tr><td class="h"><a name="2386"></a>2386</td><td></td><td></td><td></td><td></td><td class="s">    SELECT fullname FROM people WHERE $sql_clause</td></tr>
<tr><td class="h"><a name="2387"></a>2387</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="2388"></a>2388</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute(defined $age ? $age : ());</td></tr>
<tr><td class="h"><a name="2389"></a>2389</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2390"></a>2390</td><td></td><td></td><td></td><td></td><td class="s">The following technique illustrates qualifying a C&lt;WHERE&gt; clause with</td></tr>
<tr><td class="h"><a name="2391"></a>2391</td><td></td><td></td><td></td><td></td><td class="s">several columns, whose associated values (C&lt;defined&gt; or C&lt;undef&gt;) are</td></tr>
<tr><td class="h"><a name="2392"></a>2392</td><td></td><td></td><td></td><td></td><td class="s">in a hash %h:</td></tr>
<tr><td class="h"><a name="2393"></a>2393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2394"></a>2394</td><td></td><td></td><td></td><td></td><td class="s">  for my $col (&quot;age&quot;, &quot;phone&quot;, &quot;email&quot;) {</td></tr>
<tr><td class="h"><a name="2395"></a>2395</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $h{$col}) {</td></tr>
<tr><td class="h"><a name="2396"></a>2396</td><td></td><td></td><td></td><td></td><td class="s">      push @sql_qual, &quot;$col = ?&quot;;</td></tr>
<tr><td class="h"><a name="2397"></a>2397</td><td></td><td></td><td></td><td></td><td class="s">      push @sql_bind, $h{$col};</td></tr>
<tr><td class="h"><a name="2398"></a>2398</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2399"></a>2399</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="2400"></a>2400</td><td></td><td></td><td></td><td></td><td class="s">      push @sql_qual, &quot;$col IS NULL&quot;;</td></tr>
<tr><td class="h"><a name="2401"></a>2401</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2402"></a>2402</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2403"></a>2403</td><td></td><td></td><td></td><td></td><td class="s">  $sql_clause = join(&quot; AND &quot;, @sql_qual);</td></tr>
<tr><td class="h"><a name="2404"></a>2404</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(qq{</td></tr>
<tr><td class="h"><a name="2405"></a>2405</td><td></td><td></td><td></td><td></td><td class="s">      SELECT fullname FROM people WHERE $sql_clause</td></tr>
<tr><td class="h"><a name="2406"></a>2406</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="2407"></a>2407</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute(@sql_bind);</td></tr>
<tr><td class="h"><a name="2408"></a>2408</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2409"></a>2409</td><td></td><td></td><td></td><td></td><td class="s">The techniques above call prepare for the SQL statement with each call to</td></tr>
<tr><td class="h"><a name="2410"></a>2410</td><td></td><td></td><td></td><td></td><td class="s">execute.  Because calls to prepare() can be expensive, performance</td></tr>
<tr><td class="h"><a name="2411"></a>2411</td><td></td><td></td><td></td><td></td><td class="s">can suffer when an application iterates many times over statements</td></tr>
<tr><td class="h"><a name="2412"></a>2412</td><td></td><td></td><td></td><td></td><td class="s">like the above.</td></tr>
<tr><td class="h"><a name="2413"></a>2413</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2414"></a>2414</td><td></td><td></td><td></td><td></td><td class="s">A better solution is a single C&lt;WHERE&gt; clause that supports both</td></tr>
<tr><td class="h"><a name="2415"></a>2415</td><td></td><td></td><td></td><td></td><td class="s">NULL and non-NULL comparisons.  Its SQL statement would need to be</td></tr>
<tr><td class="h"><a name="2416"></a>2416</td><td></td><td></td><td></td><td></td><td class="s">prepared only once for all cases, thus improving performance.</td></tr>
<tr><td class="h"><a name="2417"></a>2417</td><td></td><td></td><td></td><td></td><td class="s">Several examples of C&lt;WHERE&gt; clauses that support this are presented</td></tr>
<tr><td class="h"><a name="2418"></a>2418</td><td></td><td></td><td></td><td></td><td class="s">below.  But each example lacks portability, robustness, or simplicity.</td></tr>
<tr><td class="h"><a name="2419"></a>2419</td><td></td><td></td><td></td><td></td><td class="s">Whether an example is supported on your database engine depends on</td></tr>
<tr><td class="h"><a name="2420"></a>2420</td><td></td><td></td><td></td><td></td><td class="s">what SQL extensions it provides, and where it supports the C&lt;?&gt;</td></tr>
<tr><td class="h"><a name="2421"></a>2421</td><td></td><td></td><td></td><td></td><td class="s">placeholder in a statement.</td></tr>
<tr><td class="h"><a name="2422"></a>2422</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2423"></a>2423</td><td></td><td></td><td></td><td></td><td class="s">  0)  age = ?</td></tr>
<tr><td class="h"><a name="2424"></a>2424</td><td></td><td></td><td></td><td></td><td class="s">  1)  NVL(age, xx) = NVL(?, xx)</td></tr>
<tr><td class="h"><a name="2425"></a>2425</td><td></td><td></td><td></td><td></td><td class="s">  2)  ISNULL(age, xx) = ISNULL(?, xx)</td></tr>
<tr><td class="h"><a name="2426"></a>2426</td><td></td><td></td><td></td><td></td><td class="s">  3)  DECODE(age, ?, 1, 0) = 1</td></tr>
<tr><td class="h"><a name="2427"></a>2427</td><td></td><td></td><td></td><td></td><td class="s">  4)  age = ? OR (age IS NULL AND ? IS NULL)</td></tr>
<tr><td class="h"><a name="2428"></a>2428</td><td></td><td></td><td></td><td></td><td class="s">  5)  age = ? OR (age IS NULL AND SP_ISNULL(?) = 1)</td></tr>
<tr><td class="h"><a name="2429"></a>2429</td><td></td><td></td><td></td><td></td><td class="s">  6)  age = ? OR (age IS NULL AND ? = 1)</td></tr>
<tr><td class="h"><a name="2430"></a>2430</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2431"></a>2431</td><td></td><td></td><td></td><td></td><td class="s">Statements formed with the above C&lt;WHERE&gt; clauses require execute</td></tr>
<tr><td class="h"><a name="2432"></a>2432</td><td></td><td></td><td></td><td></td><td class="s">statements as follows.  The arguments are required, whether their</td></tr>
<tr><td class="h"><a name="2433"></a>2433</td><td></td><td></td><td></td><td></td><td class="s">values are C&lt;defined&gt; or C&lt;undef&gt;.</td></tr>
<tr><td class="h"><a name="2434"></a>2434</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2435"></a>2435</td><td></td><td></td><td></td><td></td><td class="s">  0,1,2,3)  $sth-&gt;execute($age);</td></tr>
<tr><td class="h"><a name="2436"></a>2436</td><td></td><td></td><td></td><td></td><td class="s">  4,5)      $sth-&gt;execute($age, $age);</td></tr>
<tr><td class="h"><a name="2437"></a>2437</td><td></td><td></td><td></td><td></td><td class="s">  6)        $sth-&gt;execute($age, defined($age) ? 0 : 1);</td></tr>
<tr><td class="h"><a name="2438"></a>2438</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2439"></a>2439</td><td></td><td></td><td></td><td></td><td class="s">Example 0 should not work (as mentioned earlier), but may work on</td></tr>
<tr><td class="h"><a name="2440"></a>2440</td><td></td><td></td><td></td><td></td><td class="s">a few database engines anyway (e.g. Sybase).  Example 0 is part</td></tr>
<tr><td class="h"><a name="2441"></a>2441</td><td></td><td></td><td></td><td></td><td class="s">of examples 4, 5, and 6, so if example 0 works, these other</td></tr>
<tr><td class="h"><a name="2442"></a>2442</td><td></td><td></td><td></td><td></td><td class="s">examples may work, even if the engine does not properly support</td></tr>
<tr><td class="h"><a name="2443"></a>2443</td><td></td><td></td><td></td><td></td><td class="s">the right hand side of the C&lt;OR&gt; expression.</td></tr>
<tr><td class="h"><a name="2444"></a>2444</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2445"></a>2445</td><td></td><td></td><td></td><td></td><td class="s">Examples 1 and 2 are not robust: they require that you provide a</td></tr>
<tr><td class="h"><a name="2446"></a>2446</td><td></td><td></td><td></td><td></td><td class="s">valid column value xx (e.g. '~') which is not present in any row.</td></tr>
<tr><td class="h"><a name="2447"></a>2447</td><td></td><td></td><td></td><td></td><td class="s">That means you must have some notion of what data won't be stored</td></tr>
<tr><td class="h"><a name="2448"></a>2448</td><td></td><td></td><td></td><td></td><td class="s">in the column, and expect clients to adhere to that.</td></tr>
<tr><td class="h"><a name="2449"></a>2449</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2450"></a>2450</td><td></td><td></td><td></td><td></td><td class="s">Example 5 requires that you provide a stored procedure (SP_ISNULL</td></tr>
<tr><td class="h"><a name="2451"></a>2451</td><td></td><td></td><td></td><td></td><td class="s">in this example) that acts as a function: it checks whether a value</td></tr>
<tr><td class="h"><a name="2452"></a>2452</td><td></td><td></td><td></td><td></td><td class="s">is null, and returns 1 if it is, or 0 if not.</td></tr>
<tr><td class="h"><a name="2453"></a>2453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2454"></a>2454</td><td></td><td></td><td></td><td></td><td class="s">Example 6, the least simple, is probably the most portable, i.e., it</td></tr>
<tr><td class="h"><a name="2455"></a>2455</td><td></td><td></td><td></td><td></td><td class="s">should work with with most, if not all, database engines.</td></tr>
<tr><td class="h"><a name="2456"></a>2456</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2457"></a>2457</td><td></td><td></td><td></td><td></td><td class="s">Here is a table that indicates which examples above are known to</td></tr>
<tr><td class="h"><a name="2458"></a>2458</td><td></td><td></td><td></td><td></td><td class="s">work on various database engines:</td></tr>
<tr><td class="h"><a name="2459"></a>2459</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2460"></a>2460</td><td></td><td></td><td></td><td></td><td class="s">                   -----Examples------</td></tr>
<tr><td class="h"><a name="2461"></a>2461</td><td></td><td></td><td></td><td></td><td class="s">                   0  1  2  3  4  5  6</td></tr>
<tr><td class="h"><a name="2462"></a>2462</td><td></td><td></td><td></td><td></td><td class="s">                   -  -  -  -  -  -  -</td></tr>
<tr><td class="h"><a name="2463"></a>2463</td><td></td><td></td><td></td><td></td><td class="s">  Oracle 9         N  Y  N  Y  Y  ?  Y</td></tr>
<tr><td class="h"><a name="2464"></a>2464</td><td></td><td></td><td></td><td></td><td class="s">  Informix IDS 9   N  N  N  Y  N  Y  Y</td></tr>
<tr><td class="h"><a name="2465"></a>2465</td><td></td><td></td><td></td><td></td><td class="s">  MS SQL           N  N  Y  N  Y  ?  Y</td></tr>
<tr><td class="h"><a name="2466"></a>2466</td><td></td><td></td><td></td><td></td><td class="s">  Sybase           Y  N  N  N  N  N  Y</td></tr>
<tr><td class="h"><a name="2467"></a>2467</td><td></td><td></td><td></td><td></td><td class="s">  AnyData,DBM,CSV  Y  N  N  N  Y  Y* Y</td></tr>
<tr><td class="h"><a name="2468"></a>2468</td><td></td><td></td><td></td><td></td><td class="s">  SQLite 3.3       N  N  N  N  Y  N  N</td></tr>
<tr><td class="h"><a name="2469"></a>2469</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2470"></a>2470</td><td></td><td></td><td></td><td></td><td class="s">* Works only because Example 0 works.</td></tr>
<tr><td class="h"><a name="2471"></a>2471</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2472"></a>2472</td><td></td><td></td><td></td><td></td><td class="s">DBI provides a sample perl script that will test the examples above</td></tr>
<tr><td class="h"><a name="2473"></a>2473</td><td></td><td></td><td></td><td></td><td class="s">on your database engine and tell you which ones work.  It is located</td></tr>
<tr><td class="h"><a name="2474"></a>2474</td><td></td><td></td><td></td><td></td><td class="s">in the F&lt;ex/&gt; subdirectory of the DBI source distribution, or here:</td></tr>
<tr><td class="h"><a name="2475"></a>2475</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://svn.perl.org/modules/dbi/trunk/ex/perl_dbi_nulls_test.pl&gt;</td></tr>
<tr><td class="h"><a name="2476"></a>2476</td><td></td><td></td><td></td><td></td><td class="s">Please use the script to help us fill-in and maintain this table.</td></tr>
<tr><td class="h"><a name="2477"></a>2477</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2478"></a>2478</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Performance&gt;</td></tr>
<tr><td class="h"><a name="2479"></a>2479</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2480"></a>2480</td><td></td><td></td><td></td><td></td><td class="s">Without using placeholders, the insert statement shown previously would have to</td></tr>
<tr><td class="h"><a name="2481"></a>2481</td><td></td><td></td><td></td><td></td><td class="s">contain the literal values to be inserted and would have to be</td></tr>
<tr><td class="h"><a name="2482"></a>2482</td><td></td><td></td><td></td><td></td><td class="s">re-prepared and re-executed for each row. With placeholders, the insert</td></tr>
<tr><td class="h"><a name="2483"></a>2483</td><td></td><td></td><td></td><td></td><td class="s">statement only needs to be prepared once. The bind values for each row</td></tr>
<tr><td class="h"><a name="2484"></a>2484</td><td></td><td></td><td></td><td></td><td class="s">can be given to the C&lt;execute&gt; method each time it's called. By avoiding</td></tr>
<tr><td class="h"><a name="2485"></a>2485</td><td></td><td></td><td></td><td></td><td class="s">the need to re-prepare the statement for each row, the application</td></tr>
<tr><td class="h"><a name="2486"></a>2486</td><td></td><td></td><td></td><td></td><td class="s">typically runs many times faster. Here's an example:</td></tr>
<tr><td class="h"><a name="2487"></a>2487</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2488"></a>2488</td><td></td><td></td><td></td><td></td><td class="s">  my $sth = $dbh-&gt;prepare(q{</td></tr>
<tr><td class="h"><a name="2489"></a>2489</td><td></td><td></td><td></td><td></td><td class="s">    INSERT INTO sales (product_code, qty, price) VALUES (?, ?, ?)</td></tr>
<tr><td class="h"><a name="2490"></a>2490</td><td></td><td></td><td></td><td></td><td class="s">  }) or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="2491"></a>2491</td><td></td><td></td><td></td><td></td><td class="s">  while (&lt;&gt;) {</td></tr>
<tr><td class="h"><a name="2492"></a>2492</td><td></td><td></td><td></td><td></td><td class="s">      chomp;</td></tr>
<tr><td class="h"><a name="2493"></a>2493</td><td></td><td></td><td></td><td></td><td class="s">      my ($product_code, $qty, $price) = split /,/;</td></tr>
<tr><td class="h"><a name="2494"></a>2494</td><td></td><td></td><td></td><td></td><td class="s">      $sth-&gt;execute($product_code, $qty, $price) or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="2495"></a>2495</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2496"></a>2496</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;commit or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="2497"></a>2497</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2498"></a>2498</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/execute&gt; and L&lt;/bind_param&gt; for more details.</td></tr>
<tr><td class="h"><a name="2499"></a>2499</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2500"></a>2500</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;q{...}&gt; style quoting used in this example avoids clashing with</td></tr>
<tr><td class="h"><a name="2501"></a>2501</td><td></td><td></td><td></td><td></td><td class="s">quotes that may be used in the SQL statement. Use the double-quote like</td></tr>
<tr><td class="h"><a name="2502"></a>2502</td><td></td><td></td><td></td><td></td><td class="s">C&lt;qq{...}&gt; operator if you want to interpolate variables into the string.</td></tr>
<tr><td class="h"><a name="2503"></a>2503</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;perlop/&quot;Quote and Quote-like Operators&quot;&gt; for more details.</td></tr>
<tr><td class="h"><a name="2504"></a>2504</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2505"></a>2505</td><td></td><td></td><td></td><td></td><td class="s">See also the L&lt;/bind_columns&gt; method, which is used to associate Perl</td></tr>
<tr><td class="h"><a name="2506"></a>2506</td><td></td><td></td><td></td><td></td><td class="s">variables with the output columns of a C&lt;SELECT&gt; statement.</td></tr>
<tr><td class="h"><a name="2507"></a>2507</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2508"></a>2508</td><td></td><td></td><td></td><td></td><td class="s">=head1 THE DBI PACKAGE AND CLASS</td></tr>
<tr><td class="h"><a name="2509"></a>2509</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2510"></a>2510</td><td></td><td></td><td></td><td></td><td class="s">In this section, we cover the DBI class methods, utility functions,</td></tr>
<tr><td class="h"><a name="2511"></a>2511</td><td></td><td></td><td></td><td></td><td class="s">and the dynamic attributes associated with generic DBI handles.</td></tr>
<tr><td class="h"><a name="2512"></a>2512</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2513"></a>2513</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI Constants</td></tr>
<tr><td class="h"><a name="2514"></a>2514</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2515"></a>2515</td><td></td><td></td><td></td><td></td><td class="s">Constants representing the values of the SQL standard types can be</td></tr>
<tr><td class="h"><a name="2516"></a>2516</td><td></td><td></td><td></td><td></td><td class="s">imported individually by name, or all together by importing the</td></tr>
<tr><td class="h"><a name="2517"></a>2517</td><td></td><td></td><td></td><td></td><td class="s">special C&lt;:sql_types&gt; tag.</td></tr>
<tr><td class="h"><a name="2518"></a>2518</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2519"></a>2519</td><td></td><td></td><td></td><td></td><td class="s">The names and values of all the defined SQL standard types can be</td></tr>
<tr><td class="h"><a name="2520"></a>2520</td><td></td><td></td><td></td><td></td><td class="s">produced like this:</td></tr>
<tr><td class="h"><a name="2521"></a>2521</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2522"></a>2522</td><td></td><td></td><td></td><td></td><td class="s">  foreach (@{ $DBI::EXPORT_TAGS{sql_types} }) {</td></tr>
<tr><td class="h"><a name="2523"></a>2523</td><td></td><td></td><td></td><td></td><td class="s">    printf &quot;%s=%d\n&quot;, $_, &amp;{&quot;DBI::$_&quot;};</td></tr>
<tr><td class="h"><a name="2524"></a>2524</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2525"></a>2525</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2526"></a>2526</td><td></td><td></td><td></td><td></td><td class="s">These constants are defined by SQL/CLI, ODBC or both.</td></tr>
<tr><td class="h"><a name="2527"></a>2527</td><td></td><td></td><td></td><td></td><td class="s">C&lt;SQL_BIGINT&gt; is (currently) omitted, because SQL/CLI and ODBC provide</td></tr>
<tr><td class="h"><a name="2528"></a>2528</td><td></td><td></td><td></td><td></td><td class="s">conflicting codes.</td></tr>
<tr><td class="h"><a name="2529"></a>2529</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2530"></a>2530</td><td></td><td></td><td></td><td></td><td class="s">See the L&lt;/type_info&gt;, L&lt;/type_info_all&gt;, and L&lt;/bind_param&gt; methods</td></tr>
<tr><td class="h"><a name="2531"></a>2531</td><td></td><td></td><td></td><td></td><td class="s">for possible uses.</td></tr>
<tr><td class="h"><a name="2532"></a>2532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2533"></a>2533</td><td></td><td></td><td></td><td></td><td class="s">Note that just because the DBI defines a named constant for a given</td></tr>
<tr><td class="h"><a name="2534"></a>2534</td><td></td><td></td><td></td><td></td><td class="s">data type doesn't mean that drivers will support that data type.</td></tr>
<tr><td class="h"><a name="2535"></a>2535</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2536"></a>2536</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2537"></a>2537</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI Class Methods</td></tr>
<tr><td class="h"><a name="2538"></a>2538</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2539"></a>2539</td><td></td><td></td><td></td><td></td><td class="s">The following methods are provided by the DBI class:</td></tr>
<tr><td class="h"><a name="2540"></a>2540</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2541"></a>2541</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;parse_dsn&gt;</td></tr>
<tr><td class="h"><a name="2542"></a>2542</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2543"></a>2543</td><td></td><td></td><td></td><td></td><td class="s">  ($scheme, $driver, $attr_string, $attr_hash, $driver_dsn) = DBI-&gt;parse_dsn($dsn)</td></tr>
<tr><td class="h"><a name="2544"></a>2544</td><td></td><td></td><td></td><td></td><td class="s">      or die &quot;Can't parse DBI DSN '$dsn'&quot;;</td></tr>
<tr><td class="h"><a name="2545"></a>2545</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2546"></a>2546</td><td></td><td></td><td></td><td></td><td class="s">Breaks apart a DBI Data Source Name (DSN) and returns the individual</td></tr>
<tr><td class="h"><a name="2547"></a>2547</td><td></td><td></td><td></td><td></td><td class="s">parts. If $dsn doesn't contain a valid DSN then parse_dsn() returns</td></tr>
<tr><td class="h"><a name="2548"></a>2548</td><td></td><td></td><td></td><td></td><td class="s">an empty list.</td></tr>
<tr><td class="h"><a name="2549"></a>2549</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2550"></a>2550</td><td></td><td></td><td></td><td></td><td class="s">$scheme is the first part of the DSN and is currently always 'dbi'.</td></tr>
<tr><td class="h"><a name="2551"></a>2551</td><td></td><td></td><td></td><td></td><td class="s">$driver is the driver name, possibly defaulted to $ENV{DBI_DRIVER},</td></tr>
<tr><td class="h"><a name="2552"></a>2552</td><td></td><td></td><td></td><td></td><td class="s">and may be undefined.  $attr_string is the contents of the optional attribute</td></tr>
<tr><td class="h"><a name="2553"></a>2553</td><td></td><td></td><td></td><td></td><td class="s">string, which may be undefined.  If $attr_string is not empty then $attr_hash</td></tr>
<tr><td class="h"><a name="2554"></a>2554</td><td></td><td></td><td></td><td></td><td class="s">is a reference to a hash containing the parsed attribute names and values.</td></tr>
<tr><td class="h"><a name="2555"></a>2555</td><td></td><td></td><td></td><td></td><td class="s">$driver_dsn is the last part of the DBI DSN string. For example:</td></tr>
<tr><td class="h"><a name="2556"></a>2556</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2557"></a>2557</td><td></td><td></td><td></td><td></td><td class="s">  ($scheme, $driver, $attr_string, $attr_hash, $driver_dsn)</td></tr>
<tr><td class="h"><a name="2558"></a>2558</td><td></td><td></td><td></td><td></td><td class="s">      = DBI-&gt;parse_dsn(&quot;DBI:MyDriver(RaiseError=&gt;1):db=test;port=42&quot;);</td></tr>
<tr><td class="h"><a name="2559"></a>2559</td><td></td><td></td><td></td><td></td><td class="s">  $scheme      = 'dbi';</td></tr>
<tr><td class="h"><a name="2560"></a>2560</td><td></td><td></td><td></td><td></td><td class="s">  $driver      = 'MyDriver';</td></tr>
<tr><td class="h"><a name="2561"></a>2561</td><td></td><td></td><td></td><td></td><td class="s">  $attr_string = 'RaiseError=&gt;1';</td></tr>
<tr><td class="h"><a name="2562"></a>2562</td><td></td><td></td><td></td><td></td><td class="s">  $attr_hash   = { 'RaiseError' =&gt; '1' };</td></tr>
<tr><td class="h"><a name="2563"></a>2563</td><td></td><td></td><td></td><td></td><td class="s">  $driver_dsn  = 'db=test;port=42';</td></tr>
<tr><td class="h"><a name="2564"></a>2564</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2565"></a>2565</td><td></td><td></td><td></td><td></td><td class="s">The parse_dsn() method was added in DBI 1.43.</td></tr>
<tr><td class="h"><a name="2566"></a>2566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2567"></a>2567</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;connect&gt;</td></tr>
<tr><td class="h"><a name="2568"></a>2568</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2569"></a>2569</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($data_source, $username, $password)</td></tr>
<tr><td class="h"><a name="2570"></a>2570</td><td></td><td></td><td></td><td></td><td class="s">            or die $DBI::errstr;</td></tr>
<tr><td class="h"><a name="2571"></a>2571</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($data_source, $username, $password, \%attr)</td></tr>
<tr><td class="h"><a name="2572"></a>2572</td><td></td><td></td><td></td><td></td><td class="s">            or die $DBI::errstr;</td></tr>
<tr><td class="h"><a name="2573"></a>2573</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2574"></a>2574</td><td></td><td></td><td></td><td></td><td class="s">Establishes a database connection, or session, to the requested C&lt;$data_source&gt;.</td></tr>
<tr><td class="h"><a name="2575"></a>2575</td><td></td><td></td><td></td><td></td><td class="s">Returns a database handle object if the connection succeeds. Use</td></tr>
<tr><td class="h"><a name="2576"></a>2576</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$dbh-E&lt;gt&gt;disconnect&gt; to terminate the connection.</td></tr>
<tr><td class="h"><a name="2577"></a>2577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2578"></a>2578</td><td></td><td></td><td></td><td></td><td class="s">If the connect fails (see below), it returns C&lt;undef&gt; and sets both C&lt;$DBI::err&gt;</td></tr>
<tr><td class="h"><a name="2579"></a>2579</td><td></td><td></td><td></td><td></td><td class="s">and C&lt;$DBI::errstr&gt;. (It does I&lt;not&gt; explicitly set C&lt;$!&gt;.) You should generally</td></tr>
<tr><td class="h"><a name="2580"></a>2580</td><td></td><td></td><td></td><td></td><td class="s">test the return status of C&lt;connect&gt; and C&lt;print $DBI::errstr&gt; if it has failed.</td></tr>
<tr><td class="h"><a name="2581"></a>2581</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2582"></a>2582</td><td></td><td></td><td></td><td></td><td class="s">Multiple simultaneous connections to multiple databases through multiple</td></tr>
<tr><td class="h"><a name="2583"></a>2583</td><td></td><td></td><td></td><td></td><td class="s">drivers can be made via the DBI. Simply make one C&lt;connect&gt; call for each</td></tr>
<tr><td class="h"><a name="2584"></a>2584</td><td></td><td></td><td></td><td></td><td class="s">database and keep a copy of each returned database handle.</td></tr>
<tr><td class="h"><a name="2585"></a>2585</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2586"></a>2586</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$data_source&gt; value must begin with &quot;C&lt;dbi:&gt;I&lt;driver_name&gt;C&lt;:&gt;&quot;.</td></tr>
<tr><td class="h"><a name="2587"></a>2587</td><td></td><td></td><td></td><td></td><td class="s">The I&lt;driver_name&gt; specifies the driver that will be used to make the</td></tr>
<tr><td class="h"><a name="2588"></a>2588</td><td></td><td></td><td></td><td></td><td class="s">connection. (Letter case is significant.)</td></tr>
<tr><td class="h"><a name="2589"></a>2589</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2590"></a>2590</td><td></td><td></td><td></td><td></td><td class="s">As a convenience, if the C&lt;$data_source&gt; parameter is undefined or empty,</td></tr>
<tr><td class="h"><a name="2591"></a>2591</td><td></td><td></td><td></td><td></td><td class="s">the DBI will substitute the value of the environment variable C&lt;DBI_DSN&gt;.</td></tr>
<tr><td class="h"><a name="2592"></a>2592</td><td></td><td></td><td></td><td></td><td class="s">If just the I&lt;driver_name&gt; part is empty (i.e., the C&lt;$data_source&gt;</td></tr>
<tr><td class="h"><a name="2593"></a>2593</td><td></td><td></td><td></td><td></td><td class="s">prefix is &quot;C&lt;dbi::&gt;&quot;), the environment variable C&lt;DBI_DRIVER&gt; is</td></tr>
<tr><td class="h"><a name="2594"></a>2594</td><td></td><td></td><td></td><td></td><td class="s">used. If neither variable is set, then C&lt;connect&gt; dies.</td></tr>
<tr><td class="h"><a name="2595"></a>2595</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2596"></a>2596</td><td></td><td></td><td></td><td></td><td class="s">Examples of C&lt;$data_source&gt; values are:</td></tr>
<tr><td class="h"><a name="2597"></a>2597</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2598"></a>2598</td><td></td><td></td><td></td><td></td><td class="s">  dbi:DriverName:database_name</td></tr>
<tr><td class="h"><a name="2599"></a>2599</td><td></td><td></td><td></td><td></td><td class="s">  dbi:DriverName:database_name@hostname:port</td></tr>
<tr><td class="h"><a name="2600"></a>2600</td><td></td><td></td><td></td><td></td><td class="s">  dbi:DriverName:database=database_name;host=hostname;port=port</td></tr>
<tr><td class="h"><a name="2601"></a>2601</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2602"></a>2602</td><td></td><td></td><td></td><td></td><td class="s">There is I&lt;no standard&gt; for the text following the driver name. Each</td></tr>
<tr><td class="h"><a name="2603"></a>2603</td><td></td><td></td><td></td><td></td><td class="s">driver is free to use whatever syntax it wants. The only requirement the</td></tr>
<tr><td class="h"><a name="2604"></a>2604</td><td></td><td></td><td></td><td></td><td class="s">DBI makes is that all the information is supplied in a single string.</td></tr>
<tr><td class="h"><a name="2605"></a>2605</td><td></td><td></td><td></td><td></td><td class="s">You must consult the documentation for the drivers you are using for a</td></tr>
<tr><td class="h"><a name="2606"></a>2606</td><td></td><td></td><td></td><td></td><td class="s">description of the syntax they require.</td></tr>
<tr><td class="h"><a name="2607"></a>2607</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2608"></a>2608</td><td></td><td></td><td></td><td></td><td class="s">It is recommended that drivers support the ODBC style, shown in the</td></tr>
<tr><td class="h"><a name="2609"></a>2609</td><td></td><td></td><td></td><td></td><td class="s">last example above. It is also recommended that that they support the</td></tr>
<tr><td class="h"><a name="2610"></a>2610</td><td></td><td></td><td></td><td></td><td class="s">three common names 'C&lt;host&gt;', 'C&lt;port&gt;', and 'C&lt;database&gt;' (plus 'C&lt;db&gt;'</td></tr>
<tr><td class="h"><a name="2611"></a>2611</td><td></td><td></td><td></td><td></td><td class="s">as an alias for C&lt;database&gt;). This simplifies automatic construction</td></tr>
<tr><td class="h"><a name="2612"></a>2612</td><td></td><td></td><td></td><td></td><td class="s">of basic DSNs: C&lt;&quot;dbi:$driver:database=$db;host=$host;port=$port&quot;&gt;.</td></tr>
<tr><td class="h"><a name="2613"></a>2613</td><td></td><td></td><td></td><td></td><td class="s">Drivers should aim to 'do something reasonable' when given a DSN</td></tr>
<tr><td class="h"><a name="2614"></a>2614</td><td></td><td></td><td></td><td></td><td class="s">in this form, but if any part is meaningless for that driver (such</td></tr>
<tr><td class="h"><a name="2615"></a>2615</td><td></td><td></td><td></td><td></td><td class="s">as 'port' for Informix) it should generate an error if that part</td></tr>
<tr><td class="h"><a name="2616"></a>2616</td><td></td><td></td><td></td><td></td><td class="s">is not empty.</td></tr>
<tr><td class="h"><a name="2617"></a>2617</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2618"></a>2618</td><td></td><td></td><td></td><td></td><td class="s">If the environment variable C&lt;DBI_AUTOPROXY&gt; is defined (and the</td></tr>
<tr><td class="h"><a name="2619"></a>2619</td><td></td><td></td><td></td><td></td><td class="s">driver in C&lt;$data_source&gt; is not &quot;C&lt;Proxy&gt;&quot;) then the connect request</td></tr>
<tr><td class="h"><a name="2620"></a>2620</td><td></td><td></td><td></td><td></td><td class="s">will automatically be changed to:</td></tr>
<tr><td class="h"><a name="2621"></a>2621</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2622"></a>2622</td><td></td><td></td><td></td><td></td><td class="s">  $ENV{DBI_AUTOPROXY};dsn=$data_source</td></tr>
<tr><td class="h"><a name="2623"></a>2623</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2624"></a>2624</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DBI_AUTOPROXY&gt; is typically set as &quot;C&lt;dbi:Proxy:hostname=...;port=...&gt;&quot;.</td></tr>
<tr><td class="h"><a name="2625"></a>2625</td><td></td><td></td><td></td><td></td><td class="s">If $ENV{DBI_AUTOPROXY} doesn't begin with 'C&lt;dbi:&gt;' then &quot;dbi:Proxy:&quot;</td></tr>
<tr><td class="h"><a name="2626"></a>2626</td><td></td><td></td><td></td><td></td><td class="s">will be prepended to it first.  See the DBD::Proxy documentation</td></tr>
<tr><td class="h"><a name="2627"></a>2627</td><td></td><td></td><td></td><td></td><td class="s">for more details.</td></tr>
<tr><td class="h"><a name="2628"></a>2628</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2629"></a>2629</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;$username&gt; or C&lt;$password&gt; are undefined (rather than just empty),</td></tr>
<tr><td class="h"><a name="2630"></a>2630</td><td></td><td></td><td></td><td></td><td class="s">then the DBI will substitute the values of the C&lt;DBI_USER&gt; and C&lt;DBI_PASS&gt;</td></tr>
<tr><td class="h"><a name="2631"></a>2631</td><td></td><td></td><td></td><td></td><td class="s">environment variables, respectively.  The DBI will warn if the</td></tr>
<tr><td class="h"><a name="2632"></a>2632</td><td></td><td></td><td></td><td></td><td class="s">environment variables are not defined.  However, the everyday use</td></tr>
<tr><td class="h"><a name="2633"></a>2633</td><td></td><td></td><td></td><td></td><td class="s">of these environment variables is not recommended for security</td></tr>
<tr><td class="h"><a name="2634"></a>2634</td><td></td><td></td><td></td><td></td><td class="s">reasons. The mechanism is primarily intended to simplify testing.</td></tr>
<tr><td class="h"><a name="2635"></a>2635</td><td></td><td></td><td></td><td></td><td class="s">See below for alternative way to specify the username and password.</td></tr>
<tr><td class="h"><a name="2636"></a>2636</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2637"></a>2637</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DBI-E&lt;gt&gt;connect&gt; automatically installs the driver if it has not been</td></tr>
<tr><td class="h"><a name="2638"></a>2638</td><td></td><td></td><td></td><td></td><td class="s">installed yet. Driver installation either returns a valid driver</td></tr>
<tr><td class="h"><a name="2639"></a>2639</td><td></td><td></td><td></td><td></td><td class="s">handle, or it I&lt;dies&gt; with an error message that includes the string</td></tr>
<tr><td class="h"><a name="2640"></a>2640</td><td></td><td></td><td></td><td></td><td class="s">&quot;C&lt;install_driver&gt;&quot; and the underlying problem. So C&lt;DBI-E&lt;gt&gt;connect&gt;</td></tr>
<tr><td class="h"><a name="2641"></a>2641</td><td></td><td></td><td></td><td></td><td class="s">will die</td></tr>
<tr><td class="h"><a name="2642"></a>2642</td><td></td><td></td><td></td><td></td><td class="s">on a driver installation failure and will only return C&lt;undef&gt; on a</td></tr>
<tr><td class="h"><a name="2643"></a>2643</td><td></td><td></td><td></td><td></td><td class="s">connect failure, in which case C&lt;$DBI::errstr&gt; will hold the error message.</td></tr>
<tr><td class="h"><a name="2644"></a>2644</td><td></td><td></td><td></td><td></td><td class="s">Use C&lt;eval { ... }&gt; if you need to catch the &quot;C&lt;install_driver&gt;&quot; error.</td></tr>
<tr><td class="h"><a name="2645"></a>2645</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2646"></a>2646</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$data_source&gt; argument (with the &quot;C&lt;dbi:...:&gt;&quot; prefix removed) and the</td></tr>
<tr><td class="h"><a name="2647"></a>2647</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$username&gt; and C&lt;$password&gt; arguments are then passed to the driver for</td></tr>
<tr><td class="h"><a name="2648"></a>2648</td><td></td><td></td><td></td><td></td><td class="s">processing. The DBI does not define any interpretation for the</td></tr>
<tr><td class="h"><a name="2649"></a>2649</td><td></td><td></td><td></td><td></td><td class="s">contents of these fields.  The driver is free to interpret the</td></tr>
<tr><td class="h"><a name="2650"></a>2650</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$data_source&gt;, C&lt;$username&gt;, and C&lt;$password&gt; fields in any way, and supply</td></tr>
<tr><td class="h"><a name="2651"></a>2651</td><td></td><td></td><td></td><td></td><td class="s">whatever defaults are appropriate for the engine being accessed.</td></tr>
<tr><td class="h"><a name="2652"></a>2652</td><td></td><td></td><td></td><td></td><td class="s">(Oracle, for example, uses the ORACLE_SID and TWO_TASK environment</td></tr>
<tr><td class="h"><a name="2653"></a>2653</td><td></td><td></td><td></td><td></td><td class="s">variables if no C&lt;$data_source&gt; is specified.)</td></tr>
<tr><td class="h"><a name="2654"></a>2654</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2655"></a>2655</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;AutoCommit&gt; and C&lt;PrintError&gt; attributes for each connection</td></tr>
<tr><td class="h"><a name="2656"></a>2656</td><td></td><td></td><td></td><td></td><td class="s">default to &quot;on&quot;. (See L&lt;/AutoCommit&gt; and L&lt;/PrintError&gt; for more information.)</td></tr>
<tr><td class="h"><a name="2657"></a>2657</td><td></td><td></td><td></td><td></td><td class="s">However, it is strongly recommended that you explicitly define C&lt;AutoCommit&gt;</td></tr>
<tr><td class="h"><a name="2658"></a>2658</td><td></td><td></td><td></td><td></td><td class="s">rather than rely on the default. The C&lt;PrintWarn&gt; attribute defaults to</td></tr>
<tr><td class="h"><a name="2659"></a>2659</td><td></td><td></td><td></td><td></td><td class="s">on if $^W is true, i.e., perl is running with warnings enabled.</td></tr>
<tr><td class="h"><a name="2660"></a>2660</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2661"></a>2661</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;\%attr&gt; parameter can be used to alter the default settings of</td></tr>
<tr><td class="h"><a name="2662"></a>2662</td><td></td><td></td><td></td><td></td><td class="s">C&lt;PrintError&gt;, C&lt;RaiseError&gt;, C&lt;AutoCommit&gt;, and other attributes. For example:</td></tr>
<tr><td class="h"><a name="2663"></a>2663</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2664"></a>2664</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($data_source, $user, $pass, {</td></tr>
<tr><td class="h"><a name="2665"></a>2665</td><td></td><td></td><td></td><td></td><td class="s">        PrintError =&gt; 0,</td></tr>
<tr><td class="h"><a name="2666"></a>2666</td><td></td><td></td><td></td><td></td><td class="s">        AutoCommit =&gt; 0</td></tr>
<tr><td class="h"><a name="2667"></a>2667</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="2668"></a>2668</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2669"></a>2669</td><td></td><td></td><td></td><td></td><td class="s">The username and password can also be specified using the attributes</td></tr>
<tr><td class="h"><a name="2670"></a>2670</td><td></td><td></td><td></td><td></td><td class="s">C&lt;Username&gt; and C&lt;Password&gt;, in which case they take precedence</td></tr>
<tr><td class="h"><a name="2671"></a>2671</td><td></td><td></td><td></td><td></td><td class="s">over the C&lt;$username&gt; and C&lt;$password&gt; parameters.</td></tr>
<tr><td class="h"><a name="2672"></a>2672</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2673"></a>2673</td><td></td><td></td><td></td><td></td><td class="s">You can also define connection attribute values within the C&lt;$data_source&gt;</td></tr>
<tr><td class="h"><a name="2674"></a>2674</td><td></td><td></td><td></td><td></td><td class="s">parameter. For example:</td></tr>
<tr><td class="h"><a name="2675"></a>2675</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2676"></a>2676</td><td></td><td></td><td></td><td></td><td class="s">  dbi:DriverName(PrintWarn=&gt;1,PrintError=&gt;0,Taint=&gt;1):...</td></tr>
<tr><td class="h"><a name="2677"></a>2677</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2678"></a>2678</td><td></td><td></td><td></td><td></td><td class="s">Individual attributes values specified in this way take precedence over</td></tr>
<tr><td class="h"><a name="2679"></a>2679</td><td></td><td></td><td></td><td></td><td class="s">any conflicting values specified via the C&lt;\%attr&gt; parameter to C&lt;connect&gt;.</td></tr>
<tr><td class="h"><a name="2680"></a>2680</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2681"></a>2681</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;dbi_connect_method&gt; attribute can be used to specify which driver</td></tr>
<tr><td class="h"><a name="2682"></a>2682</td><td></td><td></td><td></td><td></td><td class="s">method should be called to establish the connection. The only useful</td></tr>
<tr><td class="h"><a name="2683"></a>2683</td><td></td><td></td><td></td><td></td><td class="s">values are 'connect', 'connect_cached', or some specialized case like</td></tr>
<tr><td class="h"><a name="2684"></a>2684</td><td></td><td></td><td></td><td></td><td class="s">'Apache::DBI::connect' (which is automatically the default when running</td></tr>
<tr><td class="h"><a name="2685"></a>2685</td><td></td><td></td><td></td><td></td><td class="s">within Apache).</td></tr>
<tr><td class="h"><a name="2686"></a>2686</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2687"></a>2687</td><td></td><td></td><td></td><td></td><td class="s">Where possible, each session (C&lt;$dbh&gt;) is independent from the transactions</td></tr>
<tr><td class="h"><a name="2688"></a>2688</td><td></td><td></td><td></td><td></td><td class="s">in other sessions. This is useful when you need to hold cursors open</td></tr>
<tr><td class="h"><a name="2689"></a>2689</td><td></td><td></td><td></td><td></td><td class="s">across transactions--for example, if you use one session for your long lifespan</td></tr>
<tr><td class="h"><a name="2690"></a>2690</td><td></td><td></td><td></td><td></td><td class="s">cursors (typically read-only) and another for your short update</td></tr>
<tr><td class="h"><a name="2691"></a>2691</td><td></td><td></td><td></td><td></td><td class="s">transactions.</td></tr>
<tr><td class="h"><a name="2692"></a>2692</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2693"></a>2693</td><td></td><td></td><td></td><td></td><td class="s">For compatibility with old DBI scripts, the driver can be specified by</td></tr>
<tr><td class="h"><a name="2694"></a>2694</td><td></td><td></td><td></td><td></td><td class="s">passing its name as the fourth argument to C&lt;connect&gt; (instead of C&lt;\%attr&gt;):</td></tr>
<tr><td class="h"><a name="2695"></a>2695</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2696"></a>2696</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect($data_source, $user, $pass, $driver);</td></tr>
<tr><td class="h"><a name="2697"></a>2697</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2698"></a>2698</td><td></td><td></td><td></td><td></td><td class="s">In this &quot;old-style&quot; form of C&lt;connect&gt;, the C&lt;$data_source&gt; should not start</td></tr>
<tr><td class="h"><a name="2699"></a>2699</td><td></td><td></td><td></td><td></td><td class="s">with &quot;C&lt;dbi:driver_name:&gt;&quot;. (If it does, the embedded driver_name</td></tr>
<tr><td class="h"><a name="2700"></a>2700</td><td></td><td></td><td></td><td></td><td class="s">will be ignored). Also note that in this older form of C&lt;connect&gt;,</td></tr>
<tr><td class="h"><a name="2701"></a>2701</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;$dbh-E&lt;gt&gt;{AutoCommit}&gt; attribute is I&lt;undefined&gt;, the</td></tr>
<tr><td class="h"><a name="2702"></a>2702</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$dbh-E&lt;gt&gt;{PrintError}&gt; attribute is off, and the old C&lt;DBI_DBNAME&gt;</td></tr>
<tr><td class="h"><a name="2703"></a>2703</td><td></td><td></td><td></td><td></td><td class="s">environment variable is</td></tr>
<tr><td class="h"><a name="2704"></a>2704</td><td></td><td></td><td></td><td></td><td class="s">checked if C&lt;DBI_DSN&gt; is not defined. Beware that this &quot;old-style&quot;</td></tr>
<tr><td class="h"><a name="2705"></a>2705</td><td></td><td></td><td></td><td></td><td class="s">C&lt;connect&gt; will soon be withdrawn in a future version of DBI.</td></tr>
<tr><td class="h"><a name="2706"></a>2706</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2707"></a>2707</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;connect_cached&gt;</td></tr>
<tr><td class="h"><a name="2708"></a>2708</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2709"></a>2709</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect_cached($data_source, $username, $password)</td></tr>
<tr><td class="h"><a name="2710"></a>2710</td><td></td><td></td><td></td><td></td><td class="s">            or die $DBI::errstr;</td></tr>
<tr><td class="h"><a name="2711"></a>2711</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect_cached($data_source, $username, $password, \%attr)</td></tr>
<tr><td class="h"><a name="2712"></a>2712</td><td></td><td></td><td></td><td></td><td class="s">            or die $DBI::errstr;</td></tr>
<tr><td class="h"><a name="2713"></a>2713</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2714"></a>2714</td><td></td><td></td><td></td><td></td><td class="s">C&lt;connect_cached&gt; is like L&lt;/connect&gt;, except that the database handle</td></tr>
<tr><td class="h"><a name="2715"></a>2715</td><td></td><td></td><td></td><td></td><td class="s">returned is also</td></tr>
<tr><td class="h"><a name="2716"></a>2716</td><td></td><td></td><td></td><td></td><td class="s">stored in a hash associated with the given parameters. If another call</td></tr>
<tr><td class="h"><a name="2717"></a>2717</td><td></td><td></td><td></td><td></td><td class="s">is made to C&lt;connect_cached&gt; with the same parameter values, then the</td></tr>
<tr><td class="h"><a name="2718"></a>2718</td><td></td><td></td><td></td><td></td><td class="s">corresponding cached C&lt;$dbh&gt; will be returned if it is still valid.</td></tr>
<tr><td class="h"><a name="2719"></a>2719</td><td></td><td></td><td></td><td></td><td class="s">The cached database handle is replaced with a new connection if it</td></tr>
<tr><td class="h"><a name="2720"></a>2720</td><td></td><td></td><td></td><td></td><td class="s">has been disconnected or if the C&lt;ping&gt; method fails.</td></tr>
<tr><td class="h"><a name="2721"></a>2721</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2722"></a>2722</td><td></td><td></td><td></td><td></td><td class="s">That the behaviour of this method differs in several respects from the</td></tr>
<tr><td class="h"><a name="2723"></a>2723</td><td></td><td></td><td></td><td></td><td class="s">behaviour of persistent connections implemented by Apache::DBI.</td></tr>
<tr><td class="h"><a name="2724"></a>2724</td><td></td><td></td><td></td><td></td><td class="s">However, if Apache::DBI is loaded then C&lt;connect_cached&gt; will use it.</td></tr>
<tr><td class="h"><a name="2725"></a>2725</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2726"></a>2726</td><td></td><td></td><td></td><td></td><td class="s">Caching connections can be useful in some applications, but it can</td></tr>
<tr><td class="h"><a name="2727"></a>2727</td><td></td><td></td><td></td><td></td><td class="s">also cause problems, such as too many connections, and so should</td></tr>
<tr><td class="h"><a name="2728"></a>2728</td><td></td><td></td><td></td><td></td><td class="s">be used with care. In particular, avoid changing the attributes of</td></tr>
<tr><td class="h"><a name="2729"></a>2729</td><td></td><td></td><td></td><td></td><td class="s">a database handle created via connect_cached() because it will affect</td></tr>
<tr><td class="h"><a name="2730"></a>2730</td><td></td><td></td><td></td><td></td><td class="s">other code that may be using the same handle.</td></tr>
<tr><td class="h"><a name="2731"></a>2731</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2732"></a>2732</td><td></td><td></td><td></td><td></td><td class="s">Where multiple separate parts of a program are using connect_cached()</td></tr>
<tr><td class="h"><a name="2733"></a>2733</td><td></td><td></td><td></td><td></td><td class="s">to connect to the same database with the same (initial) attributes</td></tr>
<tr><td class="h"><a name="2734"></a>2734</td><td></td><td></td><td></td><td></td><td class="s">it is a good idea to add a private attribute to the connect_cached()</td></tr>
<tr><td class="h"><a name="2735"></a>2735</td><td></td><td></td><td></td><td></td><td class="s">call to effectively limit the scope of the caching. For example:</td></tr>
<tr><td class="h"><a name="2736"></a>2736</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2737"></a>2737</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;connect_cached(..., { private_foo_cachekey =&gt; &quot;Bar&quot;, ... });</td></tr>
<tr><td class="h"><a name="2738"></a>2738</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2739"></a>2739</td><td></td><td></td><td></td><td></td><td class="s">Handles returned from that connect_cached() call will only be returned</td></tr>
<tr><td class="h"><a name="2740"></a>2740</td><td></td><td></td><td></td><td></td><td class="s">by other connect_cached() call elsewhere in the code if those other</td></tr>
<tr><td class="h"><a name="2741"></a>2741</td><td></td><td></td><td></td><td></td><td class="s">calls also pass in the same attribute values, including the private one.</td></tr>
<tr><td class="h"><a name="2742"></a>2742</td><td></td><td></td><td></td><td></td><td class="s">(I've used C&lt;private_foo_cachekey&gt; here as an example, you can use</td></tr>
<tr><td class="h"><a name="2743"></a>2743</td><td></td><td></td><td></td><td></td><td class="s">any attribute name with a C&lt;private_&gt; prefix.)</td></tr>
<tr><td class="h"><a name="2744"></a>2744</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2745"></a>2745</td><td></td><td></td><td></td><td></td><td class="s">Taking that one step further, you can limit a particular connect_cached()</td></tr>
<tr><td class="h"><a name="2746"></a>2746</td><td></td><td></td><td></td><td></td><td class="s">call to return handles unique to that one place in the code by setting the</td></tr>
<tr><td class="h"><a name="2747"></a>2747</td><td></td><td></td><td></td><td></td><td class="s">private attribute to a unique value for that place:</td></tr>
<tr><td class="h"><a name="2748"></a>2748</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2749"></a>2749</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;connect_cached(..., { private_foo_cachekey =&gt; __FILE__.__LINE__, ... });</td></tr>
<tr><td class="h"><a name="2750"></a>2750</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2751"></a>2751</td><td></td><td></td><td></td><td></td><td class="s">By using a private attribute you still get connection caching for</td></tr>
<tr><td class="h"><a name="2752"></a>2752</td><td></td><td></td><td></td><td></td><td class="s">the individual calls to connect_cached() but, by making separate</td></tr>
<tr><td class="h"><a name="2753"></a>2753</td><td></td><td></td><td></td><td></td><td class="s">database conections for separate parts of the code, the database</td></tr>
<tr><td class="h"><a name="2754"></a>2754</td><td></td><td></td><td></td><td></td><td class="s">handles are isolated from any attribute changes made to other handles.</td></tr>
<tr><td class="h"><a name="2755"></a>2755</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2756"></a>2756</td><td></td><td></td><td></td><td></td><td class="s">The cache can be accessed (and cleared) via the L&lt;/CachedKids&gt; attribute:</td></tr>
<tr><td class="h"><a name="2757"></a>2757</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2758"></a>2758</td><td></td><td></td><td></td><td></td><td class="s">  my $CachedKids_hashref = $dbh-&gt;{Driver}-&gt;{CachedKids};</td></tr>
<tr><td class="h"><a name="2759"></a>2759</td><td></td><td></td><td></td><td></td><td class="s">  %$CachedKids_hashref = () if $CachedKids_hashref;</td></tr>
<tr><td class="h"><a name="2760"></a>2760</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2761"></a>2761</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2762"></a>2762</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;available_drivers&gt;</td></tr>
<tr><td class="h"><a name="2763"></a>2763</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2764"></a>2764</td><td></td><td></td><td></td><td></td><td class="s">  @ary = DBI-&gt;available_drivers;</td></tr>
<tr><td class="h"><a name="2765"></a>2765</td><td></td><td></td><td></td><td></td><td class="s">  @ary = DBI-&gt;available_drivers($quiet);</td></tr>
<tr><td class="h"><a name="2766"></a>2766</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2767"></a>2767</td><td></td><td></td><td></td><td></td><td class="s">Returns a list of all available drivers by searching for C&lt;DBD::*&gt; modules</td></tr>
<tr><td class="h"><a name="2768"></a>2768</td><td></td><td></td><td></td><td></td><td class="s">through the directories in C&lt;@INC&gt;. By default, a warning is given if</td></tr>
<tr><td class="h"><a name="2769"></a>2769</td><td></td><td></td><td></td><td></td><td class="s">some drivers are hidden by others of the same name in earlier</td></tr>
<tr><td class="h"><a name="2770"></a>2770</td><td></td><td></td><td></td><td></td><td class="s">directories. Passing a true value for C&lt;$quiet&gt; will inhibit the warning.</td></tr>
<tr><td class="h"><a name="2771"></a>2771</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2772"></a>2772</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;installed_drivers&gt;</td></tr>
<tr><td class="h"><a name="2773"></a>2773</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2774"></a>2774</td><td></td><td></td><td></td><td></td><td class="s">  %drivers = DBI-&gt;installed_drivers();</td></tr>
<tr><td class="h"><a name="2775"></a>2775</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2776"></a>2776</td><td></td><td></td><td></td><td></td><td class="s">Returns a list of driver name and driver handle pairs for all drivers</td></tr>
<tr><td class="h"><a name="2777"></a>2777</td><td></td><td></td><td></td><td></td><td class="s">'installed' (loaded) into the current process.  The driver name does not</td></tr>
<tr><td class="h"><a name="2778"></a>2778</td><td></td><td></td><td></td><td></td><td class="s">include the 'DBD::' prefix.</td></tr>
<tr><td class="h"><a name="2779"></a>2779</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2780"></a>2780</td><td></td><td></td><td></td><td></td><td class="s">To get a list of all drivers available in your perl instalation you can use</td></tr>
<tr><td class="h"><a name="2781"></a>2781</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/available_drivers&gt;.</td></tr>
<tr><td class="h"><a name="2782"></a>2782</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2783"></a>2783</td><td></td><td></td><td></td><td></td><td class="s">Added in DBI 1.49.</td></tr>
<tr><td class="h"><a name="2784"></a>2784</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2785"></a>2785</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;installed_versions&gt;</td></tr>
<tr><td class="h"><a name="2786"></a>2786</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2787"></a>2787</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;installed_versions;</td></tr>
<tr><td class="h"><a name="2788"></a>2788</td><td></td><td></td><td></td><td></td><td class="s">  @ary  = DBI-&gt;installed_versions;</td></tr>
<tr><td class="h"><a name="2789"></a>2789</td><td></td><td></td><td></td><td></td><td class="s">  %hash = DBI-&gt;installed_versions;</td></tr>
<tr><td class="h"><a name="2790"></a>2790</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2791"></a>2791</td><td></td><td></td><td></td><td></td><td class="s">Calls available_drivers() and attempts to load each of them in turn</td></tr>
<tr><td class="h"><a name="2792"></a>2792</td><td></td><td></td><td></td><td></td><td class="s">using install_driver().  For each load that succeeds the driver</td></tr>
<tr><td class="h"><a name="2793"></a>2793</td><td></td><td></td><td></td><td></td><td class="s">name and version number are added to a hash. When running under</td></tr>
<tr><td class="h"><a name="2794"></a>2794</td><td></td><td></td><td></td><td></td><td class="s">L&lt;DBI::PurePerl&gt; drivers which appear not be pure-perl are ignored.</td></tr>
<tr><td class="h"><a name="2795"></a>2795</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2796"></a>2796</td><td></td><td></td><td></td><td></td><td class="s">When called in array context the list of successfully loaded drivers</td></tr>
<tr><td class="h"><a name="2797"></a>2797</td><td></td><td></td><td></td><td></td><td class="s">is returned (without the 'DBD::' prefix).</td></tr>
<tr><td class="h"><a name="2798"></a>2798</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2799"></a>2799</td><td></td><td></td><td></td><td></td><td class="s">When called in scalar context a reference to the hash is returned</td></tr>
<tr><td class="h"><a name="2800"></a>2800</td><td></td><td></td><td></td><td></td><td class="s">and the hash will also contain other entries for the C&lt;DBI&gt; version,</td></tr>
<tr><td class="h"><a name="2801"></a>2801</td><td></td><td></td><td></td><td></td><td class="s">C&lt;OS&gt; name, etc.</td></tr>
<tr><td class="h"><a name="2802"></a>2802</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2803"></a>2803</td><td></td><td></td><td></td><td></td><td class="s">When called in a void context the installed_versions() method will</td></tr>
<tr><td class="h"><a name="2804"></a>2804</td><td></td><td></td><td></td><td></td><td class="s">print out a formatted list of the hash contents, one per line.</td></tr>
<tr><td class="h"><a name="2805"></a>2805</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2806"></a>2806</td><td></td><td></td><td></td><td></td><td class="s">Due to the potentially high memory cost and unknown risks of loading</td></tr>
<tr><td class="h"><a name="2807"></a>2807</td><td></td><td></td><td></td><td></td><td class="s">in an unknown number of drivers that just happen to be installed</td></tr>
<tr><td class="h"><a name="2808"></a>2808</td><td></td><td></td><td></td><td></td><td class="s">on the system, this method is not recommended for general use.</td></tr>
<tr><td class="h"><a name="2809"></a>2809</td><td></td><td></td><td></td><td></td><td class="s">Use available_drivers() instead.</td></tr>
<tr><td class="h"><a name="2810"></a>2810</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2811"></a>2811</td><td></td><td></td><td></td><td></td><td class="s">The installed_versions() method is primarily intended as a quick</td></tr>
<tr><td class="h"><a name="2812"></a>2812</td><td></td><td></td><td></td><td></td><td class="s">way to see from the command line what's installed. For example:</td></tr>
<tr><td class="h"><a name="2813"></a>2813</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2814"></a>2814</td><td></td><td></td><td></td><td></td><td class="s">  perl -MDBI -e 'DBI-&gt;installed_versions'</td></tr>
<tr><td class="h"><a name="2815"></a>2815</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2816"></a>2816</td><td></td><td></td><td></td><td></td><td class="s">The installed_versions() method was added in DBI 1.38.</td></tr>
<tr><td class="h"><a name="2817"></a>2817</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2818"></a>2818</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;data_sources&gt;</td></tr>
<tr><td class="h"><a name="2819"></a>2819</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2820"></a>2820</td><td></td><td></td><td></td><td></td><td class="s">  @ary = DBI-&gt;data_sources($driver);</td></tr>
<tr><td class="h"><a name="2821"></a>2821</td><td></td><td></td><td></td><td></td><td class="s">  @ary = DBI-&gt;data_sources($driver, \%attr);</td></tr>
<tr><td class="h"><a name="2822"></a>2822</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2823"></a>2823</td><td></td><td></td><td></td><td></td><td class="s">Returns a list of data sources (databases) available via the named</td></tr>
<tr><td class="h"><a name="2824"></a>2824</td><td></td><td></td><td></td><td></td><td class="s">driver.  If C&lt;$driver&gt; is empty or C&lt;undef&gt;, then the value of the</td></tr>
<tr><td class="h"><a name="2825"></a>2825</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DBI_DRIVER&gt; environment variable is used.</td></tr>
<tr><td class="h"><a name="2826"></a>2826</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2827"></a>2827</td><td></td><td></td><td></td><td></td><td class="s">The driver will be loaded if it hasn't been already. Note that if the</td></tr>
<tr><td class="h"><a name="2828"></a>2828</td><td></td><td></td><td></td><td></td><td class="s">driver loading fails then data_sources() I&lt;dies&gt; with an error message</td></tr>
<tr><td class="h"><a name="2829"></a>2829</td><td></td><td></td><td></td><td></td><td class="s">that includes the string &quot;C&lt;install_driver&gt;&quot; and the underlying problem.</td></tr>
<tr><td class="h"><a name="2830"></a>2830</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2831"></a>2831</td><td></td><td></td><td></td><td></td><td class="s">Data sources are returned in a form suitable for passing to the</td></tr>
<tr><td class="h"><a name="2832"></a>2832</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/connect&gt; method (that is, they will include the &quot;C&lt;dbi:$driver:&gt;&quot; prefix).</td></tr>
<tr><td class="h"><a name="2833"></a>2833</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2834"></a>2834</td><td></td><td></td><td></td><td></td><td class="s">Note that many drivers have no way of knowing what data sources might</td></tr>
<tr><td class="h"><a name="2835"></a>2835</td><td></td><td></td><td></td><td></td><td class="s">be available for it. These drivers return an empty or incomplete list</td></tr>
<tr><td class="h"><a name="2836"></a>2836</td><td></td><td></td><td></td><td></td><td class="s">or may require driver-specific attributes.</td></tr>
<tr><td class="h"><a name="2837"></a>2837</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2838"></a>2838</td><td></td><td></td><td></td><td></td><td class="s">There is also a data_sources() method defined for database handles.</td></tr>
<tr><td class="h"><a name="2839"></a>2839</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2840"></a>2840</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2841"></a>2841</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;trace&gt;</td></tr>
<tr><td class="h"><a name="2842"></a>2842</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2843"></a>2843</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;trace($trace_setting)</td></tr>
<tr><td class="h"><a name="2844"></a>2844</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;trace($trace_setting, $trace_filename)</td></tr>
<tr><td class="h"><a name="2845"></a>2845</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;trace($trace_setting, $trace_filehandle)</td></tr>
<tr><td class="h"><a name="2846"></a>2846</td><td></td><td></td><td></td><td></td><td class="s">  $trace_setting = DBI-&gt;trace;</td></tr>
<tr><td class="h"><a name="2847"></a>2847</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2848"></a>2848</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;DBI-E&lt;gt&gt;trace&gt; method sets the I&lt;global default&gt; trace</td></tr>
<tr><td class="h"><a name="2849"></a>2849</td><td></td><td></td><td></td><td></td><td class="s">settings and returns the I&lt;previous&gt; trace settings. It can also</td></tr>
<tr><td class="h"><a name="2850"></a>2850</td><td></td><td></td><td></td><td></td><td class="s">be used to change where the trace output is sent.</td></tr>
<tr><td class="h"><a name="2851"></a>2851</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2852"></a>2852</td><td></td><td></td><td></td><td></td><td class="s">There's a similar method, C&lt;$h-E&lt;gt&gt;trace&gt;, which sets the trace</td></tr>
<tr><td class="h"><a name="2853"></a>2853</td><td></td><td></td><td></td><td></td><td class="s">settings for the specific handle it's called on.</td></tr>
<tr><td class="h"><a name="2854"></a>2854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2855"></a>2855</td><td></td><td></td><td></td><td></td><td class="s">See the L&lt;/TRACING&gt; section for full details about the DBI's powerful</td></tr>
<tr><td class="h"><a name="2856"></a>2856</td><td></td><td></td><td></td><td></td><td class="s">tracing facilities.</td></tr>
<tr><td class="h"><a name="2857"></a>2857</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2858"></a>2858</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2859"></a>2859</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2860"></a>2860</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI Utility Functions</td></tr>
<tr><td class="h"><a name="2861"></a>2861</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2862"></a>2862</td><td></td><td></td><td></td><td></td><td class="s">In addition to the DBI methods listed in the previous section,</td></tr>
<tr><td class="h"><a name="2863"></a>2863</td><td></td><td></td><td></td><td></td><td class="s">the DBI package also provides several utility functions.</td></tr>
<tr><td class="h"><a name="2864"></a>2864</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2865"></a>2865</td><td></td><td></td><td></td><td></td><td class="s">These can be imported into your code by listing them in</td></tr>
<tr><td class="h"><a name="2866"></a>2866</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;use&gt; statement. For example:</td></tr>
<tr><td class="h"><a name="2867"></a>2867</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2868"></a>2868</td><td></td><td></td><td></td><td></td><td class="s">  use DBI qw(neat data_diff);</td></tr>
<tr><td class="h"><a name="2869"></a>2869</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2870"></a>2870</td><td></td><td></td><td></td><td></td><td class="s">Alternatively, all these utility functions (except hash) can be</td></tr>
<tr><td class="h"><a name="2871"></a>2871</td><td></td><td></td><td></td><td></td><td class="s">imported using the C&lt;:utils&gt; import tag. For example:</td></tr>
<tr><td class="h"><a name="2872"></a>2872</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2873"></a>2873</td><td></td><td></td><td></td><td></td><td class="s">  use DBI qw(:utils);</td></tr>
<tr><td class="h"><a name="2874"></a>2874</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2875"></a>2875</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;data_string_desc&gt;</td></tr>
<tr><td class="h"><a name="2876"></a>2876</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2877"></a>2877</td><td></td><td></td><td></td><td></td><td class="s">  $description = data_string_desc($string);</td></tr>
<tr><td class="h"><a name="2878"></a>2878</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2879"></a>2879</td><td></td><td></td><td></td><td></td><td class="s">Returns an informal description of the string. For example:</td></tr>
<tr><td class="h"><a name="2880"></a>2880</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2881"></a>2881</td><td></td><td></td><td></td><td></td><td class="s">  UTF8 off, ASCII, 42 characters 42 bytes</td></tr>
<tr><td class="h"><a name="2882"></a>2882</td><td></td><td></td><td></td><td></td><td class="s">  UTF8 off, non-ASCII, 42 characters 42 bytes</td></tr>
<tr><td class="h"><a name="2883"></a>2883</td><td></td><td></td><td></td><td></td><td class="s">  UTF8 on, non-ASCII, 4 characters 6 bytes</td></tr>
<tr><td class="h"><a name="2884"></a>2884</td><td></td><td></td><td></td><td></td><td class="s">  UTF8 on but INVALID encoding, non-ASCII, 4 characters 6 bytes</td></tr>
<tr><td class="h"><a name="2885"></a>2885</td><td></td><td></td><td></td><td></td><td class="s">  UTF8 off, undef</td></tr>
<tr><td class="h"><a name="2886"></a>2886</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2887"></a>2887</td><td></td><td></td><td></td><td></td><td class="s">The initial C&lt;UTF8&gt; on/off refers to Perl's internal SvUTF8 flag.</td></tr>
<tr><td class="h"><a name="2888"></a>2888</td><td></td><td></td><td></td><td></td><td class="s">If $string has the SvUTF8 flag set but the sequence of bytes it</td></tr>
<tr><td class="h"><a name="2889"></a>2889</td><td></td><td></td><td></td><td></td><td class="s">contains are not a valid UTF-8 encoding then data_string_desc()</td></tr>
<tr><td class="h"><a name="2890"></a>2890</td><td></td><td></td><td></td><td></td><td class="s">will report C&lt;UTF8 on but INVALID encoding&gt;.</td></tr>
<tr><td class="h"><a name="2891"></a>2891</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2892"></a>2892</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ASCII&gt; vs C&lt;non-ASCII&gt; portion shows C&lt;ASCII&gt; if I&lt;all&gt; the</td></tr>
<tr><td class="h"><a name="2893"></a>2893</td><td></td><td></td><td></td><td></td><td class="s">characters in the string are ASCII (have code points &lt;= 127).</td></tr>
<tr><td class="h"><a name="2894"></a>2894</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2895"></a>2895</td><td></td><td></td><td></td><td></td><td class="s">The data_string_desc() function was added in DBI 1.46.</td></tr>
<tr><td class="h"><a name="2896"></a>2896</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2897"></a>2897</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;data_string_diff&gt;</td></tr>
<tr><td class="h"><a name="2898"></a>2898</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2899"></a>2899</td><td></td><td></td><td></td><td></td><td class="s">  $diff = data_string_diff($a, $b);</td></tr>
<tr><td class="h"><a name="2900"></a>2900</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2901"></a>2901</td><td></td><td></td><td></td><td></td><td class="s">Returns an informal description of the first character difference</td></tr>
<tr><td class="h"><a name="2902"></a>2902</td><td></td><td></td><td></td><td></td><td class="s">between the strings. If both $a and $b contain the same sequence</td></tr>
<tr><td class="h"><a name="2903"></a>2903</td><td></td><td></td><td></td><td></td><td class="s">of characters then data_string_diff() returns an empty string.</td></tr>
<tr><td class="h"><a name="2904"></a>2904</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="2905"></a>2905</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2906"></a>2906</td><td></td><td></td><td></td><td></td><td class="s"> Params a &amp; b     Result</td></tr>
<tr><td class="h"><a name="2907"></a>2907</td><td></td><td></td><td></td><td></td><td class="s"> ------------     ------</td></tr>
<tr><td class="h"><a name="2908"></a>2908</td><td></td><td></td><td></td><td></td><td class="s"> 'aaa', 'aaa'     ''</td></tr>
<tr><td class="h"><a name="2909"></a>2909</td><td></td><td></td><td></td><td></td><td class="s"> 'aaa', 'abc'     'Strings differ at index 2: a[2]=a, b[2]=b'</td></tr>
<tr><td class="h"><a name="2910"></a>2910</td><td></td><td></td><td></td><td></td><td class="s"> 'aaa', undef     'String b is undef, string a has 3 characters'</td></tr>
<tr><td class="h"><a name="2911"></a>2911</td><td></td><td></td><td></td><td></td><td class="s"> 'aaa', 'aa'      'String b truncated after 2 characters'</td></tr>
<tr><td class="h"><a name="2912"></a>2912</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2913"></a>2913</td><td></td><td></td><td></td><td></td><td class="s">Unicode characters are reported in C&lt;\x{XXXX}&gt; format. Unicode</td></tr>
<tr><td class="h"><a name="2914"></a>2914</td><td></td><td></td><td></td><td></td><td class="s">code points in the range U+0800 to U+08FF are unassigned and most</td></tr>
<tr><td class="h"><a name="2915"></a>2915</td><td></td><td></td><td></td><td></td><td class="s">likely to occur due to double-encoding. Characters in this range</td></tr>
<tr><td class="h"><a name="2916"></a>2916</td><td></td><td></td><td></td><td></td><td class="s">are reported as C&lt;\x{08XX}='C'&gt; where C&lt;C&gt; is the corresponding</td></tr>
<tr><td class="h"><a name="2917"></a>2917</td><td></td><td></td><td></td><td></td><td class="s">latin-1 character.</td></tr>
<tr><td class="h"><a name="2918"></a>2918</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2919"></a>2919</td><td></td><td></td><td></td><td></td><td class="s">The data_string_diff() function only considers logical I&lt;characters&gt;</td></tr>
<tr><td class="h"><a name="2920"></a>2920</td><td></td><td></td><td></td><td></td><td class="s">and not the underlying encoding. See L&lt;/data_diff&gt; for an alternative.</td></tr>
<tr><td class="h"><a name="2921"></a>2921</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2922"></a>2922</td><td></td><td></td><td></td><td></td><td class="s">The data_string_diff() function was added in DBI 1.46.</td></tr>
<tr><td class="h"><a name="2923"></a>2923</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2924"></a>2924</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;data_diff&gt;</td></tr>
<tr><td class="h"><a name="2925"></a>2925</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2926"></a>2926</td><td></td><td></td><td></td><td></td><td class="s">  $diff = data_diff($a, $b);</td></tr>
<tr><td class="h"><a name="2927"></a>2927</td><td></td><td></td><td></td><td></td><td class="s">  $diff = data_diff($a, $b, $logical);</td></tr>
<tr><td class="h"><a name="2928"></a>2928</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2929"></a>2929</td><td></td><td></td><td></td><td></td><td class="s">Returns an informal description of the difference between two strings.</td></tr>
<tr><td class="h"><a name="2930"></a>2930</td><td></td><td></td><td></td><td></td><td class="s">It calls L&lt;/data_string_desc&gt; and L&lt;/data_string_diff&gt;</td></tr>
<tr><td class="h"><a name="2931"></a>2931</td><td></td><td></td><td></td><td></td><td class="s">and returns the combined results as a multi-line string.</td></tr>
<tr><td class="h"><a name="2932"></a>2932</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2933"></a>2933</td><td></td><td></td><td></td><td></td><td class="s">For example, C&lt;data_diff(&quot;abc&quot;, &quot;ab\x{263a}&quot;)&gt; will return:</td></tr>
<tr><td class="h"><a name="2934"></a>2934</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2935"></a>2935</td><td></td><td></td><td></td><td></td><td class="s">  a: UTF8 off, ASCII, 3 characters 3 bytes</td></tr>
<tr><td class="h"><a name="2936"></a>2936</td><td></td><td></td><td></td><td></td><td class="s">  b: UTF8 on, non-ASCII, 3 characters 5 bytes</td></tr>
<tr><td class="h"><a name="2937"></a>2937</td><td></td><td></td><td></td><td></td><td class="s">  Strings differ at index 2: a[2]=c, b[2]=\x{263A}</td></tr>
<tr><td class="h"><a name="2938"></a>2938</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2939"></a>2939</td><td></td><td></td><td></td><td></td><td class="s">If $a and $b are identical in both the characters they contain I&lt;and&gt;</td></tr>
<tr><td class="h"><a name="2940"></a>2940</td><td></td><td></td><td></td><td></td><td class="s">their physical encoding then data_diff() returns an empty string.</td></tr>
<tr><td class="h"><a name="2941"></a>2941</td><td></td><td></td><td></td><td></td><td class="s">If $logical is true then physical encoding differences are ignored</td></tr>
<tr><td class="h"><a name="2942"></a>2942</td><td></td><td></td><td></td><td></td><td class="s">(but are still reported if there is a difference in the characters).</td></tr>
<tr><td class="h"><a name="2943"></a>2943</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2944"></a>2944</td><td></td><td></td><td></td><td></td><td class="s">The data_diff() function was added in DBI 1.46.</td></tr>
<tr><td class="h"><a name="2945"></a>2945</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2946"></a>2946</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;neat&gt;</td></tr>
<tr><td class="h"><a name="2947"></a>2947</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2948"></a>2948</td><td></td><td></td><td></td><td></td><td class="s">  $str = neat($value);</td></tr>
<tr><td class="h"><a name="2949"></a>2949</td><td></td><td></td><td></td><td></td><td class="s">  $str = neat($value, $maxlen);</td></tr>
<tr><td class="h"><a name="2950"></a>2950</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2951"></a>2951</td><td></td><td></td><td></td><td></td><td class="s">Return a string containing a neat (and tidy) representation of the</td></tr>
<tr><td class="h"><a name="2952"></a>2952</td><td></td><td></td><td></td><td></td><td class="s">supplied value.</td></tr>
<tr><td class="h"><a name="2953"></a>2953</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2954"></a>2954</td><td></td><td></td><td></td><td></td><td class="s">Strings will be quoted, although internal quotes will I&lt;not&gt; be escaped.</td></tr>
<tr><td class="h"><a name="2955"></a>2955</td><td></td><td></td><td></td><td></td><td class="s">Values known to be numeric will be unquoted. Undefined (NULL) values</td></tr>
<tr><td class="h"><a name="2956"></a>2956</td><td></td><td></td><td></td><td></td><td class="s">will be shown as C&lt;undef&gt; (without quotes).</td></tr>
<tr><td class="h"><a name="2957"></a>2957</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2958"></a>2958</td><td></td><td></td><td></td><td></td><td class="s">If the string is flagged internally as utf8 then double quotes will</td></tr>
<tr><td class="h"><a name="2959"></a>2959</td><td></td><td></td><td></td><td></td><td class="s">be used, otherwise single quotes are used and unprintable characters</td></tr>
<tr><td class="h"><a name="2960"></a>2960</td><td></td><td></td><td></td><td></td><td class="s">will be replaced by dot (.).</td></tr>
<tr><td class="h"><a name="2961"></a>2961</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2962"></a>2962</td><td></td><td></td><td></td><td></td><td class="s">For result strings longer than C&lt;$maxlen&gt; the result string will be</td></tr>
<tr><td class="h"><a name="2963"></a>2963</td><td></td><td></td><td></td><td></td><td class="s">truncated to C&lt;$maxlen-4&gt; and &quot;C&lt;...'&gt;&quot; will be appended.  If C&lt;$maxlen&gt; is 0</td></tr>
<tr><td class="h"><a name="2964"></a>2964</td><td></td><td></td><td></td><td></td><td class="s">or C&lt;undef&gt;, it defaults to C&lt;$DBI::neat_maxlen&gt; which, in turn, defaults to 400.</td></tr>
<tr><td class="h"><a name="2965"></a>2965</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2966"></a>2966</td><td></td><td></td><td></td><td></td><td class="s">This function is designed to format values for human consumption.</td></tr>
<tr><td class="h"><a name="2967"></a>2967</td><td></td><td></td><td></td><td></td><td class="s">It is used internally by the DBI for L&lt;/trace&gt; output. It should</td></tr>
<tr><td class="h"><a name="2968"></a>2968</td><td></td><td></td><td></td><td></td><td class="s">typically I&lt;not&gt; be used for formatting values for database use.</td></tr>
<tr><td class="h"><a name="2969"></a>2969</td><td></td><td></td><td></td><td></td><td class="s">(See also L&lt;/quote&gt;.)</td></tr>
<tr><td class="h"><a name="2970"></a>2970</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2971"></a>2971</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;neat_list&gt;</td></tr>
<tr><td class="h"><a name="2972"></a>2972</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2973"></a>2973</td><td></td><td></td><td></td><td></td><td class="s">  $str = neat_list(\@listref, $maxlen, $field_sep);</td></tr>
<tr><td class="h"><a name="2974"></a>2974</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2975"></a>2975</td><td></td><td></td><td></td><td></td><td class="s">Calls C&lt;neat&gt; on each element of the list and returns a string</td></tr>
<tr><td class="h"><a name="2976"></a>2976</td><td></td><td></td><td></td><td></td><td class="s">containing the results joined with C&lt;$field_sep&gt;. C&lt;$field_sep&gt; defaults</td></tr>
<tr><td class="h"><a name="2977"></a>2977</td><td></td><td></td><td></td><td></td><td class="s">to C&lt;&quot;, &quot;&gt;.</td></tr>
<tr><td class="h"><a name="2978"></a>2978</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2979"></a>2979</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;looks_like_number&gt;</td></tr>
<tr><td class="h"><a name="2980"></a>2980</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2981"></a>2981</td><td></td><td></td><td></td><td></td><td class="s">  @bool = looks_like_number(@array);</td></tr>
<tr><td class="h"><a name="2982"></a>2982</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2983"></a>2983</td><td></td><td></td><td></td><td></td><td class="s">Returns true for each element that looks like a number.</td></tr>
<tr><td class="h"><a name="2984"></a>2984</td><td></td><td></td><td></td><td></td><td class="s">Returns false for each element that does not look like a number.</td></tr>
<tr><td class="h"><a name="2985"></a>2985</td><td></td><td></td><td></td><td></td><td class="s">Returns C&lt;undef&gt; for each element that is undefined or empty.</td></tr>
<tr><td class="h"><a name="2986"></a>2986</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2987"></a>2987</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;hash&gt;</td></tr>
<tr><td class="h"><a name="2988"></a>2988</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2989"></a>2989</td><td></td><td></td><td></td><td></td><td class="s">  $hash_value = DBI::hash($buffer, $type);</td></tr>
<tr><td class="h"><a name="2990"></a>2990</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2991"></a>2991</td><td></td><td></td><td></td><td></td><td class="s">Return a 32-bit integer 'hash' value corresponding to the contents of $buffer.</td></tr>
<tr><td class="h"><a name="2992"></a>2992</td><td></td><td></td><td></td><td></td><td class="s">The $type parameter selects which kind of hash algorithm should be used.</td></tr>
<tr><td class="h"><a name="2993"></a>2993</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2994"></a>2994</td><td></td><td></td><td></td><td></td><td class="s">For the technically curious, type 0 (which is the default if $type</td></tr>
<tr><td class="h"><a name="2995"></a>2995</td><td></td><td></td><td></td><td></td><td class="s">isn't specified) is based on the Perl 5.1 hash except that the value</td></tr>
<tr><td class="h"><a name="2996"></a>2996</td><td></td><td></td><td></td><td></td><td class="s">is forced to be negative (for obscure historical reasons).</td></tr>
<tr><td class="h"><a name="2997"></a>2997</td><td></td><td></td><td></td><td></td><td class="s">Type 1 is the better &quot;Fowler / Noll / Vo&quot; (FNV) hash. See</td></tr>
<tr><td class="h"><a name="2998"></a>2998</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://www.isthe.com/chongo/tech/comp/fnv/&gt; for more information.</td></tr>
<tr><td class="h"><a name="2999"></a>2999</td><td></td><td></td><td></td><td></td><td class="s">Both types are implemented in C and are very fast.</td></tr>
<tr><td class="h"><a name="3000"></a>3000</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3001"></a>3001</td><td></td><td></td><td></td><td></td><td class="s">This function doesn't have much to do with databases, except that</td></tr>
<tr><td class="h"><a name="3002"></a>3002</td><td></td><td></td><td></td><td></td><td class="s">it can be handy to store hash values in a database.</td></tr>
<tr><td class="h"><a name="3003"></a>3003</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3004"></a>3004</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3005"></a>3005</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI Dynamic Attributes</td></tr>
<tr><td class="h"><a name="3006"></a>3006</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3007"></a>3007</td><td></td><td></td><td></td><td></td><td class="s">Dynamic attributes are always associated with the I&lt;last handle used&gt;</td></tr>
<tr><td class="h"><a name="3008"></a>3008</td><td></td><td></td><td></td><td></td><td class="s">(that handle is represented by C&lt;$h&gt; in the descriptions below).</td></tr>
<tr><td class="h"><a name="3009"></a>3009</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3010"></a>3010</td><td></td><td></td><td></td><td></td><td class="s">Where an attribute is equivalent to a method call, then refer to</td></tr>
<tr><td class="h"><a name="3011"></a>3011</td><td></td><td></td><td></td><td></td><td class="s">the method call for all related documentation.</td></tr>
<tr><td class="h"><a name="3012"></a>3012</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3013"></a>3013</td><td></td><td></td><td></td><td></td><td class="s">Warning: these attributes are provided as a convenience but they</td></tr>
<tr><td class="h"><a name="3014"></a>3014</td><td></td><td></td><td></td><td></td><td class="s">do have limitations. Specifically, they have a short lifespan:</td></tr>
<tr><td class="h"><a name="3015"></a>3015</td><td></td><td></td><td></td><td></td><td class="s">because they are associated with</td></tr>
<tr><td class="h"><a name="3016"></a>3016</td><td></td><td></td><td></td><td></td><td class="s">the last handle used, they should only be used I&lt;immediately&gt; after</td></tr>
<tr><td class="h"><a name="3017"></a>3017</td><td></td><td></td><td></td><td></td><td class="s">calling the method that &quot;sets&quot; them.</td></tr>
<tr><td class="h"><a name="3018"></a>3018</td><td></td><td></td><td></td><td></td><td class="s">If in any doubt, use the corresponding method call.</td></tr>
<tr><td class="h"><a name="3019"></a>3019</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3020"></a>3020</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;$DBI::err&gt;</td></tr>
<tr><td class="h"><a name="3021"></a>3021</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3022"></a>3022</td><td></td><td></td><td></td><td></td><td class="s">Equivalent to C&lt;$h-E&lt;gt&gt;err&gt;.</td></tr>
<tr><td class="h"><a name="3023"></a>3023</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3024"></a>3024</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;$DBI::errstr&gt;</td></tr>
<tr><td class="h"><a name="3025"></a>3025</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3026"></a>3026</td><td></td><td></td><td></td><td></td><td class="s">Equivalent to C&lt;$h-E&lt;gt&gt;errstr&gt;.</td></tr>
<tr><td class="h"><a name="3027"></a>3027</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3028"></a>3028</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;$DBI::state&gt;</td></tr>
<tr><td class="h"><a name="3029"></a>3029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3030"></a>3030</td><td></td><td></td><td></td><td></td><td class="s">Equivalent to C&lt;$h-E&lt;gt&gt;state&gt;.</td></tr>
<tr><td class="h"><a name="3031"></a>3031</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3032"></a>3032</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;$DBI::rows&gt;</td></tr>
<tr><td class="h"><a name="3033"></a>3033</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3034"></a>3034</td><td></td><td></td><td></td><td></td><td class="s">Equivalent to C&lt;$h-E&lt;gt&gt;rows&gt;. Please refer to the documentation</td></tr>
<tr><td class="h"><a name="3035"></a>3035</td><td></td><td></td><td></td><td></td><td class="s">for the L&lt;/rows&gt; method.</td></tr>
<tr><td class="h"><a name="3036"></a>3036</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3037"></a>3037</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;$DBI::lasth&gt;</td></tr>
<tr><td class="h"><a name="3038"></a>3038</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3039"></a>3039</td><td></td><td></td><td></td><td></td><td class="s">Returns the DBI object handle used for the most recent DBI method call.</td></tr>
<tr><td class="h"><a name="3040"></a>3040</td><td></td><td></td><td></td><td></td><td class="s">If the last DBI method call was a DESTROY then $DBI::lasth will return</td></tr>
<tr><td class="h"><a name="3041"></a>3041</td><td></td><td></td><td></td><td></td><td class="s">the handle of the parent of the destroyed handle, if there is one.</td></tr>
<tr><td class="h"><a name="3042"></a>3042</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3043"></a>3043</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3044"></a>3044</td><td></td><td></td><td></td><td></td><td class="s">=head1 METHODS COMMON TO ALL HANDLES</td></tr>
<tr><td class="h"><a name="3045"></a>3045</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3046"></a>3046</td><td></td><td></td><td></td><td></td><td class="s">The following methods can be used by all types of DBI handles.</td></tr>
<tr><td class="h"><a name="3047"></a>3047</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3048"></a>3048</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;err&gt;</td></tr>
<tr><td class="h"><a name="3049"></a>3049</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3050"></a>3050</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $h-&gt;err;</td></tr>
<tr><td class="h"><a name="3051"></a>3051</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3052"></a>3052</td><td></td><td></td><td></td><td></td><td class="s">Returns the I&lt;native&gt; database engine error code from the last driver</td></tr>
<tr><td class="h"><a name="3053"></a>3053</td><td></td><td></td><td></td><td></td><td class="s">method called. The code is typically an integer but you should not</td></tr>
<tr><td class="h"><a name="3054"></a>3054</td><td></td><td></td><td></td><td></td><td class="s">assume that.</td></tr>
<tr><td class="h"><a name="3055"></a>3055</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3056"></a>3056</td><td></td><td></td><td></td><td></td><td class="s">The DBI resets $h-&gt;err to undef before almost all DBI method calls, so the</td></tr>
<tr><td class="h"><a name="3057"></a>3057</td><td></td><td></td><td></td><td></td><td class="s">value only has a short lifespan. Also, for most drivers, the statement</td></tr>
<tr><td class="h"><a name="3058"></a>3058</td><td></td><td></td><td></td><td></td><td class="s">handles share the same error variable as the parent database handle,</td></tr>
<tr><td class="h"><a name="3059"></a>3059</td><td></td><td></td><td></td><td></td><td class="s">so calling a method on one handle may reset the error on the</td></tr>
<tr><td class="h"><a name="3060"></a>3060</td><td></td><td></td><td></td><td></td><td class="s">related handles.</td></tr>
<tr><td class="h"><a name="3061"></a>3061</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3062"></a>3062</td><td></td><td></td><td></td><td></td><td class="s">(Methods which don't reset err before being called include err() and errstr(),</td></tr>
<tr><td class="h"><a name="3063"></a>3063</td><td></td><td></td><td></td><td></td><td class="s">obviously, state(), rows(), func(), trace(), trace_msg(), ping(), and the</td></tr>
<tr><td class="h"><a name="3064"></a>3064</td><td></td><td></td><td></td><td></td><td class="s">tied hash attribute FETCH() and STORE() methods.)</td></tr>
<tr><td class="h"><a name="3065"></a>3065</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3066"></a>3066</td><td></td><td></td><td></td><td></td><td class="s">If you need to test for specific error conditions I&lt;and&gt; have your program be</td></tr>
<tr><td class="h"><a name="3067"></a>3067</td><td></td><td></td><td></td><td></td><td class="s">portable to different database engines, then you'll need to determine what the</td></tr>
<tr><td class="h"><a name="3068"></a>3068</td><td></td><td></td><td></td><td></td><td class="s">corresponding error codes are for all those engines and test for all of them.</td></tr>
<tr><td class="h"><a name="3069"></a>3069</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3070"></a>3070</td><td></td><td></td><td></td><td></td><td class="s">The DBI uses the value of $DBI::stderr as the C&lt;err&gt; value for internal errors.</td></tr>
<tr><td class="h"><a name="3071"></a>3071</td><td></td><td></td><td></td><td></td><td class="s">Drivers should also do likewise.  The default value for $DBI::stderr is 2000000000.</td></tr>
<tr><td class="h"><a name="3072"></a>3072</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3073"></a>3073</td><td></td><td></td><td></td><td></td><td class="s">A driver may return C&lt;0&gt; from err() to indicate a warning condition</td></tr>
<tr><td class="h"><a name="3074"></a>3074</td><td></td><td></td><td></td><td></td><td class="s">after a method call. Similarly, a driver may return an empty string</td></tr>
<tr><td class="h"><a name="3075"></a>3075</td><td></td><td></td><td></td><td></td><td class="s">to indicate a 'success with information' condition. In both these</td></tr>
<tr><td class="h"><a name="3076"></a>3076</td><td></td><td></td><td></td><td></td><td class="s">cases the value is false but not undef. The errstr() and state()</td></tr>
<tr><td class="h"><a name="3077"></a>3077</td><td></td><td></td><td></td><td></td><td class="s">methods may be used to retrieve extra information in these cases.</td></tr>
<tr><td class="h"><a name="3078"></a>3078</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3079"></a>3079</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/set_err&gt; for more information.</td></tr>
<tr><td class="h"><a name="3080"></a>3080</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3081"></a>3081</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;errstr&gt;</td></tr>
<tr><td class="h"><a name="3082"></a>3082</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3083"></a>3083</td><td></td><td></td><td></td><td></td><td class="s">  $str = $h-&gt;errstr;</td></tr>
<tr><td class="h"><a name="3084"></a>3084</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3085"></a>3085</td><td></td><td></td><td></td><td></td><td class="s">Returns the native database engine error message from the last DBI</td></tr>
<tr><td class="h"><a name="3086"></a>3086</td><td></td><td></td><td></td><td></td><td class="s">method called. This has the same lifespan issues as the L&lt;/err&gt; method</td></tr>
<tr><td class="h"><a name="3087"></a>3087</td><td></td><td></td><td></td><td></td><td class="s">described above.</td></tr>
<tr><td class="h"><a name="3088"></a>3088</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3089"></a>3089</td><td></td><td></td><td></td><td></td><td class="s">The returned string may contain multiple messages separated by</td></tr>
<tr><td class="h"><a name="3090"></a>3090</td><td></td><td></td><td></td><td></td><td class="s">newline characters.</td></tr>
<tr><td class="h"><a name="3091"></a>3091</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3092"></a>3092</td><td></td><td></td><td></td><td></td><td class="s">The errstr() method should not be used to test for errors, use err()</td></tr>
<tr><td class="h"><a name="3093"></a>3093</td><td></td><td></td><td></td><td></td><td class="s">for that, because drivers may return 'success with information' or</td></tr>
<tr><td class="h"><a name="3094"></a>3094</td><td></td><td></td><td></td><td></td><td class="s">warning messages via errstr() for methods that have not 'failed'.</td></tr>
<tr><td class="h"><a name="3095"></a>3095</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3096"></a>3096</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/set_err&gt; for more information.</td></tr>
<tr><td class="h"><a name="3097"></a>3097</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3098"></a>3098</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;state&gt;</td></tr>
<tr><td class="h"><a name="3099"></a>3099</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3100"></a>3100</td><td></td><td></td><td></td><td></td><td class="s">  $str = $h-&gt;state;</td></tr>
<tr><td class="h"><a name="3101"></a>3101</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3102"></a>3102</td><td></td><td></td><td></td><td></td><td class="s">Returns a state code in the standard SQLSTATE five character format.</td></tr>
<tr><td class="h"><a name="3103"></a>3103</td><td></td><td></td><td></td><td></td><td class="s">Note that the specific success code C&lt;00000&gt; is translated to any empty string</td></tr>
<tr><td class="h"><a name="3104"></a>3104</td><td></td><td></td><td></td><td></td><td class="s">(false). If the driver does not support SQLSTATE (and most don't),</td></tr>
<tr><td class="h"><a name="3105"></a>3105</td><td></td><td></td><td></td><td></td><td class="s">then state() will return C&lt;S1000&gt; (General Error) for all errors.</td></tr>
<tr><td class="h"><a name="3106"></a>3106</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3107"></a>3107</td><td></td><td></td><td></td><td></td><td class="s">The driver is free to return any value via C&lt;state&gt;, e.g., warning</td></tr>
<tr><td class="h"><a name="3108"></a>3108</td><td></td><td></td><td></td><td></td><td class="s">codes, even if it has not declared an error by returning a true value</td></tr>
<tr><td class="h"><a name="3109"></a>3109</td><td></td><td></td><td></td><td></td><td class="s">via the L&lt;/err&gt; method described above.</td></tr>
<tr><td class="h"><a name="3110"></a>3110</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3111"></a>3111</td><td></td><td></td><td></td><td></td><td class="s">The state() method should not be used to test for errors, use err()</td></tr>
<tr><td class="h"><a name="3112"></a>3112</td><td></td><td></td><td></td><td></td><td class="s">for that, because drivers may return a 'success with information' or</td></tr>
<tr><td class="h"><a name="3113"></a>3113</td><td></td><td></td><td></td><td></td><td class="s">warning state code via state() for methods that have not 'failed'.</td></tr>
<tr><td class="h"><a name="3114"></a>3114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3115"></a>3115</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;set_err&gt;</td></tr>
<tr><td class="h"><a name="3116"></a>3116</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3117"></a>3117</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $h-&gt;set_err($err, $errstr);</td></tr>
<tr><td class="h"><a name="3118"></a>3118</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $h-&gt;set_err($err, $errstr, $state);</td></tr>
<tr><td class="h"><a name="3119"></a>3119</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $h-&gt;set_err($err, $errstr, $state, $method);</td></tr>
<tr><td class="h"><a name="3120"></a>3120</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $h-&gt;set_err($err, $errstr, $state, $method, $rv);</td></tr>
<tr><td class="h"><a name="3121"></a>3121</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3122"></a>3122</td><td></td><td></td><td></td><td></td><td class="s">Set the C&lt;err&gt;, C&lt;errstr&gt;, and C&lt;state&gt; values for the handle.</td></tr>
<tr><td class="h"><a name="3123"></a>3123</td><td></td><td></td><td></td><td></td><td class="s">This method is typically only used by DBI drivers and DBI subclasses.</td></tr>
<tr><td class="h"><a name="3124"></a>3124</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3125"></a>3125</td><td></td><td></td><td></td><td></td><td class="s">If the L&lt;/HandleSetErr&gt; attribute holds a reference to a subroutine</td></tr>
<tr><td class="h"><a name="3126"></a>3126</td><td></td><td></td><td></td><td></td><td class="s">it is called first. The subroutine can alter the $err, $errstr, $state,</td></tr>
<tr><td class="h"><a name="3127"></a>3127</td><td></td><td></td><td></td><td></td><td class="s">and $method values. See L&lt;/HandleSetErr&gt; for full details.</td></tr>
<tr><td class="h"><a name="3128"></a>3128</td><td></td><td></td><td></td><td></td><td class="s">If the subroutine returns a true value then the handle C&lt;err&gt;,</td></tr>
<tr><td class="h"><a name="3129"></a>3129</td><td></td><td></td><td></td><td></td><td class="s">C&lt;errstr&gt;, and C&lt;state&gt; values are not altered and set_err() returns</td></tr>
<tr><td class="h"><a name="3130"></a>3130</td><td></td><td></td><td></td><td></td><td class="s">an empty list (it normally returns $rv which defaults to undef, see below).</td></tr>
<tr><td class="h"><a name="3131"></a>3131</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3132"></a>3132</td><td></td><td></td><td></td><td></td><td class="s">Setting C&lt;err&gt; to a I&lt;true&gt; value indicates an error and will trigger</td></tr>
<tr><td class="h"><a name="3133"></a>3133</td><td></td><td></td><td></td><td></td><td class="s">the normal DBI error handling mechanisms, such as C&lt;RaiseError&gt; and</td></tr>
<tr><td class="h"><a name="3134"></a>3134</td><td></td><td></td><td></td><td></td><td class="s">C&lt;HandleError&gt;, if they are enabled, when execution returns from</td></tr>
<tr><td class="h"><a name="3135"></a>3135</td><td></td><td></td><td></td><td></td><td class="s">the DBI back to the application.</td></tr>
<tr><td class="h"><a name="3136"></a>3136</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3137"></a>3137</td><td></td><td></td><td></td><td></td><td class="s">Setting C&lt;err&gt; to C&lt;&quot;&quot;&gt; indicates an 'information' state, and setting</td></tr>
<tr><td class="h"><a name="3138"></a>3138</td><td></td><td></td><td></td><td></td><td class="s">it to C&lt;&quot;0&quot;&gt; indicates a 'warning' state. Setting C&lt;err&gt; to C&lt;undef&gt;</td></tr>
<tr><td class="h"><a name="3139"></a>3139</td><td></td><td></td><td></td><td></td><td class="s">also sets C&lt;errstr&gt; to undef, and C&lt;state&gt; to C&lt;&quot;&quot;&gt;, irrespective</td></tr>
<tr><td class="h"><a name="3140"></a>3140</td><td></td><td></td><td></td><td></td><td class="s">of the values of the $errstr and $state parameters.</td></tr>
<tr><td class="h"><a name="3141"></a>3141</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3142"></a>3142</td><td></td><td></td><td></td><td></td><td class="s">The $method parameter provides an alternate method name for the</td></tr>
<tr><td class="h"><a name="3143"></a>3143</td><td></td><td></td><td></td><td></td><td class="s">C&lt;RaiseError&gt;/C&lt;PrintError&gt;/C&lt;PrintWarn&gt; error string instead of</td></tr>
<tr><td class="h"><a name="3144"></a>3144</td><td></td><td></td><td></td><td></td><td class="s">the fairly unhelpful 'C&lt;set_err&gt;'.</td></tr>
<tr><td class="h"><a name="3145"></a>3145</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3146"></a>3146</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;set_err&gt; method normally returns undef.  The $rv parameter</td></tr>
<tr><td class="h"><a name="3147"></a>3147</td><td></td><td></td><td></td><td></td><td class="s">provides an alternate return value.</td></tr>
<tr><td class="h"><a name="3148"></a>3148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3149"></a>3149</td><td></td><td></td><td></td><td></td><td class="s">Some special rules apply if the C&lt;err&gt; or C&lt;errstr&gt;</td></tr>
<tr><td class="h"><a name="3150"></a>3150</td><td></td><td></td><td></td><td></td><td class="s">values for the handle are I&lt;already&gt; set...</td></tr>
<tr><td class="h"><a name="3151"></a>3151</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3152"></a>3152</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;errstr&gt; is true then: &quot;C&lt; [err was %s now %s]&gt;&quot; is appended if $err is</td></tr>
<tr><td class="h"><a name="3153"></a>3153</td><td></td><td></td><td></td><td></td><td class="s">true and C&lt;err&gt; is already true and the new err value differs from the original</td></tr>
<tr><td class="h"><a name="3154"></a>3154</td><td></td><td></td><td></td><td></td><td class="s">one. Similarly &quot;C&lt; [state was %s now %s]&gt;&quot; is appended if $state is true and C&lt;state&gt; is</td></tr>
<tr><td class="h"><a name="3155"></a>3155</td><td></td><td></td><td></td><td></td><td class="s">already true and the new state value differs from the original one. Finally</td></tr>
<tr><td class="h"><a name="3156"></a>3156</td><td></td><td></td><td></td><td></td><td class="s">&quot;C&lt;\n&gt;&quot; and the new $errstr are appended if $errstr differs from the existing</td></tr>
<tr><td class="h"><a name="3157"></a>3157</td><td></td><td></td><td></td><td></td><td class="s">errstr value. Obviously the C&lt;%s&gt;'s above are replaced by the corresponding values.</td></tr>
<tr><td class="h"><a name="3158"></a>3158</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3159"></a>3159</td><td></td><td></td><td></td><td></td><td class="s">The handle C&lt;err&gt; value is set to $err if: $err is true; or handle</td></tr>
<tr><td class="h"><a name="3160"></a>3160</td><td></td><td></td><td></td><td></td><td class="s">C&lt;err&gt; value is undef; or $err is defined and the length is greater</td></tr>
<tr><td class="h"><a name="3161"></a>3161</td><td></td><td></td><td></td><td></td><td class="s">than the handle C&lt;err&gt; length. The effect is that an 'information'</td></tr>
<tr><td class="h"><a name="3162"></a>3162</td><td></td><td></td><td></td><td></td><td class="s">state only overrides undef; a 'warning' overrides undef or 'information',</td></tr>
<tr><td class="h"><a name="3163"></a>3163</td><td></td><td></td><td></td><td></td><td class="s">and an 'error' state overrides anything.</td></tr>
<tr><td class="h"><a name="3164"></a>3164</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3165"></a>3165</td><td></td><td></td><td></td><td></td><td class="s">The handle C&lt;state&gt; value is set to $state if $state is true and</td></tr>
<tr><td class="h"><a name="3166"></a>3166</td><td></td><td></td><td></td><td></td><td class="s">the handle C&lt;err&gt; value was set (by the rules above).</td></tr>
<tr><td class="h"><a name="3167"></a>3167</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3168"></a>3168</td><td></td><td></td><td></td><td></td><td class="s">Support for warning and information states was added in DBI 1.41.</td></tr>
<tr><td class="h"><a name="3169"></a>3169</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3170"></a>3170</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;trace&gt;</td></tr>
<tr><td class="h"><a name="3171"></a>3171</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3172"></a>3172</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;trace($trace_settings);</td></tr>
<tr><td class="h"><a name="3173"></a>3173</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;trace($trace_settings, $trace_filename);</td></tr>
<tr><td class="h"><a name="3174"></a>3174</td><td></td><td></td><td></td><td></td><td class="s">  $trace_settings = $h-&gt;trace;</td></tr>
<tr><td class="h"><a name="3175"></a>3175</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3176"></a>3176</td><td></td><td></td><td></td><td></td><td class="s">The trace() method is used to alter the trace settings for a handle</td></tr>
<tr><td class="h"><a name="3177"></a>3177</td><td></td><td></td><td></td><td></td><td class="s">(and any future children of that handle).  It can also be used to</td></tr>
<tr><td class="h"><a name="3178"></a>3178</td><td></td><td></td><td></td><td></td><td class="s">change where the trace output is sent.</td></tr>
<tr><td class="h"><a name="3179"></a>3179</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3180"></a>3180</td><td></td><td></td><td></td><td></td><td class="s">There's a similar method, C&lt;DBI-E&lt;gt&gt;trace&gt;, which sets the global</td></tr>
<tr><td class="h"><a name="3181"></a>3181</td><td></td><td></td><td></td><td></td><td class="s">default trace settings.</td></tr>
<tr><td class="h"><a name="3182"></a>3182</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3183"></a>3183</td><td></td><td></td><td></td><td></td><td class="s">See the L&lt;/TRACING&gt; section for full details about the DBI's powerful</td></tr>
<tr><td class="h"><a name="3184"></a>3184</td><td></td><td></td><td></td><td></td><td class="s">tracing facilities.</td></tr>
<tr><td class="h"><a name="3185"></a>3185</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3186"></a>3186</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;trace_msg&gt;</td></tr>
<tr><td class="h"><a name="3187"></a>3187</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3188"></a>3188</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;trace_msg($message_text);</td></tr>
<tr><td class="h"><a name="3189"></a>3189</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;trace_msg($message_text, $min_level);</td></tr>
<tr><td class="h"><a name="3190"></a>3190</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3191"></a>3191</td><td></td><td></td><td></td><td></td><td class="s">Writes C&lt;$message_text&gt; to the trace file if the trace level is</td></tr>
<tr><td class="h"><a name="3192"></a>3192</td><td></td><td></td><td></td><td></td><td class="s">greater than or equal to $min_level (which defaults to 1).</td></tr>
<tr><td class="h"><a name="3193"></a>3193</td><td></td><td></td><td></td><td></td><td class="s">Can also be called as C&lt;DBI-E&lt;gt&gt;trace_msg($msg)&gt;.</td></tr>
<tr><td class="h"><a name="3194"></a>3194</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3195"></a>3195</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/TRACING&gt; for more details.</td></tr>
<tr><td class="h"><a name="3196"></a>3196</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3197"></a>3197</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;func&gt;</td></tr>
<tr><td class="h"><a name="3198"></a>3198</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3199"></a>3199</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;func(@func_arguments, $func_name) or die ...;</td></tr>
<tr><td class="h"><a name="3200"></a>3200</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3201"></a>3201</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;func&gt; method can be used to call private non-standard and</td></tr>
<tr><td class="h"><a name="3202"></a>3202</td><td></td><td></td><td></td><td></td><td class="s">non-portable methods implemented by the driver. Note that the function</td></tr>
<tr><td class="h"><a name="3203"></a>3203</td><td></td><td></td><td></td><td></td><td class="s">name is given as the I&lt;last&gt; argument.</td></tr>
<tr><td class="h"><a name="3204"></a>3204</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3205"></a>3205</td><td></td><td></td><td></td><td></td><td class="s">It's also important to note that the func() method does not clear</td></tr>
<tr><td class="h"><a name="3206"></a>3206</td><td></td><td></td><td></td><td></td><td class="s">a previous error ($DBI::err etc.) and it does not trigger automatic</td></tr>
<tr><td class="h"><a name="3207"></a>3207</td><td></td><td></td><td></td><td></td><td class="s">error detection (RaiseError etc.) so you must check the return</td></tr>
<tr><td class="h"><a name="3208"></a>3208</td><td></td><td></td><td></td><td></td><td class="s">status and/or $h-&gt;err to detect errors.</td></tr>
<tr><td class="h"><a name="3209"></a>3209</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3210"></a>3210</td><td></td><td></td><td></td><td></td><td class="s">(This method is not directly related to calling stored procedures.</td></tr>
<tr><td class="h"><a name="3211"></a>3211</td><td></td><td></td><td></td><td></td><td class="s">Calling stored procedures is currently not defined by the DBI.</td></tr>
<tr><td class="h"><a name="3212"></a>3212</td><td></td><td></td><td></td><td></td><td class="s">Some drivers, such as DBD::Oracle, support it in non-portable ways.</td></tr>
<tr><td class="h"><a name="3213"></a>3213</td><td></td><td></td><td></td><td></td><td class="s">See driver documentation for more details.)</td></tr>
<tr><td class="h"><a name="3214"></a>3214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3215"></a>3215</td><td></td><td></td><td></td><td></td><td class="s">See also install_method() in L&lt;DBI::DBD&gt; for how you can avoid needing to</td></tr>
<tr><td class="h"><a name="3216"></a>3216</td><td></td><td></td><td></td><td></td><td class="s">use func() and gain direct access to driver-private methods.</td></tr>
<tr><td class="h"><a name="3217"></a>3217</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3218"></a>3218</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;can&gt;</td></tr>
<tr><td class="h"><a name="3219"></a>3219</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3220"></a>3220</td><td></td><td></td><td></td><td></td><td class="s">  $is_implemented = $h-&gt;can($method_name);</td></tr>
<tr><td class="h"><a name="3221"></a>3221</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3222"></a>3222</td><td></td><td></td><td></td><td></td><td class="s">Returns true if $method_name is implemented by the driver or a</td></tr>
<tr><td class="h"><a name="3223"></a>3223</td><td></td><td></td><td></td><td></td><td class="s">default method is provided by the DBI.</td></tr>
<tr><td class="h"><a name="3224"></a>3224</td><td></td><td></td><td></td><td></td><td class="s">It returns false where a driver hasn't implemented a method and the</td></tr>
<tr><td class="h"><a name="3225"></a>3225</td><td></td><td></td><td></td><td></td><td class="s">default method is provided by the DBI is just an empty stub.</td></tr>
<tr><td class="h"><a name="3226"></a>3226</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3227"></a>3227</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;parse_trace_flags&gt;</td></tr>
<tr><td class="h"><a name="3228"></a>3228</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3229"></a>3229</td><td></td><td></td><td></td><td></td><td class="s">  $trace_settings_integer = $h-&gt;parse_trace_flags($trace_settings);</td></tr>
<tr><td class="h"><a name="3230"></a>3230</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3231"></a>3231</td><td></td><td></td><td></td><td></td><td class="s">Parses a string containing trace settings and returns the corresponding</td></tr>
<tr><td class="h"><a name="3232"></a>3232</td><td></td><td></td><td></td><td></td><td class="s">integer value used internally by the DBI and drivers.</td></tr>
<tr><td class="h"><a name="3233"></a>3233</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3234"></a>3234</td><td></td><td></td><td></td><td></td><td class="s">The $trace_settings argument is a string containing a trace level</td></tr>
<tr><td class="h"><a name="3235"></a>3235</td><td></td><td></td><td></td><td></td><td class="s">between 0 and 15 and/or trace flag names separated by vertical bar</td></tr>
<tr><td class="h"><a name="3236"></a>3236</td><td></td><td></td><td></td><td></td><td class="s">(&quot;C&lt;|&gt;&quot;) or comma (&quot;C&lt;,&gt;&quot;) characters. For example: C&lt;&quot;SQL|3|foo&quot;&gt;.</td></tr>
<tr><td class="h"><a name="3237"></a>3237</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3238"></a>3238</td><td></td><td></td><td></td><td></td><td class="s">It uses the parse_trace_flag() method, described below, to process</td></tr>
<tr><td class="h"><a name="3239"></a>3239</td><td></td><td></td><td></td><td></td><td class="s">the individual trage flag names.</td></tr>
<tr><td class="h"><a name="3240"></a>3240</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3241"></a>3241</td><td></td><td></td><td></td><td></td><td class="s">The parse_trace_flags() method was added in DBI 1.42.</td></tr>
<tr><td class="h"><a name="3242"></a>3242</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3243"></a>3243</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;parse_trace_flag&gt;</td></tr>
<tr><td class="h"><a name="3244"></a>3244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3245"></a>3245</td><td></td><td></td><td></td><td></td><td class="s">  $bit_flag = $h-&gt;parse_trace_flag($trace_flag_name);</td></tr>
<tr><td class="h"><a name="3246"></a>3246</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3247"></a>3247</td><td></td><td></td><td></td><td></td><td class="s">Returns the bit flag corresponding to the trace flag name in</td></tr>
<tr><td class="h"><a name="3248"></a>3248</td><td></td><td></td><td></td><td></td><td class="s">$trace_flag_name.  Drivers are expected to override this method and</td></tr>
<tr><td class="h"><a name="3249"></a>3249</td><td></td><td></td><td></td><td></td><td class="s">check if $trace_flag_name is a driver specific trace flags and, if</td></tr>
<tr><td class="h"><a name="3250"></a>3250</td><td></td><td></td><td></td><td></td><td class="s">not, then call the DBIs default parse_trace_flag().</td></tr>
<tr><td class="h"><a name="3251"></a>3251</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3252"></a>3252</td><td></td><td></td><td></td><td></td><td class="s">The parse_trace_flag() method was added in DBI 1.42.</td></tr>
<tr><td class="h"><a name="3253"></a>3253</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3254"></a>3254</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;private_attribute_info&gt;</td></tr>
<tr><td class="h"><a name="3255"></a>3255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3256"></a>3256</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $h-&gt;private_attribute_info();</td></tr>
<tr><td class="h"><a name="3257"></a>3257</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3258"></a>3258</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to a hash whose keys are the names of driver-private</td></tr>
<tr><td class="h"><a name="3259"></a>3259</td><td></td><td></td><td></td><td></td><td class="s">attributes available for the kind of handle (driver, database, statement)</td></tr>
<tr><td class="h"><a name="3260"></a>3260</td><td></td><td></td><td></td><td></td><td class="s">that the method was called on.</td></tr>
<tr><td class="h"><a name="3261"></a>3261</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3262"></a>3262</td><td></td><td></td><td></td><td></td><td class="s">For example, the return value when called with a DBD::Sybase $dbh could look like this:</td></tr>
<tr><td class="h"><a name="3263"></a>3263</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3264"></a>3264</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="3265"></a>3265</td><td></td><td></td><td></td><td></td><td class="s">      syb_dynamic_supported =&gt; undef,</td></tr>
<tr><td class="h"><a name="3266"></a>3266</td><td></td><td></td><td></td><td></td><td class="s">      syb_oc_version =&gt; undef,</td></tr>
<tr><td class="h"><a name="3267"></a>3267</td><td></td><td></td><td></td><td></td><td class="s">      syb_server_version =&gt; undef,</td></tr>
<tr><td class="h"><a name="3268"></a>3268</td><td></td><td></td><td></td><td></td><td class="s">      syb_server_version_string =&gt; undef,</td></tr>
<tr><td class="h"><a name="3269"></a>3269</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3270"></a>3270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3271"></a>3271</td><td></td><td></td><td></td><td></td><td class="s">and when called with a DBD::Sybase $sth they could look like this:</td></tr>
<tr><td class="h"><a name="3272"></a>3272</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3273"></a>3273</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="3274"></a>3274</td><td></td><td></td><td></td><td></td><td class="s">      syb_types =&gt; undef,</td></tr>
<tr><td class="h"><a name="3275"></a>3275</td><td></td><td></td><td></td><td></td><td class="s">      syb_proc_status =&gt; undef,</td></tr>
<tr><td class="h"><a name="3276"></a>3276</td><td></td><td></td><td></td><td></td><td class="s">      syb_result_type =&gt; undef,</td></tr>
<tr><td class="h"><a name="3277"></a>3277</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3278"></a>3278</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3279"></a>3279</td><td></td><td></td><td></td><td></td><td class="s">The values should be undef. Meanings may be assigned to particular values in future.</td></tr>
<tr><td class="h"><a name="3280"></a>3280</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3281"></a>3281</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;swap_inner_handle&gt;</td></tr>
<tr><td class="h"><a name="3282"></a>3282</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3283"></a>3283</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $h1-&gt;swap_inner_handle( $h2 );</td></tr>
<tr><td class="h"><a name="3284"></a>3284</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $h1-&gt;swap_inner_handle( $h2, $allow_reparent );</td></tr>
<tr><td class="h"><a name="3285"></a>3285</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3286"></a>3286</td><td></td><td></td><td></td><td></td><td class="s">Brain transplants for handles. You don't need to know about this</td></tr>
<tr><td class="h"><a name="3287"></a>3287</td><td></td><td></td><td></td><td></td><td class="s">unless you want to become a handle surgeon.</td></tr>
<tr><td class="h"><a name="3288"></a>3288</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3289"></a>3289</td><td></td><td></td><td></td><td></td><td class="s">A DBI handle is a reference to a tied hash. A tied hash has an</td></tr>
<tr><td class="h"><a name="3290"></a>3290</td><td></td><td></td><td></td><td></td><td class="s">I&lt;inner&gt; hash that actually holds the contents.  The swap_inner_handle()</td></tr>
<tr><td class="h"><a name="3291"></a>3291</td><td></td><td></td><td></td><td></td><td class="s">method swaps the inner hashes between two handles. The $h1 and $h2</td></tr>
<tr><td class="h"><a name="3292"></a>3292</td><td></td><td></td><td></td><td></td><td class="s">handles still point to the same tied hashes, but what those hashes</td></tr>
<tr><td class="h"><a name="3293"></a>3293</td><td></td><td></td><td></td><td></td><td class="s">are tied to has been swapped.  In effect $h1 I&lt;becomes&gt; $h2 and</td></tr>
<tr><td class="h"><a name="3294"></a>3294</td><td></td><td></td><td></td><td></td><td class="s">vice-versa. This is powerful stuff, expect problems. Use with care.</td></tr>
<tr><td class="h"><a name="3295"></a>3295</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3296"></a>3296</td><td></td><td></td><td></td><td></td><td class="s">As a small safety measure, the two handles, $h1 and $h2, have to</td></tr>
<tr><td class="h"><a name="3297"></a>3297</td><td></td><td></td><td></td><td></td><td class="s">share the same parent unless $allow_reparent is true.</td></tr>
<tr><td class="h"><a name="3298"></a>3298</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3299"></a>3299</td><td></td><td></td><td></td><td></td><td class="s">The swap_inner_handle() method was added in DBI 1.44.</td></tr>
<tr><td class="h"><a name="3300"></a>3300</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3301"></a>3301</td><td></td><td></td><td></td><td></td><td class="s">Here's a quick kind of 'diagram' as a worked example to help think about what's</td></tr>
<tr><td class="h"><a name="3302"></a>3302</td><td></td><td></td><td></td><td></td><td class="s">happening:</td></tr>
<tr><td class="h"><a name="3303"></a>3303</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3304"></a>3304</td><td></td><td></td><td></td><td></td><td class="s">    Original state:</td></tr>
<tr><td class="h"><a name="3305"></a>3305</td><td></td><td></td><td></td><td></td><td class="s">            dbh1o -&gt; dbh1i</td></tr>
<tr><td class="h"><a name="3306"></a>3306</td><td></td><td></td><td></td><td></td><td class="s">            sthAo -&gt; sthAi(dbh1i)</td></tr>
<tr><td class="h"><a name="3307"></a>3307</td><td></td><td></td><td></td><td></td><td class="s">            dbh2o -&gt; dbh2i</td></tr>
<tr><td class="h"><a name="3308"></a>3308</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3309"></a>3309</td><td></td><td></td><td></td><td></td><td class="s">    swap_inner_handle dbh1o with dbh2o:</td></tr>
<tr><td class="h"><a name="3310"></a>3310</td><td></td><td></td><td></td><td></td><td class="s">            dbh2o -&gt; dbh1i</td></tr>
<tr><td class="h"><a name="3311"></a>3311</td><td></td><td></td><td></td><td></td><td class="s">            sthAo -&gt; sthAi(dbh1i)</td></tr>
<tr><td class="h"><a name="3312"></a>3312</td><td></td><td></td><td></td><td></td><td class="s">            dbh1o -&gt; dbh2i</td></tr>
<tr><td class="h"><a name="3313"></a>3313</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3314"></a>3314</td><td></td><td></td><td></td><td></td><td class="s">    create new sth from dbh1o:</td></tr>
<tr><td class="h"><a name="3315"></a>3315</td><td></td><td></td><td></td><td></td><td class="s">            dbh2o -&gt; dbh1i</td></tr>
<tr><td class="h"><a name="3316"></a>3316</td><td></td><td></td><td></td><td></td><td class="s">            sthAo -&gt; sthAi(dbh1i)</td></tr>
<tr><td class="h"><a name="3317"></a>3317</td><td></td><td></td><td></td><td></td><td class="s">            dbh1o -&gt; dbh2i</td></tr>
<tr><td class="h"><a name="3318"></a>3318</td><td></td><td></td><td></td><td></td><td class="s">            sthBo -&gt; sthBi(dbh2i)</td></tr>
<tr><td class="h"><a name="3319"></a>3319</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3320"></a>3320</td><td></td><td></td><td></td><td></td><td class="s">    swap_inner_handle sthAo with sthBo:</td></tr>
<tr><td class="h"><a name="3321"></a>3321</td><td></td><td></td><td></td><td></td><td class="s">            dbh2o -&gt; dbh1i</td></tr>
<tr><td class="h"><a name="3322"></a>3322</td><td></td><td></td><td></td><td></td><td class="s">            sthBo -&gt; sthAi(dbh1i)</td></tr>
<tr><td class="h"><a name="3323"></a>3323</td><td></td><td></td><td></td><td></td><td class="s">            dbh1o -&gt; dbh2i</td></tr>
<tr><td class="h"><a name="3324"></a>3324</td><td></td><td></td><td></td><td></td><td class="s">            sthAo -&gt; sthBi(dbh2i)</td></tr>
<tr><td class="h"><a name="3325"></a>3325</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3326"></a>3326</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3327"></a>3327</td><td></td><td></td><td></td><td></td><td class="s">=head1 ATTRIBUTES COMMON TO ALL HANDLES</td></tr>
<tr><td class="h"><a name="3328"></a>3328</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3329"></a>3329</td><td></td><td></td><td></td><td></td><td class="s">These attributes are common to all types of DBI handles.</td></tr>
<tr><td class="h"><a name="3330"></a>3330</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3331"></a>3331</td><td></td><td></td><td></td><td></td><td class="s">Some attributes are inherited by child handles. That is, the value</td></tr>
<tr><td class="h"><a name="3332"></a>3332</td><td></td><td></td><td></td><td></td><td class="s">of an inherited attribute in a newly created statement handle is the</td></tr>
<tr><td class="h"><a name="3333"></a>3333</td><td></td><td></td><td></td><td></td><td class="s">same as the value in the parent database handle. Changes to attributes</td></tr>
<tr><td class="h"><a name="3334"></a>3334</td><td></td><td></td><td></td><td></td><td class="s">in the new statement handle do not affect the parent database handle</td></tr>
<tr><td class="h"><a name="3335"></a>3335</td><td></td><td></td><td></td><td></td><td class="s">and changes to the database handle do not affect existing statement</td></tr>
<tr><td class="h"><a name="3336"></a>3336</td><td></td><td></td><td></td><td></td><td class="s">handles, only future ones.</td></tr>
<tr><td class="h"><a name="3337"></a>3337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3338"></a>3338</td><td></td><td></td><td></td><td></td><td class="s">Attempting to set or get the value of an unknown attribute generates a warning,</td></tr>
<tr><td class="h"><a name="3339"></a>3339</td><td></td><td></td><td></td><td></td><td class="s">except for private driver specific attributes (which all have names</td></tr>
<tr><td class="h"><a name="3340"></a>3340</td><td></td><td></td><td></td><td></td><td class="s">starting with a lowercase letter).</td></tr>
<tr><td class="h"><a name="3341"></a>3341</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3342"></a>3342</td><td></td><td></td><td></td><td></td><td class="s">Example:</td></tr>
<tr><td class="h"><a name="3343"></a>3343</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3344"></a>3344</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{AttributeName} = ...;        # set/write</td></tr>
<tr><td class="h"><a name="3345"></a>3345</td><td></td><td></td><td></td><td></td><td class="s">  ... = $h-&gt;{AttributeName};        # get/read</td></tr>
<tr><td class="h"><a name="3346"></a>3346</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3347"></a>3347</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Warn&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3348"></a>3348</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3349"></a>3349</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Warn&gt; attribute enables useful warnings for certain bad</td></tr>
<tr><td class="h"><a name="3350"></a>3350</td><td></td><td></td><td></td><td></td><td class="s">practices. It is enabled by default and should only be disabled in</td></tr>
<tr><td class="h"><a name="3351"></a>3351</td><td></td><td></td><td></td><td></td><td class="s">rare circumstances.  Since warnings are generated using the Perl</td></tr>
<tr><td class="h"><a name="3352"></a>3352</td><td></td><td></td><td></td><td></td><td class="s">C&lt;warn&gt; function, they can be intercepted using the Perl C&lt;$SIG{__WARN__}&gt;</td></tr>
<tr><td class="h"><a name="3353"></a>3353</td><td></td><td></td><td></td><td></td><td class="s">hook.</td></tr>
<tr><td class="h"><a name="3354"></a>3354</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3355"></a>3355</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Warn&gt; attribute is not related to the C&lt;PrintWarn&gt; attribute.</td></tr>
<tr><td class="h"><a name="3356"></a>3356</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3357"></a>3357</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Active&gt; (boolean, read-only)</td></tr>
<tr><td class="h"><a name="3358"></a>3358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3359"></a>3359</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Active&gt; attribute is true if the handle object is &quot;active&quot;. This is rarely used in</td></tr>
<tr><td class="h"><a name="3360"></a>3360</td><td></td><td></td><td></td><td></td><td class="s">applications. The exact meaning of active is somewhat vague at the</td></tr>
<tr><td class="h"><a name="3361"></a>3361</td><td></td><td></td><td></td><td></td><td class="s">moment. For a database handle it typically means that the handle is</td></tr>
<tr><td class="h"><a name="3362"></a>3362</td><td></td><td></td><td></td><td></td><td class="s">connected to a database (C&lt;$dbh-E&lt;gt&gt;disconnect&gt; sets C&lt;Active&gt; off).  For</td></tr>
<tr><td class="h"><a name="3363"></a>3363</td><td></td><td></td><td></td><td></td><td class="s">a statement handle it typically means that the handle is a C&lt;SELECT&gt;</td></tr>
<tr><td class="h"><a name="3364"></a>3364</td><td></td><td></td><td></td><td></td><td class="s">that may have more data to fetch. (Fetching all the data or calling C&lt;$sth-E&lt;gt&gt;finish&gt;</td></tr>
<tr><td class="h"><a name="3365"></a>3365</td><td></td><td></td><td></td><td></td><td class="s">sets C&lt;Active&gt; off.)</td></tr>
<tr><td class="h"><a name="3366"></a>3366</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3367"></a>3367</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Executed&gt; (boolean)</td></tr>
<tr><td class="h"><a name="3368"></a>3368</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3369"></a>3369</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Executed&gt; attribute is true if the handle object has been &quot;executed&quot;.</td></tr>
<tr><td class="h"><a name="3370"></a>3370</td><td></td><td></td><td></td><td></td><td class="s">Currently only the $dbh do() method and the $sth execute(), execute_array(),</td></tr>
<tr><td class="h"><a name="3371"></a>3371</td><td></td><td></td><td></td><td></td><td class="s">and execute_for_fetch() methods set the C&lt;Executed&gt; attribute.</td></tr>
<tr><td class="h"><a name="3372"></a>3372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3373"></a>3373</td><td></td><td></td><td></td><td></td><td class="s">When it's set on a handle it is also set on the parent handle at the</td></tr>
<tr><td class="h"><a name="3374"></a>3374</td><td></td><td></td><td></td><td></td><td class="s">same time. So calling execute() on a $sth also sets the C&lt;Executed&gt;</td></tr>
<tr><td class="h"><a name="3375"></a>3375</td><td></td><td></td><td></td><td></td><td class="s">attribute on the parent $dbh.</td></tr>
<tr><td class="h"><a name="3376"></a>3376</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3377"></a>3377</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Executed&gt; attribute for a database handle is cleared by the commit() and</td></tr>
<tr><td class="h"><a name="3378"></a>3378</td><td></td><td></td><td></td><td></td><td class="s">rollback() methods (even if they fail). The C&lt;Executed&gt; attribute of a</td></tr>
<tr><td class="h"><a name="3379"></a>3379</td><td></td><td></td><td></td><td></td><td class="s">statement handle is not cleared by the DBI under any circumstances and so acts</td></tr>
<tr><td class="h"><a name="3380"></a>3380</td><td></td><td></td><td></td><td></td><td class="s">as a permanent record of whether the statement handle was ever used.</td></tr>
<tr><td class="h"><a name="3381"></a>3381</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3382"></a>3382</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Executed&gt; attribute was added in DBI 1.41.</td></tr>
<tr><td class="h"><a name="3383"></a>3383</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3384"></a>3384</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Kids&gt; (integer, read-only)</td></tr>
<tr><td class="h"><a name="3385"></a>3385</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3386"></a>3386</td><td></td><td></td><td></td><td></td><td class="s">For a driver handle, C&lt;Kids&gt; is the number of currently existing database</td></tr>
<tr><td class="h"><a name="3387"></a>3387</td><td></td><td></td><td></td><td></td><td class="s">handles that were created from that driver handle.  For a database</td></tr>
<tr><td class="h"><a name="3388"></a>3388</td><td></td><td></td><td></td><td></td><td class="s">handle, C&lt;Kids&gt; is the number of currently existing statement handles that</td></tr>
<tr><td class="h"><a name="3389"></a>3389</td><td></td><td></td><td></td><td></td><td class="s">were created from that database handle.</td></tr>
<tr><td class="h"><a name="3390"></a>3390</td><td></td><td></td><td></td><td></td><td class="s">For a statement handle, the value is zero.</td></tr>
<tr><td class="h"><a name="3391"></a>3391</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3392"></a>3392</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ActiveKids&gt; (integer, read-only)</td></tr>
<tr><td class="h"><a name="3393"></a>3393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3394"></a>3394</td><td></td><td></td><td></td><td></td><td class="s">Like C&lt;Kids&gt;, but only counting those that are C&lt;Active&gt; (as above).</td></tr>
<tr><td class="h"><a name="3395"></a>3395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3396"></a>3396</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;CachedKids&gt; (hash ref)</td></tr>
<tr><td class="h"><a name="3397"></a>3397</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3398"></a>3398</td><td></td><td></td><td></td><td></td><td class="s">For a database handle, C&lt;CachedKids&gt; returns a reference to the cache (hash) of</td></tr>
<tr><td class="h"><a name="3399"></a>3399</td><td></td><td></td><td></td><td></td><td class="s">statement handles created by the L&lt;/prepare_cached&gt; method.  For a</td></tr>
<tr><td class="h"><a name="3400"></a>3400</td><td></td><td></td><td></td><td></td><td class="s">driver handle, returns a reference to the cache (hash) of</td></tr>
<tr><td class="h"><a name="3401"></a>3401</td><td></td><td></td><td></td><td></td><td class="s">database handles created by the L&lt;/connect_cached&gt; method.</td></tr>
<tr><td class="h"><a name="3402"></a>3402</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3403"></a>3403</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Type&gt; (scalar, read-only)</td></tr>
<tr><td class="h"><a name="3404"></a>3404</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3405"></a>3405</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Type&gt; attribute identifies the type of a DBI handle.  Returns</td></tr>
<tr><td class="h"><a name="3406"></a>3406</td><td></td><td></td><td></td><td></td><td class="s">&quot;dr&quot; for driver handles, &quot;db&quot; for database handles and &quot;st&quot; for</td></tr>
<tr><td class="h"><a name="3407"></a>3407</td><td></td><td></td><td></td><td></td><td class="s">statement handles.</td></tr>
<tr><td class="h"><a name="3408"></a>3408</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3409"></a>3409</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ChildHandles&gt; (array ref)</td></tr>
<tr><td class="h"><a name="3410"></a>3410</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3411"></a>3411</td><td></td><td></td><td></td><td></td><td class="s">The ChildHandles attribute contains a reference to an array of all the</td></tr>
<tr><td class="h"><a name="3412"></a>3412</td><td></td><td></td><td></td><td></td><td class="s">handles created by this handle which are still accessible.  The</td></tr>
<tr><td class="h"><a name="3413"></a>3413</td><td></td><td></td><td></td><td></td><td class="s">contents of the array are weak-refs and will become undef when the</td></tr>
<tr><td class="h"><a name="3414"></a>3414</td><td></td><td></td><td></td><td></td><td class="s">handle goes out of scope.</td></tr>
<tr><td class="h"><a name="3415"></a>3415</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3416"></a>3416</td><td></td><td></td><td></td><td></td><td class="s">C&lt;ChildHandles&gt; returns undef if your perl version does not support weak</td></tr>
<tr><td class="h"><a name="3417"></a>3417</td><td></td><td></td><td></td><td></td><td class="s">references (check the L&lt;Scalar::Util|Scalar::Util&gt; module).  The referenced</td></tr>
<tr><td class="h"><a name="3418"></a>3418</td><td></td><td></td><td></td><td></td><td class="s">array returned should be treated as read-only.</td></tr>
<tr><td class="h"><a name="3419"></a>3419</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3420"></a>3420</td><td></td><td></td><td></td><td></td><td class="s">For example, to enumerate all driver handles, database handles and</td></tr>
<tr><td class="h"><a name="3421"></a>3421</td><td></td><td></td><td></td><td></td><td class="s">statement handles:</td></tr>
<tr><td class="h"><a name="3422"></a>3422</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3423"></a>3423</td><td></td><td></td><td></td><td></td><td class="s">    sub show_child_handles {</td></tr>
<tr><td class="h"><a name="3424"></a>3424</td><td></td><td></td><td></td><td></td><td class="s">        my ($h, $level) = @_;</td></tr>
<tr><td class="h"><a name="3425"></a>3425</td><td></td><td></td><td></td><td></td><td class="s">        printf &quot;%sh %s %s\n&quot;, $h-&gt;{Type}, &quot;\t&quot; x $level, $h;</td></tr>
<tr><td class="h"><a name="3426"></a>3426</td><td></td><td></td><td></td><td></td><td class="s">        show_child_handles($_, $level + 1)</td></tr>
<tr><td class="h"><a name="3427"></a>3427</td><td></td><td></td><td></td><td></td><td class="s">            for (grep { defined } @{$h-&gt;{ChildHandles}});</td></tr>
<tr><td class="h"><a name="3428"></a>3428</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="3429"></a>3429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3430"></a>3430</td><td></td><td></td><td></td><td></td><td class="s">    my %drivers = DBI-&gt;installed_drivers();</td></tr>
<tr><td class="h"><a name="3431"></a>3431</td><td></td><td></td><td></td><td></td><td class="s">    show_child_handles($_, 0) for (values %drivers);</td></tr>
<tr><td class="h"><a name="3432"></a>3432</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3433"></a>3433</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;CompatMode&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3434"></a>3434</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3435"></a>3435</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;CompatMode&gt; attribute is used by emulation layers (such as</td></tr>
<tr><td class="h"><a name="3436"></a>3436</td><td></td><td></td><td></td><td></td><td class="s">Oraperl) to enable compatible behaviour in the underlying driver</td></tr>
<tr><td class="h"><a name="3437"></a>3437</td><td></td><td></td><td></td><td></td><td class="s">(e.g., DBD::Oracle) for this handle. Not normally set by application code.</td></tr>
<tr><td class="h"><a name="3438"></a>3438</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3439"></a>3439</td><td></td><td></td><td></td><td></td><td class="s">It also has the effect of disabling the 'quick FETCH' of attribute</td></tr>
<tr><td class="h"><a name="3440"></a>3440</td><td></td><td></td><td></td><td></td><td class="s">values from the handles attribute cache. So all attribute values</td></tr>
<tr><td class="h"><a name="3441"></a>3441</td><td></td><td></td><td></td><td></td><td class="s">are handled by the drivers own FETCH method. This makes them slightly</td></tr>
<tr><td class="h"><a name="3442"></a>3442</td><td></td><td></td><td></td><td></td><td class="s">slower but is useful for special-purpose drivers like DBD::Multiplex.</td></tr>
<tr><td class="h"><a name="3443"></a>3443</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3444"></a>3444</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;InactiveDestroy&gt; (boolean)</td></tr>
<tr><td class="h"><a name="3445"></a>3445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3446"></a>3446</td><td></td><td></td><td></td><td></td><td class="s">The default value, false, means a handle will be fully destroyed</td></tr>
<tr><td class="h"><a name="3447"></a>3447</td><td></td><td></td><td></td><td></td><td class="s">as normal when the last reference to it is removed, just as you'd expect.</td></tr>
<tr><td class="h"><a name="3448"></a>3448</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3449"></a>3449</td><td></td><td></td><td></td><td></td><td class="s">If set true then the handle will be treated by the DESTROY as if it was no</td></tr>
<tr><td class="h"><a name="3450"></a>3450</td><td></td><td></td><td></td><td></td><td class="s">longer Active, and so the I&lt;database engine&gt; related effects of DESTROYing a</td></tr>
<tr><td class="h"><a name="3451"></a>3451</td><td></td><td></td><td></td><td></td><td class="s">handle will be skipped.</td></tr>
<tr><td class="h"><a name="3452"></a>3452</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3453"></a>3453</td><td></td><td></td><td></td><td></td><td class="s">Think of the name as meaning 'treat the handle as not-Active in the DESTROY</td></tr>
<tr><td class="h"><a name="3454"></a>3454</td><td></td><td></td><td></td><td></td><td class="s">method'.</td></tr>
<tr><td class="h"><a name="3455"></a>3455</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3456"></a>3456</td><td></td><td></td><td></td><td></td><td class="s">For a database handle, this attribute does not disable an I&lt;explicit&gt;</td></tr>
<tr><td class="h"><a name="3457"></a>3457</td><td></td><td></td><td></td><td></td><td class="s">call to the disconnect method, only the implicit call from DESTROY</td></tr>
<tr><td class="h"><a name="3458"></a>3458</td><td></td><td></td><td></td><td></td><td class="s">that happens if the handle is still marked as C&lt;Active&gt;.</td></tr>
<tr><td class="h"><a name="3459"></a>3459</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3460"></a>3460</td><td></td><td></td><td></td><td></td><td class="s">This attribute is specifically designed for use in Unix applications</td></tr>
<tr><td class="h"><a name="3461"></a>3461</td><td></td><td></td><td></td><td></td><td class="s">that &quot;fork&quot; child processes. Either the parent or the child process,</td></tr>
<tr><td class="h"><a name="3462"></a>3462</td><td></td><td></td><td></td><td></td><td class="s">but not both, should set C&lt;InactiveDestroy&gt; true on all their shared handles.</td></tr>
<tr><td class="h"><a name="3463"></a>3463</td><td></td><td></td><td></td><td></td><td class="s">(Note that some databases, including Oracle, don't support passing a</td></tr>
<tr><td class="h"><a name="3464"></a>3464</td><td></td><td></td><td></td><td></td><td class="s">database connection across a fork.)</td></tr>
<tr><td class="h"><a name="3465"></a>3465</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3466"></a>3466</td><td></td><td></td><td></td><td></td><td class="s">To help tracing applications using fork the process id is shown in</td></tr>
<tr><td class="h"><a name="3467"></a>3467</td><td></td><td></td><td></td><td></td><td class="s">the trace log whenever a DBI or handle trace() method is called.</td></tr>
<tr><td class="h"><a name="3468"></a>3468</td><td></td><td></td><td></td><td></td><td class="s">The process id also shown for I&lt;every&gt; method call if the DBI trace</td></tr>
<tr><td class="h"><a name="3469"></a>3469</td><td></td><td></td><td></td><td></td><td class="s">level (not handle trace level) is set high enough to show the trace</td></tr>
<tr><td class="h"><a name="3470"></a>3470</td><td></td><td></td><td></td><td></td><td class="s">from the DBI's method dispatcher, e.g. &gt;= 9.</td></tr>
<tr><td class="h"><a name="3471"></a>3471</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3472"></a>3472</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;PrintWarn&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3473"></a>3473</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3474"></a>3474</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;PrintWarn&gt; attribute controls the printing of warnings recorded</td></tr>
<tr><td class="h"><a name="3475"></a>3475</td><td></td><td></td><td></td><td></td><td class="s">by the driver.  When set to a true value the DBI will check method</td></tr>
<tr><td class="h"><a name="3476"></a>3476</td><td></td><td></td><td></td><td></td><td class="s">calls to see if a warning condition has been set. If so, the DBI</td></tr>
<tr><td class="h"><a name="3477"></a>3477</td><td></td><td></td><td></td><td></td><td class="s">will effectively do a C&lt;warn(&quot;$class $method warning: $DBI::errstr&quot;)&gt;</td></tr>
<tr><td class="h"><a name="3478"></a>3478</td><td></td><td></td><td></td><td></td><td class="s">where C&lt;$class&gt; is the driver class and C&lt;$method&gt; is the name of</td></tr>
<tr><td class="h"><a name="3479"></a>3479</td><td></td><td></td><td></td><td></td><td class="s">the method which failed. E.g.,</td></tr>
<tr><td class="h"><a name="3480"></a>3480</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3481"></a>3481</td><td></td><td></td><td></td><td></td><td class="s">  DBD::Oracle::db execute warning: ... warning text here ...</td></tr>
<tr><td class="h"><a name="3482"></a>3482</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3483"></a>3483</td><td></td><td></td><td></td><td></td><td class="s">By default, C&lt;DBI-E&lt;gt&gt;connect&gt; sets C&lt;PrintWarn&gt; &quot;on&quot; if $^W is true,</td></tr>
<tr><td class="h"><a name="3484"></a>3484</td><td></td><td></td><td></td><td></td><td class="s">i.e., perl is running with warnings enabled.</td></tr>
<tr><td class="h"><a name="3485"></a>3485</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3486"></a>3486</td><td></td><td></td><td></td><td></td><td class="s">If desired, the warnings can be caught and processed using a C&lt;$SIG{__WARN__}&gt;</td></tr>
<tr><td class="h"><a name="3487"></a>3487</td><td></td><td></td><td></td><td></td><td class="s">handler or modules like CGI::Carp and CGI::ErrorWrap.</td></tr>
<tr><td class="h"><a name="3488"></a>3488</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3489"></a>3489</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/set_err&gt; for how warnings are recorded and L&lt;/HandleSetErr&gt;</td></tr>
<tr><td class="h"><a name="3490"></a>3490</td><td></td><td></td><td></td><td></td><td class="s">for how to influence it.</td></tr>
<tr><td class="h"><a name="3491"></a>3491</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3492"></a>3492</td><td></td><td></td><td></td><td></td><td class="s">Fetching the full details of warnings can require an extra round-trip</td></tr>
<tr><td class="h"><a name="3493"></a>3493</td><td></td><td></td><td></td><td></td><td class="s">to the database server for some drivers. In which case the driver</td></tr>
<tr><td class="h"><a name="3494"></a>3494</td><td></td><td></td><td></td><td></td><td class="s">may opt to only fetch the full details of warnings if the C&lt;PrintWarn&gt;</td></tr>
<tr><td class="h"><a name="3495"></a>3495</td><td></td><td></td><td></td><td></td><td class="s">attribute is true. If C&lt;PrintWarn&gt; is false then these drivers should</td></tr>
<tr><td class="h"><a name="3496"></a>3496</td><td></td><td></td><td></td><td></td><td class="s">still indicate the fact that there were warnings by setting the</td></tr>
<tr><td class="h"><a name="3497"></a>3497</td><td></td><td></td><td></td><td></td><td class="s">warning string to, for example: &quot;3 warnings&quot;.</td></tr>
<tr><td class="h"><a name="3498"></a>3498</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3499"></a>3499</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;PrintError&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3500"></a>3500</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3501"></a>3501</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;PrintError&gt; attribute can be used to force errors to generate warnings (using</td></tr>
<tr><td class="h"><a name="3502"></a>3502</td><td></td><td></td><td></td><td></td><td class="s">C&lt;warn&gt;) in addition to returning error codes in the normal way.  When set</td></tr>
<tr><td class="h"><a name="3503"></a>3503</td><td></td><td></td><td></td><td></td><td class="s">&quot;on&quot;, any method which results in an error occuring will cause the DBI to</td></tr>
<tr><td class="h"><a name="3504"></a>3504</td><td></td><td></td><td></td><td></td><td class="s">effectively do a C&lt;warn(&quot;$class $method failed: $DBI::errstr&quot;)&gt; where C&lt;$class&gt;</td></tr>
<tr><td class="h"><a name="3505"></a>3505</td><td></td><td></td><td></td><td></td><td class="s">is the driver class and C&lt;$method&gt; is the name of the method which failed. E.g.,</td></tr>
<tr><td class="h"><a name="3506"></a>3506</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3507"></a>3507</td><td></td><td></td><td></td><td></td><td class="s">  DBD::Oracle::db prepare failed: ... error text here ...</td></tr>
<tr><td class="h"><a name="3508"></a>3508</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3509"></a>3509</td><td></td><td></td><td></td><td></td><td class="s">By default, C&lt;DBI-E&lt;gt&gt;connect&gt; sets C&lt;PrintError&gt; &quot;on&quot;.</td></tr>
<tr><td class="h"><a name="3510"></a>3510</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3511"></a>3511</td><td></td><td></td><td></td><td></td><td class="s">If desired, the warnings can be caught and processed using a C&lt;$SIG{__WARN__}&gt;</td></tr>
<tr><td class="h"><a name="3512"></a>3512</td><td></td><td></td><td></td><td></td><td class="s">handler or modules like CGI::Carp and CGI::ErrorWrap.</td></tr>
<tr><td class="h"><a name="3513"></a>3513</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3514"></a>3514</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;RaiseError&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3515"></a>3515</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3516"></a>3516</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;RaiseError&gt; attribute can be used to force errors to raise exceptions rather</td></tr>
<tr><td class="h"><a name="3517"></a>3517</td><td></td><td></td><td></td><td></td><td class="s">than simply return error codes in the normal way. It is &quot;off&quot; by default.</td></tr>
<tr><td class="h"><a name="3518"></a>3518</td><td></td><td></td><td></td><td></td><td class="s">When set &quot;on&quot;, any method which results in an error will cause</td></tr>
<tr><td class="h"><a name="3519"></a>3519</td><td></td><td></td><td></td><td></td><td class="s">the DBI to effectively do a C&lt;die(&quot;$class $method failed: $DBI::errstr&quot;)&gt;,</td></tr>
<tr><td class="h"><a name="3520"></a>3520</td><td></td><td></td><td></td><td></td><td class="s">where C&lt;$class&gt; is the driver class and C&lt;$method&gt; is the name of the method</td></tr>
<tr><td class="h"><a name="3521"></a>3521</td><td></td><td></td><td></td><td></td><td class="s">that failed. E.g.,</td></tr>
<tr><td class="h"><a name="3522"></a>3522</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3523"></a>3523</td><td></td><td></td><td></td><td></td><td class="s">  DBD::Oracle::db prepare failed: ... error text here ...</td></tr>
<tr><td class="h"><a name="3524"></a>3524</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3525"></a>3525</td><td></td><td></td><td></td><td></td><td class="s">If you turn C&lt;RaiseError&gt; on then you'd normally turn C&lt;PrintError&gt; off.</td></tr>
<tr><td class="h"><a name="3526"></a>3526</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;PrintError&gt; is also on, then the C&lt;PrintError&gt; is done first (naturally).</td></tr>
<tr><td class="h"><a name="3527"></a>3527</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3528"></a>3528</td><td></td><td></td><td></td><td></td><td class="s">Typically C&lt;RaiseError&gt; is used in conjunction with C&lt;eval { ... }&gt;</td></tr>
<tr><td class="h"><a name="3529"></a>3529</td><td></td><td></td><td></td><td></td><td class="s">to catch the exception that's been thrown and followed by an</td></tr>
<tr><td class="h"><a name="3530"></a>3530</td><td></td><td></td><td></td><td></td><td class="s">C&lt;if ($@) { ... }&gt; block to handle the caught exception.</td></tr>
<tr><td class="h"><a name="3531"></a>3531</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="3532"></a>3532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3533"></a>3533</td><td></td><td></td><td></td><td></td><td class="s">  eval {</td></tr>
<tr><td class="h"><a name="3534"></a>3534</td><td></td><td></td><td></td><td></td><td class="s">    ...</td></tr>
<tr><td class="h"><a name="3535"></a>3535</td><td></td><td></td><td></td><td></td><td class="s">    $sth-&gt;execute();</td></tr>
<tr><td class="h"><a name="3536"></a>3536</td><td></td><td></td><td></td><td></td><td class="s">    ...</td></tr>
<tr><td class="h"><a name="3537"></a>3537</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="3538"></a>3538</td><td></td><td></td><td></td><td></td><td class="s">  if ($@) {</td></tr>
<tr><td class="h"><a name="3539"></a>3539</td><td></td><td></td><td></td><td></td><td class="s">    # $sth-&gt;err and $DBI::err will be true if error was from DBI</td></tr>
<tr><td class="h"><a name="3540"></a>3540</td><td></td><td></td><td></td><td></td><td class="s">    warn $@; # print the error</td></tr>
<tr><td class="h"><a name="3541"></a>3541</td><td></td><td></td><td></td><td></td><td class="s">    ... # do whatever you need to deal with the error</td></tr>
<tr><td class="h"><a name="3542"></a>3542</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3543"></a>3543</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3544"></a>3544</td><td></td><td></td><td></td><td></td><td class="s">In that eval block the $DBI::lasth variable can be useful for</td></tr>
<tr><td class="h"><a name="3545"></a>3545</td><td></td><td></td><td></td><td></td><td class="s">diagnosis and reporting if you can't be sure which handle triggered</td></tr>
<tr><td class="h"><a name="3546"></a>3546</td><td></td><td></td><td></td><td></td><td class="s">the error.  For example, $DBI::lasth-&gt;{Type} and $DBI::lasth-&gt;{Statement}.</td></tr>
<tr><td class="h"><a name="3547"></a>3547</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3548"></a>3548</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/Transactions&gt;.</td></tr>
<tr><td class="h"><a name="3549"></a>3549</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3550"></a>3550</td><td></td><td></td><td></td><td></td><td class="s">If you want to temporarily turn C&lt;RaiseError&gt; off (inside a library function</td></tr>
<tr><td class="h"><a name="3551"></a>3551</td><td></td><td></td><td></td><td></td><td class="s">that is likely to fail, for example), the recommended way is like this:</td></tr>
<tr><td class="h"><a name="3552"></a>3552</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3553"></a>3553</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="3554"></a>3554</td><td></td><td></td><td></td><td></td><td class="s">    local $h-&gt;{RaiseError};  # localize and turn off for this block</td></tr>
<tr><td class="h"><a name="3555"></a>3555</td><td></td><td></td><td></td><td></td><td class="s">    ...</td></tr>
<tr><td class="h"><a name="3556"></a>3556</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3557"></a>3557</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3558"></a>3558</td><td></td><td></td><td></td><td></td><td class="s">The original value will automatically and reliably be restored by Perl,</td></tr>
<tr><td class="h"><a name="3559"></a>3559</td><td></td><td></td><td></td><td></td><td class="s">regardless of how the block is exited.</td></tr>
<tr><td class="h"><a name="3560"></a>3560</td><td></td><td></td><td></td><td></td><td class="s">The same logic applies to other attributes, including C&lt;PrintError&gt;.</td></tr>
<tr><td class="h"><a name="3561"></a>3561</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3562"></a>3562</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;HandleError&gt; (code ref, inherited)</td></tr>
<tr><td class="h"><a name="3563"></a>3563</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3564"></a>3564</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;HandleError&gt; attribute can be used to provide your own alternative behaviour</td></tr>
<tr><td class="h"><a name="3565"></a>3565</td><td></td><td></td><td></td><td></td><td class="s">in case of errors. If set to a reference to a subroutine then that</td></tr>
<tr><td class="h"><a name="3566"></a>3566</td><td></td><td></td><td></td><td></td><td class="s">subroutine is called when an error is detected (at the same point that</td></tr>
<tr><td class="h"><a name="3567"></a>3567</td><td></td><td></td><td></td><td></td><td class="s">C&lt;RaiseError&gt; and C&lt;PrintError&gt; are handled).</td></tr>
<tr><td class="h"><a name="3568"></a>3568</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3569"></a>3569</td><td></td><td></td><td></td><td></td><td class="s">The subroutine is called with three parameters: the error message</td></tr>
<tr><td class="h"><a name="3570"></a>3570</td><td></td><td></td><td></td><td></td><td class="s">string that C&lt;RaiseError&gt; and C&lt;PrintError&gt; would use,</td></tr>
<tr><td class="h"><a name="3571"></a>3571</td><td></td><td></td><td></td><td></td><td class="s">the DBI handle being used, and the first value being returned by</td></tr>
<tr><td class="h"><a name="3572"></a>3572</td><td></td><td></td><td></td><td></td><td class="s">the method that failed (typically undef).</td></tr>
<tr><td class="h"><a name="3573"></a>3573</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3574"></a>3574</td><td></td><td></td><td></td><td></td><td class="s">If the subroutine returns a false value then the C&lt;RaiseError&gt;</td></tr>
<tr><td class="h"><a name="3575"></a>3575</td><td></td><td></td><td></td><td></td><td class="s">and/or C&lt;PrintError&gt; attributes are checked and acted upon as normal.</td></tr>
<tr><td class="h"><a name="3576"></a>3576</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3577"></a>3577</td><td></td><td></td><td></td><td></td><td class="s">For example, to C&lt;die&gt; with a full stack trace for any error:</td></tr>
<tr><td class="h"><a name="3578"></a>3578</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3579"></a>3579</td><td></td><td></td><td></td><td></td><td class="s">  use Carp;</td></tr>
<tr><td class="h"><a name="3580"></a>3580</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{HandleError} = sub { confess(shift) };</td></tr>
<tr><td class="h"><a name="3581"></a>3581</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3582"></a>3582</td><td></td><td></td><td></td><td></td><td class="s">Or to turn errors into exceptions:</td></tr>
<tr><td class="h"><a name="3583"></a>3583</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3584"></a>3584</td><td></td><td></td><td></td><td></td><td class="s">  use Exception; # or your own favourite exception module</td></tr>
<tr><td class="h"><a name="3585"></a>3585</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{HandleError} = sub { Exception-&gt;new('DBI')-&gt;raise($_[0]) };</td></tr>
<tr><td class="h"><a name="3586"></a>3586</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3587"></a>3587</td><td></td><td></td><td></td><td></td><td class="s">It is possible to 'stack' multiple HandleError handlers by using</td></tr>
<tr><td class="h"><a name="3588"></a>3588</td><td></td><td></td><td></td><td></td><td class="s">closures:</td></tr>
<tr><td class="h"><a name="3589"></a>3589</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3590"></a>3590</td><td></td><td></td><td></td><td></td><td class="s">  sub your_subroutine {</td></tr>
<tr><td class="h"><a name="3591"></a>3591</td><td></td><td></td><td></td><td></td><td class="s">    my $previous_handler = $h-&gt;{HandleError};</td></tr>
<tr><td class="h"><a name="3592"></a>3592</td><td></td><td></td><td></td><td></td><td class="s">    $h-&gt;{HandleError} = sub {</td></tr>
<tr><td class="h"><a name="3593"></a>3593</td><td></td><td></td><td></td><td></td><td class="s">      return 1 if $previous_handler and &amp;$previous_handler(@_);</td></tr>
<tr><td class="h"><a name="3594"></a>3594</td><td></td><td></td><td></td><td></td><td class="s">      ... your code here ...</td></tr>
<tr><td class="h"><a name="3595"></a>3595</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="3596"></a>3596</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3597"></a>3597</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3598"></a>3598</td><td></td><td></td><td></td><td></td><td class="s">Using a C&lt;my&gt; inside a subroutine to store the previous C&lt;HandleError&gt;</td></tr>
<tr><td class="h"><a name="3599"></a>3599</td><td></td><td></td><td></td><td></td><td class="s">value is important.  See L&lt;perlsub&gt; and L&lt;perlref&gt; for more information</td></tr>
<tr><td class="h"><a name="3600"></a>3600</td><td></td><td></td><td></td><td></td><td class="s">about I&lt;closures&gt;.</td></tr>
<tr><td class="h"><a name="3601"></a>3601</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3602"></a>3602</td><td></td><td></td><td></td><td></td><td class="s">It is possible for C&lt;HandleError&gt; to alter the error message that</td></tr>
<tr><td class="h"><a name="3603"></a>3603</td><td></td><td></td><td></td><td></td><td class="s">will be used by C&lt;RaiseError&gt; and C&lt;PrintError&gt; if it returns false.</td></tr>
<tr><td class="h"><a name="3604"></a>3604</td><td></td><td></td><td></td><td></td><td class="s">It can do that by altering the value of $_[0]. This example appends</td></tr>
<tr><td class="h"><a name="3605"></a>3605</td><td></td><td></td><td></td><td></td><td class="s">a stack trace to all errors and, unlike the previous example using</td></tr>
<tr><td class="h"><a name="3606"></a>3606</td><td></td><td></td><td></td><td></td><td class="s">Carp::confess, this will work C&lt;PrintError&gt; as well as C&lt;RaiseError&gt;:</td></tr>
<tr><td class="h"><a name="3607"></a>3607</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3608"></a>3608</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{HandleError} = sub { $_[0]=Carp::longmess($_[0]); 0; };</td></tr>
<tr><td class="h"><a name="3609"></a>3609</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3610"></a>3610</td><td></td><td></td><td></td><td></td><td class="s">It is also possible for C&lt;HandleError&gt; to hide an error, to a limited</td></tr>
<tr><td class="h"><a name="3611"></a>3611</td><td></td><td></td><td></td><td></td><td class="s">degree, by using L&lt;/set_err&gt; to reset $DBI::err and $DBI::errstr,</td></tr>
<tr><td class="h"><a name="3612"></a>3612</td><td></td><td></td><td></td><td></td><td class="s">and altering the return value of the failed method. For example:</td></tr>
<tr><td class="h"><a name="3613"></a>3613</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3614"></a>3614</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{HandleError} = sub {</td></tr>
<tr><td class="h"><a name="3615"></a>3615</td><td></td><td></td><td></td><td></td><td class="s">    return 0 unless $_[0] =~ /^\S+ fetchrow_arrayref failed:/;</td></tr>
<tr><td class="h"><a name="3616"></a>3616</td><td></td><td></td><td></td><td></td><td class="s">    return 0 unless $_[1]-&gt;err == 1234; # the error to 'hide'</td></tr>
<tr><td class="h"><a name="3617"></a>3617</td><td></td><td></td><td></td><td></td><td class="s">    $h-&gt;set_err(undef,undef);        # turn off the error</td></tr>
<tr><td class="h"><a name="3618"></a>3618</td><td></td><td></td><td></td><td></td><td class="s">    $_[2] = [ ... ];        # supply alternative return value</td></tr>
<tr><td class="h"><a name="3619"></a>3619</td><td></td><td></td><td></td><td></td><td class="s">    return 1;</td></tr>
<tr><td class="h"><a name="3620"></a>3620</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="3621"></a>3621</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3622"></a>3622</td><td></td><td></td><td></td><td></td><td class="s">This only works for methods which return a single value and is hard</td></tr>
<tr><td class="h"><a name="3623"></a>3623</td><td></td><td></td><td></td><td></td><td class="s">to make reliable (avoiding infinite loops, for example) and so isn't</td></tr>
<tr><td class="h"><a name="3624"></a>3624</td><td></td><td></td><td></td><td></td><td class="s">recommended for general use!  If you find a I&lt;good&gt; use for it then</td></tr>
<tr><td class="h"><a name="3625"></a>3625</td><td></td><td></td><td></td><td></td><td class="s">please let me know.</td></tr>
<tr><td class="h"><a name="3626"></a>3626</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3627"></a>3627</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;HandleSetErr&gt; (code ref, inherited)</td></tr>
<tr><td class="h"><a name="3628"></a>3628</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3629"></a>3629</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;HandleSetErr&gt; attribute can be used to intercept</td></tr>
<tr><td class="h"><a name="3630"></a>3630</td><td></td><td></td><td></td><td></td><td class="s">the setting of handle C&lt;err&gt;, C&lt;errstr&gt;, and C&lt;state&gt; values.</td></tr>
<tr><td class="h"><a name="3631"></a>3631</td><td></td><td></td><td></td><td></td><td class="s">If set to a reference to a subroutine then that subroutine is called</td></tr>
<tr><td class="h"><a name="3632"></a>3632</td><td></td><td></td><td></td><td></td><td class="s">whenever set_err() is called, typically by the driver or a subclass.</td></tr>
<tr><td class="h"><a name="3633"></a>3633</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3634"></a>3634</td><td></td><td></td><td></td><td></td><td class="s">The subroutine is called with five arguments, the first five that</td></tr>
<tr><td class="h"><a name="3635"></a>3635</td><td></td><td></td><td></td><td></td><td class="s">were passed to set_err(): the handle, the C&lt;err&gt;, C&lt;errstr&gt;, and</td></tr>
<tr><td class="h"><a name="3636"></a>3636</td><td></td><td></td><td></td><td></td><td class="s">C&lt;state&gt; values being set, and the method name. These can be altered</td></tr>
<tr><td class="h"><a name="3637"></a>3637</td><td></td><td></td><td></td><td></td><td class="s">by changing the values in the @_ array. The return value affects</td></tr>
<tr><td class="h"><a name="3638"></a>3638</td><td></td><td></td><td></td><td></td><td class="s">set_err() behaviour, see L&lt;/set_err&gt; for details.</td></tr>
<tr><td class="h"><a name="3639"></a>3639</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3640"></a>3640</td><td></td><td></td><td></td><td></td><td class="s">It is possible to 'stack' multiple HandleSetErr handlers by using</td></tr>
<tr><td class="h"><a name="3641"></a>3641</td><td></td><td></td><td></td><td></td><td class="s">closures. See L&lt;/HandleError&gt; for an example.</td></tr>
<tr><td class="h"><a name="3642"></a>3642</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3643"></a>3643</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;HandleSetErr&gt; and C&lt;HandleError&gt; subroutines differ in subtle</td></tr>
<tr><td class="h"><a name="3644"></a>3644</td><td></td><td></td><td></td><td></td><td class="s">but significant ways. HandleError is only invoked at the point where</td></tr>
<tr><td class="h"><a name="3645"></a>3645</td><td></td><td></td><td></td><td></td><td class="s">the DBI is about to return to the application with C&lt;err&gt; set true.</td></tr>
<tr><td class="h"><a name="3646"></a>3646</td><td></td><td></td><td></td><td></td><td class="s">It's not invoked by the failure of a method that's been called by</td></tr>
<tr><td class="h"><a name="3647"></a>3647</td><td></td><td></td><td></td><td></td><td class="s">another DBI method.  HandleSetErr, on the other hand, is called</td></tr>
<tr><td class="h"><a name="3648"></a>3648</td><td></td><td></td><td></td><td></td><td class="s">whenever set_err() is called with a defined C&lt;err&gt; value, even if false.</td></tr>
<tr><td class="h"><a name="3649"></a>3649</td><td></td><td></td><td></td><td></td><td class="s">So it's not just for errors, despite the name, but also warn and info states.</td></tr>
<tr><td class="h"><a name="3650"></a>3650</td><td></td><td></td><td></td><td></td><td class="s">The set_err() method, and thus HandleSetErr, may be called multiple</td></tr>
<tr><td class="h"><a name="3651"></a>3651</td><td></td><td></td><td></td><td></td><td class="s">times within a method and is usually invoked from deep within driver code.</td></tr>
<tr><td class="h"><a name="3652"></a>3652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3653"></a>3653</td><td></td><td></td><td></td><td></td><td class="s">In theory a driver can use the return value from HandleSetErr via</td></tr>
<tr><td class="h"><a name="3654"></a>3654</td><td></td><td></td><td></td><td></td><td class="s">set_err() to decide whether to continue or not. If set_err() returns</td></tr>
<tr><td class="h"><a name="3655"></a>3655</td><td></td><td></td><td></td><td></td><td class="s">an empty list, indicating that the HandleSetErr code has 'handled'</td></tr>
<tr><td class="h"><a name="3656"></a>3656</td><td></td><td></td><td></td><td></td><td class="s">the 'error', the driver could then continue instead of failing (if</td></tr>
<tr><td class="h"><a name="3657"></a>3657</td><td></td><td></td><td></td><td></td><td class="s">that's a reasonable thing to do).  This isn't excepted to be</td></tr>
<tr><td class="h"><a name="3658"></a>3658</td><td></td><td></td><td></td><td></td><td class="s">common and any such cases should be clearly marked in the driver</td></tr>
<tr><td class="h"><a name="3659"></a>3659</td><td></td><td></td><td></td><td></td><td class="s">documentation and discussed on the dbi-dev mailing list.</td></tr>
<tr><td class="h"><a name="3660"></a>3660</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3661"></a>3661</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;HandleSetErr&gt; attribute was added in DBI 1.41.</td></tr>
<tr><td class="h"><a name="3662"></a>3662</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3663"></a>3663</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ErrCount&gt; (unsigned integer)</td></tr>
<tr><td class="h"><a name="3664"></a>3664</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3665"></a>3665</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ErrCount&gt; attribute is incremented whenever the set_err()</td></tr>
<tr><td class="h"><a name="3666"></a>3666</td><td></td><td></td><td></td><td></td><td class="s">method records an error. It isn't incremented by warnings or</td></tr>
<tr><td class="h"><a name="3667"></a>3667</td><td></td><td></td><td></td><td></td><td class="s">information states. It is not reset by the DBI at any time.</td></tr>
<tr><td class="h"><a name="3668"></a>3668</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3669"></a>3669</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ErrCount&gt; attribute was added in DBI 1.41. Older drivers may</td></tr>
<tr><td class="h"><a name="3670"></a>3670</td><td></td><td></td><td></td><td></td><td class="s">not have been updated to use set_err() to record errors and so this</td></tr>
<tr><td class="h"><a name="3671"></a>3671</td><td></td><td></td><td></td><td></td><td class="s">attribute may not be incremented when using them.</td></tr>
<tr><td class="h"><a name="3672"></a>3672</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3673"></a>3673</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3674"></a>3674</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ShowErrorStatement&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3675"></a>3675</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3676"></a>3676</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ShowErrorStatement&gt; attribute can be used to cause the relevant</td></tr>
<tr><td class="h"><a name="3677"></a>3677</td><td></td><td></td><td></td><td></td><td class="s">Statement text to be appended to the error messages generated by</td></tr>
<tr><td class="h"><a name="3678"></a>3678</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;RaiseError&gt;, C&lt;PrintError&gt;, and C&lt;PrintWarn&gt; attributes.</td></tr>
<tr><td class="h"><a name="3679"></a>3679</td><td></td><td></td><td></td><td></td><td class="s">Only applies to errors on statement handles</td></tr>
<tr><td class="h"><a name="3680"></a>3680</td><td></td><td></td><td></td><td></td><td class="s">plus the prepare(), do(), and the various C&lt;select*()&gt; database handle methods.</td></tr>
<tr><td class="h"><a name="3681"></a>3681</td><td></td><td></td><td></td><td></td><td class="s">(The exact format of the appended text is subject to change.)</td></tr>
<tr><td class="h"><a name="3682"></a>3682</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3683"></a>3683</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;$h-E&lt;gt&gt;{ParamValues}&gt; returns a hash reference of parameter</td></tr>
<tr><td class="h"><a name="3684"></a>3684</td><td></td><td></td><td></td><td></td><td class="s">(placeholder) values then those are formatted and appended to the</td></tr>
<tr><td class="h"><a name="3685"></a>3685</td><td></td><td></td><td></td><td></td><td class="s">end of the Statement text in the error message.</td></tr>
<tr><td class="h"><a name="3686"></a>3686</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3687"></a>3687</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;TraceLevel&gt; (integer, inherited)</td></tr>
<tr><td class="h"><a name="3688"></a>3688</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3689"></a>3689</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TraceLevel&gt; attribute can be used as an alternative to the</td></tr>
<tr><td class="h"><a name="3690"></a>3690</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/trace&gt; method to set the DBI trace level and trace flags for a</td></tr>
<tr><td class="h"><a name="3691"></a>3691</td><td></td><td></td><td></td><td></td><td class="s">specific handle.  See L&lt;/TRACING&gt; for more details.</td></tr>
<tr><td class="h"><a name="3692"></a>3692</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3693"></a>3693</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TraceLevel&gt; attribute is especially useful combined with</td></tr>
<tr><td class="h"><a name="3694"></a>3694</td><td></td><td></td><td></td><td></td><td class="s">C&lt;local&gt; to alter the trace settings for just a single block of code.</td></tr>
<tr><td class="h"><a name="3695"></a>3695</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3696"></a>3696</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;FetchHashKeyName&gt; (string, inherited)</td></tr>
<tr><td class="h"><a name="3697"></a>3697</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3698"></a>3698</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;FetchHashKeyName&gt; attribute is used to specify whether the fetchrow_hashref()</td></tr>
<tr><td class="h"><a name="3699"></a>3699</td><td></td><td></td><td></td><td></td><td class="s">method should perform case conversion on the field names used for</td></tr>
<tr><td class="h"><a name="3700"></a>3700</td><td></td><td></td><td></td><td></td><td class="s">the hash keys. For historical reasons it defaults to 'C&lt;NAME&gt;' but</td></tr>
<tr><td class="h"><a name="3701"></a>3701</td><td></td><td></td><td></td><td></td><td class="s">it is recommended to set it to 'C&lt;NAME_lc&gt;' (convert to lower case)</td></tr>
<tr><td class="h"><a name="3702"></a>3702</td><td></td><td></td><td></td><td></td><td class="s">or 'C&lt;NAME_uc&gt;' (convert to upper case) according to your preference.</td></tr>
<tr><td class="h"><a name="3703"></a>3703</td><td></td><td></td><td></td><td></td><td class="s">It can only be set for driver and database handles.  For statement</td></tr>
<tr><td class="h"><a name="3704"></a>3704</td><td></td><td></td><td></td><td></td><td class="s">handles the value is frozen when prepare() is called.</td></tr>
<tr><td class="h"><a name="3705"></a>3705</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3706"></a>3706</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3707"></a>3707</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ChopBlanks&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3708"></a>3708</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3709"></a>3709</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ChopBlanks&gt; attribute can be used to control the trimming of trailing space</td></tr>
<tr><td class="h"><a name="3710"></a>3710</td><td></td><td></td><td></td><td></td><td class="s">characters from fixed width character (CHAR) fields. No other field</td></tr>
<tr><td class="h"><a name="3711"></a>3711</td><td></td><td></td><td></td><td></td><td class="s">types are affected, even where field values have trailing spaces.</td></tr>
<tr><td class="h"><a name="3712"></a>3712</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3713"></a>3713</td><td></td><td></td><td></td><td></td><td class="s">The default is false (although it is possible that the default may change).</td></tr>
<tr><td class="h"><a name="3714"></a>3714</td><td></td><td></td><td></td><td></td><td class="s">Applications that need specific behaviour should set the attribute as</td></tr>
<tr><td class="h"><a name="3715"></a>3715</td><td></td><td></td><td></td><td></td><td class="s">needed.</td></tr>
<tr><td class="h"><a name="3716"></a>3716</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3717"></a>3717</td><td></td><td></td><td></td><td></td><td class="s">Drivers are not required to support this attribute, but any driver which</td></tr>
<tr><td class="h"><a name="3718"></a>3718</td><td></td><td></td><td></td><td></td><td class="s">does not support it must arrange to return C&lt;undef&gt; as the attribute value.</td></tr>
<tr><td class="h"><a name="3719"></a>3719</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3720"></a>3720</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3721"></a>3721</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;LongReadLen&gt; (unsigned integer, inherited)</td></tr>
<tr><td class="h"><a name="3722"></a>3722</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3723"></a>3723</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;LongReadLen&gt; attribute may be used to control the maximum</td></tr>
<tr><td class="h"><a name="3724"></a>3724</td><td></td><td></td><td></td><td></td><td class="s">length of 'long' type fields (LONG, BLOB, CLOB, MEMO, etc.) which the driver will</td></tr>
<tr><td class="h"><a name="3725"></a>3725</td><td></td><td></td><td></td><td></td><td class="s">read from the database automatically when it fetches each row of data.</td></tr>
<tr><td class="h"><a name="3726"></a>3726</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3727"></a>3727</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;LongReadLen&gt; attribute only relates to fetching and reading</td></tr>
<tr><td class="h"><a name="3728"></a>3728</td><td></td><td></td><td></td><td></td><td class="s">long values; it is not involved in inserting or updating them.</td></tr>
<tr><td class="h"><a name="3729"></a>3729</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3730"></a>3730</td><td></td><td></td><td></td><td></td><td class="s">A value of 0 means not to automatically fetch any long data.</td></tr>
<tr><td class="h"><a name="3731"></a>3731</td><td></td><td></td><td></td><td></td><td class="s">Drivers may return undef or an empty string for long fields when</td></tr>
<tr><td class="h"><a name="3732"></a>3732</td><td></td><td></td><td></td><td></td><td class="s">C&lt;LongReadLen&gt; is 0.</td></tr>
<tr><td class="h"><a name="3733"></a>3733</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3734"></a>3734</td><td></td><td></td><td></td><td></td><td class="s">The default is typically 0 (zero) or 80 bytes but may vary between drivers.</td></tr>
<tr><td class="h"><a name="3735"></a>3735</td><td></td><td></td><td></td><td></td><td class="s">Applications fetching long fields should set this value to slightly</td></tr>
<tr><td class="h"><a name="3736"></a>3736</td><td></td><td></td><td></td><td></td><td class="s">larger than the longest long field value to be fetched.</td></tr>
<tr><td class="h"><a name="3737"></a>3737</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3738"></a>3738</td><td></td><td></td><td></td><td></td><td class="s">Some databases return some long types encoded as pairs of hex digits.</td></tr>
<tr><td class="h"><a name="3739"></a>3739</td><td></td><td></td><td></td><td></td><td class="s">For these types, C&lt;LongReadLen&gt; relates to the underlying data</td></tr>
<tr><td class="h"><a name="3740"></a>3740</td><td></td><td></td><td></td><td></td><td class="s">length and not the doubled-up length of the encoded string.</td></tr>
<tr><td class="h"><a name="3741"></a>3741</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3742"></a>3742</td><td></td><td></td><td></td><td></td><td class="s">Changing the value of C&lt;LongReadLen&gt; for a statement handle after it</td></tr>
<tr><td class="h"><a name="3743"></a>3743</td><td></td><td></td><td></td><td></td><td class="s">has been C&lt;prepare&gt;'d will typically have no effect, so it's common to</td></tr>
<tr><td class="h"><a name="3744"></a>3744</td><td></td><td></td><td></td><td></td><td class="s">set C&lt;LongReadLen&gt; on the C&lt;$dbh&gt; before calling C&lt;prepare&gt;.</td></tr>
<tr><td class="h"><a name="3745"></a>3745</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3746"></a>3746</td><td></td><td></td><td></td><td></td><td class="s">For most drivers the value used here has a direct effect on the</td></tr>
<tr><td class="h"><a name="3747"></a>3747</td><td></td><td></td><td></td><td></td><td class="s">memory used by the statement handle while it's active, so don't be</td></tr>
<tr><td class="h"><a name="3748"></a>3748</td><td></td><td></td><td></td><td></td><td class="s">too generous. If you can't be sure what value to use you could</td></tr>
<tr><td class="h"><a name="3749"></a>3749</td><td></td><td></td><td></td><td></td><td class="s">execute an extra select statement to determine the longest value.</td></tr>
<tr><td class="h"><a name="3750"></a>3750</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="3751"></a>3751</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3752"></a>3752</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{LongReadLen} = $dbh-&gt;selectrow_array(qq{</td></tr>
<tr><td class="h"><a name="3753"></a>3753</td><td></td><td></td><td></td><td></td><td class="s">      SELECT MAX(OCTET_LENGTH(long_column_name))</td></tr>
<tr><td class="h"><a name="3754"></a>3754</td><td></td><td></td><td></td><td></td><td class="s">      FROM table WHERE ...</td></tr>
<tr><td class="h"><a name="3755"></a>3755</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="3756"></a>3756</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(qq{</td></tr>
<tr><td class="h"><a name="3757"></a>3757</td><td></td><td></td><td></td><td></td><td class="s">      SELECT long_column_name, ... FROM table WHERE ...</td></tr>
<tr><td class="h"><a name="3758"></a>3758</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="3759"></a>3759</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3760"></a>3760</td><td></td><td></td><td></td><td></td><td class="s">You may need to take extra care if the table can be modified between</td></tr>
<tr><td class="h"><a name="3761"></a>3761</td><td></td><td></td><td></td><td></td><td class="s">the first select and the second being executed. You may also need to</td></tr>
<tr><td class="h"><a name="3762"></a>3762</td><td></td><td></td><td></td><td></td><td class="s">use a different function if OCTET_LENGTH() does not work for long</td></tr>
<tr><td class="h"><a name="3763"></a>3763</td><td></td><td></td><td></td><td></td><td class="s">types in your database. For example, for Sybase use DATALENGTH() and</td></tr>
<tr><td class="h"><a name="3764"></a>3764</td><td></td><td></td><td></td><td></td><td class="s">for Oracle use LENGTHB().</td></tr>
<tr><td class="h"><a name="3765"></a>3765</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3766"></a>3766</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/LongTruncOk&gt; for information on truncation of long types.</td></tr>
<tr><td class="h"><a name="3767"></a>3767</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3768"></a>3768</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;LongTruncOk&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3769"></a>3769</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3770"></a>3770</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;LongTruncOk&gt; attribute may be used to control the effect of</td></tr>
<tr><td class="h"><a name="3771"></a>3771</td><td></td><td></td><td></td><td></td><td class="s">fetching a long field value which has been truncated (typically</td></tr>
<tr><td class="h"><a name="3772"></a>3772</td><td></td><td></td><td></td><td></td><td class="s">because it's longer than the value of the C&lt;LongReadLen&gt; attribute).</td></tr>
<tr><td class="h"><a name="3773"></a>3773</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3774"></a>3774</td><td></td><td></td><td></td><td></td><td class="s">By default, C&lt;LongTruncOk&gt; is false and so fetching a long value that</td></tr>
<tr><td class="h"><a name="3775"></a>3775</td><td></td><td></td><td></td><td></td><td class="s">needs to be truncated will cause the fetch to fail.</td></tr>
<tr><td class="h"><a name="3776"></a>3776</td><td></td><td></td><td></td><td></td><td class="s">(Applications should always be sure to</td></tr>
<tr><td class="h"><a name="3777"></a>3777</td><td></td><td></td><td></td><td></td><td class="s">check for errors after a fetch loop in case an error, such as a divide</td></tr>
<tr><td class="h"><a name="3778"></a>3778</td><td></td><td></td><td></td><td></td><td class="s">by zero or long field truncation, caused the fetch to terminate</td></tr>
<tr><td class="h"><a name="3779"></a>3779</td><td></td><td></td><td></td><td></td><td class="s">prematurely.)</td></tr>
<tr><td class="h"><a name="3780"></a>3780</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3781"></a>3781</td><td></td><td></td><td></td><td></td><td class="s">If a fetch fails due to a long field truncation when C&lt;LongTruncOk&gt; is</td></tr>
<tr><td class="h"><a name="3782"></a>3782</td><td></td><td></td><td></td><td></td><td class="s">false, many drivers will allow you to continue fetching further rows.</td></tr>
<tr><td class="h"><a name="3783"></a>3783</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3784"></a>3784</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/LongReadLen&gt;.</td></tr>
<tr><td class="h"><a name="3785"></a>3785</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3786"></a>3786</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;TaintIn&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3787"></a>3787</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3788"></a>3788</td><td></td><td></td><td></td><td></td><td class="s">If the C&lt;TaintIn&gt; attribute is set to a true value I&lt;and&gt; Perl is running in</td></tr>
<tr><td class="h"><a name="3789"></a>3789</td><td></td><td></td><td></td><td></td><td class="s">taint mode (e.g., started with the C&lt;-T&gt; option), then all the arguments</td></tr>
<tr><td class="h"><a name="3790"></a>3790</td><td></td><td></td><td></td><td></td><td class="s">to most DBI method calls are checked for being tainted. I&lt;This may change.&gt;</td></tr>
<tr><td class="h"><a name="3791"></a>3791</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3792"></a>3792</td><td></td><td></td><td></td><td></td><td class="s">The attribute defaults to off, even if Perl is in taint mode.</td></tr>
<tr><td class="h"><a name="3793"></a>3793</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;perlsec&gt; for more about taint mode.  If Perl is not</td></tr>
<tr><td class="h"><a name="3794"></a>3794</td><td></td><td></td><td></td><td></td><td class="s">running in taint mode, this attribute has no effect.</td></tr>
<tr><td class="h"><a name="3795"></a>3795</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3796"></a>3796</td><td></td><td></td><td></td><td></td><td class="s">When fetching data that you trust you can turn off the TaintIn attribute,</td></tr>
<tr><td class="h"><a name="3797"></a>3797</td><td></td><td></td><td></td><td></td><td class="s">for that statement handle, for the duration of the fetch loop.</td></tr>
<tr><td class="h"><a name="3798"></a>3798</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3799"></a>3799</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TaintIn&gt; attribute was added in DBI 1.31.</td></tr>
<tr><td class="h"><a name="3800"></a>3800</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3801"></a>3801</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;TaintOut&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3802"></a>3802</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3803"></a>3803</td><td></td><td></td><td></td><td></td><td class="s">If the C&lt;TaintOut&gt; attribute is set to a true value I&lt;and&gt; Perl is running in</td></tr>
<tr><td class="h"><a name="3804"></a>3804</td><td></td><td></td><td></td><td></td><td class="s">taint mode (e.g., started with the C&lt;-T&gt; option), then most data fetched</td></tr>
<tr><td class="h"><a name="3805"></a>3805</td><td></td><td></td><td></td><td></td><td class="s">from the database is considered tainted. I&lt;This may change.&gt;</td></tr>
<tr><td class="h"><a name="3806"></a>3806</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3807"></a>3807</td><td></td><td></td><td></td><td></td><td class="s">The attribute defaults to off, even if Perl is in taint mode.</td></tr>
<tr><td class="h"><a name="3808"></a>3808</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;perlsec&gt; for more about taint mode.  If Perl is not</td></tr>
<tr><td class="h"><a name="3809"></a>3809</td><td></td><td></td><td></td><td></td><td class="s">running in taint mode, this attribute has no effect.</td></tr>
<tr><td class="h"><a name="3810"></a>3810</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3811"></a>3811</td><td></td><td></td><td></td><td></td><td class="s">When fetching data that you trust you can turn off the TaintOut attribute,</td></tr>
<tr><td class="h"><a name="3812"></a>3812</td><td></td><td></td><td></td><td></td><td class="s">for that statement handle, for the duration of the fetch loop.</td></tr>
<tr><td class="h"><a name="3813"></a>3813</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3814"></a>3814</td><td></td><td></td><td></td><td></td><td class="s">Currently only fetched data is tainted. It is possible that the results</td></tr>
<tr><td class="h"><a name="3815"></a>3815</td><td></td><td></td><td></td><td></td><td class="s">of other DBI method calls, and the value of fetched attributes, may</td></tr>
<tr><td class="h"><a name="3816"></a>3816</td><td></td><td></td><td></td><td></td><td class="s">also be tainted in future versions. That change may well break your</td></tr>
<tr><td class="h"><a name="3817"></a>3817</td><td></td><td></td><td></td><td></td><td class="s">applications unless you take great care now. If you use DBI Taint mode,</td></tr>
<tr><td class="h"><a name="3818"></a>3818</td><td></td><td></td><td></td><td></td><td class="s">please report your experience and any suggestions for changes.</td></tr>
<tr><td class="h"><a name="3819"></a>3819</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3820"></a>3820</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TaintOut&gt; attribute was added in DBI 1.31.</td></tr>
<tr><td class="h"><a name="3821"></a>3821</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3822"></a>3822</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Taint&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3823"></a>3823</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3824"></a>3824</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Taint&gt; attribute is a shortcut for L&lt;/TaintIn&gt; and L&lt;/TaintOut&gt; (it is also present</td></tr>
<tr><td class="h"><a name="3825"></a>3825</td><td></td><td></td><td></td><td></td><td class="s">for backwards compatibility).</td></tr>
<tr><td class="h"><a name="3826"></a>3826</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3827"></a>3827</td><td></td><td></td><td></td><td></td><td class="s">Setting this attribute sets both L&lt;/TaintIn&gt; and L&lt;/TaintOut&gt;, and retrieving</td></tr>
<tr><td class="h"><a name="3828"></a>3828</td><td></td><td></td><td></td><td></td><td class="s">it returns a true value if and only if L&lt;/TaintIn&gt; and L&lt;/TaintOut&gt; are</td></tr>
<tr><td class="h"><a name="3829"></a>3829</td><td></td><td></td><td></td><td></td><td class="s">both set to true values.</td></tr>
<tr><td class="h"><a name="3830"></a>3830</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3831"></a>3831</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Profile&gt; (inherited)</td></tr>
<tr><td class="h"><a name="3832"></a>3832</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3833"></a>3833</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Profile&gt; attribute enables the collection and reporting of method call timing statistics.</td></tr>
<tr><td class="h"><a name="3834"></a>3834</td><td></td><td></td><td></td><td></td><td class="s">See the L&lt;DBI::Profile&gt; module documentation for I&lt;much&gt; more detail.</td></tr>
<tr><td class="h"><a name="3835"></a>3835</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3836"></a>3836</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;Profile&gt; attribute was added in DBI 1.24.</td></tr>
<tr><td class="h"><a name="3837"></a>3837</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3838"></a>3838</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ReadOnly&gt; (boolean, inherited)</td></tr>
<tr><td class="h"><a name="3839"></a>3839</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3840"></a>3840</td><td></td><td></td><td></td><td></td><td class="s">An application can set the C&lt;ReadOnly&gt; attribute of a handle to a true value to</td></tr>
<tr><td class="h"><a name="3841"></a>3841</td><td></td><td></td><td></td><td></td><td class="s">indicate that it will not be attempting to make any changes using that handle</td></tr>
<tr><td class="h"><a name="3842"></a>3842</td><td></td><td></td><td></td><td></td><td class="s">or any children of it.</td></tr>
<tr><td class="h"><a name="3843"></a>3843</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3844"></a>3844</td><td></td><td></td><td></td><td></td><td class="s">Note that the exact definition of 'read only' is rather fuzzy.</td></tr>
<tr><td class="h"><a name="3845"></a>3845</td><td></td><td></td><td></td><td></td><td class="s">For more details see the documentation for the driver you're using.</td></tr>
<tr><td class="h"><a name="3846"></a>3846</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3847"></a>3847</td><td></td><td></td><td></td><td></td><td class="s">If the driver can make the handle truly read-only then it should</td></tr>
<tr><td class="h"><a name="3848"></a>3848</td><td></td><td></td><td></td><td></td><td class="s">(unless doing so would have unpleasant side effect, like changing the</td></tr>
<tr><td class="h"><a name="3849"></a>3849</td><td></td><td></td><td></td><td></td><td class="s">consistency level from per-statement to per-session).</td></tr>
<tr><td class="h"><a name="3850"></a>3850</td><td></td><td></td><td></td><td></td><td class="s">Otherwise the attribute is simply advisory.</td></tr>
<tr><td class="h"><a name="3851"></a>3851</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3852"></a>3852</td><td></td><td></td><td></td><td></td><td class="s">A driver can set the C&lt;ReadOnly&gt; attribute itself to indicate that the data it</td></tr>
<tr><td class="h"><a name="3853"></a>3853</td><td></td><td></td><td></td><td></td><td class="s">is connected to cannot be changed for some reason.</td></tr>
<tr><td class="h"><a name="3854"></a>3854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3855"></a>3855</td><td></td><td></td><td></td><td></td><td class="s">Library modules and proxy drivers can use the attribute to influence their behavior.</td></tr>
<tr><td class="h"><a name="3856"></a>3856</td><td></td><td></td><td></td><td></td><td class="s">For example, the DBD::Gofer driver considers the C&lt;ReadOnly&gt; attribute when</td></tr>
<tr><td class="h"><a name="3857"></a>3857</td><td></td><td></td><td></td><td></td><td class="s">making a decison about whether to retry an operation that failed.</td></tr>
<tr><td class="h"><a name="3858"></a>3858</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3859"></a>3859</td><td></td><td></td><td></td><td></td><td class="s">The attribute should be set to 1 or 0 (or undef). Other values are reserved.</td></tr>
<tr><td class="h"><a name="3860"></a>3860</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3861"></a>3861</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;private_your_module_name_*&gt;</td></tr>
<tr><td class="h"><a name="3862"></a>3862</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3863"></a>3863</td><td></td><td></td><td></td><td></td><td class="s">The DBI provides a way to store extra information in a DBI handle as</td></tr>
<tr><td class="h"><a name="3864"></a>3864</td><td></td><td></td><td></td><td></td><td class="s">&quot;private&quot; attributes. The DBI will allow you to store and retrieve any</td></tr>
<tr><td class="h"><a name="3865"></a>3865</td><td></td><td></td><td></td><td></td><td class="s">attribute which has a name starting with &quot;C&lt;private_&gt;&quot;.</td></tr>
<tr><td class="h"><a name="3866"></a>3866</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3867"></a>3867</td><td></td><td></td><td></td><td></td><td class="s">It is I&lt;strongly&gt; recommended that you use just I&lt;one&gt; private</td></tr>
<tr><td class="h"><a name="3868"></a>3868</td><td></td><td></td><td></td><td></td><td class="s">attribute (e.g., use a hash ref) I&lt;and&gt; give it a long and unambiguous</td></tr>
<tr><td class="h"><a name="3869"></a>3869</td><td></td><td></td><td></td><td></td><td class="s">name that includes the module or application name that the attribute</td></tr>
<tr><td class="h"><a name="3870"></a>3870</td><td></td><td></td><td></td><td></td><td class="s">relates to (e.g., &quot;C&lt;private_YourFullModuleName_thingy&gt;&quot;).</td></tr>
<tr><td class="h"><a name="3871"></a>3871</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3872"></a>3872</td><td></td><td></td><td></td><td></td><td class="s">Because of the way the Perl tie mechanism works you cannot reliably</td></tr>
<tr><td class="h"><a name="3873"></a>3873</td><td></td><td></td><td></td><td></td><td class="s">use the C&lt;||=&gt; operator directly to initialise the attribute, like this:</td></tr>
<tr><td class="h"><a name="3874"></a>3874</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3875"></a>3875</td><td></td><td></td><td></td><td></td><td class="s">  my $foo = $dbh-&gt;{private_yourmodname_foo} ||= { ... }; # WRONG</td></tr>
<tr><td class="h"><a name="3876"></a>3876</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3877"></a>3877</td><td></td><td></td><td></td><td></td><td class="s">you should use a two step approach like this:</td></tr>
<tr><td class="h"><a name="3878"></a>3878</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3879"></a>3879</td><td></td><td></td><td></td><td></td><td class="s">  my $foo = $dbh-&gt;{private_yourmodname_foo};</td></tr>
<tr><td class="h"><a name="3880"></a>3880</td><td></td><td></td><td></td><td></td><td class="s">  $foo ||= $dbh-&gt;{private_yourmodname_foo} = { ... };</td></tr>
<tr><td class="h"><a name="3881"></a>3881</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3882"></a>3882</td><td></td><td></td><td></td><td></td><td class="s">This attribute is primarily of interest to people sub-classing DBI,</td></tr>
<tr><td class="h"><a name="3883"></a>3883</td><td></td><td></td><td></td><td></td><td class="s">or for applications to piggy-back extra information onto DBI handles.</td></tr>
<tr><td class="h"><a name="3884"></a>3884</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3885"></a>3885</td><td></td><td></td><td></td><td></td><td class="s">=head1 DBI DATABASE HANDLE OBJECTS</td></tr>
<tr><td class="h"><a name="3886"></a>3886</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3887"></a>3887</td><td></td><td></td><td></td><td></td><td class="s">This section covers the methods and attributes associated with</td></tr>
<tr><td class="h"><a name="3888"></a>3888</td><td></td><td></td><td></td><td></td><td class="s">database handles.</td></tr>
<tr><td class="h"><a name="3889"></a>3889</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3890"></a>3890</td><td></td><td></td><td></td><td></td><td class="s">=head2 Database Handle Methods</td></tr>
<tr><td class="h"><a name="3891"></a>3891</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3892"></a>3892</td><td></td><td></td><td></td><td></td><td class="s">The following methods are specified for DBI database handles:</td></tr>
<tr><td class="h"><a name="3893"></a>3893</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3894"></a>3894</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;clone&gt;</td></tr>
<tr><td class="h"><a name="3895"></a>3895</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3896"></a>3896</td><td></td><td></td><td></td><td></td><td class="s">  $new_dbh = $dbh-&gt;clone();</td></tr>
<tr><td class="h"><a name="3897"></a>3897</td><td></td><td></td><td></td><td></td><td class="s">  $new_dbh = $dbh-&gt;clone(\%attr);</td></tr>
<tr><td class="h"><a name="3898"></a>3898</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3899"></a>3899</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;clone&gt; method duplicates the $dbh connection by connecting</td></tr>
<tr><td class="h"><a name="3900"></a>3900</td><td></td><td></td><td></td><td></td><td class="s">with the same parameters ($dsn, $user, $password) as originally used.</td></tr>
<tr><td class="h"><a name="3901"></a>3901</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3902"></a>3902</td><td></td><td></td><td></td><td></td><td class="s">The attributes for the cloned connect are the same as those used</td></tr>
<tr><td class="h"><a name="3903"></a>3903</td><td></td><td></td><td></td><td></td><td class="s">for the original connect, with some other attribute merged over</td></tr>
<tr><td class="h"><a name="3904"></a>3904</td><td></td><td></td><td></td><td></td><td class="s">them depending on the \%attr parameter.</td></tr>
<tr><td class="h"><a name="3905"></a>3905</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3906"></a>3906</td><td></td><td></td><td></td><td></td><td class="s">If \%attr is given then the attributes it contains are merged into</td></tr>
<tr><td class="h"><a name="3907"></a>3907</td><td></td><td></td><td></td><td></td><td class="s">the original attributes and override any with the same names.</td></tr>
<tr><td class="h"><a name="3908"></a>3908</td><td></td><td></td><td></td><td></td><td class="s">Effectively the same as doing:</td></tr>
<tr><td class="h"><a name="3909"></a>3909</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3910"></a>3910</td><td></td><td></td><td></td><td></td><td class="s">  %attribues_used = ( %original_attributes, %attr );</td></tr>
<tr><td class="h"><a name="3911"></a>3911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3912"></a>3912</td><td></td><td></td><td></td><td></td><td class="s">If \%attr is not given then it defaults to a hash containing all</td></tr>
<tr><td class="h"><a name="3913"></a>3913</td><td></td><td></td><td></td><td></td><td class="s">the attributes in the attribute cache of $dbh excluding any non-code</td></tr>
<tr><td class="h"><a name="3914"></a>3914</td><td></td><td></td><td></td><td></td><td class="s">references, plus the main boolean attributes (RaiseError, PrintError,</td></tr>
<tr><td class="h"><a name="3915"></a>3915</td><td></td><td></td><td></td><td></td><td class="s">AutoCommit, etc.). This behaviour is subject to change.</td></tr>
<tr><td class="h"><a name="3916"></a>3916</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3917"></a>3917</td><td></td><td></td><td></td><td></td><td class="s">The clone method can be used even if the database handle is disconnected.</td></tr>
<tr><td class="h"><a name="3918"></a>3918</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3919"></a>3919</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;clone&gt; method was added in DBI 1.33. It is very new and likely</td></tr>
<tr><td class="h"><a name="3920"></a>3920</td><td></td><td></td><td></td><td></td><td class="s">to change.</td></tr>
<tr><td class="h"><a name="3921"></a>3921</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3922"></a>3922</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;data_sources&gt;</td></tr>
<tr><td class="h"><a name="3923"></a>3923</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3924"></a>3924</td><td></td><td></td><td></td><td></td><td class="s">  @ary = $dbh-&gt;data_sources();</td></tr>
<tr><td class="h"><a name="3925"></a>3925</td><td></td><td></td><td></td><td></td><td class="s">  @ary = $dbh-&gt;data_sources(\%attr);</td></tr>
<tr><td class="h"><a name="3926"></a>3926</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3927"></a>3927</td><td></td><td></td><td></td><td></td><td class="s">Returns a list of data sources (databases) available via the $dbh</td></tr>
<tr><td class="h"><a name="3928"></a>3928</td><td></td><td></td><td></td><td></td><td class="s">driver's data_sources() method, plus any extra data sources that</td></tr>
<tr><td class="h"><a name="3929"></a>3929</td><td></td><td></td><td></td><td></td><td class="s">the driver can discover via the connected $dbh. Typically the extra</td></tr>
<tr><td class="h"><a name="3930"></a>3930</td><td></td><td></td><td></td><td></td><td class="s">data sources are other databases managed by the same server process</td></tr>
<tr><td class="h"><a name="3931"></a>3931</td><td></td><td></td><td></td><td></td><td class="s">that the $dbh is connected to.</td></tr>
<tr><td class="h"><a name="3932"></a>3932</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3933"></a>3933</td><td></td><td></td><td></td><td></td><td class="s">Data sources are returned in a form suitable for passing to the</td></tr>
<tr><td class="h"><a name="3934"></a>3934</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/connect&gt; method (that is, they will include the &quot;C&lt;dbi:$driver:&gt;&quot; prefix).</td></tr>
<tr><td class="h"><a name="3935"></a>3935</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3936"></a>3936</td><td></td><td></td><td></td><td></td><td class="s">The data_sources() method, for a $dbh, was added in DBI 1.38.</td></tr>
<tr><td class="h"><a name="3937"></a>3937</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3938"></a>3938</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;do&gt;</td></tr>
<tr><td class="h"><a name="3939"></a>3939</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3940"></a>3940</td><td></td><td></td><td></td><td></td><td class="s">  $rows = $dbh-&gt;do($statement)           or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="3941"></a>3941</td><td></td><td></td><td></td><td></td><td class="s">  $rows = $dbh-&gt;do($statement, \%attr)   or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="3942"></a>3942</td><td></td><td></td><td></td><td></td><td class="s">  $rows = $dbh-&gt;do($statement, \%attr, @bind_values) or die ...</td></tr>
<tr><td class="h"><a name="3943"></a>3943</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3944"></a>3944</td><td></td><td></td><td></td><td></td><td class="s">Prepare and execute a single statement. Returns the number of rows</td></tr>
<tr><td class="h"><a name="3945"></a>3945</td><td></td><td></td><td></td><td></td><td class="s">affected or C&lt;undef&gt; on error. A return value of C&lt;-1&gt; means the</td></tr>
<tr><td class="h"><a name="3946"></a>3946</td><td></td><td></td><td></td><td></td><td class="s">number of rows is not known, not applicable, or not available.</td></tr>
<tr><td class="h"><a name="3947"></a>3947</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3948"></a>3948</td><td></td><td></td><td></td><td></td><td class="s">This method is typically most useful for I&lt;non&gt;-C&lt;SELECT&gt; statements that</td></tr>
<tr><td class="h"><a name="3949"></a>3949</td><td></td><td></td><td></td><td></td><td class="s">either cannot be prepared in advance (due to a limitation of the</td></tr>
<tr><td class="h"><a name="3950"></a>3950</td><td></td><td></td><td></td><td></td><td class="s">driver) or do not need to be executed repeatedly. It should not</td></tr>
<tr><td class="h"><a name="3951"></a>3951</td><td></td><td></td><td></td><td></td><td class="s">be used for C&lt;SELECT&gt; statements because it does not return a statement</td></tr>
<tr><td class="h"><a name="3952"></a>3952</td><td></td><td></td><td></td><td></td><td class="s">handle (so you can't fetch any data).</td></tr>
<tr><td class="h"><a name="3953"></a>3953</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3954"></a>3954</td><td></td><td></td><td></td><td></td><td class="s">The default C&lt;do&gt; method is logically similar to:</td></tr>
<tr><td class="h"><a name="3955"></a>3955</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3956"></a>3956</td><td></td><td></td><td></td><td></td><td class="s">  sub do {</td></tr>
<tr><td class="h"><a name="3957"></a>3957</td><td></td><td></td><td></td><td></td><td class="s">      my($dbh, $statement, $attr, @bind_values) = @_;</td></tr>
<tr><td class="h"><a name="3958"></a>3958</td><td></td><td></td><td></td><td></td><td class="s">      my $sth = $dbh-&gt;prepare($statement, $attr) or return undef;</td></tr>
<tr><td class="h"><a name="3959"></a>3959</td><td></td><td></td><td></td><td></td><td class="s">      $sth-&gt;execute(@bind_values) or return undef;</td></tr>
<tr><td class="h"><a name="3960"></a>3960</td><td></td><td></td><td></td><td></td><td class="s">      my $rows = $sth-&gt;rows;</td></tr>
<tr><td class="h"><a name="3961"></a>3961</td><td></td><td></td><td></td><td></td><td class="s">      ($rows == 0) ? &quot;0E0&quot; : $rows; # always return true if no error</td></tr>
<tr><td class="h"><a name="3962"></a>3962</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="3963"></a>3963</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3964"></a>3964</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="3965"></a>3965</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3966"></a>3966</td><td></td><td></td><td></td><td></td><td class="s">  my $rows_deleted = $dbh-&gt;do(q{</td></tr>
<tr><td class="h"><a name="3967"></a>3967</td><td></td><td></td><td></td><td></td><td class="s">      DELETE FROM table</td></tr>
<tr><td class="h"><a name="3968"></a>3968</td><td></td><td></td><td></td><td></td><td class="s">      WHERE status = ?</td></tr>
<tr><td class="h"><a name="3969"></a>3969</td><td></td><td></td><td></td><td></td><td class="s">  }, undef, 'DONE') or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="3970"></a>3970</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3971"></a>3971</td><td></td><td></td><td></td><td></td><td class="s">Using placeholders and C&lt;@bind_values&gt; with the C&lt;do&gt; method can be</td></tr>
<tr><td class="h"><a name="3972"></a>3972</td><td></td><td></td><td></td><td></td><td class="s">useful because it avoids the need to correctly quote any variables</td></tr>
<tr><td class="h"><a name="3973"></a>3973</td><td></td><td></td><td></td><td></td><td class="s">in the C&lt;$statement&gt;. But if you'll be executing the statement many</td></tr>
<tr><td class="h"><a name="3974"></a>3974</td><td></td><td></td><td></td><td></td><td class="s">times then it's more efficient to C&lt;prepare&gt; it once and call</td></tr>
<tr><td class="h"><a name="3975"></a>3975</td><td></td><td></td><td></td><td></td><td class="s">C&lt;execute&gt; many times instead.</td></tr>
<tr><td class="h"><a name="3976"></a>3976</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3977"></a>3977</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;q{...}&gt; style quoting used in this example avoids clashing with</td></tr>
<tr><td class="h"><a name="3978"></a>3978</td><td></td><td></td><td></td><td></td><td class="s">quotes that may be used in the SQL statement. Use the double-quote-like</td></tr>
<tr><td class="h"><a name="3979"></a>3979</td><td></td><td></td><td></td><td></td><td class="s">C&lt;qq{...}&gt; operator if you want to interpolate variables into the string.</td></tr>
<tr><td class="h"><a name="3980"></a>3980</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;perlop/&quot;Quote and Quote-like Operators&quot;&gt; for more details.</td></tr>
<tr><td class="h"><a name="3981"></a>3981</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3982"></a>3982</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;last_insert_id&gt;</td></tr>
<tr><td class="h"><a name="3983"></a>3983</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3984"></a>3984</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $dbh-&gt;last_insert_id($catalog, $schema, $table, $field);</td></tr>
<tr><td class="h"><a name="3985"></a>3985</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $dbh-&gt;last_insert_id($catalog, $schema, $table, $field, \%attr);</td></tr>
<tr><td class="h"><a name="3986"></a>3986</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3987"></a>3987</td><td></td><td></td><td></td><td></td><td class="s">Returns a value 'identifying' the row just inserted, if possible.</td></tr>
<tr><td class="h"><a name="3988"></a>3988</td><td></td><td></td><td></td><td></td><td class="s">Typically this would be a value assigned by the database server</td></tr>
<tr><td class="h"><a name="3989"></a>3989</td><td></td><td></td><td></td><td></td><td class="s">to a column with an I&lt;auto_increment&gt; or I&lt;serial&gt; type.</td></tr>
<tr><td class="h"><a name="3990"></a>3990</td><td></td><td></td><td></td><td></td><td class="s">Returns undef if the driver does not support the method or can't</td></tr>
<tr><td class="h"><a name="3991"></a>3991</td><td></td><td></td><td></td><td></td><td class="s">determine the value.</td></tr>
<tr><td class="h"><a name="3992"></a>3992</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3993"></a>3993</td><td></td><td></td><td></td><td></td><td class="s">The $catalog, $schema, $table, and $field parameters may be required</td></tr>
<tr><td class="h"><a name="3994"></a>3994</td><td></td><td></td><td></td><td></td><td class="s">for some drivers (see below).  If you don't know the parameter values</td></tr>
<tr><td class="h"><a name="3995"></a>3995</td><td></td><td></td><td></td><td></td><td class="s">and your driver does not need them, then use C&lt;undef&gt; for each.</td></tr>
<tr><td class="h"><a name="3996"></a>3996</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3997"></a>3997</td><td></td><td></td><td></td><td></td><td class="s">There are several caveats to be aware of with this method if you want</td></tr>
<tr><td class="h"><a name="3998"></a>3998</td><td></td><td></td><td></td><td></td><td class="s">to use it for portable applications:</td></tr>
<tr><td class="h"><a name="3999"></a>3999</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4000"></a>4000</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; For some drivers the value may only available immediately after</td></tr>
<tr><td class="h"><a name="4001"></a>4001</td><td></td><td></td><td></td><td></td><td class="s">the insert statement has executed (e.g., mysql, Informix).</td></tr>
<tr><td class="h"><a name="4002"></a>4002</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4003"></a>4003</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; For some drivers the $catalog, $schema, $table, and $field parameters</td></tr>
<tr><td class="h"><a name="4004"></a>4004</td><td></td><td></td><td></td><td></td><td class="s">are required, for others they are ignored (e.g., mysql).</td></tr>
<tr><td class="h"><a name="4005"></a>4005</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4006"></a>4006</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; Drivers may return an indeterminate value if no insert has</td></tr>
<tr><td class="h"><a name="4007"></a>4007</td><td></td><td></td><td></td><td></td><td class="s">been performed yet.</td></tr>
<tr><td class="h"><a name="4008"></a>4008</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4009"></a>4009</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; For some drivers the value may only be available if placeholders</td></tr>
<tr><td class="h"><a name="4010"></a>4010</td><td></td><td></td><td></td><td></td><td class="s">have I&lt;not&gt; been used (e.g., Sybase, MS SQL). In this case the value</td></tr>
<tr><td class="h"><a name="4011"></a>4011</td><td></td><td></td><td></td><td></td><td class="s">returned would be from the last non-placeholder insert statement.</td></tr>
<tr><td class="h"><a name="4012"></a>4012</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4013"></a>4013</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; Some drivers may need driver-specific hints about how to get</td></tr>
<tr><td class="h"><a name="4014"></a>4014</td><td></td><td></td><td></td><td></td><td class="s">the value. For example, being told the name of the database 'sequence'</td></tr>
<tr><td class="h"><a name="4015"></a>4015</td><td></td><td></td><td></td><td></td><td class="s">object that holds the value. Any such hints are passed as driver-specific</td></tr>
<tr><td class="h"><a name="4016"></a>4016</td><td></td><td></td><td></td><td></td><td class="s">attributes in the \%attr parameter.</td></tr>
<tr><td class="h"><a name="4017"></a>4017</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4018"></a>4018</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; If the underlying database offers nothing better, then some</td></tr>
<tr><td class="h"><a name="4019"></a>4019</td><td></td><td></td><td></td><td></td><td class="s">drivers may attempt to implement this method by executing</td></tr>
<tr><td class="h"><a name="4020"></a>4020</td><td></td><td></td><td></td><td></td><td class="s">&quot;C&lt;select max($field) from $table&gt;&quot;. Drivers using any approach</td></tr>
<tr><td class="h"><a name="4021"></a>4021</td><td></td><td></td><td></td><td></td><td class="s">like this should issue a warning if C&lt;AutoCommit&gt; is true because</td></tr>
<tr><td class="h"><a name="4022"></a>4022</td><td></td><td></td><td></td><td></td><td class="s">it is generally unsafe - another process may have modified the table</td></tr>
<tr><td class="h"><a name="4023"></a>4023</td><td></td><td></td><td></td><td></td><td class="s">between your insert and the select. For situations where you know</td></tr>
<tr><td class="h"><a name="4024"></a>4024</td><td></td><td></td><td></td><td></td><td class="s">it is safe, such as when you have locked the table, you can silence</td></tr>
<tr><td class="h"><a name="4025"></a>4025</td><td></td><td></td><td></td><td></td><td class="s">the warning by passing C&lt;Warn&gt; =&gt; 0 in \%attr.</td></tr>
<tr><td class="h"><a name="4026"></a>4026</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4027"></a>4027</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; If no insert has been performed yet, or the last insert failed,</td></tr>
<tr><td class="h"><a name="4028"></a>4028</td><td></td><td></td><td></td><td></td><td class="s">then the value is implementation defined.</td></tr>
<tr><td class="h"><a name="4029"></a>4029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4030"></a>4030</td><td></td><td></td><td></td><td></td><td class="s">Given all the caveats above, it's clear that this method must be</td></tr>
<tr><td class="h"><a name="4031"></a>4031</td><td></td><td></td><td></td><td></td><td class="s">used with care.</td></tr>
<tr><td class="h"><a name="4032"></a>4032</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4033"></a>4033</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;last_insert_id&gt; method was added in DBI 1.38.</td></tr>
<tr><td class="h"><a name="4034"></a>4034</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4035"></a>4035</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectrow_array&gt;</td></tr>
<tr><td class="h"><a name="4036"></a>4036</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4037"></a>4037</td><td></td><td></td><td></td><td></td><td class="s">  @row_ary = $dbh-&gt;selectrow_array($statement);</td></tr>
<tr><td class="h"><a name="4038"></a>4038</td><td></td><td></td><td></td><td></td><td class="s">  @row_ary = $dbh-&gt;selectrow_array($statement, \%attr);</td></tr>
<tr><td class="h"><a name="4039"></a>4039</td><td></td><td></td><td></td><td></td><td class="s">  @row_ary = $dbh-&gt;selectrow_array($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4040"></a>4040</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4041"></a>4041</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt; and</td></tr>
<tr><td class="h"><a name="4042"></a>4042</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/fetchrow_array&gt; into a single call. If called in a list context, it</td></tr>
<tr><td class="h"><a name="4043"></a>4043</td><td></td><td></td><td></td><td></td><td class="s">returns the first row of data from the statement.  The C&lt;$statement&gt;</td></tr>
<tr><td class="h"><a name="4044"></a>4044</td><td></td><td></td><td></td><td></td><td class="s">parameter can be a previously prepared statement handle, in which case</td></tr>
<tr><td class="h"><a name="4045"></a>4045</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;prepare&gt; is skipped.</td></tr>
<tr><td class="h"><a name="4046"></a>4046</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4047"></a>4047</td><td></td><td></td><td></td><td></td><td class="s">If any method fails, and L&lt;/RaiseError&gt; is not set, C&lt;selectrow_array&gt;</td></tr>
<tr><td class="h"><a name="4048"></a>4048</td><td></td><td></td><td></td><td></td><td class="s">will return an empty list.</td></tr>
<tr><td class="h"><a name="4049"></a>4049</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4050"></a>4050</td><td></td><td></td><td></td><td></td><td class="s">If called in a scalar context for a statement handle that has more</td></tr>
<tr><td class="h"><a name="4051"></a>4051</td><td></td><td></td><td></td><td></td><td class="s">than one column, it is undefined whether the driver will return</td></tr>
<tr><td class="h"><a name="4052"></a>4052</td><td></td><td></td><td></td><td></td><td class="s">the value of the first column or the last. So don't do that.</td></tr>
<tr><td class="h"><a name="4053"></a>4053</td><td></td><td></td><td></td><td></td><td class="s">Also, in a scalar context, an C&lt;undef&gt; is returned if there are no</td></tr>
<tr><td class="h"><a name="4054"></a>4054</td><td></td><td></td><td></td><td></td><td class="s">more rows or if an error occurred. That C&lt;undef&gt; can't be distinguished</td></tr>
<tr><td class="h"><a name="4055"></a>4055</td><td></td><td></td><td></td><td></td><td class="s">from an C&lt;undef&gt; returned because the first field value was NULL.</td></tr>
<tr><td class="h"><a name="4056"></a>4056</td><td></td><td></td><td></td><td></td><td class="s">For these reasons you should exercise some caution if you use</td></tr>
<tr><td class="h"><a name="4057"></a>4057</td><td></td><td></td><td></td><td></td><td class="s">C&lt;selectrow_array&gt; in a scalar context, or just don't do that.</td></tr>
<tr><td class="h"><a name="4058"></a>4058</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4059"></a>4059</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4060"></a>4060</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectrow_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4061"></a>4061</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4062"></a>4062</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectrow_arrayref($statement);</td></tr>
<tr><td class="h"><a name="4063"></a>4063</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectrow_arrayref($statement, \%attr);</td></tr>
<tr><td class="h"><a name="4064"></a>4064</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectrow_arrayref($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4065"></a>4065</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4066"></a>4066</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt; and</td></tr>
<tr><td class="h"><a name="4067"></a>4067</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/fetchrow_arrayref&gt; into a single call. It returns the first row of</td></tr>
<tr><td class="h"><a name="4068"></a>4068</td><td></td><td></td><td></td><td></td><td class="s">data from the statement.  The C&lt;$statement&gt; parameter can be a previously</td></tr>
<tr><td class="h"><a name="4069"></a>4069</td><td></td><td></td><td></td><td></td><td class="s">prepared statement handle, in which case the C&lt;prepare&gt; is skipped.</td></tr>
<tr><td class="h"><a name="4070"></a>4070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4071"></a>4071</td><td></td><td></td><td></td><td></td><td class="s">If any method fails, and L&lt;/RaiseError&gt; is not set, C&lt;selectrow_array&gt;</td></tr>
<tr><td class="h"><a name="4072"></a>4072</td><td></td><td></td><td></td><td></td><td class="s">will return undef.</td></tr>
<tr><td class="h"><a name="4073"></a>4073</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4074"></a>4074</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4075"></a>4075</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectrow_hashref&gt;</td></tr>
<tr><td class="h"><a name="4076"></a>4076</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4077"></a>4077</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectrow_hashref($statement);</td></tr>
<tr><td class="h"><a name="4078"></a>4078</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectrow_hashref($statement, \%attr);</td></tr>
<tr><td class="h"><a name="4079"></a>4079</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectrow_hashref($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4080"></a>4080</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4081"></a>4081</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt; and</td></tr>
<tr><td class="h"><a name="4082"></a>4082</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/fetchrow_hashref&gt; into a single call. It returns the first row of</td></tr>
<tr><td class="h"><a name="4083"></a>4083</td><td></td><td></td><td></td><td></td><td class="s">data from the statement.  The C&lt;$statement&gt; parameter can be a previously</td></tr>
<tr><td class="h"><a name="4084"></a>4084</td><td></td><td></td><td></td><td></td><td class="s">prepared statement handle, in which case the C&lt;prepare&gt; is skipped.</td></tr>
<tr><td class="h"><a name="4085"></a>4085</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4086"></a>4086</td><td></td><td></td><td></td><td></td><td class="s">If any method fails, and L&lt;/RaiseError&gt; is not set, C&lt;selectrow_hashref&gt;</td></tr>
<tr><td class="h"><a name="4087"></a>4087</td><td></td><td></td><td></td><td></td><td class="s">will return undef.</td></tr>
<tr><td class="h"><a name="4088"></a>4088</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4089"></a>4089</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4090"></a>4090</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4091"></a>4091</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4092"></a>4092</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectall_arrayref($statement);</td></tr>
<tr><td class="h"><a name="4093"></a>4093</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectall_arrayref($statement, \%attr);</td></tr>
<tr><td class="h"><a name="4094"></a>4094</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectall_arrayref($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4095"></a>4095</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4096"></a>4096</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt; and</td></tr>
<tr><td class="h"><a name="4097"></a>4097</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/fetchall_arrayref&gt; into a single call. It returns a reference to an</td></tr>
<tr><td class="h"><a name="4098"></a>4098</td><td></td><td></td><td></td><td></td><td class="s">array containing a reference to an array (or hash, see below) for each row of</td></tr>
<tr><td class="h"><a name="4099"></a>4099</td><td></td><td></td><td></td><td></td><td class="s">data fetched.</td></tr>
<tr><td class="h"><a name="4100"></a>4100</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4101"></a>4101</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$statement&gt; parameter can be a previously prepared statement handle,</td></tr>
<tr><td class="h"><a name="4102"></a>4102</td><td></td><td></td><td></td><td></td><td class="s">in which case the C&lt;prepare&gt; is skipped. This is recommended if the</td></tr>
<tr><td class="h"><a name="4103"></a>4103</td><td></td><td></td><td></td><td></td><td class="s">statement is going to be executed many times.</td></tr>
<tr><td class="h"><a name="4104"></a>4104</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4105"></a>4105</td><td></td><td></td><td></td><td></td><td class="s">If L&lt;/RaiseError&gt; is not set and any method except C&lt;fetchall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4106"></a>4106</td><td></td><td></td><td></td><td></td><td class="s">fails then C&lt;selectall_arrayref&gt; will return C&lt;undef&gt;; if</td></tr>
<tr><td class="h"><a name="4107"></a>4107</td><td></td><td></td><td></td><td></td><td class="s">C&lt;fetchall_arrayref&gt; fails then it will return with whatever data</td></tr>
<tr><td class="h"><a name="4108"></a>4108</td><td></td><td></td><td></td><td></td><td class="s">has been fetched thus far. You should check C&lt;$sth-E&lt;gt&gt;err&gt;</td></tr>
<tr><td class="h"><a name="4109"></a>4109</td><td></td><td></td><td></td><td></td><td class="s">afterwards (or use the C&lt;RaiseError&gt; attribute) to discover if the data is</td></tr>
<tr><td class="h"><a name="4110"></a>4110</td><td></td><td></td><td></td><td></td><td class="s">complete or was truncated due to an error.</td></tr>
<tr><td class="h"><a name="4111"></a>4111</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4112"></a>4112</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/fetchall_arrayref&gt; method called by C&lt;selectall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4113"></a>4113</td><td></td><td></td><td></td><td></td><td class="s">supports a $max_rows parameter. You can specify a value for $max_rows</td></tr>
<tr><td class="h"><a name="4114"></a>4114</td><td></td><td></td><td></td><td></td><td class="s">by including a 'C&lt;MaxRows&gt;' attribute in \%attr. In which case finish()</td></tr>
<tr><td class="h"><a name="4115"></a>4115</td><td></td><td></td><td></td><td></td><td class="s">is called for you after fetchall_arrayref() returns.</td></tr>
<tr><td class="h"><a name="4116"></a>4116</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4117"></a>4117</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/fetchall_arrayref&gt; method called by C&lt;selectall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4118"></a>4118</td><td></td><td></td><td></td><td></td><td class="s">also supports a $slice parameter. You can specify a value for $slice by</td></tr>
<tr><td class="h"><a name="4119"></a>4119</td><td></td><td></td><td></td><td></td><td class="s">including a 'C&lt;Slice&gt;' or 'C&lt;Columns&gt;' attribute in \%attr. The only</td></tr>
<tr><td class="h"><a name="4120"></a>4120</td><td></td><td></td><td></td><td></td><td class="s">difference between the two is that if C&lt;Slice&gt; is not defined and</td></tr>
<tr><td class="h"><a name="4121"></a>4121</td><td></td><td></td><td></td><td></td><td class="s">C&lt;Columns&gt; is an array ref, then the array is assumed to contain column</td></tr>
<tr><td class="h"><a name="4122"></a>4122</td><td></td><td></td><td></td><td></td><td class="s">index values (which count from 1), rather than perl array index values.</td></tr>
<tr><td class="h"><a name="4123"></a>4123</td><td></td><td></td><td></td><td></td><td class="s">In which case the array is copied and each value decremented before</td></tr>
<tr><td class="h"><a name="4124"></a>4124</td><td></td><td></td><td></td><td></td><td class="s">passing to C&lt;/fetchall_arrayref&gt;.</td></tr>
<tr><td class="h"><a name="4125"></a>4125</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4126"></a>4126</td><td></td><td></td><td></td><td></td><td class="s">You may often want to fetch an array of rows where each row is stored as a</td></tr>
<tr><td class="h"><a name="4127"></a>4127</td><td></td><td></td><td></td><td></td><td class="s">hash. That can be done simple using:</td></tr>
<tr><td class="h"><a name="4128"></a>4128</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4129"></a>4129</td><td></td><td></td><td></td><td></td><td class="s">  my $emps = $dbh-&gt;selectall_arrayref(</td></tr>
<tr><td class="h"><a name="4130"></a>4130</td><td></td><td></td><td></td><td></td><td class="s">      &quot;SELECT ename FROM emp ORDER BY ename&quot;,</td></tr>
<tr><td class="h"><a name="4131"></a>4131</td><td></td><td></td><td></td><td></td><td class="s">      { Slice =&gt; {} }</td></tr>
<tr><td class="h"><a name="4132"></a>4132</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="4133"></a>4133</td><td></td><td></td><td></td><td></td><td class="s">  foreach my $emp ( @$emps ) {</td></tr>
<tr><td class="h"><a name="4134"></a>4134</td><td></td><td></td><td></td><td></td><td class="s">      print &quot;Employee: $emp-&gt;{ename}\n&quot;;</td></tr>
<tr><td class="h"><a name="4135"></a>4135</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="4136"></a>4136</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4137"></a>4137</td><td></td><td></td><td></td><td></td><td class="s">Or, to fetch into an array instead of an array ref:</td></tr>
<tr><td class="h"><a name="4138"></a>4138</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4139"></a>4139</td><td></td><td></td><td></td><td></td><td class="s">  @result = @{ $dbh-&gt;selectall_arrayref($sql, { Slice =&gt; {} }) };</td></tr>
<tr><td class="h"><a name="4140"></a>4140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4141"></a>4141</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/fetchall_arrayref&gt; method for more details.</td></tr>
<tr><td class="h"><a name="4142"></a>4142</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4143"></a>4143</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectall_hashref&gt;</td></tr>
<tr><td class="h"><a name="4144"></a>4144</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4145"></a>4145</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field);</td></tr>
<tr><td class="h"><a name="4146"></a>4146</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field, \%attr);</td></tr>
<tr><td class="h"><a name="4147"></a>4147</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4148"></a>4148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4149"></a>4149</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt; and</td></tr>
<tr><td class="h"><a name="4150"></a>4150</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/fetchall_hashref&gt; into a single call. It returns a reference to a</td></tr>
<tr><td class="h"><a name="4151"></a>4151</td><td></td><td></td><td></td><td></td><td class="s">hash containing one entry, at most, for each row, as returned by fetchall_hashref().</td></tr>
<tr><td class="h"><a name="4152"></a>4152</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4153"></a>4153</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$statement&gt; parameter can be a previously prepared statement handle,</td></tr>
<tr><td class="h"><a name="4154"></a>4154</td><td></td><td></td><td></td><td></td><td class="s">in which case the C&lt;prepare&gt; is skipped.  This is recommended if the</td></tr>
<tr><td class="h"><a name="4155"></a>4155</td><td></td><td></td><td></td><td></td><td class="s">statement is going to be executed many times.</td></tr>
<tr><td class="h"><a name="4156"></a>4156</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4157"></a>4157</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$key_field&gt; parameter defines which column, or columns, are used as keys</td></tr>
<tr><td class="h"><a name="4158"></a>4158</td><td></td><td></td><td></td><td></td><td class="s">in the returned hash. It can either be the name of a single field, or a</td></tr>
<tr><td class="h"><a name="4159"></a>4159</td><td></td><td></td><td></td><td></td><td class="s">reference to an array containing multiple field names. Using multiple names</td></tr>
<tr><td class="h"><a name="4160"></a>4160</td><td></td><td></td><td></td><td></td><td class="s">yields a tree of nested hashes.</td></tr>
<tr><td class="h"><a name="4161"></a>4161</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4162"></a>4162</td><td></td><td></td><td></td><td></td><td class="s">If a row has the same key as an earlier row then it replaces the earlier row.</td></tr>
<tr><td class="h"><a name="4163"></a>4163</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4164"></a>4164</td><td></td><td></td><td></td><td></td><td class="s">If any method except C&lt;fetchrow_hashref&gt; fails, and L&lt;/RaiseError&gt; is not set,</td></tr>
<tr><td class="h"><a name="4165"></a>4165</td><td></td><td></td><td></td><td></td><td class="s">C&lt;selectall_hashref&gt; will return C&lt;undef&gt;.  If C&lt;fetchrow_hashref&gt; fails and</td></tr>
<tr><td class="h"><a name="4166"></a>4166</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/RaiseError&gt; is not set, then it will return with whatever data it</td></tr>
<tr><td class="h"><a name="4167"></a>4167</td><td></td><td></td><td></td><td></td><td class="s">has fetched thus far. $DBI::err should be checked to catch that.</td></tr>
<tr><td class="h"><a name="4168"></a>4168</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4169"></a>4169</td><td></td><td></td><td></td><td></td><td class="s">See fetchall_hashref() for more details.</td></tr>
<tr><td class="h"><a name="4170"></a>4170</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4171"></a>4171</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;selectcol_arrayref&gt;</td></tr>
<tr><td class="h"><a name="4172"></a>4172</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4173"></a>4173</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectcol_arrayref($statement);</td></tr>
<tr><td class="h"><a name="4174"></a>4174</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectcol_arrayref($statement, \%attr);</td></tr>
<tr><td class="h"><a name="4175"></a>4175</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $dbh-&gt;selectcol_arrayref($statement, \%attr, @bind_values);</td></tr>
<tr><td class="h"><a name="4176"></a>4176</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4177"></a>4177</td><td></td><td></td><td></td><td></td><td class="s">This utility method combines L&lt;/prepare&gt;, L&lt;/execute&gt;, and fetching one</td></tr>
<tr><td class="h"><a name="4178"></a>4178</td><td></td><td></td><td></td><td></td><td class="s">column from all the rows, into a single call. It returns a reference to</td></tr>
<tr><td class="h"><a name="4179"></a>4179</td><td></td><td></td><td></td><td></td><td class="s">an array containing the values of the first column from each row.</td></tr>
<tr><td class="h"><a name="4180"></a>4180</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4181"></a>4181</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$statement&gt; parameter can be a previously prepared statement handle,</td></tr>
<tr><td class="h"><a name="4182"></a>4182</td><td></td><td></td><td></td><td></td><td class="s">in which case the C&lt;prepare&gt; is skipped. This is recommended if the</td></tr>
<tr><td class="h"><a name="4183"></a>4183</td><td></td><td></td><td></td><td></td><td class="s">statement is going to be executed many times.</td></tr>
<tr><td class="h"><a name="4184"></a>4184</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4185"></a>4185</td><td></td><td></td><td></td><td></td><td class="s">If any method except C&lt;fetch&gt; fails, and L&lt;/RaiseError&gt; is not set,</td></tr>
<tr><td class="h"><a name="4186"></a>4186</td><td></td><td></td><td></td><td></td><td class="s">C&lt;selectcol_arrayref&gt; will return C&lt;undef&gt;.  If C&lt;fetch&gt; fails and</td></tr>
<tr><td class="h"><a name="4187"></a>4187</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/RaiseError&gt; is not set, then it will return with whatever data it</td></tr>
<tr><td class="h"><a name="4188"></a>4188</td><td></td><td></td><td></td><td></td><td class="s">has fetched thus far. $DBI::err should be checked to catch that.</td></tr>
<tr><td class="h"><a name="4189"></a>4189</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4190"></a>4190</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;selectcol_arrayref&gt; method defaults to pushing a single column</td></tr>
<tr><td class="h"><a name="4191"></a>4191</td><td></td><td></td><td></td><td></td><td class="s">value (the first) from each row into the result array. However, it can</td></tr>
<tr><td class="h"><a name="4192"></a>4192</td><td></td><td></td><td></td><td></td><td class="s">also push another column, or even multiple columns per row, into the</td></tr>
<tr><td class="h"><a name="4193"></a>4193</td><td></td><td></td><td></td><td></td><td class="s">result array. This behaviour can be specified via a 'C&lt;Columns&gt;'</td></tr>
<tr><td class="h"><a name="4194"></a>4194</td><td></td><td></td><td></td><td></td><td class="s">attribute which must be a ref to an array containing the column number</td></tr>
<tr><td class="h"><a name="4195"></a>4195</td><td></td><td></td><td></td><td></td><td class="s">or numbers to use. For example:</td></tr>
<tr><td class="h"><a name="4196"></a>4196</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4197"></a>4197</td><td></td><td></td><td></td><td></td><td class="s">  # get array of id and name pairs:</td></tr>
<tr><td class="h"><a name="4198"></a>4198</td><td></td><td></td><td></td><td></td><td class="s">  my $ary_ref = $dbh-&gt;selectcol_arrayref(&quot;select id, name from table&quot;, { Columns=&gt;[1,2] });</td></tr>
<tr><td class="h"><a name="4199"></a>4199</td><td></td><td></td><td></td><td></td><td class="s">  my %hash = @$ary_ref; # build hash from key-value pairs so $hash{$id} =&gt; name</td></tr>
<tr><td class="h"><a name="4200"></a>4200</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4201"></a>4201</td><td></td><td></td><td></td><td></td><td class="s">You can specify a maximum number of rows to fetch by including a</td></tr>
<tr><td class="h"><a name="4202"></a>4202</td><td></td><td></td><td></td><td></td><td class="s">'C&lt;MaxRows&gt;' attribute in \%attr.</td></tr>
<tr><td class="h"><a name="4203"></a>4203</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4204"></a>4204</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;prepare&gt;</td></tr>
<tr><td class="h"><a name="4205"></a>4205</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4206"></a>4206</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare($statement)          or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4207"></a>4207</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare($statement, \%attr)  or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4208"></a>4208</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4209"></a>4209</td><td></td><td></td><td></td><td></td><td class="s">Prepares a statement for later execution by the database</td></tr>
<tr><td class="h"><a name="4210"></a>4210</td><td></td><td></td><td></td><td></td><td class="s">engine and returns a reference to a statement handle object.</td></tr>
<tr><td class="h"><a name="4211"></a>4211</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4212"></a>4212</td><td></td><td></td><td></td><td></td><td class="s">The returned statement handle can be used to get attributes of the</td></tr>
<tr><td class="h"><a name="4213"></a>4213</td><td></td><td></td><td></td><td></td><td class="s">statement and invoke the L&lt;/execute&gt; method. See L&lt;/Statement Handle Methods&gt;.</td></tr>
<tr><td class="h"><a name="4214"></a>4214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4215"></a>4215</td><td></td><td></td><td></td><td></td><td class="s">Drivers for engines without the concept of preparing a</td></tr>
<tr><td class="h"><a name="4216"></a>4216</td><td></td><td></td><td></td><td></td><td class="s">statement will typically just store the statement in the returned</td></tr>
<tr><td class="h"><a name="4217"></a>4217</td><td></td><td></td><td></td><td></td><td class="s">handle and process it when C&lt;$sth-E&lt;gt&gt;execute&gt; is called. Such drivers are</td></tr>
<tr><td class="h"><a name="4218"></a>4218</td><td></td><td></td><td></td><td></td><td class="s">unlikely to give much useful information about the</td></tr>
<tr><td class="h"><a name="4219"></a>4219</td><td></td><td></td><td></td><td></td><td class="s">statement, such as C&lt;$sth-E&lt;gt&gt;{NUM_OF_FIELDS}&gt;, until after C&lt;$sth-E&lt;gt&gt;execute&gt;</td></tr>
<tr><td class="h"><a name="4220"></a>4220</td><td></td><td></td><td></td><td></td><td class="s">has been called. Portable applications should take this into account.</td></tr>
<tr><td class="h"><a name="4221"></a>4221</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4222"></a>4222</td><td></td><td></td><td></td><td></td><td class="s">In general, DBI drivers do not parse the contents of the statement</td></tr>
<tr><td class="h"><a name="4223"></a>4223</td><td></td><td></td><td></td><td></td><td class="s">(other than simply counting any L&lt;/Placeholders&gt;). The statement is</td></tr>
<tr><td class="h"><a name="4224"></a>4224</td><td></td><td></td><td></td><td></td><td class="s">passed directly to the database engine, sometimes known as pass-thru</td></tr>
<tr><td class="h"><a name="4225"></a>4225</td><td></td><td></td><td></td><td></td><td class="s">mode. This has advantages and disadvantages. On the plus side, you can</td></tr>
<tr><td class="h"><a name="4226"></a>4226</td><td></td><td></td><td></td><td></td><td class="s">access all the functionality of the engine being used. On the downside,</td></tr>
<tr><td class="h"><a name="4227"></a>4227</td><td></td><td></td><td></td><td></td><td class="s">you're limited if you're using a simple engine, and you need to take extra care if</td></tr>
<tr><td class="h"><a name="4228"></a>4228</td><td></td><td></td><td></td><td></td><td class="s">writing applications intended to be portable between engines.</td></tr>
<tr><td class="h"><a name="4229"></a>4229</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4230"></a>4230</td><td></td><td></td><td></td><td></td><td class="s">Portable applications should not assume that a new statement can be</td></tr>
<tr><td class="h"><a name="4231"></a>4231</td><td></td><td></td><td></td><td></td><td class="s">prepared and/or executed while still fetching results from a previous</td></tr>
<tr><td class="h"><a name="4232"></a>4232</td><td></td><td></td><td></td><td></td><td class="s">statement.</td></tr>
<tr><td class="h"><a name="4233"></a>4233</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4234"></a>4234</td><td></td><td></td><td></td><td></td><td class="s">Some command-line SQL tools use statement terminators, like a semicolon,</td></tr>
<tr><td class="h"><a name="4235"></a>4235</td><td></td><td></td><td></td><td></td><td class="s">to indicate the end of a statement. Such terminators should not normally</td></tr>
<tr><td class="h"><a name="4236"></a>4236</td><td></td><td></td><td></td><td></td><td class="s">be used with the DBI.</td></tr>
<tr><td class="h"><a name="4237"></a>4237</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4238"></a>4238</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4239"></a>4239</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;prepare_cached&gt;</td></tr>
<tr><td class="h"><a name="4240"></a>4240</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4241"></a>4241</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare_cached($statement)</td></tr>
<tr><td class="h"><a name="4242"></a>4242</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare_cached($statement, \%attr)</td></tr>
<tr><td class="h"><a name="4243"></a>4243</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare_cached($statement, \%attr, $if_active)</td></tr>
<tr><td class="h"><a name="4244"></a>4244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4245"></a>4245</td><td></td><td></td><td></td><td></td><td class="s">Like L&lt;/prepare&gt; except that the statement handle returned will be</td></tr>
<tr><td class="h"><a name="4246"></a>4246</td><td></td><td></td><td></td><td></td><td class="s">stored in a hash associated with the C&lt;$dbh&gt;. If another call is made to</td></tr>
<tr><td class="h"><a name="4247"></a>4247</td><td></td><td></td><td></td><td></td><td class="s">C&lt;prepare_cached&gt; with the same C&lt;$statement&gt; and C&lt;%attr&gt; parameter values,</td></tr>
<tr><td class="h"><a name="4248"></a>4248</td><td></td><td></td><td></td><td></td><td class="s">then the corresponding cached C&lt;$sth&gt; will be returned without contacting the</td></tr>
<tr><td class="h"><a name="4249"></a>4249</td><td></td><td></td><td></td><td></td><td class="s">database server.</td></tr>
<tr><td class="h"><a name="4250"></a>4250</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4251"></a>4251</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$if_active&gt; parameter lets you adjust the behaviour if an</td></tr>
<tr><td class="h"><a name="4252"></a>4252</td><td></td><td></td><td></td><td></td><td class="s">already cached statement handle is still Active.  There are several</td></tr>
<tr><td class="h"><a name="4253"></a>4253</td><td></td><td></td><td></td><td></td><td class="s">alternatives:</td></tr>
<tr><td class="h"><a name="4254"></a>4254</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4255"></a>4255</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="4256"></a>4256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4257"></a>4257</td><td></td><td></td><td></td><td></td><td class="s">=item B&lt;0&gt;: A warning will be generated, and finish() will be called on</td></tr>
<tr><td class="h"><a name="4258"></a>4258</td><td></td><td></td><td></td><td></td><td class="s">the statement handle before it is returned.  This is the default</td></tr>
<tr><td class="h"><a name="4259"></a>4259</td><td></td><td></td><td></td><td></td><td class="s">behaviour if $if_active is not passed.</td></tr>
<tr><td class="h"><a name="4260"></a>4260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4261"></a>4261</td><td></td><td></td><td></td><td></td><td class="s">=item B&lt;1&gt;: finish() will be called on the statement handle, but the</td></tr>
<tr><td class="h"><a name="4262"></a>4262</td><td></td><td></td><td></td><td></td><td class="s">warning is suppressed.</td></tr>
<tr><td class="h"><a name="4263"></a>4263</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4264"></a>4264</td><td></td><td></td><td></td><td></td><td class="s">=item B&lt;2&gt;: Disables any checking.</td></tr>
<tr><td class="h"><a name="4265"></a>4265</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4266"></a>4266</td><td></td><td></td><td></td><td></td><td class="s">=item B&lt;3&gt;: The existing active statement handle will be removed from the</td></tr>
<tr><td class="h"><a name="4267"></a>4267</td><td></td><td></td><td></td><td></td><td class="s">cache and a new statement handle prepared and cached in its place.</td></tr>
<tr><td class="h"><a name="4268"></a>4268</td><td></td><td></td><td></td><td></td><td class="s">This is the safest option because it doesn't affect the state of the</td></tr>
<tr><td class="h"><a name="4269"></a>4269</td><td></td><td></td><td></td><td></td><td class="s">old handle, it just removes it from the cache. [Added in DBI 1.40]</td></tr>
<tr><td class="h"><a name="4270"></a>4270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4271"></a>4271</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="4272"></a>4272</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4273"></a>4273</td><td></td><td></td><td></td><td></td><td class="s">Here are some examples of C&lt;prepare_cached&gt;:</td></tr>
<tr><td class="h"><a name="4274"></a>4274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4275"></a>4275</td><td></td><td></td><td></td><td></td><td class="s">  sub insert_hash {</td></tr>
<tr><td class="h"><a name="4276"></a>4276</td><td></td><td></td><td></td><td></td><td class="s">    my ($table, $field_values) = @_;</td></tr>
<tr><td class="h"><a name="4277"></a>4277</td><td></td><td></td><td></td><td></td><td class="s">    # sort to keep field order, and thus sql, stable for prepare_cached</td></tr>
<tr><td class="h"><a name="4278"></a>4278</td><td></td><td></td><td></td><td></td><td class="s">    my @fields = sort keys %$field_values;</td></tr>
<tr><td class="h"><a name="4279"></a>4279</td><td></td><td></td><td></td><td></td><td class="s">    my @values = @{$field_values}{@fields};</td></tr>
<tr><td class="h"><a name="4280"></a>4280</td><td></td><td></td><td></td><td></td><td class="s">    my $sql = sprintf &quot;insert into %s (%s) values (%s)&quot;,</td></tr>
<tr><td class="h"><a name="4281"></a>4281</td><td></td><td></td><td></td><td></td><td class="s">        $table, join(&quot;,&quot;, @fields), join(&quot;,&quot;, (&quot;?&quot;)x@fields);</td></tr>
<tr><td class="h"><a name="4282"></a>4282</td><td></td><td></td><td></td><td></td><td class="s">    my $sth = $dbh-&gt;prepare_cached($sql);</td></tr>
<tr><td class="h"><a name="4283"></a>4283</td><td></td><td></td><td></td><td></td><td class="s">    return $sth-&gt;execute(@values);</td></tr>
<tr><td class="h"><a name="4284"></a>4284</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="4285"></a>4285</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4286"></a>4286</td><td></td><td></td><td></td><td></td><td class="s">  sub search_hash {</td></tr>
<tr><td class="h"><a name="4287"></a>4287</td><td></td><td></td><td></td><td></td><td class="s">    my ($table, $field_values) = @_;</td></tr>
<tr><td class="h"><a name="4288"></a>4288</td><td></td><td></td><td></td><td></td><td class="s">    # sort to keep field order, and thus sql, stable for prepare_cached</td></tr>
<tr><td class="h"><a name="4289"></a>4289</td><td></td><td></td><td></td><td></td><td class="s">    my @fields = sort keys %$field_values;</td></tr>
<tr><td class="h"><a name="4290"></a>4290</td><td></td><td></td><td></td><td></td><td class="s">    my @values = @{$field_values}{@fields};</td></tr>
<tr><td class="h"><a name="4291"></a>4291</td><td></td><td></td><td></td><td></td><td class="s">    my $qualifier = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="4292"></a>4292</td><td></td><td></td><td></td><td></td><td class="s">    $qualifier = &quot;where &quot;.join(&quot; and &quot;, map { &quot;$_=?&quot; } @fields) if @fields;</td></tr>
<tr><td class="h"><a name="4293"></a>4293</td><td></td><td></td><td></td><td></td><td class="s">    $sth = $dbh-&gt;prepare_cached(&quot;SELECT * FROM $table $qualifier&quot;);</td></tr>
<tr><td class="h"><a name="4294"></a>4294</td><td></td><td></td><td></td><td></td><td class="s">    return $dbh-&gt;selectall_arrayref($sth, {}, @values);</td></tr>
<tr><td class="h"><a name="4295"></a>4295</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="4296"></a>4296</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4297"></a>4297</td><td></td><td></td><td></td><td></td><td class="s">I&lt;Caveat emptor:&gt; This caching can be useful in some applications,</td></tr>
<tr><td class="h"><a name="4298"></a>4298</td><td></td><td></td><td></td><td></td><td class="s">but it can also cause problems and should be used with care. Here</td></tr>
<tr><td class="h"><a name="4299"></a>4299</td><td></td><td></td><td></td><td></td><td class="s">is a contrived case where caching would cause a significant problem:</td></tr>
<tr><td class="h"><a name="4300"></a>4300</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4301"></a>4301</td><td></td><td></td><td></td><td></td><td class="s">  my $sth = $dbh-&gt;prepare_cached('SELECT * FROM foo WHERE bar=?');</td></tr>
<tr><td class="h"><a name="4302"></a>4302</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute(...);</td></tr>
<tr><td class="h"><a name="4303"></a>4303</td><td></td><td></td><td></td><td></td><td class="s">  while (my $data = $sth-&gt;fetchrow_hashref) {</td></tr>
<tr><td class="h"><a name="4304"></a>4304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4305"></a>4305</td><td></td><td></td><td></td><td></td><td class="s">    # later, in some other code called within the loop...</td></tr>
<tr><td class="h"><a name="4306"></a>4306</td><td></td><td></td><td></td><td></td><td class="s">    my $sth2 = $dbh-&gt;prepare_cached('SELECT * FROM foo WHERE bar=?');</td></tr>
<tr><td class="h"><a name="4307"></a>4307</td><td></td><td></td><td></td><td></td><td class="s">    $sth2-&gt;execute(...);</td></tr>
<tr><td class="h"><a name="4308"></a>4308</td><td></td><td></td><td></td><td></td><td class="s">    while (my $data2 = $sth2-&gt;fetchrow_arrayref) {</td></tr>
<tr><td class="h"><a name="4309"></a>4309</td><td></td><td></td><td></td><td></td><td class="s">      do_stuff(...);</td></tr>
<tr><td class="h"><a name="4310"></a>4310</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="4311"></a>4311</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="4312"></a>4312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4313"></a>4313</td><td></td><td></td><td></td><td></td><td class="s">In this example, since both handles are preparing the exact same statement,</td></tr>
<tr><td class="h"><a name="4314"></a>4314</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$sth2&gt; will not be its own statement handle, but a duplicate of C&lt;$sth&gt;</td></tr>
<tr><td class="h"><a name="4315"></a>4315</td><td></td><td></td><td></td><td></td><td class="s">returned from the cache. The results will certainly not be what you expect.</td></tr>
<tr><td class="h"><a name="4316"></a>4316</td><td></td><td></td><td></td><td></td><td class="s">Typically the the inner fetch loop will work normally, fetching all</td></tr>
<tr><td class="h"><a name="4317"></a>4317</td><td></td><td></td><td></td><td></td><td class="s">the records and terminating when there are no more, but now $sth</td></tr>
<tr><td class="h"><a name="4318"></a>4318</td><td></td><td></td><td></td><td></td><td class="s">is the same as $sth2 the outer fetch loop will also terminate.</td></tr>
<tr><td class="h"><a name="4319"></a>4319</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4320"></a>4320</td><td></td><td></td><td></td><td></td><td class="s">You'll know if you run into this problem because prepare_cached()</td></tr>
<tr><td class="h"><a name="4321"></a>4321</td><td></td><td></td><td></td><td></td><td class="s">will generate a warning by default (when $if_active is false).</td></tr>
<tr><td class="h"><a name="4322"></a>4322</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4323"></a>4323</td><td></td><td></td><td></td><td></td><td class="s">The cache used by prepare_cached() is keyed by both the statement</td></tr>
<tr><td class="h"><a name="4324"></a>4324</td><td></td><td></td><td></td><td></td><td class="s">and any attributes so you can also avoid this issue by doing something</td></tr>
<tr><td class="h"><a name="4325"></a>4325</td><td></td><td></td><td></td><td></td><td class="s">like:</td></tr>
<tr><td class="h"><a name="4326"></a>4326</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4327"></a>4327</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare_cached(&quot;...&quot;, { dbi_dummy =&gt; __FILE__.__LINE__ });</td></tr>
<tr><td class="h"><a name="4328"></a>4328</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4329"></a>4329</td><td></td><td></td><td></td><td></td><td class="s">which will ensure that prepare_cached only returns statements cached</td></tr>
<tr><td class="h"><a name="4330"></a>4330</td><td></td><td></td><td></td><td></td><td class="s">by that line of code in that source file.</td></tr>
<tr><td class="h"><a name="4331"></a>4331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4332"></a>4332</td><td></td><td></td><td></td><td></td><td class="s">If you'd like the cache to managed intelligently, you can tie the</td></tr>
<tr><td class="h"><a name="4333"></a>4333</td><td></td><td></td><td></td><td></td><td class="s">hashref returned by C&lt;CachedKids&gt; to an appropriate caching module,</td></tr>
<tr><td class="h"><a name="4334"></a>4334</td><td></td><td></td><td></td><td></td><td class="s">such as L&lt;Tie::Cache::LRU&gt;:</td></tr>
<tr><td class="h"><a name="4335"></a>4335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4336"></a>4336</td><td></td><td></td><td></td><td></td><td class="s">  my $cache;</td></tr>
<tr><td class="h"><a name="4337"></a>4337</td><td></td><td></td><td></td><td></td><td class="s">  tie %$cache, 'Tie::Cache::LRU', 500;</td></tr>
<tr><td class="h"><a name="4338"></a>4338</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{CachedKids} = $cache;</td></tr>
<tr><td class="h"><a name="4339"></a>4339</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4340"></a>4340</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;commit&gt;</td></tr>
<tr><td class="h"><a name="4341"></a>4341</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4342"></a>4342</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;commit     or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4343"></a>4343</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4344"></a>4344</td><td></td><td></td><td></td><td></td><td class="s">Commit (make permanent) the most recent series of database changes</td></tr>
<tr><td class="h"><a name="4345"></a>4345</td><td></td><td></td><td></td><td></td><td class="s">if the database supports transactions and AutoCommit is off.</td></tr>
<tr><td class="h"><a name="4346"></a>4346</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4347"></a>4347</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;AutoCommit&gt; is on, then calling</td></tr>
<tr><td class="h"><a name="4348"></a>4348</td><td></td><td></td><td></td><td></td><td class="s">C&lt;commit&gt; will issue a &quot;commit ineffective with AutoCommit&quot; warning.</td></tr>
<tr><td class="h"><a name="4349"></a>4349</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4350"></a>4350</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/Transactions&gt; in the L&lt;/FURTHER INFORMATION&gt; section below.</td></tr>
<tr><td class="h"><a name="4351"></a>4351</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4352"></a>4352</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;rollback&gt;</td></tr>
<tr><td class="h"><a name="4353"></a>4353</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4354"></a>4354</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;rollback   or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4355"></a>4355</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4356"></a>4356</td><td></td><td></td><td></td><td></td><td class="s">Rollback (undo) the most recent series of uncommitted database</td></tr>
<tr><td class="h"><a name="4357"></a>4357</td><td></td><td></td><td></td><td></td><td class="s">changes if the database supports transactions and AutoCommit is off.</td></tr>
<tr><td class="h"><a name="4358"></a>4358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4359"></a>4359</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;AutoCommit&gt; is on, then calling</td></tr>
<tr><td class="h"><a name="4360"></a>4360</td><td></td><td></td><td></td><td></td><td class="s">C&lt;rollback&gt; will issue a &quot;rollback ineffective with AutoCommit&quot; warning.</td></tr>
<tr><td class="h"><a name="4361"></a>4361</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4362"></a>4362</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/Transactions&gt; in the L&lt;/FURTHER INFORMATION&gt; section below.</td></tr>
<tr><td class="h"><a name="4363"></a>4363</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4364"></a>4364</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;begin_work&gt;</td></tr>
<tr><td class="h"><a name="4365"></a>4365</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4366"></a>4366</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $dbh-&gt;begin_work   or die $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4367"></a>4367</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4368"></a>4368</td><td></td><td></td><td></td><td></td><td class="s">Enable transactions (by turning C&lt;AutoCommit&gt; off) until the next call</td></tr>
<tr><td class="h"><a name="4369"></a>4369</td><td></td><td></td><td></td><td></td><td class="s">to C&lt;commit&gt; or C&lt;rollback&gt;. After the next C&lt;commit&gt; or C&lt;rollback&gt;,</td></tr>
<tr><td class="h"><a name="4370"></a>4370</td><td></td><td></td><td></td><td></td><td class="s">C&lt;AutoCommit&gt; will automatically be turned on again.</td></tr>
<tr><td class="h"><a name="4371"></a>4371</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4372"></a>4372</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;AutoCommit&gt; is already off when C&lt;begin_work&gt; is called then</td></tr>
<tr><td class="h"><a name="4373"></a>4373</td><td></td><td></td><td></td><td></td><td class="s">it does nothing except return an error. If the driver does not support</td></tr>
<tr><td class="h"><a name="4374"></a>4374</td><td></td><td></td><td></td><td></td><td class="s">transactions then when C&lt;begin_work&gt; attempts to set C&lt;AutoCommit&gt; off</td></tr>
<tr><td class="h"><a name="4375"></a>4375</td><td></td><td></td><td></td><td></td><td class="s">the driver will trigger a fatal error.</td></tr>
<tr><td class="h"><a name="4376"></a>4376</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4377"></a>4377</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/Transactions&gt; in the L&lt;/FURTHER INFORMATION&gt; section below.</td></tr>
<tr><td class="h"><a name="4378"></a>4378</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4379"></a>4379</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4380"></a>4380</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;disconnect&gt;</td></tr>
<tr><td class="h"><a name="4381"></a>4381</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4382"></a>4382</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $dbh-&gt;disconnect  or warn $dbh-&gt;errstr;</td></tr>
<tr><td class="h"><a name="4383"></a>4383</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4384"></a>4384</td><td></td><td></td><td></td><td></td><td class="s">Disconnects the database from the database handle. C&lt;disconnect&gt; is typically only used</td></tr>
<tr><td class="h"><a name="4385"></a>4385</td><td></td><td></td><td></td><td></td><td class="s">before exiting the program. The handle is of little use after disconnecting.</td></tr>
<tr><td class="h"><a name="4386"></a>4386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4387"></a>4387</td><td></td><td></td><td></td><td></td><td class="s">The transaction behaviour of the C&lt;disconnect&gt; method is, sadly,</td></tr>
<tr><td class="h"><a name="4388"></a>4388</td><td></td><td></td><td></td><td></td><td class="s">undefined.  Some database systems (such as Oracle and Ingres) will</td></tr>
<tr><td class="h"><a name="4389"></a>4389</td><td></td><td></td><td></td><td></td><td class="s">automatically commit any outstanding changes, but others (such as</td></tr>
<tr><td class="h"><a name="4390"></a>4390</td><td></td><td></td><td></td><td></td><td class="s">Informix) will rollback any outstanding changes.  Applications not</td></tr>
<tr><td class="h"><a name="4391"></a>4391</td><td></td><td></td><td></td><td></td><td class="s">using C&lt;AutoCommit&gt; should explicitly call C&lt;commit&gt; or C&lt;rollback&gt; before</td></tr>
<tr><td class="h"><a name="4392"></a>4392</td><td></td><td></td><td></td><td></td><td class="s">calling C&lt;disconnect&gt;.</td></tr>
<tr><td class="h"><a name="4393"></a>4393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4394"></a>4394</td><td></td><td></td><td></td><td></td><td class="s">The database is automatically disconnected by the C&lt;DESTROY&gt; method if</td></tr>
<tr><td class="h"><a name="4395"></a>4395</td><td></td><td></td><td></td><td></td><td class="s">still connected when there are no longer any references to the handle.</td></tr>
<tr><td class="h"><a name="4396"></a>4396</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;DESTROY&gt; method for each driver should implicitly call C&lt;rollback&gt; to</td></tr>
<tr><td class="h"><a name="4397"></a>4397</td><td></td><td></td><td></td><td></td><td class="s">undo any uncommitted changes. This is vital behaviour to ensure that</td></tr>
<tr><td class="h"><a name="4398"></a>4398</td><td></td><td></td><td></td><td></td><td class="s">incomplete transactions don't get committed simply because Perl calls</td></tr>
<tr><td class="h"><a name="4399"></a>4399</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DESTROY&gt; on every object before exiting. Also, do not rely on the order</td></tr>
<tr><td class="h"><a name="4400"></a>4400</td><td></td><td></td><td></td><td></td><td class="s">of object destruction during &quot;global destruction&quot;, as it is undefined.</td></tr>
<tr><td class="h"><a name="4401"></a>4401</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4402"></a>4402</td><td></td><td></td><td></td><td></td><td class="s">Generally, if you want your changes to be commited or rolled back when</td></tr>
<tr><td class="h"><a name="4403"></a>4403</td><td></td><td></td><td></td><td></td><td class="s">you disconnect, then you should explicitly call L&lt;/commit&gt; or L&lt;/rollback&gt;</td></tr>
<tr><td class="h"><a name="4404"></a>4404</td><td></td><td></td><td></td><td></td><td class="s">before disconnecting.</td></tr>
<tr><td class="h"><a name="4405"></a>4405</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4406"></a>4406</td><td></td><td></td><td></td><td></td><td class="s">If you disconnect from a database while you still have active</td></tr>
<tr><td class="h"><a name="4407"></a>4407</td><td></td><td></td><td></td><td></td><td class="s">statement handles (e.g., SELECT statement handles that may have</td></tr>
<tr><td class="h"><a name="4408"></a>4408</td><td></td><td></td><td></td><td></td><td class="s">more data to fetch), you will get a warning. The warning may indicate</td></tr>
<tr><td class="h"><a name="4409"></a>4409</td><td></td><td></td><td></td><td></td><td class="s">that a fetch loop terminated early, perhaps due to an uncaught error.</td></tr>
<tr><td class="h"><a name="4410"></a>4410</td><td></td><td></td><td></td><td></td><td class="s">To avoid the warning call the C&lt;finish&gt; method on the active handles.</td></tr>
<tr><td class="h"><a name="4411"></a>4411</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4412"></a>4412</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4413"></a>4413</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ping&gt;</td></tr>
<tr><td class="h"><a name="4414"></a>4414</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4415"></a>4415</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $dbh-&gt;ping;</td></tr>
<tr><td class="h"><a name="4416"></a>4416</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4417"></a>4417</td><td></td><td></td><td></td><td></td><td class="s">Attempts to determine, in a reasonably efficient way, if the database</td></tr>
<tr><td class="h"><a name="4418"></a>4418</td><td></td><td></td><td></td><td></td><td class="s">server is still running and the connection to it is still working.</td></tr>
<tr><td class="h"><a name="4419"></a>4419</td><td></td><td></td><td></td><td></td><td class="s">Individual drivers should implement this function in the most suitable</td></tr>
<tr><td class="h"><a name="4420"></a>4420</td><td></td><td></td><td></td><td></td><td class="s">manner for their database engine.</td></tr>
<tr><td class="h"><a name="4421"></a>4421</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4422"></a>4422</td><td></td><td></td><td></td><td></td><td class="s">The current I&lt;default&gt; implementation always returns true without</td></tr>
<tr><td class="h"><a name="4423"></a>4423</td><td></td><td></td><td></td><td></td><td class="s">actually doing anything. Actually, it returns &quot;C&lt;0 but true&gt;&quot; which is</td></tr>
<tr><td class="h"><a name="4424"></a>4424</td><td></td><td></td><td></td><td></td><td class="s">true but zero. That way you can tell if the return value is genuine or</td></tr>
<tr><td class="h"><a name="4425"></a>4425</td><td></td><td></td><td></td><td></td><td class="s">just the default. Drivers should override this method with one that</td></tr>
<tr><td class="h"><a name="4426"></a>4426</td><td></td><td></td><td></td><td></td><td class="s">does the right thing for their type of database.</td></tr>
<tr><td class="h"><a name="4427"></a>4427</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4428"></a>4428</td><td></td><td></td><td></td><td></td><td class="s">Few applications would have direct use for this method. See the specialized</td></tr>
<tr><td class="h"><a name="4429"></a>4429</td><td></td><td></td><td></td><td></td><td class="s">Apache::DBI module for one example usage.</td></tr>
<tr><td class="h"><a name="4430"></a>4430</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4431"></a>4431</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4432"></a>4432</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;get_info&gt;</td></tr>
<tr><td class="h"><a name="4433"></a>4433</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4434"></a>4434</td><td></td><td></td><td></td><td></td><td class="s">  $value = $dbh-&gt;get_info( $info_type );</td></tr>
<tr><td class="h"><a name="4435"></a>4435</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4436"></a>4436</td><td></td><td></td><td></td><td></td><td class="s">Returns information about the implementation, i.e. driver and data</td></tr>
<tr><td class="h"><a name="4437"></a>4437</td><td></td><td></td><td></td><td></td><td class="s">source capabilities, restrictions etc. It returns C&lt;undef&gt; for</td></tr>
<tr><td class="h"><a name="4438"></a>4438</td><td></td><td></td><td></td><td></td><td class="s">unknown or unimplemented information types. For example:</td></tr>
<tr><td class="h"><a name="4439"></a>4439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4440"></a>4440</td><td></td><td></td><td></td><td></td><td class="s">  $database_version  = $dbh-&gt;get_info(  18 ); # SQL_DBMS_VER</td></tr>
<tr><td class="h"><a name="4441"></a>4441</td><td></td><td></td><td></td><td></td><td class="s">  $max_select_tables = $dbh-&gt;get_info( 106 ); # SQL_MAXIMUM_TABLES_IN_SELECT</td></tr>
<tr><td class="h"><a name="4442"></a>4442</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4443"></a>4443</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/&quot;Standards Reference Information&quot;&gt; for more detailed information</td></tr>
<tr><td class="h"><a name="4444"></a>4444</td><td></td><td></td><td></td><td></td><td class="s">about the information types and their meanings and possible return values.</td></tr>
<tr><td class="h"><a name="4445"></a>4445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4446"></a>4446</td><td></td><td></td><td></td><td></td><td class="s">The DBI::Const::GetInfoType module exports a %GetInfoType hash that</td></tr>
<tr><td class="h"><a name="4447"></a>4447</td><td></td><td></td><td></td><td></td><td class="s">can be used to map info type names to numbers. For example:</td></tr>
<tr><td class="h"><a name="4448"></a>4448</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4449"></a>4449</td><td></td><td></td><td></td><td></td><td class="s">  $database_version = $dbh-&gt;get_info( $GetInfoType{SQL_DBMS_VER} );</td></tr>
<tr><td class="h"><a name="4450"></a>4450</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4451"></a>4451</td><td></td><td></td><td></td><td></td><td class="s">The names are a merging of the ANSI and ODBC standards (which differ</td></tr>
<tr><td class="h"><a name="4452"></a>4452</td><td></td><td></td><td></td><td></td><td class="s">in some cases). See L&lt;DBI::Const::GetInfoType&gt; for more details.</td></tr>
<tr><td class="h"><a name="4453"></a>4453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4454"></a>4454</td><td></td><td></td><td></td><td></td><td class="s">Because some DBI methods make use of get_info(), drivers are strongly</td></tr>
<tr><td class="h"><a name="4455"></a>4455</td><td></td><td></td><td></td><td></td><td class="s">encouraged to support I&lt;at least&gt; the following very minimal set</td></tr>
<tr><td class="h"><a name="4456"></a>4456</td><td></td><td></td><td></td><td></td><td class="s">of information types to ensure the DBI itself works properly:</td></tr>
<tr><td class="h"><a name="4457"></a>4457</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4458"></a>4458</td><td></td><td></td><td></td><td></td><td class="s"> Type  Name                        Example A     Example B</td></tr>
<tr><td class="h"><a name="4459"></a>4459</td><td></td><td></td><td></td><td></td><td class="s"> ----  --------------------------  ------------  ----------------</td></tr>
<tr><td class="h"><a name="4460"></a>4460</td><td></td><td></td><td></td><td></td><td class="s">   17  SQL_DBMS_NAME               'ACCESS'      'Oracle'</td></tr>
<tr><td class="h"><a name="4461"></a>4461</td><td></td><td></td><td></td><td></td><td class="s">   18  SQL_DBMS_VER                '03.50.0000'  '08.01.0721 ...'</td></tr>
<tr><td class="h"><a name="4462"></a>4462</td><td></td><td></td><td></td><td></td><td class="s">   29  SQL_IDENTIFIER_QUOTE_CHAR   '`'           '&quot;'</td></tr>
<tr><td class="h"><a name="4463"></a>4463</td><td></td><td></td><td></td><td></td><td class="s">   41  SQL_CATALOG_NAME_SEPARATOR  '.'           '@'</td></tr>
<tr><td class="h"><a name="4464"></a>4464</td><td></td><td></td><td></td><td></td><td class="s">  114  SQL_CATALOG_LOCATION        1             2</td></tr>
<tr><td class="h"><a name="4465"></a>4465</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4466"></a>4466</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;table_info&gt;</td></tr>
<tr><td class="h"><a name="4467"></a>4467</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4468"></a>4468</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;table_info( $catalog, $schema, $table, $type );</td></tr>
<tr><td class="h"><a name="4469"></a>4469</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;table_info( $catalog, $schema, $table, $type, \%attr );</td></tr>
<tr><td class="h"><a name="4470"></a>4470</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4471"></a>4471</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4472"></a>4472</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4473"></a>4473</td><td></td><td></td><td></td><td></td><td class="s">Returns an active statement handle that can be used to fetch</td></tr>
<tr><td class="h"><a name="4474"></a>4474</td><td></td><td></td><td></td><td></td><td class="s">information about tables and views that exist in the database.</td></tr>
<tr><td class="h"><a name="4475"></a>4475</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4476"></a>4476</td><td></td><td></td><td></td><td></td><td class="s">The arguments $catalog, $schema and $table may accept search patterns</td></tr>
<tr><td class="h"><a name="4477"></a>4477</td><td></td><td></td><td></td><td></td><td class="s">according to the database/driver, for example: $table = '%FOO%';</td></tr>
<tr><td class="h"><a name="4478"></a>4478</td><td></td><td></td><td></td><td></td><td class="s">Remember that the underscore character ('C&lt;_&gt;') is a search pattern</td></tr>
<tr><td class="h"><a name="4479"></a>4479</td><td></td><td></td><td></td><td></td><td class="s">that means match any character, so 'FOO_%' is the same as 'FOO%'</td></tr>
<tr><td class="h"><a name="4480"></a>4480</td><td></td><td></td><td></td><td></td><td class="s">and 'FOO_BAR%' will match names like 'FOO1BAR'.</td></tr>
<tr><td class="h"><a name="4481"></a>4481</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4482"></a>4482</td><td></td><td></td><td></td><td></td><td class="s">The value of $type is a comma-separated list of one or more types of</td></tr>
<tr><td class="h"><a name="4483"></a>4483</td><td></td><td></td><td></td><td></td><td class="s">tables to be returned in the result set. Each value may optionally be</td></tr>
<tr><td class="h"><a name="4484"></a>4484</td><td></td><td></td><td></td><td></td><td class="s">quoted, e.g.:</td></tr>
<tr><td class="h"><a name="4485"></a>4485</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4486"></a>4486</td><td></td><td></td><td></td><td></td><td class="s">  $type = &quot;TABLE&quot;;</td></tr>
<tr><td class="h"><a name="4487"></a>4487</td><td></td><td></td><td></td><td></td><td class="s">  $type = &quot;'TABLE','VIEW'&quot;;</td></tr>
<tr><td class="h"><a name="4488"></a>4488</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4489"></a>4489</td><td></td><td></td><td></td><td></td><td class="s">In addition the following special cases may also be supported by some drivers:</td></tr>
<tr><td class="h"><a name="4490"></a>4490</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4491"></a>4491</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="4492"></a>4492</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4493"></a>4493</td><td></td><td></td><td></td><td></td><td class="s">=item *</td></tr>
<tr><td class="h"><a name="4494"></a>4494</td><td></td><td></td><td></td><td></td><td class="s">If the value of $catalog is '%' and $schema and $table name</td></tr>
<tr><td class="h"><a name="4495"></a>4495</td><td></td><td></td><td></td><td></td><td class="s">are empty strings, the result set contains a list of catalog names.</td></tr>
<tr><td class="h"><a name="4496"></a>4496</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="4497"></a>4497</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4498"></a>4498</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;table_info('%', '', '');</td></tr>
<tr><td class="h"><a name="4499"></a>4499</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4500"></a>4500</td><td></td><td></td><td></td><td></td><td class="s">=item *</td></tr>
<tr><td class="h"><a name="4501"></a>4501</td><td></td><td></td><td></td><td></td><td class="s">If the value of $schema is '%' and $catalog and $table are empty</td></tr>
<tr><td class="h"><a name="4502"></a>4502</td><td></td><td></td><td></td><td></td><td class="s">strings, the result set contains a list of schema names.</td></tr>
<tr><td class="h"><a name="4503"></a>4503</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4504"></a>4504</td><td></td><td></td><td></td><td></td><td class="s">=item *</td></tr>
<tr><td class="h"><a name="4505"></a>4505</td><td></td><td></td><td></td><td></td><td class="s">If the value of $type is '%' and $catalog, $schema, and $table are all</td></tr>
<tr><td class="h"><a name="4506"></a>4506</td><td></td><td></td><td></td><td></td><td class="s">empty strings, the result set contains a list of table types.</td></tr>
<tr><td class="h"><a name="4507"></a>4507</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4508"></a>4508</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="4509"></a>4509</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4510"></a>4510</td><td></td><td></td><td></td><td></td><td class="s">If your driver doesn't support one or more of the selection filter</td></tr>
<tr><td class="h"><a name="4511"></a>4511</td><td></td><td></td><td></td><td></td><td class="s">parameters then you may get back more than you asked for and can</td></tr>
<tr><td class="h"><a name="4512"></a>4512</td><td></td><td></td><td></td><td></td><td class="s">do the filtering yourself.</td></tr>
<tr><td class="h"><a name="4513"></a>4513</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4514"></a>4514</td><td></td><td></td><td></td><td></td><td class="s">This method can be expensive, and can return a large amount of data.</td></tr>
<tr><td class="h"><a name="4515"></a>4515</td><td></td><td></td><td></td><td></td><td class="s">(For example, small Oracle installation returns over 2000 rows.)</td></tr>
<tr><td class="h"><a name="4516"></a>4516</td><td></td><td></td><td></td><td></td><td class="s">So it's a good idea to use the filters to limit the data as much as possible.</td></tr>
<tr><td class="h"><a name="4517"></a>4517</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4518"></a>4518</td><td></td><td></td><td></td><td></td><td class="s">The statement handle returned has at least the following fields in the</td></tr>
<tr><td class="h"><a name="4519"></a>4519</td><td></td><td></td><td></td><td></td><td class="s">order show below. Other fields, after these, may also be present.</td></tr>
<tr><td class="h"><a name="4520"></a>4520</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4521"></a>4521</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_CAT&gt;: Table catalog identifier. This field is NULL (C&lt;undef&gt;) if not</td></tr>
<tr><td class="h"><a name="4522"></a>4522</td><td></td><td></td><td></td><td></td><td class="s">applicable to the data source, which is usually the case. This field</td></tr>
<tr><td class="h"><a name="4523"></a>4523</td><td></td><td></td><td></td><td></td><td class="s">is empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4524"></a>4524</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4525"></a>4525</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_SCHEM&gt;: The name of the schema containing the TABLE_NAME value.</td></tr>
<tr><td class="h"><a name="4526"></a>4526</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to data source, and</td></tr>
<tr><td class="h"><a name="4527"></a>4527</td><td></td><td></td><td></td><td></td><td class="s">empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4528"></a>4528</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4529"></a>4529</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_NAME&gt;: Name of the table (or view, synonym, etc).</td></tr>
<tr><td class="h"><a name="4530"></a>4530</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4531"></a>4531</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_TYPE&gt;: One of the following: &quot;TABLE&quot;, &quot;VIEW&quot;, &quot;SYSTEM TABLE&quot;,</td></tr>
<tr><td class="h"><a name="4532"></a>4532</td><td></td><td></td><td></td><td></td><td class="s">&quot;GLOBAL TEMPORARY&quot;, &quot;LOCAL TEMPORARY&quot;, &quot;ALIAS&quot;, &quot;SYNONYM&quot; or a type</td></tr>
<tr><td class="h"><a name="4533"></a>4533</td><td></td><td></td><td></td><td></td><td class="s">identifier that is specific to the data</td></tr>
<tr><td class="h"><a name="4534"></a>4534</td><td></td><td></td><td></td><td></td><td class="s">source.</td></tr>
<tr><td class="h"><a name="4535"></a>4535</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4536"></a>4536</td><td></td><td></td><td></td><td></td><td class="s">B&lt;REMARKS&gt;: A description of the table. May be NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="4537"></a>4537</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4538"></a>4538</td><td></td><td></td><td></td><td></td><td class="s">Note that C&lt;table_info&gt; might not return records for all tables.</td></tr>
<tr><td class="h"><a name="4539"></a>4539</td><td></td><td></td><td></td><td></td><td class="s">Applications can use any valid table regardless of whether it's</td></tr>
<tr><td class="h"><a name="4540"></a>4540</td><td></td><td></td><td></td><td></td><td class="s">returned by C&lt;table_info&gt;.</td></tr>
<tr><td class="h"><a name="4541"></a>4541</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4542"></a>4542</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/tables&gt;, L&lt;/&quot;Catalog Methods&quot;&gt; and</td></tr>
<tr><td class="h"><a name="4543"></a>4543</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="4544"></a>4544</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4545"></a>4545</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;column_info&gt;</td></tr>
<tr><td class="h"><a name="4546"></a>4546</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4547"></a>4547</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;column_info( $catalog, $schema, $table, $column );</td></tr>
<tr><td class="h"><a name="4548"></a>4548</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4549"></a>4549</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4550"></a>4550</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4551"></a>4551</td><td></td><td></td><td></td><td></td><td class="s">Returns an active statement handle that can be used to fetch</td></tr>
<tr><td class="h"><a name="4552"></a>4552</td><td></td><td></td><td></td><td></td><td class="s">information about columns in specified tables.</td></tr>
<tr><td class="h"><a name="4553"></a>4553</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4554"></a>4554</td><td></td><td></td><td></td><td></td><td class="s">The arguments $schema, $table and $column may accept search patterns</td></tr>
<tr><td class="h"><a name="4555"></a>4555</td><td></td><td></td><td></td><td></td><td class="s">according to the database/driver, for example: $table = '%FOO%';</td></tr>
<tr><td class="h"><a name="4556"></a>4556</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4557"></a>4557</td><td></td><td></td><td></td><td></td><td class="s">Note: The support for the selection criteria is driver specific. If the</td></tr>
<tr><td class="h"><a name="4558"></a>4558</td><td></td><td></td><td></td><td></td><td class="s">driver doesn't support one or more of them then you may get back more</td></tr>
<tr><td class="h"><a name="4559"></a>4559</td><td></td><td></td><td></td><td></td><td class="s">than you asked for and can do the filtering yourself.</td></tr>
<tr><td class="h"><a name="4560"></a>4560</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4561"></a>4561</td><td></td><td></td><td></td><td></td><td class="s">If the arguments don't match any tables then you'll still get a statement</td></tr>
<tr><td class="h"><a name="4562"></a>4562</td><td></td><td></td><td></td><td></td><td class="s">handle, it'll just return no rows.</td></tr>
<tr><td class="h"><a name="4563"></a>4563</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4564"></a>4564</td><td></td><td></td><td></td><td></td><td class="s">The statement handle returned has at least the following fields in the</td></tr>
<tr><td class="h"><a name="4565"></a>4565</td><td></td><td></td><td></td><td></td><td class="s">order shown below. Other fields, after these, may also be present.</td></tr>
<tr><td class="h"><a name="4566"></a>4566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4567"></a>4567</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_CAT&gt;: The catalog identifier.</td></tr>
<tr><td class="h"><a name="4568"></a>4568</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4569"></a>4569</td><td></td><td></td><td></td><td></td><td class="s">which is often the case.  This field is empty if not applicable to the</td></tr>
<tr><td class="h"><a name="4570"></a>4570</td><td></td><td></td><td></td><td></td><td class="s">table.</td></tr>
<tr><td class="h"><a name="4571"></a>4571</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4572"></a>4572</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_SCHEM&gt;: The schema identifier.</td></tr>
<tr><td class="h"><a name="4573"></a>4573</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4574"></a>4574</td><td></td><td></td><td></td><td></td><td class="s">and empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4575"></a>4575</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4576"></a>4576</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_NAME&gt;: The table identifier.</td></tr>
<tr><td class="h"><a name="4577"></a>4577</td><td></td><td></td><td></td><td></td><td class="s">Note: A driver may provide column metadata not only for base tables, but</td></tr>
<tr><td class="h"><a name="4578"></a>4578</td><td></td><td></td><td></td><td></td><td class="s">also for derived objects like SYNONYMS etc.</td></tr>
<tr><td class="h"><a name="4579"></a>4579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4580"></a>4580</td><td></td><td></td><td></td><td></td><td class="s">B&lt;COLUMN_NAME&gt;: The column identifier.</td></tr>
<tr><td class="h"><a name="4581"></a>4581</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4582"></a>4582</td><td></td><td></td><td></td><td></td><td class="s">B&lt;DATA_TYPE&gt;: The concise data type code.</td></tr>
<tr><td class="h"><a name="4583"></a>4583</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4584"></a>4584</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TYPE_NAME&gt;: A data source dependent data type name.</td></tr>
<tr><td class="h"><a name="4585"></a>4585</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4586"></a>4586</td><td></td><td></td><td></td><td></td><td class="s">B&lt;COLUMN_SIZE&gt;: The column size.</td></tr>
<tr><td class="h"><a name="4587"></a>4587</td><td></td><td></td><td></td><td></td><td class="s">This is the maximum length in characters for character data types,</td></tr>
<tr><td class="h"><a name="4588"></a>4588</td><td></td><td></td><td></td><td></td><td class="s">the number of digits or bits for numeric data types or the length</td></tr>
<tr><td class="h"><a name="4589"></a>4589</td><td></td><td></td><td></td><td></td><td class="s">in the representation of temporal types.</td></tr>
<tr><td class="h"><a name="4590"></a>4590</td><td></td><td></td><td></td><td></td><td class="s">See the relevant specifications for detailed information.</td></tr>
<tr><td class="h"><a name="4591"></a>4591</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4592"></a>4592</td><td></td><td></td><td></td><td></td><td class="s">B&lt;BUFFER_LENGTH&gt;: The length in bytes of transferred data.</td></tr>
<tr><td class="h"><a name="4593"></a>4593</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4594"></a>4594</td><td></td><td></td><td></td><td></td><td class="s">B&lt;DECIMAL_DIGITS&gt;: The total number of significant digits to the right of</td></tr>
<tr><td class="h"><a name="4595"></a>4595</td><td></td><td></td><td></td><td></td><td class="s">the decimal point.</td></tr>
<tr><td class="h"><a name="4596"></a>4596</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4597"></a>4597</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NUM_PREC_RADIX&gt;: The radix for numeric precision.</td></tr>
<tr><td class="h"><a name="4598"></a>4598</td><td></td><td></td><td></td><td></td><td class="s">The value is 10 or 2 for numeric data types and NULL (C&lt;undef&gt;) if not</td></tr>
<tr><td class="h"><a name="4599"></a>4599</td><td></td><td></td><td></td><td></td><td class="s">applicable.</td></tr>
<tr><td class="h"><a name="4600"></a>4600</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4601"></a>4601</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NULLABLE&gt;: Indicates if a column can accept NULLs.</td></tr>
<tr><td class="h"><a name="4602"></a>4602</td><td></td><td></td><td></td><td></td><td class="s">The following values are defined:</td></tr>
<tr><td class="h"><a name="4603"></a>4603</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4604"></a>4604</td><td></td><td></td><td></td><td></td><td class="s">  SQL_NO_NULLS          0</td></tr>
<tr><td class="h"><a name="4605"></a>4605</td><td></td><td></td><td></td><td></td><td class="s">  SQL_NULLABLE          1</td></tr>
<tr><td class="h"><a name="4606"></a>4606</td><td></td><td></td><td></td><td></td><td class="s">  SQL_NULLABLE_UNKNOWN  2</td></tr>
<tr><td class="h"><a name="4607"></a>4607</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4608"></a>4608</td><td></td><td></td><td></td><td></td><td class="s">B&lt;REMARKS&gt;: A description of the column.</td></tr>
<tr><td class="h"><a name="4609"></a>4609</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4610"></a>4610</td><td></td><td></td><td></td><td></td><td class="s">B&lt;COLUMN_DEF&gt;: The default value of the column.</td></tr>
<tr><td class="h"><a name="4611"></a>4611</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4612"></a>4612</td><td></td><td></td><td></td><td></td><td class="s">B&lt;SQL_DATA_TYPE&gt;: The SQL data type.</td></tr>
<tr><td class="h"><a name="4613"></a>4613</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4614"></a>4614</td><td></td><td></td><td></td><td></td><td class="s">B&lt;SQL_DATETIME_SUB&gt;: The subtype code for datetime and interval data types.</td></tr>
<tr><td class="h"><a name="4615"></a>4615</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4616"></a>4616</td><td></td><td></td><td></td><td></td><td class="s">B&lt;CHAR_OCTET_LENGTH&gt;: The maximum length in bytes of a character or binary</td></tr>
<tr><td class="h"><a name="4617"></a>4617</td><td></td><td></td><td></td><td></td><td class="s">data type column.</td></tr>
<tr><td class="h"><a name="4618"></a>4618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4619"></a>4619</td><td></td><td></td><td></td><td></td><td class="s">B&lt;ORDINAL_POSITION&gt;: The column sequence number (starting with 1).</td></tr>
<tr><td class="h"><a name="4620"></a>4620</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4621"></a>4621</td><td></td><td></td><td></td><td></td><td class="s">B&lt;IS_NULLABLE&gt;: Indicates if the column can accept NULLs.</td></tr>
<tr><td class="h"><a name="4622"></a>4622</td><td></td><td></td><td></td><td></td><td class="s">Possible values are: 'NO', 'YES' and ''.</td></tr>
<tr><td class="h"><a name="4623"></a>4623</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4624"></a>4624</td><td></td><td></td><td></td><td></td><td class="s">SQL/CLI defines the following additional columns:</td></tr>
<tr><td class="h"><a name="4625"></a>4625</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4626"></a>4626</td><td></td><td></td><td></td><td></td><td class="s">  CHAR_SET_CAT</td></tr>
<tr><td class="h"><a name="4627"></a>4627</td><td></td><td></td><td></td><td></td><td class="s">  CHAR_SET_SCHEM</td></tr>
<tr><td class="h"><a name="4628"></a>4628</td><td></td><td></td><td></td><td></td><td class="s">  CHAR_SET_NAME</td></tr>
<tr><td class="h"><a name="4629"></a>4629</td><td></td><td></td><td></td><td></td><td class="s">  COLLATION_CAT</td></tr>
<tr><td class="h"><a name="4630"></a>4630</td><td></td><td></td><td></td><td></td><td class="s">  COLLATION_SCHEM</td></tr>
<tr><td class="h"><a name="4631"></a>4631</td><td></td><td></td><td></td><td></td><td class="s">  COLLATION_NAME</td></tr>
<tr><td class="h"><a name="4632"></a>4632</td><td></td><td></td><td></td><td></td><td class="s">  UDT_CAT</td></tr>
<tr><td class="h"><a name="4633"></a>4633</td><td></td><td></td><td></td><td></td><td class="s">  UDT_SCHEM</td></tr>
<tr><td class="h"><a name="4634"></a>4634</td><td></td><td></td><td></td><td></td><td class="s">  UDT_NAME</td></tr>
<tr><td class="h"><a name="4635"></a>4635</td><td></td><td></td><td></td><td></td><td class="s">  DOMAIN_CAT</td></tr>
<tr><td class="h"><a name="4636"></a>4636</td><td></td><td></td><td></td><td></td><td class="s">  DOMAIN_SCHEM</td></tr>
<tr><td class="h"><a name="4637"></a>4637</td><td></td><td></td><td></td><td></td><td class="s">  DOMAIN_NAME</td></tr>
<tr><td class="h"><a name="4638"></a>4638</td><td></td><td></td><td></td><td></td><td class="s">  SCOPE_CAT</td></tr>
<tr><td class="h"><a name="4639"></a>4639</td><td></td><td></td><td></td><td></td><td class="s">  SCOPE_SCHEM</td></tr>
<tr><td class="h"><a name="4640"></a>4640</td><td></td><td></td><td></td><td></td><td class="s">  SCOPE_NAME</td></tr>
<tr><td class="h"><a name="4641"></a>4641</td><td></td><td></td><td></td><td></td><td class="s">  MAX_CARDINALITY</td></tr>
<tr><td class="h"><a name="4642"></a>4642</td><td></td><td></td><td></td><td></td><td class="s">  DTD_IDENTIFIER</td></tr>
<tr><td class="h"><a name="4643"></a>4643</td><td></td><td></td><td></td><td></td><td class="s">  IS_SELF_REF</td></tr>
<tr><td class="h"><a name="4644"></a>4644</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4645"></a>4645</td><td></td><td></td><td></td><td></td><td class="s">Drivers capable of supplying any of those values should do so in</td></tr>
<tr><td class="h"><a name="4646"></a>4646</td><td></td><td></td><td></td><td></td><td class="s">the corresponding column and supply undef values for the others.</td></tr>
<tr><td class="h"><a name="4647"></a>4647</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4648"></a>4648</td><td></td><td></td><td></td><td></td><td class="s">Drivers wishing to provide extra database/driver specific information</td></tr>
<tr><td class="h"><a name="4649"></a>4649</td><td></td><td></td><td></td><td></td><td class="s">should do so in extra columns beyond all those listed above, and</td></tr>
<tr><td class="h"><a name="4650"></a>4650</td><td></td><td></td><td></td><td></td><td class="s">use lowercase field names with the driver-specific prefix (i.e.,</td></tr>
<tr><td class="h"><a name="4651"></a>4651</td><td></td><td></td><td></td><td></td><td class="s">'ora_...'). Applications accessing such fields should do so by name</td></tr>
<tr><td class="h"><a name="4652"></a>4652</td><td></td><td></td><td></td><td></td><td class="s">and not by column number.</td></tr>
<tr><td class="h"><a name="4653"></a>4653</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4654"></a>4654</td><td></td><td></td><td></td><td></td><td class="s">The result set is ordered by TABLE_CAT, TABLE_SCHEM, TABLE_NAME</td></tr>
<tr><td class="h"><a name="4655"></a>4655</td><td></td><td></td><td></td><td></td><td class="s">and ORDINAL_POSITION.</td></tr>
<tr><td class="h"><a name="4656"></a>4656</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4657"></a>4657</td><td></td><td></td><td></td><td></td><td class="s">Note: There is some overlap with statement attributes (in perl) and</td></tr>
<tr><td class="h"><a name="4658"></a>4658</td><td></td><td></td><td></td><td></td><td class="s">SQLDescribeCol (in ODBC). However, SQLColumns provides more metadata.</td></tr>
<tr><td class="h"><a name="4659"></a>4659</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4660"></a>4660</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Catalog Methods&quot;&gt; and L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="4661"></a>4661</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4662"></a>4662</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;primary_key_info&gt;</td></tr>
<tr><td class="h"><a name="4663"></a>4663</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4664"></a>4664</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;primary_key_info( $catalog, $schema, $table );</td></tr>
<tr><td class="h"><a name="4665"></a>4665</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4666"></a>4666</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4667"></a>4667</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4668"></a>4668</td><td></td><td></td><td></td><td></td><td class="s">Returns an active statement handle that can be used to fetch information</td></tr>
<tr><td class="h"><a name="4669"></a>4669</td><td></td><td></td><td></td><td></td><td class="s">about columns that make up the primary key for a table.</td></tr>
<tr><td class="h"><a name="4670"></a>4670</td><td></td><td></td><td></td><td></td><td class="s">The arguments don't accept search patterns (unlike table_info()).</td></tr>
<tr><td class="h"><a name="4671"></a>4671</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4672"></a>4672</td><td></td><td></td><td></td><td></td><td class="s">The statement handle will return one row per column, ordered by</td></tr>
<tr><td class="h"><a name="4673"></a>4673</td><td></td><td></td><td></td><td></td><td class="s">TABLE_CAT, TABLE_SCHEM, TABLE_NAME, and KEY_SEQ.</td></tr>
<tr><td class="h"><a name="4674"></a>4674</td><td></td><td></td><td></td><td></td><td class="s">If there is no primary key then the statement handle will fetch no rows.</td></tr>
<tr><td class="h"><a name="4675"></a>4675</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4676"></a>4676</td><td></td><td></td><td></td><td></td><td class="s">Note: The support for the selection criteria, such as $catalog, is</td></tr>
<tr><td class="h"><a name="4677"></a>4677</td><td></td><td></td><td></td><td></td><td class="s">driver specific.  If the driver doesn't support catalogs and/or</td></tr>
<tr><td class="h"><a name="4678"></a>4678</td><td></td><td></td><td></td><td></td><td class="s">schemas, it may ignore these criteria.</td></tr>
<tr><td class="h"><a name="4679"></a>4679</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4680"></a>4680</td><td></td><td></td><td></td><td></td><td class="s">The statement handle returned has at least the following fields in the</td></tr>
<tr><td class="h"><a name="4681"></a>4681</td><td></td><td></td><td></td><td></td><td class="s">order shown below. Other fields, after these, may also be present.</td></tr>
<tr><td class="h"><a name="4682"></a>4682</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4683"></a>4683</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_CAT&gt;: The catalog identifier.</td></tr>
<tr><td class="h"><a name="4684"></a>4684</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4685"></a>4685</td><td></td><td></td><td></td><td></td><td class="s">which is often the case.  This field is empty if not applicable to the</td></tr>
<tr><td class="h"><a name="4686"></a>4686</td><td></td><td></td><td></td><td></td><td class="s">table.</td></tr>
<tr><td class="h"><a name="4687"></a>4687</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4688"></a>4688</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_SCHEM&gt;: The schema identifier.</td></tr>
<tr><td class="h"><a name="4689"></a>4689</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4690"></a>4690</td><td></td><td></td><td></td><td></td><td class="s">and empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4691"></a>4691</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4692"></a>4692</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_NAME&gt;: The table identifier.</td></tr>
<tr><td class="h"><a name="4693"></a>4693</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4694"></a>4694</td><td></td><td></td><td></td><td></td><td class="s">B&lt;COLUMN_NAME&gt;: The column identifier.</td></tr>
<tr><td class="h"><a name="4695"></a>4695</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4696"></a>4696</td><td></td><td></td><td></td><td></td><td class="s">B&lt;KEY_SEQ&gt;: The column sequence number (starting with 1).</td></tr>
<tr><td class="h"><a name="4697"></a>4697</td><td></td><td></td><td></td><td></td><td class="s">Note: This field is named B&lt;ORDINAL_POSITION&gt; in SQL/CLI.</td></tr>
<tr><td class="h"><a name="4698"></a>4698</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4699"></a>4699</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PK_NAME&gt;: The primary key constraint identifier.</td></tr>
<tr><td class="h"><a name="4700"></a>4700</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source.</td></tr>
<tr><td class="h"><a name="4701"></a>4701</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4702"></a>4702</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Catalog Methods&quot;&gt; and L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="4703"></a>4703</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4704"></a>4704</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;primary_key&gt;</td></tr>
<tr><td class="h"><a name="4705"></a>4705</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4706"></a>4706</td><td></td><td></td><td></td><td></td><td class="s">  @key_column_names = $dbh-&gt;primary_key( $catalog, $schema, $table );</td></tr>
<tr><td class="h"><a name="4707"></a>4707</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4708"></a>4708</td><td></td><td></td><td></td><td></td><td class="s">Simple interface to the primary_key_info() method. Returns a list of</td></tr>
<tr><td class="h"><a name="4709"></a>4709</td><td></td><td></td><td></td><td></td><td class="s">the column names that comprise the primary key of the specified table.</td></tr>
<tr><td class="h"><a name="4710"></a>4710</td><td></td><td></td><td></td><td></td><td class="s">The list is in primary key column sequence order.</td></tr>
<tr><td class="h"><a name="4711"></a>4711</td><td></td><td></td><td></td><td></td><td class="s">If there is no primary key then an empty list is returned.</td></tr>
<tr><td class="h"><a name="4712"></a>4712</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4713"></a>4713</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;foreign_key_info&gt;</td></tr>
<tr><td class="h"><a name="4714"></a>4714</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4715"></a>4715</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;foreign_key_info( $pk_catalog, $pk_schema, $pk_table</td></tr>
<tr><td class="h"><a name="4716"></a>4716</td><td></td><td></td><td></td><td></td><td class="s">                               , $fk_catalog, $fk_schema, $fk_table );</td></tr>
<tr><td class="h"><a name="4717"></a>4717</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4718"></a>4718</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;foreign_key_info( $pk_catalog, $pk_schema, $pk_table</td></tr>
<tr><td class="h"><a name="4719"></a>4719</td><td></td><td></td><td></td><td></td><td class="s">                               , $fk_catalog, $fk_schema, $fk_table</td></tr>
<tr><td class="h"><a name="4720"></a>4720</td><td></td><td></td><td></td><td></td><td class="s">                               , \%attr );</td></tr>
<tr><td class="h"><a name="4721"></a>4721</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4722"></a>4722</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4723"></a>4723</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4724"></a>4724</td><td></td><td></td><td></td><td></td><td class="s">Returns an active statement handle that can be used to fetch information</td></tr>
<tr><td class="h"><a name="4725"></a>4725</td><td></td><td></td><td></td><td></td><td class="s">about foreign keys in and/or referencing the specified table(s).</td></tr>
<tr><td class="h"><a name="4726"></a>4726</td><td></td><td></td><td></td><td></td><td class="s">The arguments don't accept search patterns (unlike table_info()).</td></tr>
<tr><td class="h"><a name="4727"></a>4727</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4728"></a>4728</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$pk_catalog&gt;, C&lt;$pk_schema&gt;, C&lt;$pk_table&gt;</td></tr>
<tr><td class="h"><a name="4729"></a>4729</td><td></td><td></td><td></td><td></td><td class="s">identify the primary (unique) key table (B&lt;PKT&gt;).</td></tr>
<tr><td class="h"><a name="4730"></a>4730</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4731"></a>4731</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$fk_catalog&gt;, C&lt;$fk_schema&gt;, C&lt;$fk_table&gt;</td></tr>
<tr><td class="h"><a name="4732"></a>4732</td><td></td><td></td><td></td><td></td><td class="s">identify the foreign key table (B&lt;FKT&gt;).</td></tr>
<tr><td class="h"><a name="4733"></a>4733</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4734"></a>4734</td><td></td><td></td><td></td><td></td><td class="s">If both B&lt;PKT&gt; and B&lt;FKT&gt; are given, the function returns the foreign key, if</td></tr>
<tr><td class="h"><a name="4735"></a>4735</td><td></td><td></td><td></td><td></td><td class="s">any, in table B&lt;FKT&gt; that refers to the primary (unique) key of table B&lt;PKT&gt;.</td></tr>
<tr><td class="h"><a name="4736"></a>4736</td><td></td><td></td><td></td><td></td><td class="s">(Note: In SQL/CLI, the result is implementation-defined.)</td></tr>
<tr><td class="h"><a name="4737"></a>4737</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4738"></a>4738</td><td></td><td></td><td></td><td></td><td class="s">If only B&lt;PKT&gt; is given, then the result set contains the primary key</td></tr>
<tr><td class="h"><a name="4739"></a>4739</td><td></td><td></td><td></td><td></td><td class="s">of that table and all foreign keys that refer to it.</td></tr>
<tr><td class="h"><a name="4740"></a>4740</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4741"></a>4741</td><td></td><td></td><td></td><td></td><td class="s">If only B&lt;FKT&gt; is given, then the result set contains all foreign keys</td></tr>
<tr><td class="h"><a name="4742"></a>4742</td><td></td><td></td><td></td><td></td><td class="s">in that table and the primary keys to which they refer.</td></tr>
<tr><td class="h"><a name="4743"></a>4743</td><td></td><td></td><td></td><td></td><td class="s">(Note: In SQL/CLI, the result includes unique keys too.)</td></tr>
<tr><td class="h"><a name="4744"></a>4744</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4745"></a>4745</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="4746"></a>4746</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4747"></a>4747</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;foreign_key_info( undef, $user, 'master');</td></tr>
<tr><td class="h"><a name="4748"></a>4748</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;foreign_key_info( undef, undef,   undef , undef, $user, 'detail');</td></tr>
<tr><td class="h"><a name="4749"></a>4749</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;foreign_key_info( undef, $user, 'master', undef, $user, 'detail');</td></tr>
<tr><td class="h"><a name="4750"></a>4750</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4751"></a>4751</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4752"></a>4752</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4753"></a>4753</td><td></td><td></td><td></td><td></td><td class="s">Note: The support for the selection criteria, such as C&lt;$catalog&gt;, is</td></tr>
<tr><td class="h"><a name="4754"></a>4754</td><td></td><td></td><td></td><td></td><td class="s">driver specific.  If the driver doesn't support catalogs and/or</td></tr>
<tr><td class="h"><a name="4755"></a>4755</td><td></td><td></td><td></td><td></td><td class="s">schemas, it may ignore these criteria.</td></tr>
<tr><td class="h"><a name="4756"></a>4756</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4757"></a>4757</td><td></td><td></td><td></td><td></td><td class="s">The statement handle returned has the following fields in the order shown below.</td></tr>
<tr><td class="h"><a name="4758"></a>4758</td><td></td><td></td><td></td><td></td><td class="s">Because ODBC never includes unique keys, they define different columns in the</td></tr>
<tr><td class="h"><a name="4759"></a>4759</td><td></td><td></td><td></td><td></td><td class="s">result set than SQL/CLI. SQL/CLI column names are shown in parentheses.</td></tr>
<tr><td class="h"><a name="4760"></a>4760</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4761"></a>4761</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PKTABLE_CAT    ( UK_TABLE_CAT      )&gt;:</td></tr>
<tr><td class="h"><a name="4762"></a>4762</td><td></td><td></td><td></td><td></td><td class="s">The primary (unique) key table catalog identifier.</td></tr>
<tr><td class="h"><a name="4763"></a>4763</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4764"></a>4764</td><td></td><td></td><td></td><td></td><td class="s">which is often the case.  This field is empty if not applicable to the</td></tr>
<tr><td class="h"><a name="4765"></a>4765</td><td></td><td></td><td></td><td></td><td class="s">table.</td></tr>
<tr><td class="h"><a name="4766"></a>4766</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4767"></a>4767</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PKTABLE_SCHEM  ( UK_TABLE_SCHEM    )&gt;:</td></tr>
<tr><td class="h"><a name="4768"></a>4768</td><td></td><td></td><td></td><td></td><td class="s">The primary (unique) key table schema identifier.</td></tr>
<tr><td class="h"><a name="4769"></a>4769</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4770"></a>4770</td><td></td><td></td><td></td><td></td><td class="s">and empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4771"></a>4771</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4772"></a>4772</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PKTABLE_NAME   ( UK_TABLE_NAME     )&gt;:</td></tr>
<tr><td class="h"><a name="4773"></a>4773</td><td></td><td></td><td></td><td></td><td class="s">The primary (unique) key table identifier.</td></tr>
<tr><td class="h"><a name="4774"></a>4774</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4775"></a>4775</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PKCOLUMN_NAME  (UK_COLUMN_NAME    )&gt;:</td></tr>
<tr><td class="h"><a name="4776"></a>4776</td><td></td><td></td><td></td><td></td><td class="s">The primary (unique) key column identifier.</td></tr>
<tr><td class="h"><a name="4777"></a>4777</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4778"></a>4778</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FKTABLE_CAT    ( FK_TABLE_CAT      )&gt;:</td></tr>
<tr><td class="h"><a name="4779"></a>4779</td><td></td><td></td><td></td><td></td><td class="s">The foreign key table catalog identifier.</td></tr>
<tr><td class="h"><a name="4780"></a>4780</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4781"></a>4781</td><td></td><td></td><td></td><td></td><td class="s">which is often the case.  This field is empty if not applicable to the</td></tr>
<tr><td class="h"><a name="4782"></a>4782</td><td></td><td></td><td></td><td></td><td class="s">table.</td></tr>
<tr><td class="h"><a name="4783"></a>4783</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4784"></a>4784</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FKTABLE_SCHEM  ( FK_TABLE_SCHEM    )&gt;:</td></tr>
<tr><td class="h"><a name="4785"></a>4785</td><td></td><td></td><td></td><td></td><td class="s">The foreign key table schema identifier.</td></tr>
<tr><td class="h"><a name="4786"></a>4786</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4787"></a>4787</td><td></td><td></td><td></td><td></td><td class="s">and empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4788"></a>4788</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4789"></a>4789</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FKTABLE_NAME   ( FK_TABLE_NAME     )&gt;:</td></tr>
<tr><td class="h"><a name="4790"></a>4790</td><td></td><td></td><td></td><td></td><td class="s">The foreign key table identifier.</td></tr>
<tr><td class="h"><a name="4791"></a>4791</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4792"></a>4792</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FKCOLUMN_NAME  ( FK_COLUMN_NAME    )&gt;:</td></tr>
<tr><td class="h"><a name="4793"></a>4793</td><td></td><td></td><td></td><td></td><td class="s">The foreign key column identifier.</td></tr>
<tr><td class="h"><a name="4794"></a>4794</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4795"></a>4795</td><td></td><td></td><td></td><td></td><td class="s">B&lt;KEY_SEQ        ( ORDINAL_POSITION  )&gt;:</td></tr>
<tr><td class="h"><a name="4796"></a>4796</td><td></td><td></td><td></td><td></td><td class="s">The column sequence number (starting with 1).</td></tr>
<tr><td class="h"><a name="4797"></a>4797</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4798"></a>4798</td><td></td><td></td><td></td><td></td><td class="s">B&lt;UPDATE_RULE    ( UPDATE_RULE       )&gt;:</td></tr>
<tr><td class="h"><a name="4799"></a>4799</td><td></td><td></td><td></td><td></td><td class="s">The referential action for the UPDATE rule.</td></tr>
<tr><td class="h"><a name="4800"></a>4800</td><td></td><td></td><td></td><td></td><td class="s">The following codes are defined:</td></tr>
<tr><td class="h"><a name="4801"></a>4801</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4802"></a>4802</td><td></td><td></td><td></td><td></td><td class="s">  CASCADE              0</td></tr>
<tr><td class="h"><a name="4803"></a>4803</td><td></td><td></td><td></td><td></td><td class="s">  RESTRICT             1</td></tr>
<tr><td class="h"><a name="4804"></a>4804</td><td></td><td></td><td></td><td></td><td class="s">  SET NULL             2</td></tr>
<tr><td class="h"><a name="4805"></a>4805</td><td></td><td></td><td></td><td></td><td class="s">  NO ACTION            3</td></tr>
<tr><td class="h"><a name="4806"></a>4806</td><td></td><td></td><td></td><td></td><td class="s">  SET DEFAULT          4</td></tr>
<tr><td class="h"><a name="4807"></a>4807</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4808"></a>4808</td><td></td><td></td><td></td><td></td><td class="s">B&lt;DELETE_RULE    ( DELETE_RULE       )&gt;:</td></tr>
<tr><td class="h"><a name="4809"></a>4809</td><td></td><td></td><td></td><td></td><td class="s">The referential action for the DELETE rule.</td></tr>
<tr><td class="h"><a name="4810"></a>4810</td><td></td><td></td><td></td><td></td><td class="s">The codes are the same as for UPDATE_RULE.</td></tr>
<tr><td class="h"><a name="4811"></a>4811</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4812"></a>4812</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FK_NAME        ( FK_NAME           )&gt;:</td></tr>
<tr><td class="h"><a name="4813"></a>4813</td><td></td><td></td><td></td><td></td><td class="s">The foreign key name.</td></tr>
<tr><td class="h"><a name="4814"></a>4814</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4815"></a>4815</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PK_NAME        ( UK_NAME           )&gt;:</td></tr>
<tr><td class="h"><a name="4816"></a>4816</td><td></td><td></td><td></td><td></td><td class="s">The primary (unique) key name.</td></tr>
<tr><td class="h"><a name="4817"></a>4817</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4818"></a>4818</td><td></td><td></td><td></td><td></td><td class="s">B&lt;DEFERRABILITY  ( DEFERABILITY      )&gt;:</td></tr>
<tr><td class="h"><a name="4819"></a>4819</td><td></td><td></td><td></td><td></td><td class="s">The deferrability of the foreign key constraint.</td></tr>
<tr><td class="h"><a name="4820"></a>4820</td><td></td><td></td><td></td><td></td><td class="s">The following codes are defined:</td></tr>
<tr><td class="h"><a name="4821"></a>4821</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4822"></a>4822</td><td></td><td></td><td></td><td></td><td class="s">  INITIALLY DEFERRED   5</td></tr>
<tr><td class="h"><a name="4823"></a>4823</td><td></td><td></td><td></td><td></td><td class="s">  INITIALLY IMMEDIATE  6</td></tr>
<tr><td class="h"><a name="4824"></a>4824</td><td></td><td></td><td></td><td></td><td class="s">  NOT DEFERRABLE       7</td></tr>
<tr><td class="h"><a name="4825"></a>4825</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4826"></a>4826</td><td></td><td></td><td></td><td></td><td class="s">B&lt;               ( UNIQUE_OR_PRIMARY )&gt;:</td></tr>
<tr><td class="h"><a name="4827"></a>4827</td><td></td><td></td><td></td><td></td><td class="s">This column is necessary if a driver includes all candidate (i.e. primary and</td></tr>
<tr><td class="h"><a name="4828"></a>4828</td><td></td><td></td><td></td><td></td><td class="s">alternate) keys in the result set (as specified by SQL/CLI).</td></tr>
<tr><td class="h"><a name="4829"></a>4829</td><td></td><td></td><td></td><td></td><td class="s">The value of this column is UNIQUE if the foreign key references an alternate</td></tr>
<tr><td class="h"><a name="4830"></a>4830</td><td></td><td></td><td></td><td></td><td class="s">key and PRIMARY if the foreign key references a primary key, or it</td></tr>
<tr><td class="h"><a name="4831"></a>4831</td><td></td><td></td><td></td><td></td><td class="s">may be undefined if the driver doesn't have access to the information.</td></tr>
<tr><td class="h"><a name="4832"></a>4832</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4833"></a>4833</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Catalog Methods&quot;&gt; and L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="4834"></a>4834</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4835"></a>4835</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;statistics_info&gt;</td></tr>
<tr><td class="h"><a name="4836"></a>4836</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4837"></a>4837</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Warning:&gt; This method is experimental and may change.</td></tr>
<tr><td class="h"><a name="4838"></a>4838</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4839"></a>4839</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;statistics_info( $catalog, $schema, $table, $unique_only, $quick );</td></tr>
<tr><td class="h"><a name="4840"></a>4840</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4841"></a>4841</td><td></td><td></td><td></td><td></td><td class="s">  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc</td></tr>
<tr><td class="h"><a name="4842"></a>4842</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4843"></a>4843</td><td></td><td></td><td></td><td></td><td class="s">Returns an active statement handle that can be used to fetch statistical</td></tr>
<tr><td class="h"><a name="4844"></a>4844</td><td></td><td></td><td></td><td></td><td class="s">information about a table and its indexes.</td></tr>
<tr><td class="h"><a name="4845"></a>4845</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4846"></a>4846</td><td></td><td></td><td></td><td></td><td class="s">The arguments don't accept search patterns (unlike L&lt;/table_info&gt;).</td></tr>
<tr><td class="h"><a name="4847"></a>4847</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4848"></a>4848</td><td></td><td></td><td></td><td></td><td class="s">If the boolean argument $unique_only is true, only UNIQUE indexes will be</td></tr>
<tr><td class="h"><a name="4849"></a>4849</td><td></td><td></td><td></td><td></td><td class="s">returned in the result set, otherwise all indexes will be returned.</td></tr>
<tr><td class="h"><a name="4850"></a>4850</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4851"></a>4851</td><td></td><td></td><td></td><td></td><td class="s">If the boolean argument $quick is set, the actual statistical information</td></tr>
<tr><td class="h"><a name="4852"></a>4852</td><td></td><td></td><td></td><td></td><td class="s">columns (CARDINALITY and PAGES) will only be returned if they are readily</td></tr>
<tr><td class="h"><a name="4853"></a>4853</td><td></td><td></td><td></td><td></td><td class="s">available from the server, and might not be current.  Some databases may</td></tr>
<tr><td class="h"><a name="4854"></a>4854</td><td></td><td></td><td></td><td></td><td class="s">return stale statistics or no statistics at all with this flag set.</td></tr>
<tr><td class="h"><a name="4855"></a>4855</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4856"></a>4856</td><td></td><td></td><td></td><td></td><td class="s">The statement handle will return at most one row per column name per index,</td></tr>
<tr><td class="h"><a name="4857"></a>4857</td><td></td><td></td><td></td><td></td><td class="s">plus at most one row for the entire table itself, ordered by NON_UNIQUE, TYPE,</td></tr>
<tr><td class="h"><a name="4858"></a>4858</td><td></td><td></td><td></td><td></td><td class="s">INDEX_QUALIFIER, INDEX_NAME, and ORDINAL_POSITION.</td></tr>
<tr><td class="h"><a name="4859"></a>4859</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4860"></a>4860</td><td></td><td></td><td></td><td></td><td class="s">Note: The support for the selection criteria, such as $catalog, is</td></tr>
<tr><td class="h"><a name="4861"></a>4861</td><td></td><td></td><td></td><td></td><td class="s">driver specific.  If the driver doesn't support catalogs and/or</td></tr>
<tr><td class="h"><a name="4862"></a>4862</td><td></td><td></td><td></td><td></td><td class="s">schemas, it may ignore these criteria.</td></tr>
<tr><td class="h"><a name="4863"></a>4863</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4864"></a>4864</td><td></td><td></td><td></td><td></td><td class="s">The statement handle returned has at least the following fields in the</td></tr>
<tr><td class="h"><a name="4865"></a>4865</td><td></td><td></td><td></td><td></td><td class="s">order shown below. Other fields, after these, may also be present.</td></tr>
<tr><td class="h"><a name="4866"></a>4866</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4867"></a>4867</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_CAT&gt;: The catalog identifier.</td></tr>
<tr><td class="h"><a name="4868"></a>4868</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4869"></a>4869</td><td></td><td></td><td></td><td></td><td class="s">which is often the case.  This field is empty if not applicable to the</td></tr>
<tr><td class="h"><a name="4870"></a>4870</td><td></td><td></td><td></td><td></td><td class="s">table.</td></tr>
<tr><td class="h"><a name="4871"></a>4871</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4872"></a>4872</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_SCHEM&gt;: The schema identifier.</td></tr>
<tr><td class="h"><a name="4873"></a>4873</td><td></td><td></td><td></td><td></td><td class="s">This field is NULL (C&lt;undef&gt;) if not applicable to the data source,</td></tr>
<tr><td class="h"><a name="4874"></a>4874</td><td></td><td></td><td></td><td></td><td class="s">and empty if not applicable to the table.</td></tr>
<tr><td class="h"><a name="4875"></a>4875</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4876"></a>4876</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TABLE_NAME&gt;: The table identifier.</td></tr>
<tr><td class="h"><a name="4877"></a>4877</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4878"></a>4878</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NON_UNIQUE&gt;: Unique index indicator.</td></tr>
<tr><td class="h"><a name="4879"></a>4879</td><td></td><td></td><td></td><td></td><td class="s">Returns 0 for unique indexes, 1 for non-unique indexes</td></tr>
<tr><td class="h"><a name="4880"></a>4880</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4881"></a>4881</td><td></td><td></td><td></td><td></td><td class="s">B&lt;INDEX_QUALIFIER&gt;: Index qualifier identifier.</td></tr>
<tr><td class="h"><a name="4882"></a>4882</td><td></td><td></td><td></td><td></td><td class="s">The identifier that is used to qualify the index name when doing a</td></tr>
<tr><td class="h"><a name="4883"></a>4883</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DROP INDEX&gt;; NULL (C&lt;undef&gt;) is returned if an index qualifier is not</td></tr>
<tr><td class="h"><a name="4884"></a>4884</td><td></td><td></td><td></td><td></td><td class="s">supported by the data source.</td></tr>
<tr><td class="h"><a name="4885"></a>4885</td><td></td><td></td><td></td><td></td><td class="s">If a non-NULL (defined) value is returned in this column, it must be used</td></tr>
<tr><td class="h"><a name="4886"></a>4886</td><td></td><td></td><td></td><td></td><td class="s">to qualify the index name on a C&lt;DROP INDEX&gt; statement; otherwise,</td></tr>
<tr><td class="h"><a name="4887"></a>4887</td><td></td><td></td><td></td><td></td><td class="s">the TABLE_SCHEM should be used to qualify the index name.</td></tr>
<tr><td class="h"><a name="4888"></a>4888</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4889"></a>4889</td><td></td><td></td><td></td><td></td><td class="s">B&lt;INDEX_NAME&gt;: The index identifier.</td></tr>
<tr><td class="h"><a name="4890"></a>4890</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4891"></a>4891</td><td></td><td></td><td></td><td></td><td class="s">B&lt;TYPE&gt;: The type of information being returned.  Can be any of the</td></tr>
<tr><td class="h"><a name="4892"></a>4892</td><td></td><td></td><td></td><td></td><td class="s">following values: 'table', 'btree', 'clustered', 'content', 'hashed',</td></tr>
<tr><td class="h"><a name="4893"></a>4893</td><td></td><td></td><td></td><td></td><td class="s">or 'other'.</td></tr>
<tr><td class="h"><a name="4894"></a>4894</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4895"></a>4895</td><td></td><td></td><td></td><td></td><td class="s">In the case that this field is 'table', all fields</td></tr>
<tr><td class="h"><a name="4896"></a>4896</td><td></td><td></td><td></td><td></td><td class="s">other than TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TYPE,</td></tr>
<tr><td class="h"><a name="4897"></a>4897</td><td></td><td></td><td></td><td></td><td class="s">CARDINALITY, and PAGES will be NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="4898"></a>4898</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4899"></a>4899</td><td></td><td></td><td></td><td></td><td class="s">B&lt;ORDINAL_POSITION&gt;: Column sequence number (starting with 1).</td></tr>
<tr><td class="h"><a name="4900"></a>4900</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4901"></a>4901</td><td></td><td></td><td></td><td></td><td class="s">B&lt;COLUMN_NAME&gt;: The column identifier.</td></tr>
<tr><td class="h"><a name="4902"></a>4902</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4903"></a>4903</td><td></td><td></td><td></td><td></td><td class="s">B&lt;ASC_OR_DESC&gt;: Column sort sequence.</td></tr>
<tr><td class="h"><a name="4904"></a>4904</td><td></td><td></td><td></td><td></td><td class="s">C&lt;A&gt; for Ascending, C&lt;D&gt; for Descending, or NULL (C&lt;undef&gt;) if</td></tr>
<tr><td class="h"><a name="4905"></a>4905</td><td></td><td></td><td></td><td></td><td class="s">not supported for this index.</td></tr>
<tr><td class="h"><a name="4906"></a>4906</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4907"></a>4907</td><td></td><td></td><td></td><td></td><td class="s">B&lt;CARDINALITY&gt;: Cardinality of the table or index.</td></tr>
<tr><td class="h"><a name="4908"></a>4908</td><td></td><td></td><td></td><td></td><td class="s">For indexes, this is the number of unique values in the index.</td></tr>
<tr><td class="h"><a name="4909"></a>4909</td><td></td><td></td><td></td><td></td><td class="s">For tables, this is the number of rows in the table.</td></tr>
<tr><td class="h"><a name="4910"></a>4910</td><td></td><td></td><td></td><td></td><td class="s">If not supported, the value will be NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="4911"></a>4911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4912"></a>4912</td><td></td><td></td><td></td><td></td><td class="s">B&lt;PAGES&gt;: Number of storage pages used by this table or index.</td></tr>
<tr><td class="h"><a name="4913"></a>4913</td><td></td><td></td><td></td><td></td><td class="s">If not supported, the value will be NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="4914"></a>4914</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4915"></a>4915</td><td></td><td></td><td></td><td></td><td class="s">B&lt;FILTER_CONDITION&gt;: The index filter condition as a string.</td></tr>
<tr><td class="h"><a name="4916"></a>4916</td><td></td><td></td><td></td><td></td><td class="s">If the index is not a filtered index, or it cannot be determined</td></tr>
<tr><td class="h"><a name="4917"></a>4917</td><td></td><td></td><td></td><td></td><td class="s">whether the index is a filtered index, this value is NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="4918"></a>4918</td><td></td><td></td><td></td><td></td><td class="s">If the index is a filtered index, but the filter condition</td></tr>
<tr><td class="h"><a name="4919"></a>4919</td><td></td><td></td><td></td><td></td><td class="s">cannot be determined, this value is the empty string C&lt;''&gt;.</td></tr>
<tr><td class="h"><a name="4920"></a>4920</td><td></td><td></td><td></td><td></td><td class="s">Otherwise it will be the literal filter condition as a string,</td></tr>
<tr><td class="h"><a name="4921"></a>4921</td><td></td><td></td><td></td><td></td><td class="s">such as C&lt;SALARY &lt;= 4500&gt;.</td></tr>
<tr><td class="h"><a name="4922"></a>4922</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4923"></a>4923</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Catalog Methods&quot;&gt; and L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="4924"></a>4924</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4925"></a>4925</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;tables&gt;</td></tr>
<tr><td class="h"><a name="4926"></a>4926</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4927"></a>4927</td><td></td><td></td><td></td><td></td><td class="s">  @names = $dbh-&gt;tables( $catalog, $schema, $table, $type );</td></tr>
<tr><td class="h"><a name="4928"></a>4928</td><td></td><td></td><td></td><td></td><td class="s">  @names = $dbh-&gt;tables;        # deprecated</td></tr>
<tr><td class="h"><a name="4929"></a>4929</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4930"></a>4930</td><td></td><td></td><td></td><td></td><td class="s">Simple interface to table_info(). Returns a list of matching</td></tr>
<tr><td class="h"><a name="4931"></a>4931</td><td></td><td></td><td></td><td></td><td class="s">table names, possibly including a catalog/schema prefix.</td></tr>
<tr><td class="h"><a name="4932"></a>4932</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4933"></a>4933</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/table_info&gt; for a description of the parameters.</td></tr>
<tr><td class="h"><a name="4934"></a>4934</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4935"></a>4935</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;$dbh-E&lt;gt&gt;get_info(29)&gt; returns true (29 is SQL_IDENTIFIER_QUOTE_CHAR)</td></tr>
<tr><td class="h"><a name="4936"></a>4936</td><td></td><td></td><td></td><td></td><td class="s">then the table names are constructed and quoted by L&lt;/quote_identifier&gt;</td></tr>
<tr><td class="h"><a name="4937"></a>4937</td><td></td><td></td><td></td><td></td><td class="s">to ensure they are usable even if they contain whitespace or reserved</td></tr>
<tr><td class="h"><a name="4938"></a>4938</td><td></td><td></td><td></td><td></td><td class="s">words etc. This means that the table names returned will include</td></tr>
<tr><td class="h"><a name="4939"></a>4939</td><td></td><td></td><td></td><td></td><td class="s">quote characters.</td></tr>
<tr><td class="h"><a name="4940"></a>4940</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4941"></a>4941</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;type_info_all&gt;</td></tr>
<tr><td class="h"><a name="4942"></a>4942</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4943"></a>4943</td><td></td><td></td><td></td><td></td><td class="s">  $type_info_all = $dbh-&gt;type_info_all;</td></tr>
<tr><td class="h"><a name="4944"></a>4944</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4945"></a>4945</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array which holds information about each data</td></tr>
<tr><td class="h"><a name="4946"></a>4946</td><td></td><td></td><td></td><td></td><td class="s">type variant supported by the database and driver. The array and its</td></tr>
<tr><td class="h"><a name="4947"></a>4947</td><td></td><td></td><td></td><td></td><td class="s">contents should be treated as read-only.</td></tr>
<tr><td class="h"><a name="4948"></a>4948</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4949"></a>4949</td><td></td><td></td><td></td><td></td><td class="s">The first item is a reference to an 'index' hash of C&lt;Name =&gt;E&lt;gt&gt; C&lt;Index&gt; pairs.</td></tr>
<tr><td class="h"><a name="4950"></a>4950</td><td></td><td></td><td></td><td></td><td class="s">The items following that are references to arrays, one per supported data</td></tr>
<tr><td class="h"><a name="4951"></a>4951</td><td></td><td></td><td></td><td></td><td class="s">type variant. The leading index hash defines the names and order of the</td></tr>
<tr><td class="h"><a name="4952"></a>4952</td><td></td><td></td><td></td><td></td><td class="s">fields within the arrays that follow it.</td></tr>
<tr><td class="h"><a name="4953"></a>4953</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="4954"></a>4954</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4955"></a>4955</td><td></td><td></td><td></td><td></td><td class="s">  $type_info_all = [</td></tr>
<tr><td class="h"><a name="4956"></a>4956</td><td></td><td></td><td></td><td></td><td class="s">    {   TYPE_NAME         =&gt; 0,</td></tr>
<tr><td class="h"><a name="4957"></a>4957</td><td></td><td></td><td></td><td></td><td class="s">        DATA_TYPE         =&gt; 1,</td></tr>
<tr><td class="h"><a name="4958"></a>4958</td><td></td><td></td><td></td><td></td><td class="s">        COLUMN_SIZE       =&gt; 2,     # was PRECISION originally</td></tr>
<tr><td class="h"><a name="4959"></a>4959</td><td></td><td></td><td></td><td></td><td class="s">        LITERAL_PREFIX    =&gt; 3,</td></tr>
<tr><td class="h"><a name="4960"></a>4960</td><td></td><td></td><td></td><td></td><td class="s">        LITERAL_SUFFIX    =&gt; 4,</td></tr>
<tr><td class="h"><a name="4961"></a>4961</td><td></td><td></td><td></td><td></td><td class="s">        CREATE_PARAMS     =&gt; 5,</td></tr>
<tr><td class="h"><a name="4962"></a>4962</td><td></td><td></td><td></td><td></td><td class="s">        NULLABLE          =&gt; 6,</td></tr>
<tr><td class="h"><a name="4963"></a>4963</td><td></td><td></td><td></td><td></td><td class="s">        CASE_SENSITIVE    =&gt; 7,</td></tr>
<tr><td class="h"><a name="4964"></a>4964</td><td></td><td></td><td></td><td></td><td class="s">        SEARCHABLE        =&gt; 8,</td></tr>
<tr><td class="h"><a name="4965"></a>4965</td><td></td><td></td><td></td><td></td><td class="s">        UNSIGNED_ATTRIBUTE=&gt; 9,</td></tr>
<tr><td class="h"><a name="4966"></a>4966</td><td></td><td></td><td></td><td></td><td class="s">        FIXED_PREC_SCALE  =&gt; 10,    # was MONEY originally</td></tr>
<tr><td class="h"><a name="4967"></a>4967</td><td></td><td></td><td></td><td></td><td class="s">        AUTO_UNIQUE_VALUE =&gt; 11,    # was AUTO_INCREMENT originally</td></tr>
<tr><td class="h"><a name="4968"></a>4968</td><td></td><td></td><td></td><td></td><td class="s">        LOCAL_TYPE_NAME   =&gt; 12,</td></tr>
<tr><td class="h"><a name="4969"></a>4969</td><td></td><td></td><td></td><td></td><td class="s">        MINIMUM_SCALE     =&gt; 13,</td></tr>
<tr><td class="h"><a name="4970"></a>4970</td><td></td><td></td><td></td><td></td><td class="s">        MAXIMUM_SCALE     =&gt; 14,</td></tr>
<tr><td class="h"><a name="4971"></a>4971</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DATA_TYPE     =&gt; 15,</td></tr>
<tr><td class="h"><a name="4972"></a>4972</td><td></td><td></td><td></td><td></td><td class="s">        SQL_DATETIME_SUB  =&gt; 16,</td></tr>
<tr><td class="h"><a name="4973"></a>4973</td><td></td><td></td><td></td><td></td><td class="s">        NUM_PREC_RADIX    =&gt; 17,</td></tr>
<tr><td class="h"><a name="4974"></a>4974</td><td></td><td></td><td></td><td></td><td class="s">        INTERVAL_PRECISION=&gt; 18,</td></tr>
<tr><td class="h"><a name="4975"></a>4975</td><td></td><td></td><td></td><td></td><td class="s">    },</td></tr>
<tr><td class="h"><a name="4976"></a>4976</td><td></td><td></td><td></td><td></td><td class="s">    [ 'VARCHAR', SQL_VARCHAR,</td></tr>
<tr><td class="h"><a name="4977"></a>4977</td><td></td><td></td><td></td><td></td><td class="s">        undef, &quot;'&quot;,&quot;'&quot;, undef,0, 1,1,0,0,0,undef,1,255, undef</td></tr>
<tr><td class="h"><a name="4978"></a>4978</td><td></td><td></td><td></td><td></td><td class="s">    ],</td></tr>
<tr><td class="h"><a name="4979"></a>4979</td><td></td><td></td><td></td><td></td><td class="s">    [ 'INTEGER', SQL_INTEGER,</td></tr>
<tr><td class="h"><a name="4980"></a>4980</td><td></td><td></td><td></td><td></td><td class="s">        undef,  &quot;&quot;, &quot;&quot;, undef,0, 0,1,0,0,0,undef,0,  0, 10</td></tr>
<tr><td class="h"><a name="4981"></a>4981</td><td></td><td></td><td></td><td></td><td class="s">    ],</td></tr>
<tr><td class="h"><a name="4982"></a>4982</td><td></td><td></td><td></td><td></td><td class="s">  ];</td></tr>
<tr><td class="h"><a name="4983"></a>4983</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4984"></a>4984</td><td></td><td></td><td></td><td></td><td class="s">More than one row may have the same value in the C&lt;DATA_TYPE&gt;</td></tr>
<tr><td class="h"><a name="4985"></a>4985</td><td></td><td></td><td></td><td></td><td class="s">field if there are different ways to spell the type name and/or there</td></tr>
<tr><td class="h"><a name="4986"></a>4986</td><td></td><td></td><td></td><td></td><td class="s">are variants of the type with different attributes (e.g., with and</td></tr>
<tr><td class="h"><a name="4987"></a>4987</td><td></td><td></td><td></td><td></td><td class="s">without C&lt;AUTO_UNIQUE_VALUE&gt; set, with and without C&lt;UNSIGNED_ATTRIBUTE&gt;, etc).</td></tr>
<tr><td class="h"><a name="4988"></a>4988</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4989"></a>4989</td><td></td><td></td><td></td><td></td><td class="s">The rows are ordered by C&lt;DATA_TYPE&gt; first and then by how closely each</td></tr>
<tr><td class="h"><a name="4990"></a>4990</td><td></td><td></td><td></td><td></td><td class="s">type maps to the corresponding ODBC SQL data type, closest first.</td></tr>
<tr><td class="h"><a name="4991"></a>4991</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4992"></a>4992</td><td></td><td></td><td></td><td></td><td class="s">The meaning of the fields is described in the documentation for</td></tr>
<tr><td class="h"><a name="4993"></a>4993</td><td></td><td></td><td></td><td></td><td class="s">the L&lt;/type_info&gt; method.</td></tr>
<tr><td class="h"><a name="4994"></a>4994</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="4995"></a>4995</td><td></td><td></td><td></td><td></td><td class="s">An 'index' hash is provided so you don't need to rely on index</td></tr>
<tr><td class="h"><a name="4996"></a>4996</td><td></td><td></td><td></td><td></td><td class="s">values defined above.  However, using DBD::ODBC with some old ODBC</td></tr>
<tr><td class="h"><a name="4997"></a>4997</td><td></td><td></td><td></td><td></td><td class="s">drivers may return older names, shown as comments in the example above.</td></tr>
<tr><td class="h"><a name="4998"></a>4998</td><td></td><td></td><td></td><td></td><td class="s">Another issue with the index hash is that the lettercase of the</td></tr>
<tr><td class="h"><a name="4999"></a>4999</td><td></td><td></td><td></td><td></td><td class="s">keys is not defined. It is usually uppercase, as show here, but</td></tr>
<tr><td class="h"><a name="5000"></a>5000</td><td></td><td></td><td></td><td></td><td class="s">drivers may return names with any lettercase.</td></tr>
<tr><td class="h"><a name="5001"></a>5001</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5002"></a>5002</td><td></td><td></td><td></td><td></td><td class="s">Drivers are also free to return extra driver-specific columns of</td></tr>
<tr><td class="h"><a name="5003"></a>5003</td><td></td><td></td><td></td><td></td><td class="s">information - though it's recommended that they start at column</td></tr>
<tr><td class="h"><a name="5004"></a>5004</td><td></td><td></td><td></td><td></td><td class="s">index 50 to leave room for expansion of the DBI/ODBC specification.</td></tr>
<tr><td class="h"><a name="5005"></a>5005</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5006"></a>5006</td><td></td><td></td><td></td><td></td><td class="s">The type_info_all() method is not normally used directly.</td></tr>
<tr><td class="h"><a name="5007"></a>5007</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/type_info&gt; method provides a more usable and useful interface</td></tr>
<tr><td class="h"><a name="5008"></a>5008</td><td></td><td></td><td></td><td></td><td class="s">to the data.</td></tr>
<tr><td class="h"><a name="5009"></a>5009</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5010"></a>5010</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;type_info&gt;</td></tr>
<tr><td class="h"><a name="5011"></a>5011</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5012"></a>5012</td><td></td><td></td><td></td><td></td><td class="s">  @type_info = $dbh-&gt;type_info($data_type);</td></tr>
<tr><td class="h"><a name="5013"></a>5013</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5014"></a>5014</td><td></td><td></td><td></td><td></td><td class="s">Returns a list of hash references holding information about one or more</td></tr>
<tr><td class="h"><a name="5015"></a>5015</td><td></td><td></td><td></td><td></td><td class="s">variants of $data_type. The list is ordered by C&lt;DATA_TYPE&gt; first and</td></tr>
<tr><td class="h"><a name="5016"></a>5016</td><td></td><td></td><td></td><td></td><td class="s">then by how closely each type maps to the corresponding ODBC SQL data</td></tr>
<tr><td class="h"><a name="5017"></a>5017</td><td></td><td></td><td></td><td></td><td class="s">type, closest first.  If called in a scalar context then only the first</td></tr>
<tr><td class="h"><a name="5018"></a>5018</td><td></td><td></td><td></td><td></td><td class="s">(best) element is returned.</td></tr>
<tr><td class="h"><a name="5019"></a>5019</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5020"></a>5020</td><td></td><td></td><td></td><td></td><td class="s">If $data_type is undefined or C&lt;SQL_ALL_TYPES&gt;, then the list will</td></tr>
<tr><td class="h"><a name="5021"></a>5021</td><td></td><td></td><td></td><td></td><td class="s">contain hashes for all data type variants supported by the database and driver.</td></tr>
<tr><td class="h"><a name="5022"></a>5022</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5023"></a>5023</td><td></td><td></td><td></td><td></td><td class="s">If $data_type is an array reference then C&lt;type_info&gt; returns the</td></tr>
<tr><td class="h"><a name="5024"></a>5024</td><td></td><td></td><td></td><td></td><td class="s">information for the I&lt;first&gt; type in the array that has any matches.</td></tr>
<tr><td class="h"><a name="5025"></a>5025</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5026"></a>5026</td><td></td><td></td><td></td><td></td><td class="s">The keys of the hash follow the same letter case conventions as the</td></tr>
<tr><td class="h"><a name="5027"></a>5027</td><td></td><td></td><td></td><td></td><td class="s">rest of the DBI (see L&lt;/Naming Conventions and Name Space&gt;). The</td></tr>
<tr><td class="h"><a name="5028"></a>5028</td><td></td><td></td><td></td><td></td><td class="s">following uppercase items should always exist, though may be undef:</td></tr>
<tr><td class="h"><a name="5029"></a>5029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5030"></a>5030</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="5031"></a>5031</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5032"></a>5032</td><td></td><td></td><td></td><td></td><td class="s">=item TYPE_NAME (string)</td></tr>
<tr><td class="h"><a name="5033"></a>5033</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5034"></a>5034</td><td></td><td></td><td></td><td></td><td class="s">Data type name for use in CREATE TABLE statements etc.</td></tr>
<tr><td class="h"><a name="5035"></a>5035</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5036"></a>5036</td><td></td><td></td><td></td><td></td><td class="s">=item DATA_TYPE (integer)</td></tr>
<tr><td class="h"><a name="5037"></a>5037</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5038"></a>5038</td><td></td><td></td><td></td><td></td><td class="s">SQL data type number.</td></tr>
<tr><td class="h"><a name="5039"></a>5039</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5040"></a>5040</td><td></td><td></td><td></td><td></td><td class="s">=item COLUMN_SIZE (integer)</td></tr>
<tr><td class="h"><a name="5041"></a>5041</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5042"></a>5042</td><td></td><td></td><td></td><td></td><td class="s">For numeric types, this is either the total number of digits (if the</td></tr>
<tr><td class="h"><a name="5043"></a>5043</td><td></td><td></td><td></td><td></td><td class="s">NUM_PREC_RADIX value is 10) or the total number of bits allowed in the</td></tr>
<tr><td class="h"><a name="5044"></a>5044</td><td></td><td></td><td></td><td></td><td class="s">column (if NUM_PREC_RADIX is 2).</td></tr>
<tr><td class="h"><a name="5045"></a>5045</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5046"></a>5046</td><td></td><td></td><td></td><td></td><td class="s">For string types, this is the maximum size of the string in characters.</td></tr>
<tr><td class="h"><a name="5047"></a>5047</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5048"></a>5048</td><td></td><td></td><td></td><td></td><td class="s">For date and interval types, this is the maximum number of characters</td></tr>
<tr><td class="h"><a name="5049"></a>5049</td><td></td><td></td><td></td><td></td><td class="s">needed to display the value.</td></tr>
<tr><td class="h"><a name="5050"></a>5050</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5051"></a>5051</td><td></td><td></td><td></td><td></td><td class="s">=item LITERAL_PREFIX (string)</td></tr>
<tr><td class="h"><a name="5052"></a>5052</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5053"></a>5053</td><td></td><td></td><td></td><td></td><td class="s">Characters used to prefix a literal. A typical prefix is &quot;C&lt;'&gt;&quot; for characters,</td></tr>
<tr><td class="h"><a name="5054"></a>5054</td><td></td><td></td><td></td><td></td><td class="s">or possibly &quot;C&lt;0x&gt;&quot; for binary values passed as hexadecimal.  NULL (C&lt;undef&gt;) is</td></tr>
<tr><td class="h"><a name="5055"></a>5055</td><td></td><td></td><td></td><td></td><td class="s">returned for data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5056"></a>5056</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5057"></a>5057</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5058"></a>5058</td><td></td><td></td><td></td><td></td><td class="s">=item LITERAL_SUFFIX (string)</td></tr>
<tr><td class="h"><a name="5059"></a>5059</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5060"></a>5060</td><td></td><td></td><td></td><td></td><td class="s">Characters used to suffix a literal. Typically &quot;C&lt;'&gt;&quot; for characters.</td></tr>
<tr><td class="h"><a name="5061"></a>5061</td><td></td><td></td><td></td><td></td><td class="s">NULL (C&lt;undef&gt;) is returned for data types where this is not applicable.</td></tr>
<tr><td class="h"><a name="5062"></a>5062</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5063"></a>5063</td><td></td><td></td><td></td><td></td><td class="s">=item CREATE_PARAMS (string)</td></tr>
<tr><td class="h"><a name="5064"></a>5064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5065"></a>5065</td><td></td><td></td><td></td><td></td><td class="s">Parameter names for data type definition. For example, C&lt;CREATE_PARAMS&gt; for a</td></tr>
<tr><td class="h"><a name="5066"></a>5066</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DECIMAL&gt; would be &quot;C&lt;precision,scale&gt;&quot; if the DECIMAL type should be</td></tr>
<tr><td class="h"><a name="5067"></a>5067</td><td></td><td></td><td></td><td></td><td class="s">declared as C&lt;DECIMAL(&gt;I&lt;precision,scale&gt;C&lt;)&gt; where I&lt;precision&gt; and I&lt;scale&gt;</td></tr>
<tr><td class="h"><a name="5068"></a>5068</td><td></td><td></td><td></td><td></td><td class="s">are integer values.  For a C&lt;VARCHAR&gt; it would be &quot;C&lt;max length&gt;&quot;.</td></tr>
<tr><td class="h"><a name="5069"></a>5069</td><td></td><td></td><td></td><td></td><td class="s">NULL (C&lt;undef&gt;) is returned for data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5070"></a>5070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5071"></a>5071</td><td></td><td></td><td></td><td></td><td class="s">=item NULLABLE (integer)</td></tr>
<tr><td class="h"><a name="5072"></a>5072</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5073"></a>5073</td><td></td><td></td><td></td><td></td><td class="s">Indicates whether the data type accepts a NULL value:</td></tr>
<tr><td class="h"><a name="5074"></a>5074</td><td></td><td></td><td></td><td></td><td class="s">C&lt;0&gt; or an empty string = no, C&lt;1&gt; = yes, C&lt;2&gt; = unknown.</td></tr>
<tr><td class="h"><a name="5075"></a>5075</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5076"></a>5076</td><td></td><td></td><td></td><td></td><td class="s">=item CASE_SENSITIVE (boolean)</td></tr>
<tr><td class="h"><a name="5077"></a>5077</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5078"></a>5078</td><td></td><td></td><td></td><td></td><td class="s">Indicates whether the data type is case sensitive in collations and</td></tr>
<tr><td class="h"><a name="5079"></a>5079</td><td></td><td></td><td></td><td></td><td class="s">comparisons.</td></tr>
<tr><td class="h"><a name="5080"></a>5080</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5081"></a>5081</td><td></td><td></td><td></td><td></td><td class="s">=item SEARCHABLE (integer)</td></tr>
<tr><td class="h"><a name="5082"></a>5082</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5083"></a>5083</td><td></td><td></td><td></td><td></td><td class="s">Indicates how the data type can be used in a WHERE clause, as</td></tr>
<tr><td class="h"><a name="5084"></a>5084</td><td></td><td></td><td></td><td></td><td class="s">follows:</td></tr>
<tr><td class="h"><a name="5085"></a>5085</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5086"></a>5086</td><td></td><td></td><td></td><td></td><td class="s">  0 - Cannot be used in a WHERE clause</td></tr>
<tr><td class="h"><a name="5087"></a>5087</td><td></td><td></td><td></td><td></td><td class="s">  1 - Only with a LIKE predicate</td></tr>
<tr><td class="h"><a name="5088"></a>5088</td><td></td><td></td><td></td><td></td><td class="s">  2 - All comparison operators except LIKE</td></tr>
<tr><td class="h"><a name="5089"></a>5089</td><td></td><td></td><td></td><td></td><td class="s">  3 - Can be used in a WHERE clause with any comparison operator</td></tr>
<tr><td class="h"><a name="5090"></a>5090</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5091"></a>5091</td><td></td><td></td><td></td><td></td><td class="s">=item UNSIGNED_ATTRIBUTE (boolean)</td></tr>
<tr><td class="h"><a name="5092"></a>5092</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5093"></a>5093</td><td></td><td></td><td></td><td></td><td class="s">Indicates whether the data type is unsigned.  NULL (C&lt;undef&gt;) is returned</td></tr>
<tr><td class="h"><a name="5094"></a>5094</td><td></td><td></td><td></td><td></td><td class="s">for data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5095"></a>5095</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5096"></a>5096</td><td></td><td></td><td></td><td></td><td class="s">=item FIXED_PREC_SCALE (boolean)</td></tr>
<tr><td class="h"><a name="5097"></a>5097</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5098"></a>5098</td><td></td><td></td><td></td><td></td><td class="s">Indicates whether the data type always has the same precision and scale</td></tr>
<tr><td class="h"><a name="5099"></a>5099</td><td></td><td></td><td></td><td></td><td class="s">(such as a money type).  NULL (C&lt;undef&gt;) is returned for data types</td></tr>
<tr><td class="h"><a name="5100"></a>5100</td><td></td><td></td><td></td><td></td><td class="s">for which</td></tr>
<tr><td class="h"><a name="5101"></a>5101</td><td></td><td></td><td></td><td></td><td class="s">this is not applicable.</td></tr>
<tr><td class="h"><a name="5102"></a>5102</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5103"></a>5103</td><td></td><td></td><td></td><td></td><td class="s">=item AUTO_UNIQUE_VALUE (boolean)</td></tr>
<tr><td class="h"><a name="5104"></a>5104</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5105"></a>5105</td><td></td><td></td><td></td><td></td><td class="s">Indicates whether a column of this data type is automatically set to a</td></tr>
<tr><td class="h"><a name="5106"></a>5106</td><td></td><td></td><td></td><td></td><td class="s">unique value whenever a new row is inserted.  NULL (C&lt;undef&gt;) is returned</td></tr>
<tr><td class="h"><a name="5107"></a>5107</td><td></td><td></td><td></td><td></td><td class="s">for data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5108"></a>5108</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5109"></a>5109</td><td></td><td></td><td></td><td></td><td class="s">=item LOCAL_TYPE_NAME (string)</td></tr>
<tr><td class="h"><a name="5110"></a>5110</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5111"></a>5111</td><td></td><td></td><td></td><td></td><td class="s">Localized version of the C&lt;TYPE_NAME&gt; for use in dialog with users.</td></tr>
<tr><td class="h"><a name="5112"></a>5112</td><td></td><td></td><td></td><td></td><td class="s">NULL (C&lt;undef&gt;) is returned if a localized name is not available (in which</td></tr>
<tr><td class="h"><a name="5113"></a>5113</td><td></td><td></td><td></td><td></td><td class="s">case C&lt;TYPE_NAME&gt; should be used).</td></tr>
<tr><td class="h"><a name="5114"></a>5114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5115"></a>5115</td><td></td><td></td><td></td><td></td><td class="s">=item MINIMUM_SCALE (integer)</td></tr>
<tr><td class="h"><a name="5116"></a>5116</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5117"></a>5117</td><td></td><td></td><td></td><td></td><td class="s">The minimum scale of the data type. If a data type has a fixed scale,</td></tr>
<tr><td class="h"><a name="5118"></a>5118</td><td></td><td></td><td></td><td></td><td class="s">then C&lt;MAXIMUM_SCALE&gt; holds the same value.  NULL (C&lt;undef&gt;) is returned for</td></tr>
<tr><td class="h"><a name="5119"></a>5119</td><td></td><td></td><td></td><td></td><td class="s">data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5120"></a>5120</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5121"></a>5121</td><td></td><td></td><td></td><td></td><td class="s">=item MAXIMUM_SCALE (integer)</td></tr>
<tr><td class="h"><a name="5122"></a>5122</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5123"></a>5123</td><td></td><td></td><td></td><td></td><td class="s">The maximum scale of the data type. If a data type has a fixed scale,</td></tr>
<tr><td class="h"><a name="5124"></a>5124</td><td></td><td></td><td></td><td></td><td class="s">then C&lt;MINIMUM_SCALE&gt; holds the same value.  NULL (C&lt;undef&gt;) is returned for</td></tr>
<tr><td class="h"><a name="5125"></a>5125</td><td></td><td></td><td></td><td></td><td class="s">data types for which this is not applicable.</td></tr>
<tr><td class="h"><a name="5126"></a>5126</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5127"></a>5127</td><td></td><td></td><td></td><td></td><td class="s">=item SQL_DATA_TYPE (integer)</td></tr>
<tr><td class="h"><a name="5128"></a>5128</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5129"></a>5129</td><td></td><td></td><td></td><td></td><td class="s">This column is the same as the C&lt;DATA_TYPE&gt; column, except for interval</td></tr>
<tr><td class="h"><a name="5130"></a>5130</td><td></td><td></td><td></td><td></td><td class="s">and datetime data types.  For interval and datetime data types, the</td></tr>
<tr><td class="h"><a name="5131"></a>5131</td><td></td><td></td><td></td><td></td><td class="s">C&lt;SQL_DATA_TYPE&gt; field will return C&lt;SQL_INTERVAL&gt; or C&lt;SQL_DATETIME&gt;, and the</td></tr>
<tr><td class="h"><a name="5132"></a>5132</td><td></td><td></td><td></td><td></td><td class="s">C&lt;SQL_DATETIME_SUB&gt; field below will return the subcode for the specific</td></tr>
<tr><td class="h"><a name="5133"></a>5133</td><td></td><td></td><td></td><td></td><td class="s">interval or datetime data type. If this field is NULL, then the driver</td></tr>
<tr><td class="h"><a name="5134"></a>5134</td><td></td><td></td><td></td><td></td><td class="s">does not support or report on interval or datetime subtypes.</td></tr>
<tr><td class="h"><a name="5135"></a>5135</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5136"></a>5136</td><td></td><td></td><td></td><td></td><td class="s">=item SQL_DATETIME_SUB (integer)</td></tr>
<tr><td class="h"><a name="5137"></a>5137</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5138"></a>5138</td><td></td><td></td><td></td><td></td><td class="s">For interval or datetime data types, where the C&lt;SQL_DATA_TYPE&gt;</td></tr>
<tr><td class="h"><a name="5139"></a>5139</td><td></td><td></td><td></td><td></td><td class="s">field above is C&lt;SQL_INTERVAL&gt; or C&lt;SQL_DATETIME&gt;, this field will</td></tr>
<tr><td class="h"><a name="5140"></a>5140</td><td></td><td></td><td></td><td></td><td class="s">hold the I&lt;subcode&gt; for the specific interval or datetime data type.</td></tr>
<tr><td class="h"><a name="5141"></a>5141</td><td></td><td></td><td></td><td></td><td class="s">Otherwise it will be NULL (C&lt;undef&gt;).</td></tr>
<tr><td class="h"><a name="5142"></a>5142</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5143"></a>5143</td><td></td><td></td><td></td><td></td><td class="s">Although not mentioned explicitly in the standards, it seems there</td></tr>
<tr><td class="h"><a name="5144"></a>5144</td><td></td><td></td><td></td><td></td><td class="s">is a simple relationship between these values:</td></tr>
<tr><td class="h"><a name="5145"></a>5145</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5146"></a>5146</td><td></td><td></td><td></td><td></td><td class="s">  DATA_TYPE == (10 * SQL_DATA_TYPE) + SQL_DATETIME_SUB</td></tr>
<tr><td class="h"><a name="5147"></a>5147</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5148"></a>5148</td><td></td><td></td><td></td><td></td><td class="s">=item NUM_PREC_RADIX (integer)</td></tr>
<tr><td class="h"><a name="5149"></a>5149</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5150"></a>5150</td><td></td><td></td><td></td><td></td><td class="s">The radix value of the data type. For approximate numeric types,</td></tr>
<tr><td class="h"><a name="5151"></a>5151</td><td></td><td></td><td></td><td></td><td class="s">C&lt;NUM_PREC_RADIX&gt;</td></tr>
<tr><td class="h"><a name="5152"></a>5152</td><td></td><td></td><td></td><td></td><td class="s">contains the value 2 and C&lt;COLUMN_SIZE&gt; holds the number of bits. For</td></tr>
<tr><td class="h"><a name="5153"></a>5153</td><td></td><td></td><td></td><td></td><td class="s">exact numeric types, C&lt;NUM_PREC_RADIX&gt; contains the value 10 and C&lt;COLUMN_SIZE&gt; holds</td></tr>
<tr><td class="h"><a name="5154"></a>5154</td><td></td><td></td><td></td><td></td><td class="s">the number of decimal digits. NULL (C&lt;undef&gt;) is returned either for data types</td></tr>
<tr><td class="h"><a name="5155"></a>5155</td><td></td><td></td><td></td><td></td><td class="s">for which this is not applicable or if the driver cannot report this information.</td></tr>
<tr><td class="h"><a name="5156"></a>5156</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5157"></a>5157</td><td></td><td></td><td></td><td></td><td class="s">=item INTERVAL_PRECISION (integer)</td></tr>
<tr><td class="h"><a name="5158"></a>5158</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5159"></a>5159</td><td></td><td></td><td></td><td></td><td class="s">The interval leading precision for interval types. NULL is returned</td></tr>
<tr><td class="h"><a name="5160"></a>5160</td><td></td><td></td><td></td><td></td><td class="s">either for data types for which this is not applicable or if the driver</td></tr>
<tr><td class="h"><a name="5161"></a>5161</td><td></td><td></td><td></td><td></td><td class="s">cannot report this information.</td></tr>
<tr><td class="h"><a name="5162"></a>5162</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5163"></a>5163</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="5164"></a>5164</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5165"></a>5165</td><td></td><td></td><td></td><td></td><td class="s">For example, to find the type name for the fields in a select statement</td></tr>
<tr><td class="h"><a name="5166"></a>5166</td><td></td><td></td><td></td><td></td><td class="s">you can do:</td></tr>
<tr><td class="h"><a name="5167"></a>5167</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5168"></a>5168</td><td></td><td></td><td></td><td></td><td class="s">  @names = map { scalar $dbh-&gt;type_info($_)-&gt;{TYPE_NAME} } @{ $sth-&gt;{TYPE} }</td></tr>
<tr><td class="h"><a name="5169"></a>5169</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5170"></a>5170</td><td></td><td></td><td></td><td></td><td class="s">Since DBI and ODBC drivers vary in how they map their types into the</td></tr>
<tr><td class="h"><a name="5171"></a>5171</td><td></td><td></td><td></td><td></td><td class="s">ISO standard types you may need to search for more than one type.</td></tr>
<tr><td class="h"><a name="5172"></a>5172</td><td></td><td></td><td></td><td></td><td class="s">Here's an example looking for a usable type to store a date:</td></tr>
<tr><td class="h"><a name="5173"></a>5173</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5174"></a>5174</td><td></td><td></td><td></td><td></td><td class="s">  $my_date_type = $dbh-&gt;type_info( [ SQL_DATE, SQL_TIMESTAMP ] );</td></tr>
<tr><td class="h"><a name="5175"></a>5175</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5176"></a>5176</td><td></td><td></td><td></td><td></td><td class="s">Similarly, to more reliably find a type to store small integers, you could</td></tr>
<tr><td class="h"><a name="5177"></a>5177</td><td></td><td></td><td></td><td></td><td class="s">use a list starting with C&lt;SQL_SMALLINT&gt;, C&lt;SQL_INTEGER&gt;, C&lt;SQL_DECIMAL&gt;, etc.</td></tr>
<tr><td class="h"><a name="5178"></a>5178</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5179"></a>5179</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Standards Reference Information&quot;&gt;.</td></tr>
<tr><td class="h"><a name="5180"></a>5180</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5181"></a>5181</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5182"></a>5182</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;quote&gt;</td></tr>
<tr><td class="h"><a name="5183"></a>5183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5184"></a>5184</td><td></td><td></td><td></td><td></td><td class="s">  $sql = $dbh-&gt;quote($value);</td></tr>
<tr><td class="h"><a name="5185"></a>5185</td><td></td><td></td><td></td><td></td><td class="s">  $sql = $dbh-&gt;quote($value, $data_type);</td></tr>
<tr><td class="h"><a name="5186"></a>5186</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5187"></a>5187</td><td></td><td></td><td></td><td></td><td class="s">Quote a string literal for use as a literal value in an SQL statement,</td></tr>
<tr><td class="h"><a name="5188"></a>5188</td><td></td><td></td><td></td><td></td><td class="s">by escaping any special characters (such as quotation marks)</td></tr>
<tr><td class="h"><a name="5189"></a>5189</td><td></td><td></td><td></td><td></td><td class="s">contained within the string and adding the required type of outer</td></tr>
<tr><td class="h"><a name="5190"></a>5190</td><td></td><td></td><td></td><td></td><td class="s">quotation marks.</td></tr>
<tr><td class="h"><a name="5191"></a>5191</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5192"></a>5192</td><td></td><td></td><td></td><td></td><td class="s">  $sql = sprintf &quot;SELECT foo FROM bar WHERE baz = %s&quot;,</td></tr>
<tr><td class="h"><a name="5193"></a>5193</td><td></td><td></td><td></td><td></td><td class="s">                $dbh-&gt;quote(&quot;Don't&quot;);</td></tr>
<tr><td class="h"><a name="5194"></a>5194</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5195"></a>5195</td><td></td><td></td><td></td><td></td><td class="s">For most database types, at least those that conform to SQL standards, quote</td></tr>
<tr><td class="h"><a name="5196"></a>5196</td><td></td><td></td><td></td><td></td><td class="s">would return C&lt;'Don''t'&gt; (including the outer quotation marks). For others it</td></tr>
<tr><td class="h"><a name="5197"></a>5197</td><td></td><td></td><td></td><td></td><td class="s">may return something like C&lt;'Don\'t'&gt;</td></tr>
<tr><td class="h"><a name="5198"></a>5198</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5199"></a>5199</td><td></td><td></td><td></td><td></td><td class="s">An undefined C&lt;$value&gt; value will be returned as the string C&lt;NULL&gt; (without</td></tr>
<tr><td class="h"><a name="5200"></a>5200</td><td></td><td></td><td></td><td></td><td class="s">single quotation marks) to match how NULLs are represented in SQL.</td></tr>
<tr><td class="h"><a name="5201"></a>5201</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5202"></a>5202</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;$data_type&gt; is supplied, it is used to try to determine the required</td></tr>
<tr><td class="h"><a name="5203"></a>5203</td><td></td><td></td><td></td><td></td><td class="s">quoting behaviour by using the information returned by L&lt;/type_info&gt;.</td></tr>
<tr><td class="h"><a name="5204"></a>5204</td><td></td><td></td><td></td><td></td><td class="s">As a special case, the standard numeric types are optimized to return</td></tr>
<tr><td class="h"><a name="5205"></a>5205</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$value&gt; without calling C&lt;type_info&gt;.</td></tr>
<tr><td class="h"><a name="5206"></a>5206</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5207"></a>5207</td><td></td><td></td><td></td><td></td><td class="s">Quote will probably I&lt;not&gt; be able to deal with all possible input</td></tr>
<tr><td class="h"><a name="5208"></a>5208</td><td></td><td></td><td></td><td></td><td class="s">(such as binary data or data containing newlines), and is not related in</td></tr>
<tr><td class="h"><a name="5209"></a>5209</td><td></td><td></td><td></td><td></td><td class="s">any way with escaping or quoting shell meta-characters.</td></tr>
<tr><td class="h"><a name="5210"></a>5210</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5211"></a>5211</td><td></td><td></td><td></td><td></td><td class="s">It is valid for the quote() method to return an SQL expression that</td></tr>
<tr><td class="h"><a name="5212"></a>5212</td><td></td><td></td><td></td><td></td><td class="s">evaluates to the desired string. For example:</td></tr>
<tr><td class="h"><a name="5213"></a>5213</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5214"></a>5214</td><td></td><td></td><td></td><td></td><td class="s">  $quoted = $dbh-&gt;quote(&quot;one\ntwo\0three&quot;)</td></tr>
<tr><td class="h"><a name="5215"></a>5215</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5216"></a>5216</td><td></td><td></td><td></td><td></td><td class="s">may return something like:</td></tr>
<tr><td class="h"><a name="5217"></a>5217</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5218"></a>5218</td><td></td><td></td><td></td><td></td><td class="s">  CONCAT('one', CHAR(12), 'two', CHAR(0), 'three')</td></tr>
<tr><td class="h"><a name="5219"></a>5219</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5220"></a>5220</td><td></td><td></td><td></td><td></td><td class="s">The quote() method should I&lt;not&gt; be used with L&lt;/&quot;Placeholders and</td></tr>
<tr><td class="h"><a name="5221"></a>5221</td><td></td><td></td><td></td><td></td><td class="s">Bind Values&quot;&gt;.</td></tr>
<tr><td class="h"><a name="5222"></a>5222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5223"></a>5223</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;quote_identifier&gt;</td></tr>
<tr><td class="h"><a name="5224"></a>5224</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5225"></a>5225</td><td></td><td></td><td></td><td></td><td class="s">  $sql = $dbh-&gt;quote_identifier( $name );</td></tr>
<tr><td class="h"><a name="5226"></a>5226</td><td></td><td></td><td></td><td></td><td class="s">  $sql = $dbh-&gt;quote_identifier( $catalog, $schema, $table, \%attr );</td></tr>
<tr><td class="h"><a name="5227"></a>5227</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5228"></a>5228</td><td></td><td></td><td></td><td></td><td class="s">Quote an identifier (table name etc.) for use in an SQL statement,</td></tr>
<tr><td class="h"><a name="5229"></a>5229</td><td></td><td></td><td></td><td></td><td class="s">by escaping any special characters (such as double quotation marks)</td></tr>
<tr><td class="h"><a name="5230"></a>5230</td><td></td><td></td><td></td><td></td><td class="s">it contains and adding the required type of outer quotation marks.</td></tr>
<tr><td class="h"><a name="5231"></a>5231</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5232"></a>5232</td><td></td><td></td><td></td><td></td><td class="s">Undefined names are ignored and the remainder are quoted and then</td></tr>
<tr><td class="h"><a name="5233"></a>5233</td><td></td><td></td><td></td><td></td><td class="s">joined together, typically with a dot (C&lt;.&gt;) character. For example:</td></tr>
<tr><td class="h"><a name="5234"></a>5234</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5235"></a>5235</td><td></td><td></td><td></td><td></td><td class="s">  $id = $dbh-&gt;quote_identifier( undef, 'Her schema', 'My table' );</td></tr>
<tr><td class="h"><a name="5236"></a>5236</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5237"></a>5237</td><td></td><td></td><td></td><td></td><td class="s">would, for most database types, return C&lt;&quot;Her schema&quot;.&quot;My table&quot;&gt;</td></tr>
<tr><td class="h"><a name="5238"></a>5238</td><td></td><td></td><td></td><td></td><td class="s">(including all the double quotation marks).</td></tr>
<tr><td class="h"><a name="5239"></a>5239</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5240"></a>5240</td><td></td><td></td><td></td><td></td><td class="s">If three names are supplied then the first is assumed to be a</td></tr>
<tr><td class="h"><a name="5241"></a>5241</td><td></td><td></td><td></td><td></td><td class="s">catalog name and special rules may be applied based on what L&lt;/get_info&gt;</td></tr>
<tr><td class="h"><a name="5242"></a>5242</td><td></td><td></td><td></td><td></td><td class="s">returns for SQL_CATALOG_NAME_SEPARATOR (41) and SQL_CATALOG_LOCATION (114).</td></tr>
<tr><td class="h"><a name="5243"></a>5243</td><td></td><td></td><td></td><td></td><td class="s">For example, for Oracle:</td></tr>
<tr><td class="h"><a name="5244"></a>5244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5245"></a>5245</td><td></td><td></td><td></td><td></td><td class="s">  $id = $dbh-&gt;quote_identifier( 'link', 'schema', 'table' );</td></tr>
<tr><td class="h"><a name="5246"></a>5246</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5247"></a>5247</td><td></td><td></td><td></td><td></td><td class="s">would return C&lt;&quot;schema&quot;.&quot;table&quot;@&quot;link&quot;&gt;.</td></tr>
<tr><td class="h"><a name="5248"></a>5248</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5249"></a>5249</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;take_imp_data&gt;</td></tr>
<tr><td class="h"><a name="5250"></a>5250</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5251"></a>5251</td><td></td><td></td><td></td><td></td><td class="s">  $imp_data = $dbh-&gt;take_imp_data;</td></tr>
<tr><td class="h"><a name="5252"></a>5252</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5253"></a>5253</td><td></td><td></td><td></td><td></td><td class="s">Leaves the $dbh in an almost dead, zombie-like, state and returns</td></tr>
<tr><td class="h"><a name="5254"></a>5254</td><td></td><td></td><td></td><td></td><td class="s">a binary string of raw implementation data from the driver which</td></tr>
<tr><td class="h"><a name="5255"></a>5255</td><td></td><td></td><td></td><td></td><td class="s">describes the current database connection. Effectively it detaches</td></tr>
<tr><td class="h"><a name="5256"></a>5256</td><td></td><td></td><td></td><td></td><td class="s">the underlying database API connection data from the DBI handle.</td></tr>
<tr><td class="h"><a name="5257"></a>5257</td><td></td><td></td><td></td><td></td><td class="s">After calling take_imp_data(), all other methods except C&lt;DESTROY&gt;</td></tr>
<tr><td class="h"><a name="5258"></a>5258</td><td></td><td></td><td></td><td></td><td class="s">will generate a warning and return undef.</td></tr>
<tr><td class="h"><a name="5259"></a>5259</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5260"></a>5260</td><td></td><td></td><td></td><td></td><td class="s">Why would you want to do this? You don't, forget I even mentioned it.</td></tr>
<tr><td class="h"><a name="5261"></a>5261</td><td></td><td></td><td></td><td></td><td class="s">Unless, that is, you're implementing something advanced like a</td></tr>
<tr><td class="h"><a name="5262"></a>5262</td><td></td><td></td><td></td><td></td><td class="s">multi-threaded connection pool. See L&lt;DBI::Pool&gt;.</td></tr>
<tr><td class="h"><a name="5263"></a>5263</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5264"></a>5264</td><td></td><td></td><td></td><td></td><td class="s">The returned $imp_data can be passed as a C&lt;dbi_imp_data&gt; attribute</td></tr>
<tr><td class="h"><a name="5265"></a>5265</td><td></td><td></td><td></td><td></td><td class="s">to a later connect() call, even in a separate thread in the same</td></tr>
<tr><td class="h"><a name="5266"></a>5266</td><td></td><td></td><td></td><td></td><td class="s">process, where the driver can use it to 'adopt' the existing</td></tr>
<tr><td class="h"><a name="5267"></a>5267</td><td></td><td></td><td></td><td></td><td class="s">connection that the implementation data was taken from.</td></tr>
<tr><td class="h"><a name="5268"></a>5268</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5269"></a>5269</td><td></td><td></td><td></td><td></td><td class="s">Some things to keep in mind...</td></tr>
<tr><td class="h"><a name="5270"></a>5270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5271"></a>5271</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; the $imp_data holds the only reference to the underlying</td></tr>
<tr><td class="h"><a name="5272"></a>5272</td><td></td><td></td><td></td><td></td><td class="s">database API connection data. That connection is still 'live' and</td></tr>
<tr><td class="h"><a name="5273"></a>5273</td><td></td><td></td><td></td><td></td><td class="s">won't be cleaned up properly unless the $imp_data is used to create</td></tr>
<tr><td class="h"><a name="5274"></a>5274</td><td></td><td></td><td></td><td></td><td class="s">a new $dbh which is then allowed to disconnect() normally.</td></tr>
<tr><td class="h"><a name="5275"></a>5275</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5276"></a>5276</td><td></td><td></td><td></td><td></td><td class="s">B&lt;*&gt; using the same $imp_data to create more than one other new</td></tr>
<tr><td class="h"><a name="5277"></a>5277</td><td></td><td></td><td></td><td></td><td class="s">$dbh at a time may well lead to unpleasant problems. Don't do that.</td></tr>
<tr><td class="h"><a name="5278"></a>5278</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5279"></a>5279</td><td></td><td></td><td></td><td></td><td class="s">Any child statement handles are effectively destroyed when take_imp_data() is</td></tr>
<tr><td class="h"><a name="5280"></a>5280</td><td></td><td></td><td></td><td></td><td class="s">called.</td></tr>
<tr><td class="h"><a name="5281"></a>5281</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5282"></a>5282</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;take_imp_data&gt; method was added in DBI 1.36 but wasn't useful till 1.49.</td></tr>
<tr><td class="h"><a name="5283"></a>5283</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5284"></a>5284</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5285"></a>5285</td><td></td><td></td><td></td><td></td><td class="s">=head2 Database Handle Attributes</td></tr>
<tr><td class="h"><a name="5286"></a>5286</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5287"></a>5287</td><td></td><td></td><td></td><td></td><td class="s">This section describes attributes specific to database handles.</td></tr>
<tr><td class="h"><a name="5288"></a>5288</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5289"></a>5289</td><td></td><td></td><td></td><td></td><td class="s">Changes to these database handle attributes do not affect any other</td></tr>
<tr><td class="h"><a name="5290"></a>5290</td><td></td><td></td><td></td><td></td><td class="s">existing or future database handles.</td></tr>
<tr><td class="h"><a name="5291"></a>5291</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5292"></a>5292</td><td></td><td></td><td></td><td></td><td class="s">Attempting to set or get the value of an unknown attribute generates a warning,</td></tr>
<tr><td class="h"><a name="5293"></a>5293</td><td></td><td></td><td></td><td></td><td class="s">except for private driver-specific attributes (which all have names</td></tr>
<tr><td class="h"><a name="5294"></a>5294</td><td></td><td></td><td></td><td></td><td class="s">starting with a lowercase letter).</td></tr>
<tr><td class="h"><a name="5295"></a>5295</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5296"></a>5296</td><td></td><td></td><td></td><td></td><td class="s">Example:</td></tr>
<tr><td class="h"><a name="5297"></a>5297</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5298"></a>5298</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;{AutoCommit} = ...;        # set/write</td></tr>
<tr><td class="h"><a name="5299"></a>5299</td><td></td><td></td><td></td><td></td><td class="s">  ... = $h-&gt;{AutoCommit};        # get/read</td></tr>
<tr><td class="h"><a name="5300"></a>5300</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5301"></a>5301</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;AutoCommit&gt;  (boolean)</td></tr>
<tr><td class="h"><a name="5302"></a>5302</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5303"></a>5303</td><td></td><td></td><td></td><td></td><td class="s">If true, then database changes cannot be rolled-back (undone).  If false,</td></tr>
<tr><td class="h"><a name="5304"></a>5304</td><td></td><td></td><td></td><td></td><td class="s">then database changes automatically occur within a &quot;transaction&quot;, which</td></tr>
<tr><td class="h"><a name="5305"></a>5305</td><td></td><td></td><td></td><td></td><td class="s">must either be committed or rolled back using the C&lt;commit&gt; or C&lt;rollback&gt;</td></tr>
<tr><td class="h"><a name="5306"></a>5306</td><td></td><td></td><td></td><td></td><td class="s">methods.</td></tr>
<tr><td class="h"><a name="5307"></a>5307</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5308"></a>5308</td><td></td><td></td><td></td><td></td><td class="s">Drivers should always default to C&lt;AutoCommit&gt; mode (an unfortunate</td></tr>
<tr><td class="h"><a name="5309"></a>5309</td><td></td><td></td><td></td><td></td><td class="s">choice largely forced on the DBI by ODBC and JDBC conventions.)</td></tr>
<tr><td class="h"><a name="5310"></a>5310</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5311"></a>5311</td><td></td><td></td><td></td><td></td><td class="s">Attempting to set C&lt;AutoCommit&gt; to an unsupported value is a fatal error.</td></tr>
<tr><td class="h"><a name="5312"></a>5312</td><td></td><td></td><td></td><td></td><td class="s">This is an important feature of the DBI. Applications that need</td></tr>
<tr><td class="h"><a name="5313"></a>5313</td><td></td><td></td><td></td><td></td><td class="s">full transaction behaviour can set C&lt;$dbh-E&lt;gt&gt;{AutoCommit} = 0&gt; (or</td></tr>
<tr><td class="h"><a name="5314"></a>5314</td><td></td><td></td><td></td><td></td><td class="s">set C&lt;AutoCommit&gt; to 0 via L&lt;/connect&gt;)</td></tr>
<tr><td class="h"><a name="5315"></a>5315</td><td></td><td></td><td></td><td></td><td class="s">without having to check that the value was assigned successfully.</td></tr>
<tr><td class="h"><a name="5316"></a>5316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5317"></a>5317</td><td></td><td></td><td></td><td></td><td class="s">For the purposes of this description, we can divide databases into three</td></tr>
<tr><td class="h"><a name="5318"></a>5318</td><td></td><td></td><td></td><td></td><td class="s">categories:</td></tr>
<tr><td class="h"><a name="5319"></a>5319</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5320"></a>5320</td><td></td><td></td><td></td><td></td><td class="s">  Databases which don't support transactions at all.</td></tr>
<tr><td class="h"><a name="5321"></a>5321</td><td></td><td></td><td></td><td></td><td class="s">  Databases in which a transaction is always active.</td></tr>
<tr><td class="h"><a name="5322"></a>5322</td><td></td><td></td><td></td><td></td><td class="s">  Databases in which a transaction must be explicitly started (C&lt;'BEGIN WORK'&gt;).</td></tr>
<tr><td class="h"><a name="5323"></a>5323</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5324"></a>5324</td><td></td><td></td><td></td><td></td><td class="s">B&lt;* Databases which don't support transactions at all&gt;</td></tr>
<tr><td class="h"><a name="5325"></a>5325</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5326"></a>5326</td><td></td><td></td><td></td><td></td><td class="s">For these databases, attempting to turn C&lt;AutoCommit&gt; off is a fatal error.</td></tr>
<tr><td class="h"><a name="5327"></a>5327</td><td></td><td></td><td></td><td></td><td class="s">C&lt;commit&gt; and C&lt;rollback&gt; both issue warnings about being ineffective while</td></tr>
<tr><td class="h"><a name="5328"></a>5328</td><td></td><td></td><td></td><td></td><td class="s">C&lt;AutoCommit&gt; is in effect.</td></tr>
<tr><td class="h"><a name="5329"></a>5329</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5330"></a>5330</td><td></td><td></td><td></td><td></td><td class="s">B&lt;* Databases in which a transaction is always active&gt;</td></tr>
<tr><td class="h"><a name="5331"></a>5331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5332"></a>5332</td><td></td><td></td><td></td><td></td><td class="s">These are typically mainstream commercial relational databases with</td></tr>
<tr><td class="h"><a name="5333"></a>5333</td><td></td><td></td><td></td><td></td><td class="s">&quot;ANSI standard&quot; transaction behaviour.</td></tr>
<tr><td class="h"><a name="5334"></a>5334</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;AutoCommit&gt; is off, then changes to the database won't have any</td></tr>
<tr><td class="h"><a name="5335"></a>5335</td><td></td><td></td><td></td><td></td><td class="s">lasting effect unless L&lt;/commit&gt; is called (but see also</td></tr>
<tr><td class="h"><a name="5336"></a>5336</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/disconnect&gt;). If L&lt;/rollback&gt; is called then any changes since the</td></tr>
<tr><td class="h"><a name="5337"></a>5337</td><td></td><td></td><td></td><td></td><td class="s">last commit are undone.</td></tr>
<tr><td class="h"><a name="5338"></a>5338</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5339"></a>5339</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;AutoCommit&gt; is on, then the effect is the same as if the DBI</td></tr>
<tr><td class="h"><a name="5340"></a>5340</td><td></td><td></td><td></td><td></td><td class="s">called C&lt;commit&gt; automatically after every successful database</td></tr>
<tr><td class="h"><a name="5341"></a>5341</td><td></td><td></td><td></td><td></td><td class="s">operation. So calling C&lt;commit&gt; or C&lt;rollback&gt; explicitly while</td></tr>
<tr><td class="h"><a name="5342"></a>5342</td><td></td><td></td><td></td><td></td><td class="s">C&lt;AutoCommit&gt; is on would be ineffective because the changes would</td></tr>
<tr><td class="h"><a name="5343"></a>5343</td><td></td><td></td><td></td><td></td><td class="s">have already been commited.</td></tr>
<tr><td class="h"><a name="5344"></a>5344</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5345"></a>5345</td><td></td><td></td><td></td><td></td><td class="s">Changing C&lt;AutoCommit&gt; from off to on will trigger a L&lt;/commit&gt;.</td></tr>
<tr><td class="h"><a name="5346"></a>5346</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5347"></a>5347</td><td></td><td></td><td></td><td></td><td class="s">For databases which don't support a specific auto-commit mode, the</td></tr>
<tr><td class="h"><a name="5348"></a>5348</td><td></td><td></td><td></td><td></td><td class="s">driver has to commit each statement automatically using an explicit</td></tr>
<tr><td class="h"><a name="5349"></a>5349</td><td></td><td></td><td></td><td></td><td class="s">C&lt;COMMIT&gt; after it completes successfully (and roll it back using an</td></tr>
<tr><td class="h"><a name="5350"></a>5350</td><td></td><td></td><td></td><td></td><td class="s">explicit C&lt;ROLLBACK&gt; if it fails).  The error information reported to the</td></tr>
<tr><td class="h"><a name="5351"></a>5351</td><td></td><td></td><td></td><td></td><td class="s">application will correspond to the statement which was executed, unless</td></tr>
<tr><td class="h"><a name="5352"></a>5352</td><td></td><td></td><td></td><td></td><td class="s">it succeeded and the commit or rollback failed.</td></tr>
<tr><td class="h"><a name="5353"></a>5353</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5354"></a>5354</td><td></td><td></td><td></td><td></td><td class="s">B&lt;* Databases in which a transaction must be explicitly started&gt;</td></tr>
<tr><td class="h"><a name="5355"></a>5355</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5356"></a>5356</td><td></td><td></td><td></td><td></td><td class="s">For these databases, the intention is to have them act like databases in</td></tr>
<tr><td class="h"><a name="5357"></a>5357</td><td></td><td></td><td></td><td></td><td class="s">which a transaction is always active (as described above).</td></tr>
<tr><td class="h"><a name="5358"></a>5358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5359"></a>5359</td><td></td><td></td><td></td><td></td><td class="s">To do this, the driver will automatically begin an explicit transaction</td></tr>
<tr><td class="h"><a name="5360"></a>5360</td><td></td><td></td><td></td><td></td><td class="s">when C&lt;AutoCommit&gt; is turned off, or after a L&lt;/commit&gt; or</td></tr>
<tr><td class="h"><a name="5361"></a>5361</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/rollback&gt; (or when the application issues the next database</td></tr>
<tr><td class="h"><a name="5362"></a>5362</td><td></td><td></td><td></td><td></td><td class="s">operation after one of those events).</td></tr>
<tr><td class="h"><a name="5363"></a>5363</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5364"></a>5364</td><td></td><td></td><td></td><td></td><td class="s">In this way, the application does not have to treat these databases</td></tr>
<tr><td class="h"><a name="5365"></a>5365</td><td></td><td></td><td></td><td></td><td class="s">as a special case.</td></tr>
<tr><td class="h"><a name="5366"></a>5366</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5367"></a>5367</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/commit&gt;, L&lt;/disconnect&gt; and L&lt;/Transactions&gt; for other important</td></tr>
<tr><td class="h"><a name="5368"></a>5368</td><td></td><td></td><td></td><td></td><td class="s">notes about transactions.</td></tr>
<tr><td class="h"><a name="5369"></a>5369</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5370"></a>5370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5371"></a>5371</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Driver&gt;  (handle)</td></tr>
<tr><td class="h"><a name="5372"></a>5372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5373"></a>5373</td><td></td><td></td><td></td><td></td><td class="s">Holds the handle of the parent driver. The only recommended use for this</td></tr>
<tr><td class="h"><a name="5374"></a>5374</td><td></td><td></td><td></td><td></td><td class="s">is to find the name of the driver using:</td></tr>
<tr><td class="h"><a name="5375"></a>5375</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5376"></a>5376</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{Driver}-&gt;{Name}</td></tr>
<tr><td class="h"><a name="5377"></a>5377</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5378"></a>5378</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5379"></a>5379</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Name&gt;  (string)</td></tr>
<tr><td class="h"><a name="5380"></a>5380</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5381"></a>5381</td><td></td><td></td><td></td><td></td><td class="s">Holds the &quot;name&quot; of the database. Usually (and recommended to be) the</td></tr>
<tr><td class="h"><a name="5382"></a>5382</td><td></td><td></td><td></td><td></td><td class="s">same as the &quot;C&lt;dbi:DriverName:...&gt;&quot; string used to connect to the database,</td></tr>
<tr><td class="h"><a name="5383"></a>5383</td><td></td><td></td><td></td><td></td><td class="s">but with the leading &quot;C&lt;dbi:DriverName:&gt;&quot; removed.</td></tr>
<tr><td class="h"><a name="5384"></a>5384</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5385"></a>5385</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5386"></a>5386</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Statement&gt;  (string, read-only)</td></tr>
<tr><td class="h"><a name="5387"></a>5387</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5388"></a>5388</td><td></td><td></td><td></td><td></td><td class="s">Returns the statement string passed to the most recent L&lt;/prepare&gt; method</td></tr>
<tr><td class="h"><a name="5389"></a>5389</td><td></td><td></td><td></td><td></td><td class="s">called in this database handle, even if that method failed. This is especially</td></tr>
<tr><td class="h"><a name="5390"></a>5390</td><td></td><td></td><td></td><td></td><td class="s">useful where C&lt;RaiseError&gt; is enabled and the exception handler checks $@</td></tr>
<tr><td class="h"><a name="5391"></a>5391</td><td></td><td></td><td></td><td></td><td class="s">and sees that a 'prepare' method call failed.</td></tr>
<tr><td class="h"><a name="5392"></a>5392</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5393"></a>5393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5394"></a>5394</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;RowCacheSize&gt;  (integer)</td></tr>
<tr><td class="h"><a name="5395"></a>5395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5396"></a>5396</td><td></td><td></td><td></td><td></td><td class="s">A hint to the driver indicating the size of the local row cache that the</td></tr>
<tr><td class="h"><a name="5397"></a>5397</td><td></td><td></td><td></td><td></td><td class="s">application would like the driver to use for future C&lt;SELECT&gt; statements.</td></tr>
<tr><td class="h"><a name="5398"></a>5398</td><td></td><td></td><td></td><td></td><td class="s">If a row cache is not implemented, then setting C&lt;RowCacheSize&gt; is ignored</td></tr>
<tr><td class="h"><a name="5399"></a>5399</td><td></td><td></td><td></td><td></td><td class="s">and getting the value returns C&lt;undef&gt;.</td></tr>
<tr><td class="h"><a name="5400"></a>5400</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5401"></a>5401</td><td></td><td></td><td></td><td></td><td class="s">Some C&lt;RowCacheSize&gt; values have special meaning, as follows:</td></tr>
<tr><td class="h"><a name="5402"></a>5402</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5403"></a>5403</td><td></td><td></td><td></td><td></td><td class="s">  0 - Automatically determine a reasonable cache size for each C&lt;SELECT&gt;</td></tr>
<tr><td class="h"><a name="5404"></a>5404</td><td></td><td></td><td></td><td></td><td class="s">  1 - Disable the local row cache</td></tr>
<tr><td class="h"><a name="5405"></a>5405</td><td></td><td></td><td></td><td></td><td class="s"> &gt;1 - Cache this many rows</td></tr>
<tr><td class="h"><a name="5406"></a>5406</td><td></td><td></td><td></td><td></td><td class="s"> &lt;0 - Cache as many rows that will fit into this much memory for each C&lt;SELECT&gt;.</td></tr>
<tr><td class="h"><a name="5407"></a>5407</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5408"></a>5408</td><td></td><td></td><td></td><td></td><td class="s">Note that large cache sizes may require a very large amount of memory</td></tr>
<tr><td class="h"><a name="5409"></a>5409</td><td></td><td></td><td></td><td></td><td class="s">(I&lt;cached rows * maximum size of row&gt;). Also, a large cache will cause</td></tr>
<tr><td class="h"><a name="5410"></a>5410</td><td></td><td></td><td></td><td></td><td class="s">a longer delay not only for the first fetch, but also whenever the</td></tr>
<tr><td class="h"><a name="5411"></a>5411</td><td></td><td></td><td></td><td></td><td class="s">cache needs refilling.</td></tr>
<tr><td class="h"><a name="5412"></a>5412</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5413"></a>5413</td><td></td><td></td><td></td><td></td><td class="s">See also the L&lt;/RowsInCache&gt; statement handle attribute.</td></tr>
<tr><td class="h"><a name="5414"></a>5414</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5415"></a>5415</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Username&gt;  (string)</td></tr>
<tr><td class="h"><a name="5416"></a>5416</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5417"></a>5417</td><td></td><td></td><td></td><td></td><td class="s">Returns the username used to connect to the database.</td></tr>
<tr><td class="h"><a name="5418"></a>5418</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5419"></a>5419</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5420"></a>5420</td><td></td><td></td><td></td><td></td><td class="s">=head1 DBI STATEMENT HANDLE OBJECTS</td></tr>
<tr><td class="h"><a name="5421"></a>5421</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5422"></a>5422</td><td></td><td></td><td></td><td></td><td class="s">This section lists the methods and attributes associated with DBI</td></tr>
<tr><td class="h"><a name="5423"></a>5423</td><td></td><td></td><td></td><td></td><td class="s">statement handles.</td></tr>
<tr><td class="h"><a name="5424"></a>5424</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5425"></a>5425</td><td></td><td></td><td></td><td></td><td class="s">=head2 Statement Handle Methods</td></tr>
<tr><td class="h"><a name="5426"></a>5426</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5427"></a>5427</td><td></td><td></td><td></td><td></td><td class="s">The DBI defines the following methods for use on DBI statement handles:</td></tr>
<tr><td class="h"><a name="5428"></a>5428</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5429"></a>5429</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;bind_param&gt;</td></tr>
<tr><td class="h"><a name="5430"></a>5430</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5431"></a>5431</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param($p_num, $bind_value)</td></tr>
<tr><td class="h"><a name="5432"></a>5432</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param($p_num, $bind_value, \%attr)</td></tr>
<tr><td class="h"><a name="5433"></a>5433</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param($p_num, $bind_value, $bind_type)</td></tr>
<tr><td class="h"><a name="5434"></a>5434</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5435"></a>5435</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;bind_param&gt; method takes a copy of $bind_value and associates it</td></tr>
<tr><td class="h"><a name="5436"></a>5436</td><td></td><td></td><td></td><td></td><td class="s">(binds it) with a placeholder, identified by $p_num, embedded in</td></tr>
<tr><td class="h"><a name="5437"></a>5437</td><td></td><td></td><td></td><td></td><td class="s">the prepared statement. Placeholders are indicated with question</td></tr>
<tr><td class="h"><a name="5438"></a>5438</td><td></td><td></td><td></td><td></td><td class="s">mark character (C&lt;?&gt;). For example:</td></tr>
<tr><td class="h"><a name="5439"></a>5439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5440"></a>5440</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{RaiseError} = 1;        # save having to check each method call</td></tr>
<tr><td class="h"><a name="5441"></a>5441</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;SELECT name, age FROM people WHERE name LIKE ?&quot;);</td></tr>
<tr><td class="h"><a name="5442"></a>5442</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param(1, &quot;John%&quot;);  # placeholders are numbered from 1</td></tr>
<tr><td class="h"><a name="5443"></a>5443</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="5444"></a>5444</td><td></td><td></td><td></td><td></td><td class="s">  DBI::dump_results($sth);</td></tr>
<tr><td class="h"><a name="5445"></a>5445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5446"></a>5446</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/&quot;Placeholders and Bind Values&quot;&gt; for more information.</td></tr>
<tr><td class="h"><a name="5447"></a>5447</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5448"></a>5448</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5449"></a>5449</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Data Types for Placeholders&gt;</td></tr>
<tr><td class="h"><a name="5450"></a>5450</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5451"></a>5451</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;\%attr&gt; parameter can be used to hint at the data type the</td></tr>
<tr><td class="h"><a name="5452"></a>5452</td><td></td><td></td><td></td><td></td><td class="s">placeholder should have. This is rarely needed. Typically, the driver is only</td></tr>
<tr><td class="h"><a name="5453"></a>5453</td><td></td><td></td><td></td><td></td><td class="s">interested in knowing if the placeholder should be bound as a number or a string.</td></tr>
<tr><td class="h"><a name="5454"></a>5454</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5455"></a>5455</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param(1, $value, { TYPE =&gt; SQL_INTEGER });</td></tr>
<tr><td class="h"><a name="5456"></a>5456</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5457"></a>5457</td><td></td><td></td><td></td><td></td><td class="s">As a short-cut for the common case, the data type can be passed</td></tr>
<tr><td class="h"><a name="5458"></a>5458</td><td></td><td></td><td></td><td></td><td class="s">directly, in place of the C&lt;\%attr&gt; hash reference. This example is</td></tr>
<tr><td class="h"><a name="5459"></a>5459</td><td></td><td></td><td></td><td></td><td class="s">equivalent to the one above:</td></tr>
<tr><td class="h"><a name="5460"></a>5460</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5461"></a>5461</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param(1, $value, SQL_INTEGER);</td></tr>
<tr><td class="h"><a name="5462"></a>5462</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5463"></a>5463</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TYPE&gt; value indicates the standard (non-driver-specific) type for</td></tr>
<tr><td class="h"><a name="5464"></a>5464</td><td></td><td></td><td></td><td></td><td class="s">this parameter. To specify the driver-specific type, the driver may</td></tr>
<tr><td class="h"><a name="5465"></a>5465</td><td></td><td></td><td></td><td></td><td class="s">support a driver-specific attribute, such as C&lt;{ ora_type =E&lt;gt&gt; 97 }&gt;.</td></tr>
<tr><td class="h"><a name="5466"></a>5466</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5467"></a>5467</td><td></td><td></td><td></td><td></td><td class="s">The SQL_INTEGER and other related constants can be imported using</td></tr>
<tr><td class="h"><a name="5468"></a>5468</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5469"></a>5469</td><td></td><td></td><td></td><td></td><td class="s">  use DBI qw(:sql_types);</td></tr>
<tr><td class="h"><a name="5470"></a>5470</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5471"></a>5471</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/&quot;DBI Constants&quot;&gt; for more information.</td></tr>
<tr><td class="h"><a name="5472"></a>5472</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5473"></a>5473</td><td></td><td></td><td></td><td></td><td class="s">The data type for a placeholder cannot be changed after the first</td></tr>
<tr><td class="h"><a name="5474"></a>5474</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param&gt; call. In fact the whole \%attr parameter is 'sticky'</td></tr>
<tr><td class="h"><a name="5475"></a>5475</td><td></td><td></td><td></td><td></td><td class="s">in the sense that a driver only needs to consider the \%attr parameter</td></tr>
<tr><td class="h"><a name="5476"></a>5476</td><td></td><td></td><td></td><td></td><td class="s">for the first call, for a given $sth and parameter. After that the driver</td></tr>
<tr><td class="h"><a name="5477"></a>5477</td><td></td><td></td><td></td><td></td><td class="s">may ignore the \%attr parameter for that placeholder.</td></tr>
<tr><td class="h"><a name="5478"></a>5478</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5479"></a>5479</td><td></td><td></td><td></td><td></td><td class="s">Perl only has string and number scalar data types. All database types</td></tr>
<tr><td class="h"><a name="5480"></a>5480</td><td></td><td></td><td></td><td></td><td class="s">that aren't numbers are bound as strings and must be in a format the</td></tr>
<tr><td class="h"><a name="5481"></a>5481</td><td></td><td></td><td></td><td></td><td class="s">database will understand except where the bind_param() TYPE attribute</td></tr>
<tr><td class="h"><a name="5482"></a>5482</td><td></td><td></td><td></td><td></td><td class="s">specifies a type that implies a particular format. For example, given:</td></tr>
<tr><td class="h"><a name="5483"></a>5483</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5484"></a>5484</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param(1, $value, SQL_DATETIME);</td></tr>
<tr><td class="h"><a name="5485"></a>5485</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5486"></a>5486</td><td></td><td></td><td></td><td></td><td class="s">the driver should expect $value to be in the ODBC standard SQL_DATETIME</td></tr>
<tr><td class="h"><a name="5487"></a>5487</td><td></td><td></td><td></td><td></td><td class="s">format, which is 'YYYY-MM-DD HH:MM:SS'. Similarly for SQL_DATE, SQL_TIME etc.</td></tr>
<tr><td class="h"><a name="5488"></a>5488</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5489"></a>5489</td><td></td><td></td><td></td><td></td><td class="s">As an alternative to specifying the data type in the C&lt;bind_param&gt; call,</td></tr>
<tr><td class="h"><a name="5490"></a>5490</td><td></td><td></td><td></td><td></td><td class="s">you can let the driver pass the value as the default type (C&lt;VARCHAR&gt;).</td></tr>
<tr><td class="h"><a name="5491"></a>5491</td><td></td><td></td><td></td><td></td><td class="s">You can then use an SQL function to convert the type within the statement.</td></tr>
<tr><td class="h"><a name="5492"></a>5492</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="5493"></a>5493</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5494"></a>5494</td><td></td><td></td><td></td><td></td><td class="s">  INSERT INTO price(code, price) VALUES (?, CONVERT(MONEY,?))</td></tr>
<tr><td class="h"><a name="5495"></a>5495</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5496"></a>5496</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;CONVERT&gt; function used here is just an example. The actual function</td></tr>
<tr><td class="h"><a name="5497"></a>5497</td><td></td><td></td><td></td><td></td><td class="s">and syntax will vary between different databases and is non-portable.</td></tr>
<tr><td class="h"><a name="5498"></a>5498</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5499"></a>5499</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Placeholders and Bind Values&quot;&gt; for more information.</td></tr>
<tr><td class="h"><a name="5500"></a>5500</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5501"></a>5501</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5502"></a>5502</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;bind_param_inout&gt;</td></tr>
<tr><td class="h"><a name="5503"></a>5503</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5504"></a>5504</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len)  or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5505"></a>5505</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len, \%attr)     or ...</td></tr>
<tr><td class="h"><a name="5506"></a>5506</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len, $bind_type) or ...</td></tr>
<tr><td class="h"><a name="5507"></a>5507</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5508"></a>5508</td><td></td><td></td><td></td><td></td><td class="s">This method acts like L&lt;/bind_param&gt;, but also enables values to be</td></tr>
<tr><td class="h"><a name="5509"></a>5509</td><td></td><td></td><td></td><td></td><td class="s">updated by the statement. The statement is typically</td></tr>
<tr><td class="h"><a name="5510"></a>5510</td><td></td><td></td><td></td><td></td><td class="s">a call to a stored procedure. The C&lt;$bind_value&gt; must be passed as a</td></tr>
<tr><td class="h"><a name="5511"></a>5511</td><td></td><td></td><td></td><td></td><td class="s">reference to the actual value to be used.</td></tr>
<tr><td class="h"><a name="5512"></a>5512</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5513"></a>5513</td><td></td><td></td><td></td><td></td><td class="s">Note that unlike L&lt;/bind_param&gt;, the C&lt;$bind_value&gt; variable is not</td></tr>
<tr><td class="h"><a name="5514"></a>5514</td><td></td><td></td><td></td><td></td><td class="s">copied when C&lt;bind_param_inout&gt; is called. Instead, the value in the</td></tr>
<tr><td class="h"><a name="5515"></a>5515</td><td></td><td></td><td></td><td></td><td class="s">variable is read at the time L&lt;/execute&gt; is called.</td></tr>
<tr><td class="h"><a name="5516"></a>5516</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5517"></a>5517</td><td></td><td></td><td></td><td></td><td class="s">The additional C&lt;$max_len&gt; parameter specifies the minimum amount of</td></tr>
<tr><td class="h"><a name="5518"></a>5518</td><td></td><td></td><td></td><td></td><td class="s">memory to allocate to C&lt;$bind_value&gt; for the new value. If the value</td></tr>
<tr><td class="h"><a name="5519"></a>5519</td><td></td><td></td><td></td><td></td><td class="s">returned from the database is too</td></tr>
<tr><td class="h"><a name="5520"></a>5520</td><td></td><td></td><td></td><td></td><td class="s">big to fit, then the execution should fail. If unsure what value to use,</td></tr>
<tr><td class="h"><a name="5521"></a>5521</td><td></td><td></td><td></td><td></td><td class="s">pick a generous length, i.e., a length larger than the longest value that would ever be</td></tr>
<tr><td class="h"><a name="5522"></a>5522</td><td></td><td></td><td></td><td></td><td class="s">returned.  The only cost of using a larger value than needed is wasted memory.</td></tr>
<tr><td class="h"><a name="5523"></a>5523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5524"></a>5524</td><td></td><td></td><td></td><td></td><td class="s">Undefined values or C&lt;undef&gt; are used to indicate null values.</td></tr>
<tr><td class="h"><a name="5525"></a>5525</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/&quot;Placeholders and Bind Values&quot;&gt; for more information.</td></tr>
<tr><td class="h"><a name="5526"></a>5526</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5527"></a>5527</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5528"></a>5528</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;bind_param_array&gt;</td></tr>
<tr><td class="h"><a name="5529"></a>5529</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5530"></a>5530</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value)</td></tr>
<tr><td class="h"><a name="5531"></a>5531</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value, \%attr)</td></tr>
<tr><td class="h"><a name="5532"></a>5532</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value, $bind_type)</td></tr>
<tr><td class="h"><a name="5533"></a>5533</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5534"></a>5534</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;bind_param_array&gt; method is used to bind an array of values</td></tr>
<tr><td class="h"><a name="5535"></a>5535</td><td></td><td></td><td></td><td></td><td class="s">to a placeholder embedded in the prepared statement which is to be executed</td></tr>
<tr><td class="h"><a name="5536"></a>5536</td><td></td><td></td><td></td><td></td><td class="s">with L&lt;/execute_array&gt;. For example:</td></tr>
<tr><td class="h"><a name="5537"></a>5537</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5538"></a>5538</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{RaiseError} = 1;        # save having to check each method call</td></tr>
<tr><td class="h"><a name="5539"></a>5539</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (first_name, last_name, dept) VALUES(?, ?, ?)&quot;);</td></tr>
<tr><td class="h"><a name="5540"></a>5540</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param_array(1, [ 'John', 'Mary', 'Tim' ]);</td></tr>
<tr><td class="h"><a name="5541"></a>5541</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param_array(2, [ 'Booth', 'Todd', 'Robinson' ]);</td></tr>
<tr><td class="h"><a name="5542"></a>5542</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_param_array(3, &quot;SALES&quot;); # scalar will be reused for each row</td></tr>
<tr><td class="h"><a name="5543"></a>5543</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute_array( { ArrayTupleStatus =&gt; \my @tuple_status } );</td></tr>
<tr><td class="h"><a name="5544"></a>5544</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5545"></a>5545</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;%attr&gt; ($bind_type) argument is the same as defined for L&lt;/bind_param&gt;.</td></tr>
<tr><td class="h"><a name="5546"></a>5546</td><td></td><td></td><td></td><td></td><td class="s">Refer to L&lt;/bind_param&gt; for general details on using placeholders.</td></tr>
<tr><td class="h"><a name="5547"></a>5547</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5548"></a>5548</td><td></td><td></td><td></td><td></td><td class="s">(Note that bind_param_array() can I&lt;not&gt; be used to expand a</td></tr>
<tr><td class="h"><a name="5549"></a>5549</td><td></td><td></td><td></td><td></td><td class="s">placeholder into a list of values for a statement like &quot;SELECT foo</td></tr>
<tr><td class="h"><a name="5550"></a>5550</td><td></td><td></td><td></td><td></td><td class="s">WHERE bar IN (?)&quot;.  A placeholder can only ever represent one value</td></tr>
<tr><td class="h"><a name="5551"></a>5551</td><td></td><td></td><td></td><td></td><td class="s">per execution.)</td></tr>
<tr><td class="h"><a name="5552"></a>5552</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5553"></a>5553</td><td></td><td></td><td></td><td></td><td class="s">Scalar values, including C&lt;undef&gt;, may also be bound by</td></tr>
<tr><td class="h"><a name="5554"></a>5554</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param_array&gt;. In which case the same value will be used for each</td></tr>
<tr><td class="h"><a name="5555"></a>5555</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/execute&gt; call. Driver-specific implementations may behave</td></tr>
<tr><td class="h"><a name="5556"></a>5556</td><td></td><td></td><td></td><td></td><td class="s">differently, e.g., when binding to a stored procedure call, some</td></tr>
<tr><td class="h"><a name="5557"></a>5557</td><td></td><td></td><td></td><td></td><td class="s">databases may permit mixing scalars and arrays as arguments.</td></tr>
<tr><td class="h"><a name="5558"></a>5558</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5559"></a>5559</td><td></td><td></td><td></td><td></td><td class="s">The default implementation provided by DBI (for drivers that have</td></tr>
<tr><td class="h"><a name="5560"></a>5560</td><td></td><td></td><td></td><td></td><td class="s">not implemented array binding) is to iteratively call L&lt;/execute&gt; for</td></tr>
<tr><td class="h"><a name="5561"></a>5561</td><td></td><td></td><td></td><td></td><td class="s">each parameter tuple provided in the bound arrays.  Drivers may</td></tr>
<tr><td class="h"><a name="5562"></a>5562</td><td></td><td></td><td></td><td></td><td class="s">provide more optimized implementations using whatever bulk operation</td></tr>
<tr><td class="h"><a name="5563"></a>5563</td><td></td><td></td><td></td><td></td><td class="s">support the database API provides. The default driver behaviour should</td></tr>
<tr><td class="h"><a name="5564"></a>5564</td><td></td><td></td><td></td><td></td><td class="s">match the default DBI behaviour, but always consult your driver</td></tr>
<tr><td class="h"><a name="5565"></a>5565</td><td></td><td></td><td></td><td></td><td class="s">documentation as there may be driver specific issues to consider.</td></tr>
<tr><td class="h"><a name="5566"></a>5566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5567"></a>5567</td><td></td><td></td><td></td><td></td><td class="s">Note that the default implementation currently only supports non-data</td></tr>
<tr><td class="h"><a name="5568"></a>5568</td><td></td><td></td><td></td><td></td><td class="s">returning statements (INSERT, UPDATE, but not SELECT). Also,</td></tr>
<tr><td class="h"><a name="5569"></a>5569</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param_array&gt; and L&lt;/bind_param&gt; cannot be mixed in the same</td></tr>
<tr><td class="h"><a name="5570"></a>5570</td><td></td><td></td><td></td><td></td><td class="s">statement execution, and C&lt;bind_param_array&gt; must be used with</td></tr>
<tr><td class="h"><a name="5571"></a>5571</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/execute_array&gt;; using C&lt;bind_param_array&gt; will have no effect</td></tr>
<tr><td class="h"><a name="5572"></a>5572</td><td></td><td></td><td></td><td></td><td class="s">for L&lt;/execute&gt;.</td></tr>
<tr><td class="h"><a name="5573"></a>5573</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5574"></a>5574</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;bind_param_array&gt; method was added in DBI 1.22.</td></tr>
<tr><td class="h"><a name="5575"></a>5575</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5576"></a>5576</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;execute&gt;</td></tr>
<tr><td class="h"><a name="5577"></a>5577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5578"></a>5578</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;execute                or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5579"></a>5579</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;execute(@bind_values)  or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5580"></a>5580</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5581"></a>5581</td><td></td><td></td><td></td><td></td><td class="s">Perform whatever processing is necessary to execute the prepared</td></tr>
<tr><td class="h"><a name="5582"></a>5582</td><td></td><td></td><td></td><td></td><td class="s">statement.  An C&lt;undef&gt; is returned if an error occurs.  A successful</td></tr>
<tr><td class="h"><a name="5583"></a>5583</td><td></td><td></td><td></td><td></td><td class="s">C&lt;execute&gt; always returns true regardless of the number of rows affected,</td></tr>
<tr><td class="h"><a name="5584"></a>5584</td><td></td><td></td><td></td><td></td><td class="s">even if it's zero (see below). It is always important to check the</td></tr>
<tr><td class="h"><a name="5585"></a>5585</td><td></td><td></td><td></td><td></td><td class="s">return status of C&lt;execute&gt; (and most other DBI methods) for errors</td></tr>
<tr><td class="h"><a name="5586"></a>5586</td><td></td><td></td><td></td><td></td><td class="s">if you're not using L&lt;/RaiseError&gt;.</td></tr>
<tr><td class="h"><a name="5587"></a>5587</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5588"></a>5588</td><td></td><td></td><td></td><td></td><td class="s">For a I&lt;non&gt;-C&lt;SELECT&gt; statement, C&lt;execute&gt; returns the number of rows</td></tr>
<tr><td class="h"><a name="5589"></a>5589</td><td></td><td></td><td></td><td></td><td class="s">affected, if known. If no rows were affected, then C&lt;execute&gt; returns</td></tr>
<tr><td class="h"><a name="5590"></a>5590</td><td></td><td></td><td></td><td></td><td class="s">&quot;C&lt;0E0&gt;&quot;, which Perl will treat as 0 but will regard as true. Note that it</td></tr>
<tr><td class="h"><a name="5591"></a>5591</td><td></td><td></td><td></td><td></td><td class="s">is I&lt;not&gt; an error for no rows to be affected by a statement. If the</td></tr>
<tr><td class="h"><a name="5592"></a>5592</td><td></td><td></td><td></td><td></td><td class="s">number of rows affected is not known, then C&lt;execute&gt; returns -1.</td></tr>
<tr><td class="h"><a name="5593"></a>5593</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5594"></a>5594</td><td></td><td></td><td></td><td></td><td class="s">For C&lt;SELECT&gt; statements, execute simply &quot;starts&quot; the query within the</td></tr>
<tr><td class="h"><a name="5595"></a>5595</td><td></td><td></td><td></td><td></td><td class="s">database engine. Use one of the fetch methods to retrieve the data after</td></tr>
<tr><td class="h"><a name="5596"></a>5596</td><td></td><td></td><td></td><td></td><td class="s">calling C&lt;execute&gt;.  The C&lt;execute&gt; method does I&lt;not&gt; return the number of</td></tr>
<tr><td class="h"><a name="5597"></a>5597</td><td></td><td></td><td></td><td></td><td class="s">rows that will be returned by the query (because most databases can't</td></tr>
<tr><td class="h"><a name="5598"></a>5598</td><td></td><td></td><td></td><td></td><td class="s">tell in advance), it simply returns a true value.</td></tr>
<tr><td class="h"><a name="5599"></a>5599</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5600"></a>5600</td><td></td><td></td><td></td><td></td><td class="s">You can tell if the statement was a C&lt;SELECT&gt; statement by checking if</td></tr>
<tr><td class="h"><a name="5601"></a>5601</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$sth-E&lt;gt&gt;{NUM_OF_FIELDS}&gt; is greater than zero after calling C&lt;execute&gt;.</td></tr>
<tr><td class="h"><a name="5602"></a>5602</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5603"></a>5603</td><td></td><td></td><td></td><td></td><td class="s">If any arguments are given, then C&lt;execute&gt; will effectively call</td></tr>
<tr><td class="h"><a name="5604"></a>5604</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/bind_param&gt; for each value before executing the statement.  Values</td></tr>
<tr><td class="h"><a name="5605"></a>5605</td><td></td><td></td><td></td><td></td><td class="s">bound in this way are usually treated as C&lt;SQL_VARCHAR&gt; types unless</td></tr>
<tr><td class="h"><a name="5606"></a>5606</td><td></td><td></td><td></td><td></td><td class="s">the driver can determine the correct type (which is rare), or unless</td></tr>
<tr><td class="h"><a name="5607"></a>5607</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param&gt; (or C&lt;bind_param_inout&gt;) has already been used to</td></tr>
<tr><td class="h"><a name="5608"></a>5608</td><td></td><td></td><td></td><td></td><td class="s">specify the type.</td></tr>
<tr><td class="h"><a name="5609"></a>5609</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5610"></a>5610</td><td></td><td></td><td></td><td></td><td class="s">Note that passing C&lt;execute&gt; an empty array is the same as passing no arguments</td></tr>
<tr><td class="h"><a name="5611"></a>5611</td><td></td><td></td><td></td><td></td><td class="s">at all, which will execute the statement with previously bound values.</td></tr>
<tr><td class="h"><a name="5612"></a>5612</td><td></td><td></td><td></td><td></td><td class="s">That's probably not what you want.</td></tr>
<tr><td class="h"><a name="5613"></a>5613</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5614"></a>5614</td><td></td><td></td><td></td><td></td><td class="s">If execute() is called on a statement handle that's still active</td></tr>
<tr><td class="h"><a name="5615"></a>5615</td><td></td><td></td><td></td><td></td><td class="s">($sth-&gt;{Active} is true) then it should effectively call finish()</td></tr>
<tr><td class="h"><a name="5616"></a>5616</td><td></td><td></td><td></td><td></td><td class="s">to tidy up the previous execution results before starting this new</td></tr>
<tr><td class="h"><a name="5617"></a>5617</td><td></td><td></td><td></td><td></td><td class="s">execution.</td></tr>
<tr><td class="h"><a name="5618"></a>5618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5619"></a>5619</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;execute_array&gt;</td></tr>
<tr><td class="h"><a name="5620"></a>5620</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5621"></a>5621</td><td></td><td></td><td></td><td></td><td class="s">  $tuples = $sth-&gt;execute_array(\%attr) or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5622"></a>5622</td><td></td><td></td><td></td><td></td><td class="s">  $tuples = $sth-&gt;execute_array(\%attr, @bind_values) or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5623"></a>5623</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5624"></a>5624</td><td></td><td></td><td></td><td></td><td class="s">  ($tuples, $rows) = $sth-&gt;execute_array(\%attr) or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5625"></a>5625</td><td></td><td></td><td></td><td></td><td class="s">  ($tuples, $rows) = $sth-&gt;execute_array(\%attr, @bind_values) or die $sth-&gt;errstr;</td></tr>
<tr><td class="h"><a name="5626"></a>5626</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5627"></a>5627</td><td></td><td></td><td></td><td></td><td class="s">Execute the prepared statement once for each parameter tuple</td></tr>
<tr><td class="h"><a name="5628"></a>5628</td><td></td><td></td><td></td><td></td><td class="s">(group of values) provided either in the @bind_values, or by prior</td></tr>
<tr><td class="h"><a name="5629"></a>5629</td><td></td><td></td><td></td><td></td><td class="s">calls to L&lt;/bind_param_array&gt;, or via a reference passed in \%attr.</td></tr>
<tr><td class="h"><a name="5630"></a>5630</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5631"></a>5631</td><td></td><td></td><td></td><td></td><td class="s">When called in scalar context the execute_array() method returns the</td></tr>
<tr><td class="h"><a name="5632"></a>5632</td><td></td><td></td><td></td><td></td><td class="s">number of tuples executed, or C&lt;undef&gt; if an error occured.  Like</td></tr>
<tr><td class="h"><a name="5633"></a>5633</td><td></td><td></td><td></td><td></td><td class="s">execute(), a successful execute_array() always returns true regardless</td></tr>
<tr><td class="h"><a name="5634"></a>5634</td><td></td><td></td><td></td><td></td><td class="s">of the number of tuples executed, even if it's zero. If there were any</td></tr>
<tr><td class="h"><a name="5635"></a>5635</td><td></td><td></td><td></td><td></td><td class="s">errors the ArrayTupleStatus array can be used to discover which tuples</td></tr>
<tr><td class="h"><a name="5636"></a>5636</td><td></td><td></td><td></td><td></td><td class="s">failed and with what errors.</td></tr>
<tr><td class="h"><a name="5637"></a>5637</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5638"></a>5638</td><td></td><td></td><td></td><td></td><td class="s">When called in list context the execute_array() method returns two scalars;</td></tr>
<tr><td class="h"><a name="5639"></a>5639</td><td></td><td></td><td></td><td></td><td class="s">$tuples is the same as calling execute_array() in scalar context and $rows is</td></tr>
<tr><td class="h"><a name="5640"></a>5640</td><td></td><td></td><td></td><td></td><td class="s">the sum of the number of rows affected for each tuple, if available or</td></tr>
<tr><td class="h"><a name="5641"></a>5641</td><td></td><td></td><td></td><td></td><td class="s">-1 if the driver cannot determine this.</td></tr>
<tr><td class="h"><a name="5642"></a>5642</td><td></td><td></td><td></td><td></td><td class="s">If you are doing an update operation the returned rows affected may not be what</td></tr>
<tr><td class="h"><a name="5643"></a>5643</td><td></td><td></td><td></td><td></td><td class="s">you expect if, for instance, one or more of the tuples affected the same row</td></tr>
<tr><td class="h"><a name="5644"></a>5644</td><td></td><td></td><td></td><td></td><td class="s">multiple times.  Some drivers may not yet support list context, in which case</td></tr>
<tr><td class="h"><a name="5645"></a>5645</td><td></td><td></td><td></td><td></td><td class="s">$rows will be undef, or may not be able to provide the number of rows affected</td></tr>
<tr><td class="h"><a name="5646"></a>5646</td><td></td><td></td><td></td><td></td><td class="s">when performing this batch operation, in which case $rows will be -1.</td></tr>
<tr><td class="h"><a name="5647"></a>5647</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5648"></a>5648</td><td></td><td></td><td></td><td></td><td class="s">Bind values for the tuples to be executed may be supplied row-wise</td></tr>
<tr><td class="h"><a name="5649"></a>5649</td><td></td><td></td><td></td><td></td><td class="s">by an C&lt;ArrayTupleFetch&gt; attribute, or else column-wise in the</td></tr>
<tr><td class="h"><a name="5650"></a>5650</td><td></td><td></td><td></td><td></td><td class="s">C&lt;@bind_values&gt; argument, or else column-wise by prior calls to</td></tr>
<tr><td class="h"><a name="5651"></a>5651</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/bind_param_array&gt;.</td></tr>
<tr><td class="h"><a name="5652"></a>5652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5653"></a>5653</td><td></td><td></td><td></td><td></td><td class="s">Where column-wise binding is used (via the C&lt;@bind_values&gt; argument</td></tr>
<tr><td class="h"><a name="5654"></a>5654</td><td></td><td></td><td></td><td></td><td class="s">or calls to bind_param_array()) the maximum number of elements in</td></tr>
<tr><td class="h"><a name="5655"></a>5655</td><td></td><td></td><td></td><td></td><td class="s">any one of the bound value arrays determines the number of tuples</td></tr>
<tr><td class="h"><a name="5656"></a>5656</td><td></td><td></td><td></td><td></td><td class="s">executed. Placeholders with fewer values in their parameter arrays</td></tr>
<tr><td class="h"><a name="5657"></a>5657</td><td></td><td></td><td></td><td></td><td class="s">are treated as if padded with undef (NULL) values.</td></tr>
<tr><td class="h"><a name="5658"></a>5658</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5659"></a>5659</td><td></td><td></td><td></td><td></td><td class="s">If a scalar value is bound, instead of an array reference, it is</td></tr>
<tr><td class="h"><a name="5660"></a>5660</td><td></td><td></td><td></td><td></td><td class="s">treated as a I&lt;variable&gt; length array with all elements having the</td></tr>
<tr><td class="h"><a name="5661"></a>5661</td><td></td><td></td><td></td><td></td><td class="s">same value. It's does not influence the number of tuples executed,</td></tr>
<tr><td class="h"><a name="5662"></a>5662</td><td></td><td></td><td></td><td></td><td class="s">so if all bound arrays have zero elements then zero tuples will</td></tr>
<tr><td class="h"><a name="5663"></a>5663</td><td></td><td></td><td></td><td></td><td class="s">be executed. If I&lt;all&gt; bound values are scalars then one tuple</td></tr>
<tr><td class="h"><a name="5664"></a>5664</td><td></td><td></td><td></td><td></td><td class="s">will be executed, making execute_array() act just like execute().</td></tr>
<tr><td class="h"><a name="5665"></a>5665</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5666"></a>5666</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ArrayTupleFetch&gt; attribute can be used to specify a reference</td></tr>
<tr><td class="h"><a name="5667"></a>5667</td><td></td><td></td><td></td><td></td><td class="s">to a subroutine that will be called to provide the bind values for</td></tr>
<tr><td class="h"><a name="5668"></a>5668</td><td></td><td></td><td></td><td></td><td class="s">each tuple execution. The subroutine should return an reference to</td></tr>
<tr><td class="h"><a name="5669"></a>5669</td><td></td><td></td><td></td><td></td><td class="s">an array which contains the appropriate number of bind values, or</td></tr>
<tr><td class="h"><a name="5670"></a>5670</td><td></td><td></td><td></td><td></td><td class="s">return an undef if there is no more data to execute.</td></tr>
<tr><td class="h"><a name="5671"></a>5671</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5672"></a>5672</td><td></td><td></td><td></td><td></td><td class="s">As a convienience, the C&lt;ArrayTupleFetch&gt; attribute can also be</td></tr>
<tr><td class="h"><a name="5673"></a>5673</td><td></td><td></td><td></td><td></td><td class="s">used to specify a statement handle. In which case the fetchrow_arrayref()</td></tr>
<tr><td class="h"><a name="5674"></a>5674</td><td></td><td></td><td></td><td></td><td class="s">method will be called on the given statement handle in order to</td></tr>
<tr><td class="h"><a name="5675"></a>5675</td><td></td><td></td><td></td><td></td><td class="s">provide the bind values for each tuple execution.</td></tr>
<tr><td class="h"><a name="5676"></a>5676</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5677"></a>5677</td><td></td><td></td><td></td><td></td><td class="s">The values specified via bind_param_array() or the @bind_values</td></tr>
<tr><td class="h"><a name="5678"></a>5678</td><td></td><td></td><td></td><td></td><td class="s">parameter may be either scalars, or arrayrefs.  If any C&lt;@bind_values&gt;</td></tr>
<tr><td class="h"><a name="5679"></a>5679</td><td></td><td></td><td></td><td></td><td class="s">are given, then C&lt;execute_array&gt; will effectively call L&lt;/bind_param_array&gt;</td></tr>
<tr><td class="h"><a name="5680"></a>5680</td><td></td><td></td><td></td><td></td><td class="s">for each value before executing the statement.  Values bound in</td></tr>
<tr><td class="h"><a name="5681"></a>5681</td><td></td><td></td><td></td><td></td><td class="s">this way are usually treated as C&lt;SQL_VARCHAR&gt; types unless the</td></tr>
<tr><td class="h"><a name="5682"></a>5682</td><td></td><td></td><td></td><td></td><td class="s">driver can determine the correct type (which is rare), or unless</td></tr>
<tr><td class="h"><a name="5683"></a>5683</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param&gt;, C&lt;bind_param_inout&gt;, C&lt;bind_param_array&gt;, or</td></tr>
<tr><td class="h"><a name="5684"></a>5684</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_param_inout_array&gt; has already been used to specify the type.</td></tr>
<tr><td class="h"><a name="5685"></a>5685</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/bind_param_array&gt; for details.</td></tr>
<tr><td class="h"><a name="5686"></a>5686</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5687"></a>5687</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ArrayTupleStatus&gt; attribute can be used to specify a</td></tr>
<tr><td class="h"><a name="5688"></a>5688</td><td></td><td></td><td></td><td></td><td class="s">reference to an array which will receive the execute status of each</td></tr>
<tr><td class="h"><a name="5689"></a>5689</td><td></td><td></td><td></td><td></td><td class="s">executed parameter tuple. Note the C&lt;ArrayTupleStatus&gt; attribute was</td></tr>
<tr><td class="h"><a name="5690"></a>5690</td><td></td><td></td><td></td><td></td><td class="s">mandatory until DBI 1.38.</td></tr>
<tr><td class="h"><a name="5691"></a>5691</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5692"></a>5692</td><td></td><td></td><td></td><td></td><td class="s">For tuples which are successfully executed, the element at the same</td></tr>
<tr><td class="h"><a name="5693"></a>5693</td><td></td><td></td><td></td><td></td><td class="s">ordinal position in the status array is the resulting rowcount.</td></tr>
<tr><td class="h"><a name="5694"></a>5694</td><td></td><td></td><td></td><td></td><td class="s">If the execution of a tuple causes an error, then the corresponding</td></tr>
<tr><td class="h"><a name="5695"></a>5695</td><td></td><td></td><td></td><td></td><td class="s">status array element will be set to a reference to an array containing</td></tr>
<tr><td class="h"><a name="5696"></a>5696</td><td></td><td></td><td></td><td></td><td class="s">the error code and error string set by the failed execution.</td></tr>
<tr><td class="h"><a name="5697"></a>5697</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5698"></a>5698</td><td></td><td></td><td></td><td></td><td class="s">If B&lt;any&gt; tuple execution returns an error, C&lt;execute_array&gt; will</td></tr>
<tr><td class="h"><a name="5699"></a>5699</td><td></td><td></td><td></td><td></td><td class="s">return C&lt;undef&gt;. In that case, the application should inspect the</td></tr>
<tr><td class="h"><a name="5700"></a>5700</td><td></td><td></td><td></td><td></td><td class="s">status array to determine which parameter tuples failed.</td></tr>
<tr><td class="h"><a name="5701"></a>5701</td><td></td><td></td><td></td><td></td><td class="s">Some databases may not continue executing tuples beyond the first</td></tr>
<tr><td class="h"><a name="5702"></a>5702</td><td></td><td></td><td></td><td></td><td class="s">failure. In this case the status array will either hold fewer</td></tr>
<tr><td class="h"><a name="5703"></a>5703</td><td></td><td></td><td></td><td></td><td class="s">elements, or the elements beyond the failure will be undef.</td></tr>
<tr><td class="h"><a name="5704"></a>5704</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5705"></a>5705</td><td></td><td></td><td></td><td></td><td class="s">If all parameter tuples are successfully executed, C&lt;execute_array&gt;</td></tr>
<tr><td class="h"><a name="5706"></a>5706</td><td></td><td></td><td></td><td></td><td class="s">returns the number tuples executed.  If no tuples were executed,</td></tr>
<tr><td class="h"><a name="5707"></a>5707</td><td></td><td></td><td></td><td></td><td class="s">then execute_array() returns &quot;C&lt;0E0&gt;&quot;, just like execute() does,</td></tr>
<tr><td class="h"><a name="5708"></a>5708</td><td></td><td></td><td></td><td></td><td class="s">which Perl will treat as 0 but will regard as true.</td></tr>
<tr><td class="h"><a name="5709"></a>5709</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5710"></a>5710</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="5711"></a>5711</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5712"></a>5712</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (first_name, last_name) VALUES (?, ?)&quot;);</td></tr>
<tr><td class="h"><a name="5713"></a>5713</td><td></td><td></td><td></td><td></td><td class="s">  my $tuples = $sth-&gt;execute_array(</td></tr>
<tr><td class="h"><a name="5714"></a>5714</td><td></td><td></td><td></td><td></td><td class="s">      { ArrayTupleStatus =&gt; \my @tuple_status },</td></tr>
<tr><td class="h"><a name="5715"></a>5715</td><td></td><td></td><td></td><td></td><td class="s">      \@first_names,</td></tr>
<tr><td class="h"><a name="5716"></a>5716</td><td></td><td></td><td></td><td></td><td class="s">      \@last_names,</td></tr>
<tr><td class="h"><a name="5717"></a>5717</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="5718"></a>5718</td><td></td><td></td><td></td><td></td><td class="s">  if ($tuples) {</td></tr>
<tr><td class="h"><a name="5719"></a>5719</td><td></td><td></td><td></td><td></td><td class="s">      print &quot;Successfully inserted $tuples records\n&quot;;</td></tr>
<tr><td class="h"><a name="5720"></a>5720</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="5721"></a>5721</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="5722"></a>5722</td><td></td><td></td><td></td><td></td><td class="s">      for my $tuple (0..@last_names-1) {</td></tr>
<tr><td class="h"><a name="5723"></a>5723</td><td></td><td></td><td></td><td></td><td class="s">          my $status = $tuple_status[$tuple];</td></tr>
<tr><td class="h"><a name="5724"></a>5724</td><td></td><td></td><td></td><td></td><td class="s">          $status = [0, &quot;Skipped&quot;] unless defined $status;</td></tr>
<tr><td class="h"><a name="5725"></a>5725</td><td></td><td></td><td></td><td></td><td class="s">          next unless ref $status;</td></tr>
<tr><td class="h"><a name="5726"></a>5726</td><td></td><td></td><td></td><td></td><td class="s">          printf &quot;Failed to insert (%s, %s): %s\n&quot;,</td></tr>
<tr><td class="h"><a name="5727"></a>5727</td><td></td><td></td><td></td><td></td><td class="s">              $first_names[$tuple], $last_names[$tuple], $status-&gt;[1];</td></tr>
<tr><td class="h"><a name="5728"></a>5728</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="5729"></a>5729</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="5730"></a>5730</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5731"></a>5731</td><td></td><td></td><td></td><td></td><td class="s">Support for data returning statements such as SELECT is driver-specific</td></tr>
<tr><td class="h"><a name="5732"></a>5732</td><td></td><td></td><td></td><td></td><td class="s">and subject to change. At present, the default implementation</td></tr>
<tr><td class="h"><a name="5733"></a>5733</td><td></td><td></td><td></td><td></td><td class="s">provided by DBI only supports non-data returning statements.</td></tr>
<tr><td class="h"><a name="5734"></a>5734</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5735"></a>5735</td><td></td><td></td><td></td><td></td><td class="s">Transaction semantics when using array binding are driver and</td></tr>
<tr><td class="h"><a name="5736"></a>5736</td><td></td><td></td><td></td><td></td><td class="s">database specific.  If C&lt;AutoCommit&gt; is on, the default DBI</td></tr>
<tr><td class="h"><a name="5737"></a>5737</td><td></td><td></td><td></td><td></td><td class="s">implementation will cause each parameter tuple to be inidividually</td></tr>
<tr><td class="h"><a name="5738"></a>5738</td><td></td><td></td><td></td><td></td><td class="s">committed (or rolled back in the event of an error). If C&lt;AutoCommit&gt;</td></tr>
<tr><td class="h"><a name="5739"></a>5739</td><td></td><td></td><td></td><td></td><td class="s">is off, the application is responsible for explicitly committing</td></tr>
<tr><td class="h"><a name="5740"></a>5740</td><td></td><td></td><td></td><td></td><td class="s">the entire set of bound parameter tuples.  Note that different</td></tr>
<tr><td class="h"><a name="5741"></a>5741</td><td></td><td></td><td></td><td></td><td class="s">drivers and databases may have different behaviours when some</td></tr>
<tr><td class="h"><a name="5742"></a>5742</td><td></td><td></td><td></td><td></td><td class="s">parameter tuples cause failures. In some cases, the driver or</td></tr>
<tr><td class="h"><a name="5743"></a>5743</td><td></td><td></td><td></td><td></td><td class="s">database may automatically rollback the effect of all prior parameter</td></tr>
<tr><td class="h"><a name="5744"></a>5744</td><td></td><td></td><td></td><td></td><td class="s">tuples that succeeded in the transaction; other drivers or databases</td></tr>
<tr><td class="h"><a name="5745"></a>5745</td><td></td><td></td><td></td><td></td><td class="s">may retain the effect of prior successfully executed parameter</td></tr>
<tr><td class="h"><a name="5746"></a>5746</td><td></td><td></td><td></td><td></td><td class="s">tuples. Be sure to check your driver and database for its specific</td></tr>
<tr><td class="h"><a name="5747"></a>5747</td><td></td><td></td><td></td><td></td><td class="s">behaviour.</td></tr>
<tr><td class="h"><a name="5748"></a>5748</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5749"></a>5749</td><td></td><td></td><td></td><td></td><td class="s">Note that, in general, performance will usually be better with</td></tr>
<tr><td class="h"><a name="5750"></a>5750</td><td></td><td></td><td></td><td></td><td class="s">C&lt;AutoCommit&gt; turned off, and using explicit C&lt;commit&gt; after each</td></tr>
<tr><td class="h"><a name="5751"></a>5751</td><td></td><td></td><td></td><td></td><td class="s">C&lt;execute_array&gt; call.</td></tr>
<tr><td class="h"><a name="5752"></a>5752</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5753"></a>5753</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;execute_array&gt; method was added in DBI 1.22, and ArrayTupleFetch</td></tr>
<tr><td class="h"><a name="5754"></a>5754</td><td></td><td></td><td></td><td></td><td class="s">was added in 1.36.</td></tr>
<tr><td class="h"><a name="5755"></a>5755</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5756"></a>5756</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;execute_for_fetch&gt;</td></tr>
<tr><td class="h"><a name="5757"></a>5757</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5758"></a>5758</td><td></td><td></td><td></td><td></td><td class="s">  $tuples = $sth-&gt;execute_for_fetch($fetch_tuple_sub);</td></tr>
<tr><td class="h"><a name="5759"></a>5759</td><td></td><td></td><td></td><td></td><td class="s">  $tuples = $sth-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);</td></tr>
<tr><td class="h"><a name="5760"></a>5760</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5761"></a>5761</td><td></td><td></td><td></td><td></td><td class="s">  ($tuples, $rows) = $sth-&gt;execute_for_fetch($fetch_tuple_sub);</td></tr>
<tr><td class="h"><a name="5762"></a>5762</td><td></td><td></td><td></td><td></td><td class="s">  ($tuples, $rows) = $sth-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);</td></tr>
<tr><td class="h"><a name="5763"></a>5763</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5764"></a>5764</td><td></td><td></td><td></td><td></td><td class="s">The execute_for_fetch() method is used to perform bulk operations</td></tr>
<tr><td class="h"><a name="5765"></a>5765</td><td></td><td></td><td></td><td></td><td class="s">and is most often used via the execute_array() method, not directly.</td></tr>
<tr><td class="h"><a name="5766"></a>5766</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5767"></a>5767</td><td></td><td></td><td></td><td></td><td class="s">The fetch subroutine, referenced by $fetch_tuple_sub, is expected</td></tr>
<tr><td class="h"><a name="5768"></a>5768</td><td></td><td></td><td></td><td></td><td class="s">to return a reference to an array (known as a 'tuple') or undef.</td></tr>
<tr><td class="h"><a name="5769"></a>5769</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5770"></a>5770</td><td></td><td></td><td></td><td></td><td class="s">The execute_for_fetch() method calls $fetch_tuple_sub, without any</td></tr>
<tr><td class="h"><a name="5771"></a>5771</td><td></td><td></td><td></td><td></td><td class="s">parameters, until it returns a false value. Each tuple returned is</td></tr>
<tr><td class="h"><a name="5772"></a>5772</td><td></td><td></td><td></td><td></td><td class="s">used to provide bind values for an $sth-&gt;execute(@$tuple) call.</td></tr>
<tr><td class="h"><a name="5773"></a>5773</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5774"></a>5774</td><td></td><td></td><td></td><td></td><td class="s">In scalar context execute_for_fetch() returns C&lt;undef&gt; if there were any</td></tr>
<tr><td class="h"><a name="5775"></a>5775</td><td></td><td></td><td></td><td></td><td class="s">errors and the number of tuples executed otherwise. Like execute() and</td></tr>
<tr><td class="h"><a name="5776"></a>5776</td><td></td><td></td><td></td><td></td><td class="s">execute_array() a zero is returned as &quot;0E0&quot; so execute_for_fetch() is</td></tr>
<tr><td class="h"><a name="5777"></a>5777</td><td></td><td></td><td></td><td></td><td class="s">only false on error.  If there were any errors the @tuple_status array</td></tr>
<tr><td class="h"><a name="5778"></a>5778</td><td></td><td></td><td></td><td></td><td class="s">can be used to discover which tuples failed and with what errors.</td></tr>
<tr><td class="h"><a name="5779"></a>5779</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5780"></a>5780</td><td></td><td></td><td></td><td></td><td class="s">When called in list context execute_for_fetch() returns two scalars;</td></tr>
<tr><td class="h"><a name="5781"></a>5781</td><td></td><td></td><td></td><td></td><td class="s">$tuples is the same as calling execute_for_fetch() in scalar context and $rows is</td></tr>
<tr><td class="h"><a name="5782"></a>5782</td><td></td><td></td><td></td><td></td><td class="s">the sum of the number of rows affected for each tuple, if available or -1</td></tr>
<tr><td class="h"><a name="5783"></a>5783</td><td></td><td></td><td></td><td></td><td class="s">if the driver cannot determine this.</td></tr>
<tr><td class="h"><a name="5784"></a>5784</td><td></td><td></td><td></td><td></td><td class="s">If you are doing an update operation the returned rows affected may not be what</td></tr>
<tr><td class="h"><a name="5785"></a>5785</td><td></td><td></td><td></td><td></td><td class="s">you expect if, for instance, one or more of the tuples affected the same row</td></tr>
<tr><td class="h"><a name="5786"></a>5786</td><td></td><td></td><td></td><td></td><td class="s">multiple times.  Some drivers may not yet support list context, in which case</td></tr>
<tr><td class="h"><a name="5787"></a>5787</td><td></td><td></td><td></td><td></td><td class="s">$rows will be undef, or may not be able to provide the number of rows affected</td></tr>
<tr><td class="h"><a name="5788"></a>5788</td><td></td><td></td><td></td><td></td><td class="s">when performing this batch operation, in which case $rows will be -1.</td></tr>
<tr><td class="h"><a name="5789"></a>5789</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5790"></a>5790</td><td></td><td></td><td></td><td></td><td class="s">If \@tuple_status is passed then the execute_for_fetch method uses</td></tr>
<tr><td class="h"><a name="5791"></a>5791</td><td></td><td></td><td></td><td></td><td class="s">it to return status information. The tuple_status array holds one</td></tr>
<tr><td class="h"><a name="5792"></a>5792</td><td></td><td></td><td></td><td></td><td class="s">element per tuple. If the corresponding execute() did not fail then</td></tr>
<tr><td class="h"><a name="5793"></a>5793</td><td></td><td></td><td></td><td></td><td class="s">the element holds the return value from execute(), which is typically</td></tr>
<tr><td class="h"><a name="5794"></a>5794</td><td></td><td></td><td></td><td></td><td class="s">a row count. If the execute() did fail then the element holds a</td></tr>
<tr><td class="h"><a name="5795"></a>5795</td><td></td><td></td><td></td><td></td><td class="s">reference to an array containing ($sth-&gt;err, $sth-&gt;errstr, $sth-&gt;state).</td></tr>
<tr><td class="h"><a name="5796"></a>5796</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5797"></a>5797</td><td></td><td></td><td></td><td></td><td class="s">If the driver detects an error that it knows means no further tuples can be</td></tr>
<tr><td class="h"><a name="5798"></a>5798</td><td></td><td></td><td></td><td></td><td class="s">executed then it may return, with an error status, even though $fetch_tuple_sub</td></tr>
<tr><td class="h"><a name="5799"></a>5799</td><td></td><td></td><td></td><td></td><td class="s">may still have more tuples to be executed.</td></tr>
<tr><td class="h"><a name="5800"></a>5800</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5801"></a>5801</td><td></td><td></td><td></td><td></td><td class="s">Although each tuple returned by $fetch_tuple_sub is effectively used</td></tr>
<tr><td class="h"><a name="5802"></a>5802</td><td></td><td></td><td></td><td></td><td class="s">to call $sth-&gt;execute(@$tuple_array_ref) the exact timing may vary.</td></tr>
<tr><td class="h"><a name="5803"></a>5803</td><td></td><td></td><td></td><td></td><td class="s">Drivers are free to accumulate sets of tuples to pass to the</td></tr>
<tr><td class="h"><a name="5804"></a>5804</td><td></td><td></td><td></td><td></td><td class="s">database server in bulk group operations for more efficient execution.</td></tr>
<tr><td class="h"><a name="5805"></a>5805</td><td></td><td></td><td></td><td></td><td class="s">However, the $fetch_tuple_sub is specifically allowed to return</td></tr>
<tr><td class="h"><a name="5806"></a>5806</td><td></td><td></td><td></td><td></td><td class="s">the same array reference each time (which is what fetchrow_arrayref()</td></tr>
<tr><td class="h"><a name="5807"></a>5807</td><td></td><td></td><td></td><td></td><td class="s">usually does).</td></tr>
<tr><td class="h"><a name="5808"></a>5808</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5809"></a>5809</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="5810"></a>5810</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5811"></a>5811</td><td></td><td></td><td></td><td></td><td class="s">  my $sel = $dbh1-&gt;prepare(&quot;select foo, bar from table1&quot;);</td></tr>
<tr><td class="h"><a name="5812"></a>5812</td><td></td><td></td><td></td><td></td><td class="s">  $sel-&gt;execute;</td></tr>
<tr><td class="h"><a name="5813"></a>5813</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5814"></a>5814</td><td></td><td></td><td></td><td></td><td class="s">  my $ins = $dbh2-&gt;prepare(&quot;insert into table2 (foo, bar) values (?,?)&quot;);</td></tr>
<tr><td class="h"><a name="5815"></a>5815</td><td></td><td></td><td></td><td></td><td class="s">  my $fetch_tuple_sub = sub { $sel-&gt;fetchrow_arrayref };</td></tr>
<tr><td class="h"><a name="5816"></a>5816</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5817"></a>5817</td><td></td><td></td><td></td><td></td><td class="s">  my @tuple_status;</td></tr>
<tr><td class="h"><a name="5818"></a>5818</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $ins-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);</td></tr>
<tr><td class="h"><a name="5819"></a>5819</td><td></td><td></td><td></td><td></td><td class="s">  my @errors = grep { ref $_ } @tuple_status;</td></tr>
<tr><td class="h"><a name="5820"></a>5820</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5821"></a>5821</td><td></td><td></td><td></td><td></td><td class="s">Similarly, if you already have an array containing the data rows</td></tr>
<tr><td class="h"><a name="5822"></a>5822</td><td></td><td></td><td></td><td></td><td class="s">to be processed you'd use a subroutine to shift off and return</td></tr>
<tr><td class="h"><a name="5823"></a>5823</td><td></td><td></td><td></td><td></td><td class="s">each array ref in turn:</td></tr>
<tr><td class="h"><a name="5824"></a>5824</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5825"></a>5825</td><td></td><td></td><td></td><td></td><td class="s">  $ins-&gt;execute_for_fetch( sub { shift @array_of_arrays }, \@tuple_status);</td></tr>
<tr><td class="h"><a name="5826"></a>5826</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5827"></a>5827</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;execute_for_fetch&gt; method was added in DBI 1.38.</td></tr>
<tr><td class="h"><a name="5828"></a>5828</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5829"></a>5829</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5830"></a>5830</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;fetchrow_arrayref&gt;</td></tr>
<tr><td class="h"><a name="5831"></a>5831</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5832"></a>5832</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $sth-&gt;fetchrow_arrayref;</td></tr>
<tr><td class="h"><a name="5833"></a>5833</td><td></td><td></td><td></td><td></td><td class="s">  $ary_ref = $sth-&gt;fetch;    # alias</td></tr>
<tr><td class="h"><a name="5834"></a>5834</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5835"></a>5835</td><td></td><td></td><td></td><td></td><td class="s">Fetches the next row of data and returns a reference to an array</td></tr>
<tr><td class="h"><a name="5836"></a>5836</td><td></td><td></td><td></td><td></td><td class="s">holding the field values.  Null fields are returned as C&lt;undef&gt;</td></tr>
<tr><td class="h"><a name="5837"></a>5837</td><td></td><td></td><td></td><td></td><td class="s">values in the array.</td></tr>
<tr><td class="h"><a name="5838"></a>5838</td><td></td><td></td><td></td><td></td><td class="s">This is the fastest way to fetch data, particularly if used with</td></tr>
<tr><td class="h"><a name="5839"></a>5839</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$sth-E&lt;gt&gt;bind_columns&gt;.</td></tr>
<tr><td class="h"><a name="5840"></a>5840</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5841"></a>5841</td><td></td><td></td><td></td><td></td><td class="s">If there are no more rows or if an error occurs, then C&lt;fetchrow_arrayref&gt;</td></tr>
<tr><td class="h"><a name="5842"></a>5842</td><td></td><td></td><td></td><td></td><td class="s">returns an C&lt;undef&gt;. You should check C&lt;$sth-E&lt;gt&gt;err&gt; afterwards (or use the</td></tr>
<tr><td class="h"><a name="5843"></a>5843</td><td></td><td></td><td></td><td></td><td class="s">C&lt;RaiseError&gt; attribute) to discover if the C&lt;undef&gt; returned was due to an</td></tr>
<tr><td class="h"><a name="5844"></a>5844</td><td></td><td></td><td></td><td></td><td class="s">error.</td></tr>
<tr><td class="h"><a name="5845"></a>5845</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5846"></a>5846</td><td></td><td></td><td></td><td></td><td class="s">Note that the same array reference is returned for each fetch, so don't</td></tr>
<tr><td class="h"><a name="5847"></a>5847</td><td></td><td></td><td></td><td></td><td class="s">store the reference and then use it after a later fetch.  Also, the</td></tr>
<tr><td class="h"><a name="5848"></a>5848</td><td></td><td></td><td></td><td></td><td class="s">elements of the array are also reused for each row, so take care if you</td></tr>
<tr><td class="h"><a name="5849"></a>5849</td><td></td><td></td><td></td><td></td><td class="s">want to take a reference to an element. See also L&lt;/bind_columns&gt;.</td></tr>
<tr><td class="h"><a name="5850"></a>5850</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5851"></a>5851</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;fetchrow_array&gt;</td></tr>
<tr><td class="h"><a name="5852"></a>5852</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5853"></a>5853</td><td></td><td></td><td></td><td></td><td class="s"> @ary = $sth-&gt;fetchrow_array;</td></tr>
<tr><td class="h"><a name="5854"></a>5854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5855"></a>5855</td><td></td><td></td><td></td><td></td><td class="s">An alternative to C&lt;fetchrow_arrayref&gt;. Fetches the next row of data</td></tr>
<tr><td class="h"><a name="5856"></a>5856</td><td></td><td></td><td></td><td></td><td class="s">and returns it as a list containing the field values.  Null fields</td></tr>
<tr><td class="h"><a name="5857"></a>5857</td><td></td><td></td><td></td><td></td><td class="s">are returned as C&lt;undef&gt; values in the list.</td></tr>
<tr><td class="h"><a name="5858"></a>5858</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5859"></a>5859</td><td></td><td></td><td></td><td></td><td class="s">If there are no more rows or if an error occurs, then C&lt;fetchrow_array&gt;</td></tr>
<tr><td class="h"><a name="5860"></a>5860</td><td></td><td></td><td></td><td></td><td class="s">returns an empty list. You should check C&lt;$sth-E&lt;gt&gt;err&gt; afterwards (or use</td></tr>
<tr><td class="h"><a name="5861"></a>5861</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;RaiseError&gt; attribute) to discover if the empty list returned was</td></tr>
<tr><td class="h"><a name="5862"></a>5862</td><td></td><td></td><td></td><td></td><td class="s">due to an error.</td></tr>
<tr><td class="h"><a name="5863"></a>5863</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5864"></a>5864</td><td></td><td></td><td></td><td></td><td class="s">If called in a scalar context for a statement handle that has more</td></tr>
<tr><td class="h"><a name="5865"></a>5865</td><td></td><td></td><td></td><td></td><td class="s">than one column, it is undefined whether the driver will return</td></tr>
<tr><td class="h"><a name="5866"></a>5866</td><td></td><td></td><td></td><td></td><td class="s">the value of the first column or the last. So don't do that.</td></tr>
<tr><td class="h"><a name="5867"></a>5867</td><td></td><td></td><td></td><td></td><td class="s">Also, in a scalar context, an C&lt;undef&gt; is returned if there are no</td></tr>
<tr><td class="h"><a name="5868"></a>5868</td><td></td><td></td><td></td><td></td><td class="s">more rows or if an error occurred. That C&lt;undef&gt; can't be distinguished</td></tr>
<tr><td class="h"><a name="5869"></a>5869</td><td></td><td></td><td></td><td></td><td class="s">from an C&lt;undef&gt; returned because the first field value was NULL.</td></tr>
<tr><td class="h"><a name="5870"></a>5870</td><td></td><td></td><td></td><td></td><td class="s">For these reasons you should exercise some caution if you use</td></tr>
<tr><td class="h"><a name="5871"></a>5871</td><td></td><td></td><td></td><td></td><td class="s">C&lt;fetchrow_array&gt; in a scalar context.</td></tr>
<tr><td class="h"><a name="5872"></a>5872</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5873"></a>5873</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;fetchrow_hashref&gt;</td></tr>
<tr><td class="h"><a name="5874"></a>5874</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5875"></a>5875</td><td></td><td></td><td></td><td></td><td class="s"> $hash_ref = $sth-&gt;fetchrow_hashref;</td></tr>
<tr><td class="h"><a name="5876"></a>5876</td><td></td><td></td><td></td><td></td><td class="s"> $hash_ref = $sth-&gt;fetchrow_hashref($name);</td></tr>
<tr><td class="h"><a name="5877"></a>5877</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5878"></a>5878</td><td></td><td></td><td></td><td></td><td class="s">An alternative to C&lt;fetchrow_arrayref&gt;. Fetches the next row of data</td></tr>
<tr><td class="h"><a name="5879"></a>5879</td><td></td><td></td><td></td><td></td><td class="s">and returns it as a reference to a hash containing field name and field</td></tr>
<tr><td class="h"><a name="5880"></a>5880</td><td></td><td></td><td></td><td></td><td class="s">value pairs.  Null fields are returned as C&lt;undef&gt; values in the hash.</td></tr>
<tr><td class="h"><a name="5881"></a>5881</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5882"></a>5882</td><td></td><td></td><td></td><td></td><td class="s">If there are no more rows or if an error occurs, then C&lt;fetchrow_hashref&gt;</td></tr>
<tr><td class="h"><a name="5883"></a>5883</td><td></td><td></td><td></td><td></td><td class="s">returns an C&lt;undef&gt;. You should check C&lt;$sth-E&lt;gt&gt;err&gt; afterwards (or use the</td></tr>
<tr><td class="h"><a name="5884"></a>5884</td><td></td><td></td><td></td><td></td><td class="s">C&lt;RaiseError&gt; attribute) to discover if the C&lt;undef&gt; returned was due to an</td></tr>
<tr><td class="h"><a name="5885"></a>5885</td><td></td><td></td><td></td><td></td><td class="s">error.</td></tr>
<tr><td class="h"><a name="5886"></a>5886</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5887"></a>5887</td><td></td><td></td><td></td><td></td><td class="s">The optional C&lt;$name&gt; parameter specifies the name of the statement handle</td></tr>
<tr><td class="h"><a name="5888"></a>5888</td><td></td><td></td><td></td><td></td><td class="s">attribute. For historical reasons it defaults to &quot;C&lt;NAME&gt;&quot;, however using either</td></tr>
<tr><td class="h"><a name="5889"></a>5889</td><td></td><td></td><td></td><td></td><td class="s">&quot;C&lt;NAME_lc&gt;&quot; or &quot;C&lt;NAME_uc&gt;&quot; is recomended for portability.</td></tr>
<tr><td class="h"><a name="5890"></a>5890</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5891"></a>5891</td><td></td><td></td><td></td><td></td><td class="s">The keys of the hash are the same names returned by C&lt;$sth-E&lt;gt&gt;{$name}&gt;. If</td></tr>
<tr><td class="h"><a name="5892"></a>5892</td><td></td><td></td><td></td><td></td><td class="s">more than one field has the same name, there will only be one entry in</td></tr>
<tr><td class="h"><a name="5893"></a>5893</td><td></td><td></td><td></td><td></td><td class="s">the returned hash for those fields.</td></tr>
<tr><td class="h"><a name="5894"></a>5894</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5895"></a>5895</td><td></td><td></td><td></td><td></td><td class="s">Because of the extra work C&lt;fetchrow_hashref&gt; and Perl have to perform, it</td></tr>
<tr><td class="h"><a name="5896"></a>5896</td><td></td><td></td><td></td><td></td><td class="s">is not as efficient as C&lt;fetchrow_arrayref&gt; or C&lt;fetchrow_array&gt;.</td></tr>
<tr><td class="h"><a name="5897"></a>5897</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5898"></a>5898</td><td></td><td></td><td></td><td></td><td class="s">By default a reference to a new hash is returned for each row.</td></tr>
<tr><td class="h"><a name="5899"></a>5899</td><td></td><td></td><td></td><td></td><td class="s">It is likely that a future version of the DBI will support an</td></tr>
<tr><td class="h"><a name="5900"></a>5900</td><td></td><td></td><td></td><td></td><td class="s">attribute which will enable the same hash to be reused for each</td></tr>
<tr><td class="h"><a name="5901"></a>5901</td><td></td><td></td><td></td><td></td><td class="s">row. This will give a significant performance boost, but it won't</td></tr>
<tr><td class="h"><a name="5902"></a>5902</td><td></td><td></td><td></td><td></td><td class="s">be enabled by default because of the risk of breaking old code.</td></tr>
<tr><td class="h"><a name="5903"></a>5903</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5904"></a>5904</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5905"></a>5905</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;fetchall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="5906"></a>5906</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5907"></a>5907</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref;</td></tr>
<tr><td class="h"><a name="5908"></a>5908</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref( $slice );</td></tr>
<tr><td class="h"><a name="5909"></a>5909</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref( $slice, $max_rows  );</td></tr>
<tr><td class="h"><a name="5910"></a>5910</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5911"></a>5911</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;fetchall_arrayref&gt; method can be used to fetch all the data to be</td></tr>
<tr><td class="h"><a name="5912"></a>5912</td><td></td><td></td><td></td><td></td><td class="s">returned from a prepared and executed statement handle. It returns a</td></tr>
<tr><td class="h"><a name="5913"></a>5913</td><td></td><td></td><td></td><td></td><td class="s">reference to an array that contains one reference per row.</td></tr>
<tr><td class="h"><a name="5914"></a>5914</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5915"></a>5915</td><td></td><td></td><td></td><td></td><td class="s">If there are no rows to return, C&lt;fetchall_arrayref&gt; returns a reference</td></tr>
<tr><td class="h"><a name="5916"></a>5916</td><td></td><td></td><td></td><td></td><td class="s">to an empty array. If an error occurs, C&lt;fetchall_arrayref&gt; returns the</td></tr>
<tr><td class="h"><a name="5917"></a>5917</td><td></td><td></td><td></td><td></td><td class="s">data fetched thus far, which may be none.  You should check C&lt;$sth-E&lt;gt&gt;err&gt;</td></tr>
<tr><td class="h"><a name="5918"></a>5918</td><td></td><td></td><td></td><td></td><td class="s">afterwards (or use the C&lt;RaiseError&gt; attribute) to discover if the data is</td></tr>
<tr><td class="h"><a name="5919"></a>5919</td><td></td><td></td><td></td><td></td><td class="s">complete or was truncated due to an error.</td></tr>
<tr><td class="h"><a name="5920"></a>5920</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5921"></a>5921</td><td></td><td></td><td></td><td></td><td class="s">If $slice is an array reference, C&lt;fetchall_arrayref&gt; uses L&lt;/fetchrow_arrayref&gt;</td></tr>
<tr><td class="h"><a name="5922"></a>5922</td><td></td><td></td><td></td><td></td><td class="s">to fetch each row as an array ref. If the $slice array is not empty</td></tr>
<tr><td class="h"><a name="5923"></a>5923</td><td></td><td></td><td></td><td></td><td class="s">then it is used as a slice to select individual columns by perl array</td></tr>
<tr><td class="h"><a name="5924"></a>5924</td><td></td><td></td><td></td><td></td><td class="s">index number (starting at 0, unlike column and parameter numbers which</td></tr>
<tr><td class="h"><a name="5925"></a>5925</td><td></td><td></td><td></td><td></td><td class="s">start at 1).</td></tr>
<tr><td class="h"><a name="5926"></a>5926</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5927"></a>5927</td><td></td><td></td><td></td><td></td><td class="s">With no parameters, or if $slice is undefined, C&lt;fetchall_arrayref&gt;</td></tr>
<tr><td class="h"><a name="5928"></a>5928</td><td></td><td></td><td></td><td></td><td class="s">acts as if passed an empty array ref.</td></tr>
<tr><td class="h"><a name="5929"></a>5929</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5930"></a>5930</td><td></td><td></td><td></td><td></td><td class="s">If $slice is a hash reference, C&lt;fetchall_arrayref&gt; uses L&lt;/fetchrow_hashref&gt;</td></tr>
<tr><td class="h"><a name="5931"></a>5931</td><td></td><td></td><td></td><td></td><td class="s">to fetch each row as a hash reference. If the $slice hash is empty then</td></tr>
<tr><td class="h"><a name="5932"></a>5932</td><td></td><td></td><td></td><td></td><td class="s">fetchrow_hashref() is simply called in a tight loop and the keys in the hashes</td></tr>
<tr><td class="h"><a name="5933"></a>5933</td><td></td><td></td><td></td><td></td><td class="s">have whatever name lettercase is returned by default from fetchrow_hashref.</td></tr>
<tr><td class="h"><a name="5934"></a>5934</td><td></td><td></td><td></td><td></td><td class="s">(See L&lt;/FetchHashKeyName&gt; attribute.) If the $slice hash is not</td></tr>
<tr><td class="h"><a name="5935"></a>5935</td><td></td><td></td><td></td><td></td><td class="s">empty, then it is used as a slice to select individual columns by</td></tr>
<tr><td class="h"><a name="5936"></a>5936</td><td></td><td></td><td></td><td></td><td class="s">name.  The values of the hash should be set to 1.  The key names</td></tr>
<tr><td class="h"><a name="5937"></a>5937</td><td></td><td></td><td></td><td></td><td class="s">of the returned hashes match the letter case of the names in the</td></tr>
<tr><td class="h"><a name="5938"></a>5938</td><td></td><td></td><td></td><td></td><td class="s">parameter hash, regardless of the L&lt;/FetchHashKeyName&gt; attribute.</td></tr>
<tr><td class="h"><a name="5939"></a>5939</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5940"></a>5940</td><td></td><td></td><td></td><td></td><td class="s">For example, to fetch just the first column of every row:</td></tr>
<tr><td class="h"><a name="5941"></a>5941</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5942"></a>5942</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref([0]);</td></tr>
<tr><td class="h"><a name="5943"></a>5943</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5944"></a>5944</td><td></td><td></td><td></td><td></td><td class="s">To fetch the second to last and last column of every row:</td></tr>
<tr><td class="h"><a name="5945"></a>5945</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5946"></a>5946</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref([-2,-1]);</td></tr>
<tr><td class="h"><a name="5947"></a>5947</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5948"></a>5948</td><td></td><td></td><td></td><td></td><td class="s">To fetch all fields of every row as a hash ref:</td></tr>
<tr><td class="h"><a name="5949"></a>5949</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5950"></a>5950</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref({});</td></tr>
<tr><td class="h"><a name="5951"></a>5951</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5952"></a>5952</td><td></td><td></td><td></td><td></td><td class="s">To fetch only the fields called &quot;foo&quot; and &quot;bar&quot; of every row as a hash ref</td></tr>
<tr><td class="h"><a name="5953"></a>5953</td><td></td><td></td><td></td><td></td><td class="s">(with keys named &quot;foo&quot; and &quot;BAR&quot;):</td></tr>
<tr><td class="h"><a name="5954"></a>5954</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5955"></a>5955</td><td></td><td></td><td></td><td></td><td class="s">  $tbl_ary_ref = $sth-&gt;fetchall_arrayref({ foo=&gt;1, BAR=&gt;1 });</td></tr>
<tr><td class="h"><a name="5956"></a>5956</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5957"></a>5957</td><td></td><td></td><td></td><td></td><td class="s">The first two examples return a reference to an array of array refs.</td></tr>
<tr><td class="h"><a name="5958"></a>5958</td><td></td><td></td><td></td><td></td><td class="s">The third and forth return a reference to an array of hash refs.</td></tr>
<tr><td class="h"><a name="5959"></a>5959</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5960"></a>5960</td><td></td><td></td><td></td><td></td><td class="s">If $max_rows is defined and greater than or equal to zero then it</td></tr>
<tr><td class="h"><a name="5961"></a>5961</td><td></td><td></td><td></td><td></td><td class="s">is used to limit the number of rows fetched before returning.</td></tr>
<tr><td class="h"><a name="5962"></a>5962</td><td></td><td></td><td></td><td></td><td class="s">fetchall_arrayref() can then be called again to fetch more rows.</td></tr>
<tr><td class="h"><a name="5963"></a>5963</td><td></td><td></td><td></td><td></td><td class="s">This is especially useful when you need the better performance of</td></tr>
<tr><td class="h"><a name="5964"></a>5964</td><td></td><td></td><td></td><td></td><td class="s">fetchall_arrayref() but don't have enough memory to fetch and return</td></tr>
<tr><td class="h"><a name="5965"></a>5965</td><td></td><td></td><td></td><td></td><td class="s">all the rows in one go.</td></tr>
<tr><td class="h"><a name="5966"></a>5966</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5967"></a>5967</td><td></td><td></td><td></td><td></td><td class="s">Here's an example (assumes RaiseError is enabled):</td></tr>
<tr><td class="h"><a name="5968"></a>5968</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5969"></a>5969</td><td></td><td></td><td></td><td></td><td class="s">  my $rows = []; # cache for batches of rows</td></tr>
<tr><td class="h"><a name="5970"></a>5970</td><td></td><td></td><td></td><td></td><td class="s">  while( my $row = ( shift(@$rows) || # get row from cache, or reload cache:</td></tr>
<tr><td class="h"><a name="5971"></a>5971</td><td></td><td></td><td></td><td></td><td class="s">                     shift(@{$rows=$sth-&gt;fetchall_arrayref(undef,10_000)||[]}) )</td></tr>
<tr><td class="h"><a name="5972"></a>5972</td><td></td><td></td><td></td><td></td><td class="s">  ) {</td></tr>
<tr><td class="h"><a name="5973"></a>5973</td><td></td><td></td><td></td><td></td><td class="s">    ...</td></tr>
<tr><td class="h"><a name="5974"></a>5974</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="5975"></a>5975</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5976"></a>5976</td><td></td><td></td><td></td><td></td><td class="s">That I&lt;might&gt; be the fastest way to fetch and process lots of rows using the DBI,</td></tr>
<tr><td class="h"><a name="5977"></a>5977</td><td></td><td></td><td></td><td></td><td class="s">but it depends on the relative cost of method calls vs memory allocation.</td></tr>
<tr><td class="h"><a name="5978"></a>5978</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5979"></a>5979</td><td></td><td></td><td></td><td></td><td class="s">A standard C&lt;while&gt; loop with column binding is often faster because</td></tr>
<tr><td class="h"><a name="5980"></a>5980</td><td></td><td></td><td></td><td></td><td class="s">the cost of allocating memory for the batch of rows is greater than</td></tr>
<tr><td class="h"><a name="5981"></a>5981</td><td></td><td></td><td></td><td></td><td class="s">the saving by reducing method calls. It's possible that the DBI may</td></tr>
<tr><td class="h"><a name="5982"></a>5982</td><td></td><td></td><td></td><td></td><td class="s">provide a way to reuse the memory of a previous batch in future, which</td></tr>
<tr><td class="h"><a name="5983"></a>5983</td><td></td><td></td><td></td><td></td><td class="s">would then shift the balance back towards fetchall_arrayref().</td></tr>
<tr><td class="h"><a name="5984"></a>5984</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5985"></a>5985</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5986"></a>5986</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;fetchall_hashref&gt;</td></tr>
<tr><td class="h"><a name="5987"></a>5987</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5988"></a>5988</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $sth-&gt;fetchall_hashref($key_field);</td></tr>
<tr><td class="h"><a name="5989"></a>5989</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5990"></a>5990</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;fetchall_hashref&gt; method can be used to fetch all the data to be</td></tr>
<tr><td class="h"><a name="5991"></a>5991</td><td></td><td></td><td></td><td></td><td class="s">returned from a prepared and executed statement handle. It returns a reference</td></tr>
<tr><td class="h"><a name="5992"></a>5992</td><td></td><td></td><td></td><td></td><td class="s">to a hash containing a key for each distinct value of the $key_field column</td></tr>
<tr><td class="h"><a name="5993"></a>5993</td><td></td><td></td><td></td><td></td><td class="s">that was fetched. For each key the corresponding value is a reference to a hash</td></tr>
<tr><td class="h"><a name="5994"></a>5994</td><td></td><td></td><td></td><td></td><td class="s">containing all the selected columns and their values, as returned by fetchrow_hashref().</td></tr>
<tr><td class="h"><a name="5995"></a>5995</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5996"></a>5996</td><td></td><td></td><td></td><td></td><td class="s">If there are no rows to return, C&lt;fetchall_hashref&gt; returns a reference</td></tr>
<tr><td class="h"><a name="5997"></a>5997</td><td></td><td></td><td></td><td></td><td class="s">to an empty hash. If an error occurs, C&lt;fetchall_hashref&gt; returns the</td></tr>
<tr><td class="h"><a name="5998"></a>5998</td><td></td><td></td><td></td><td></td><td class="s">data fetched thus far, which may be none.  You should check</td></tr>
<tr><td class="h"><a name="5999"></a>5999</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$sth-E&lt;gt&gt;err&gt; afterwards (or use the C&lt;RaiseError&gt; attribute) to</td></tr>
<tr><td class="h"><a name="6000"></a>6000</td><td></td><td></td><td></td><td></td><td class="s">discover if the data is complete or was truncated due to an error.</td></tr>
<tr><td class="h"><a name="6001"></a>6001</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6002"></a>6002</td><td></td><td></td><td></td><td></td><td class="s">The $key_field parameter provides the name of the field that holds the</td></tr>
<tr><td class="h"><a name="6003"></a>6003</td><td></td><td></td><td></td><td></td><td class="s">value to be used for the key for the returned hash.  For example:</td></tr>
<tr><td class="h"><a name="6004"></a>6004</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6005"></a>6005</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{FetchHashKeyName} = 'NAME_lc';</td></tr>
<tr><td class="h"><a name="6006"></a>6006</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;SELECT FOO, BAR, ID, NAME, BAZ FROM TABLE&quot;);</td></tr>
<tr><td class="h"><a name="6007"></a>6007</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="6008"></a>6008</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $sth-&gt;fetchall_hashref('id');</td></tr>
<tr><td class="h"><a name="6009"></a>6009</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;Name for id 42 is $hash_ref-&gt;{42}-&gt;{name}\n&quot;;</td></tr>
<tr><td class="h"><a name="6010"></a>6010</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6011"></a>6011</td><td></td><td></td><td></td><td></td><td class="s">The $key_field parameter can also be specified as an integer column</td></tr>
<tr><td class="h"><a name="6012"></a>6012</td><td></td><td></td><td></td><td></td><td class="s">number (counting from 1).  If $key_field doesn't match any column in</td></tr>
<tr><td class="h"><a name="6013"></a>6013</td><td></td><td></td><td></td><td></td><td class="s">the statement, as a name first then as a number, then an error is</td></tr>
<tr><td class="h"><a name="6014"></a>6014</td><td></td><td></td><td></td><td></td><td class="s">returned.</td></tr>
<tr><td class="h"><a name="6015"></a>6015</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6016"></a>6016</td><td></td><td></td><td></td><td></td><td class="s">For queries returing more than one 'key' column, you can specify</td></tr>
<tr><td class="h"><a name="6017"></a>6017</td><td></td><td></td><td></td><td></td><td class="s">multiple column names by passing $key_field as a reference to an</td></tr>
<tr><td class="h"><a name="6018"></a>6018</td><td></td><td></td><td></td><td></td><td class="s">array containing one or more key column names (or index numbers).</td></tr>
<tr><td class="h"><a name="6019"></a>6019</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="6020"></a>6020</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6021"></a>6021</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;SELECT foo, bar, baz FROM table&quot;);</td></tr>
<tr><td class="h"><a name="6022"></a>6022</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="6023"></a>6023</td><td></td><td></td><td></td><td></td><td class="s">  $hash_ref = $sth-&gt;fetchall_hashref( [ qw(foo bar) ] );</td></tr>
<tr><td class="h"><a name="6024"></a>6024</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;For foo 42 and bar 38, baz is $hash_ref-&gt;{42}-&gt;{38}-&gt;{baz}\n&quot;;</td></tr>
<tr><td class="h"><a name="6025"></a>6025</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6026"></a>6026</td><td></td><td></td><td></td><td></td><td class="s">The fetchall_hashref() method is normally used only where the key</td></tr>
<tr><td class="h"><a name="6027"></a>6027</td><td></td><td></td><td></td><td></td><td class="s">fields values for each row are unique.  If multiple rows are returned</td></tr>
<tr><td class="h"><a name="6028"></a>6028</td><td></td><td></td><td></td><td></td><td class="s">with the same values for the key fields then later rows overwrite</td></tr>
<tr><td class="h"><a name="6029"></a>6029</td><td></td><td></td><td></td><td></td><td class="s">earlier ones.</td></tr>
<tr><td class="h"><a name="6030"></a>6030</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6031"></a>6031</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;finish&gt;</td></tr>
<tr><td class="h"><a name="6032"></a>6032</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6033"></a>6033</td><td></td><td></td><td></td><td></td><td class="s">  $rc  = $sth-&gt;finish;</td></tr>
<tr><td class="h"><a name="6034"></a>6034</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6035"></a>6035</td><td></td><td></td><td></td><td></td><td class="s">Indicate that no more data will be fetched from this statement handle</td></tr>
<tr><td class="h"><a name="6036"></a>6036</td><td></td><td></td><td></td><td></td><td class="s">before it is either executed again or destroyed.  The C&lt;finish&gt; method</td></tr>
<tr><td class="h"><a name="6037"></a>6037</td><td></td><td></td><td></td><td></td><td class="s">is rarely needed, and frequently overused, but can sometimes be</td></tr>
<tr><td class="h"><a name="6038"></a>6038</td><td></td><td></td><td></td><td></td><td class="s">helpful in a few very specific situations to allow the server to free</td></tr>
<tr><td class="h"><a name="6039"></a>6039</td><td></td><td></td><td></td><td></td><td class="s">up resources (such as sort buffers).</td></tr>
<tr><td class="h"><a name="6040"></a>6040</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6041"></a>6041</td><td></td><td></td><td></td><td></td><td class="s">When all the data has been fetched from a C&lt;SELECT&gt; statement, the</td></tr>
<tr><td class="h"><a name="6042"></a>6042</td><td></td><td></td><td></td><td></td><td class="s">driver should automatically call C&lt;finish&gt; for you. So you should</td></tr>
<tr><td class="h"><a name="6043"></a>6043</td><td></td><td></td><td></td><td></td><td class="s">I&lt;not&gt; normally need to call it explicitly I&lt;except&gt; when you know</td></tr>
<tr><td class="h"><a name="6044"></a>6044</td><td></td><td></td><td></td><td></td><td class="s">that you've not fetched all the data from a statement handle.</td></tr>
<tr><td class="h"><a name="6045"></a>6045</td><td></td><td></td><td></td><td></td><td class="s">The most common example is when you only want to fetch one row,</td></tr>
<tr><td class="h"><a name="6046"></a>6046</td><td></td><td></td><td></td><td></td><td class="s">but in that case the C&lt;selectrow_*&gt; methods are usually better anyway.</td></tr>
<tr><td class="h"><a name="6047"></a>6047</td><td></td><td></td><td></td><td></td><td class="s">Adding calls to C&lt;finish&gt; after each fetch loop is a common mistake,</td></tr>
<tr><td class="h"><a name="6048"></a>6048</td><td></td><td></td><td></td><td></td><td class="s">don't do it, it can mask genuine problems like uncaught fetch errors.</td></tr>
<tr><td class="h"><a name="6049"></a>6049</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6050"></a>6050</td><td></td><td></td><td></td><td></td><td class="s">Consider a query like:</td></tr>
<tr><td class="h"><a name="6051"></a>6051</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6052"></a>6052</td><td></td><td></td><td></td><td></td><td class="s">  SELECT foo FROM table WHERE bar=? ORDER BY foo</td></tr>
<tr><td class="h"><a name="6053"></a>6053</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6054"></a>6054</td><td></td><td></td><td></td><td></td><td class="s">where you want to select just the first (smallest) &quot;foo&quot; value from a</td></tr>
<tr><td class="h"><a name="6055"></a>6055</td><td></td><td></td><td></td><td></td><td class="s">very large table. When executed, the database server will have to use</td></tr>
<tr><td class="h"><a name="6056"></a>6056</td><td></td><td></td><td></td><td></td><td class="s">temporary buffer space to store the sorted rows. If, after executing</td></tr>
<tr><td class="h"><a name="6057"></a>6057</td><td></td><td></td><td></td><td></td><td class="s">the handle and selecting one row, the handle won't be re-executed for</td></tr>
<tr><td class="h"><a name="6058"></a>6058</td><td></td><td></td><td></td><td></td><td class="s">some time and won't be destroyed, the C&lt;finish&gt; method can be used to tell</td></tr>
<tr><td class="h"><a name="6059"></a>6059</td><td></td><td></td><td></td><td></td><td class="s">the server that the buffer space can be freed.</td></tr>
<tr><td class="h"><a name="6060"></a>6060</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6061"></a>6061</td><td></td><td></td><td></td><td></td><td class="s">Calling C&lt;finish&gt; resets the L&lt;/Active&gt; attribute for the statement.  It</td></tr>
<tr><td class="h"><a name="6062"></a>6062</td><td></td><td></td><td></td><td></td><td class="s">may also make some statement handle attributes (such as C&lt;NAME&gt; and C&lt;TYPE&gt;)</td></tr>
<tr><td class="h"><a name="6063"></a>6063</td><td></td><td></td><td></td><td></td><td class="s">unavailable if they have not already been accessed (and thus cached).</td></tr>
<tr><td class="h"><a name="6064"></a>6064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6065"></a>6065</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;finish&gt; method does not affect the transaction status of the</td></tr>
<tr><td class="h"><a name="6066"></a>6066</td><td></td><td></td><td></td><td></td><td class="s">database connection.  It has nothing to do with transactions. It's mostly an</td></tr>
<tr><td class="h"><a name="6067"></a>6067</td><td></td><td></td><td></td><td></td><td class="s">internal &quot;housekeeping&quot; method that is rarely needed.</td></tr>
<tr><td class="h"><a name="6068"></a>6068</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/disconnect&gt; and the L&lt;/Active&gt; attribute.</td></tr>
<tr><td class="h"><a name="6069"></a>6069</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6070"></a>6070</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;finish&gt; method should have been called C&lt;discard_pending_rows&gt;.</td></tr>
<tr><td class="h"><a name="6071"></a>6071</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6072"></a>6072</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6073"></a>6073</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;rows&gt;</td></tr>
<tr><td class="h"><a name="6074"></a>6074</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6075"></a>6075</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;rows;</td></tr>
<tr><td class="h"><a name="6076"></a>6076</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6077"></a>6077</td><td></td><td></td><td></td><td></td><td class="s">Returns the number of rows affected by the last row affecting command,</td></tr>
<tr><td class="h"><a name="6078"></a>6078</td><td></td><td></td><td></td><td></td><td class="s">or -1 if the number of rows is not known or not available.</td></tr>
<tr><td class="h"><a name="6079"></a>6079</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6080"></a>6080</td><td></td><td></td><td></td><td></td><td class="s">Generally, you can only rely on a row count after a I&lt;non&gt;-C&lt;SELECT&gt;</td></tr>
<tr><td class="h"><a name="6081"></a>6081</td><td></td><td></td><td></td><td></td><td class="s">C&lt;execute&gt; (for some specific operations like C&lt;UPDATE&gt; and C&lt;DELETE&gt;), or</td></tr>
<tr><td class="h"><a name="6082"></a>6082</td><td></td><td></td><td></td><td></td><td class="s">after fetching all the rows of a C&lt;SELECT&gt; statement.</td></tr>
<tr><td class="h"><a name="6083"></a>6083</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6084"></a>6084</td><td></td><td></td><td></td><td></td><td class="s">For C&lt;SELECT&gt; statements, it is generally not possible to know how many</td></tr>
<tr><td class="h"><a name="6085"></a>6085</td><td></td><td></td><td></td><td></td><td class="s">rows will be returned except by fetching them all.  Some drivers will</td></tr>
<tr><td class="h"><a name="6086"></a>6086</td><td></td><td></td><td></td><td></td><td class="s">return the number of rows the application has fetched so far, but</td></tr>
<tr><td class="h"><a name="6087"></a>6087</td><td></td><td></td><td></td><td></td><td class="s">others may return -1 until all rows have been fetched.  So use of the</td></tr>
<tr><td class="h"><a name="6088"></a>6088</td><td></td><td></td><td></td><td></td><td class="s">C&lt;rows&gt; method or C&lt;$DBI::rows&gt; with C&lt;SELECT&gt; statements is not</td></tr>
<tr><td class="h"><a name="6089"></a>6089</td><td></td><td></td><td></td><td></td><td class="s">recommended.</td></tr>
<tr><td class="h"><a name="6090"></a>6090</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6091"></a>6091</td><td></td><td></td><td></td><td></td><td class="s">One alternative method to get a row count for a C&lt;SELECT&gt; is to execute a</td></tr>
<tr><td class="h"><a name="6092"></a>6092</td><td></td><td></td><td></td><td></td><td class="s">&quot;SELECT COUNT(*) FROM ...&quot; SQL statement with the same &quot;...&quot; as your</td></tr>
<tr><td class="h"><a name="6093"></a>6093</td><td></td><td></td><td></td><td></td><td class="s">query and then fetch the row count from that.</td></tr>
<tr><td class="h"><a name="6094"></a>6094</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6095"></a>6095</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6096"></a>6096</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;bind_col&gt;</td></tr>
<tr><td class="h"><a name="6097"></a>6097</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6098"></a>6098</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind);</td></tr>
<tr><td class="h"><a name="6099"></a>6099</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind, \%attr );</td></tr>
<tr><td class="h"><a name="6100"></a>6100</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind, $bind_type );</td></tr>
<tr><td class="h"><a name="6101"></a>6101</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6102"></a>6102</td><td></td><td></td><td></td><td></td><td class="s">Binds a Perl variable and/or some attributes to an output column</td></tr>
<tr><td class="h"><a name="6103"></a>6103</td><td></td><td></td><td></td><td></td><td class="s">(field) of a C&lt;SELECT&gt; statement.  Column numbers count up from 1.</td></tr>
<tr><td class="h"><a name="6104"></a>6104</td><td></td><td></td><td></td><td></td><td class="s">You do not need to bind output columns in order to fetch data.</td></tr>
<tr><td class="h"><a name="6105"></a>6105</td><td></td><td></td><td></td><td></td><td class="s">For maximum portability between drivers, bind_col() should be called</td></tr>
<tr><td class="h"><a name="6106"></a>6106</td><td></td><td></td><td></td><td></td><td class="s">after execute() and not before.</td></tr>
<tr><td class="h"><a name="6107"></a>6107</td><td></td><td></td><td></td><td></td><td class="s">See also C&lt;bind_columns&gt; for an example.</td></tr>
<tr><td class="h"><a name="6108"></a>6108</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6109"></a>6109</td><td></td><td></td><td></td><td></td><td class="s">The binding is performed at a low level using Perl aliasing.</td></tr>
<tr><td class="h"><a name="6110"></a>6110</td><td></td><td></td><td></td><td></td><td class="s">Whenever a row is fetched from the database $var_to_bind appears</td></tr>
<tr><td class="h"><a name="6111"></a>6111</td><td></td><td></td><td></td><td></td><td class="s">to be automatically updated simply because it now refers to the same</td></tr>
<tr><td class="h"><a name="6112"></a>6112</td><td></td><td></td><td></td><td></td><td class="s">memory location as the corresponding column value.  This makes using</td></tr>
<tr><td class="h"><a name="6113"></a>6113</td><td></td><td></td><td></td><td></td><td class="s">bound variables very efficient.</td></tr>
<tr><td class="h"><a name="6114"></a>6114</td><td></td><td></td><td></td><td></td><td class="s">Binding a tied variable doesn't work, currently.</td></tr>
<tr><td class="h"><a name="6115"></a>6115</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6116"></a>6116</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/bind_param&gt; method</td></tr>
<tr><td class="h"><a name="6117"></a>6117</td><td></td><td></td><td></td><td></td><td class="s">performs a similar, but opposite, function for input variables.</td></tr>
<tr><td class="h"><a name="6118"></a>6118</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6119"></a>6119</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Data Types for Column Binding&gt;</td></tr>
<tr><td class="h"><a name="6120"></a>6120</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6121"></a>6121</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;\%attr&gt; parameter can be used to hint at the data type</td></tr>
<tr><td class="h"><a name="6122"></a>6122</td><td></td><td></td><td></td><td></td><td class="s">formatting the column should have. For example, you can use:</td></tr>
<tr><td class="h"><a name="6123"></a>6123</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6124"></a>6124</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_col(1, undef, { TYPE =&gt; SQL_DATETIME });</td></tr>
<tr><td class="h"><a name="6125"></a>6125</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6126"></a>6126</td><td></td><td></td><td></td><td></td><td class="s">to specify that you'd like the column (which presumably is some</td></tr>
<tr><td class="h"><a name="6127"></a>6127</td><td></td><td></td><td></td><td></td><td class="s">kind of datetime type) to be returned in the standard format for</td></tr>
<tr><td class="h"><a name="6128"></a>6128</td><td></td><td></td><td></td><td></td><td class="s">SQL_DATETIME, which is 'YYYY-MM-DD HH:MM:SS', rather than the</td></tr>
<tr><td class="h"><a name="6129"></a>6129</td><td></td><td></td><td></td><td></td><td class="s">native formatting the database would normally use.</td></tr>
<tr><td class="h"><a name="6130"></a>6130</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6131"></a>6131</td><td></td><td></td><td></td><td></td><td class="s">There's no $var_to_bind in that example to emphasize the point</td></tr>
<tr><td class="h"><a name="6132"></a>6132</td><td></td><td></td><td></td><td></td><td class="s">that bind_col() works on the underlying column value and not just</td></tr>
<tr><td class="h"><a name="6133"></a>6133</td><td></td><td></td><td></td><td></td><td class="s">a particular bound variable.</td></tr>
<tr><td class="h"><a name="6134"></a>6134</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6135"></a>6135</td><td></td><td></td><td></td><td></td><td class="s">As a short-cut for the common case, the data type can be passed</td></tr>
<tr><td class="h"><a name="6136"></a>6136</td><td></td><td></td><td></td><td></td><td class="s">directly, in place of the C&lt;\%attr&gt; hash reference. This example is</td></tr>
<tr><td class="h"><a name="6137"></a>6137</td><td></td><td></td><td></td><td></td><td class="s">equivalent to the one above:</td></tr>
<tr><td class="h"><a name="6138"></a>6138</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6139"></a>6139</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_col(1, undef, SQL_DATETIME);</td></tr>
<tr><td class="h"><a name="6140"></a>6140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6141"></a>6141</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;TYPE&gt; value indicates the standard (non-driver-specific) type for</td></tr>
<tr><td class="h"><a name="6142"></a>6142</td><td></td><td></td><td></td><td></td><td class="s">this parameter. To specify the driver-specific type, the driver may</td></tr>
<tr><td class="h"><a name="6143"></a>6143</td><td></td><td></td><td></td><td></td><td class="s">support a driver-specific attribute, such as C&lt;{ ora_type =E&lt;gt&gt; 97 }&gt;.</td></tr>
<tr><td class="h"><a name="6144"></a>6144</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6145"></a>6145</td><td></td><td></td><td></td><td></td><td class="s">The SQL_DATETIME and other related constants can be imported using</td></tr>
<tr><td class="h"><a name="6146"></a>6146</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6147"></a>6147</td><td></td><td></td><td></td><td></td><td class="s">  use DBI qw(:sql_types);</td></tr>
<tr><td class="h"><a name="6148"></a>6148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6149"></a>6149</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/&quot;DBI Constants&quot;&gt; for more information.</td></tr>
<tr><td class="h"><a name="6150"></a>6150</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6151"></a>6151</td><td></td><td></td><td></td><td></td><td class="s">The data type for a bind variable cannot be changed after the first</td></tr>
<tr><td class="h"><a name="6152"></a>6152</td><td></td><td></td><td></td><td></td><td class="s">C&lt;bind_col&gt; call. In fact the whole \%attr parameter is 'sticky'</td></tr>
<tr><td class="h"><a name="6153"></a>6153</td><td></td><td></td><td></td><td></td><td class="s">in the sense that a driver only needs to consider the \%attr parameter</td></tr>
<tr><td class="h"><a name="6154"></a>6154</td><td></td><td></td><td></td><td></td><td class="s">for the first call for a given $sth and column.</td></tr>
<tr><td class="h"><a name="6155"></a>6155</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6156"></a>6156</td><td></td><td></td><td></td><td></td><td class="s">The TYPE attribute for bind_col() was first specified in DBI 1.41.</td></tr>
<tr><td class="h"><a name="6157"></a>6157</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6158"></a>6158</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6159"></a>6159</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;bind_columns&gt;</td></tr>
<tr><td class="h"><a name="6160"></a>6160</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6161"></a>6161</td><td></td><td></td><td></td><td></td><td class="s">  $rc = $sth-&gt;bind_columns(@list_of_refs_to_vars_to_bind);</td></tr>
<tr><td class="h"><a name="6162"></a>6162</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6163"></a>6163</td><td></td><td></td><td></td><td></td><td class="s">Calls L&lt;/bind_col&gt; for each column of the C&lt;SELECT&gt; statement.</td></tr>
<tr><td class="h"><a name="6164"></a>6164</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6165"></a>6165</td><td></td><td></td><td></td><td></td><td class="s">The list of references should have the same number of elements as the number of</td></tr>
<tr><td class="h"><a name="6166"></a>6166</td><td></td><td></td><td></td><td></td><td class="s">columns in the C&lt;SELECT&gt; statement. If it doesn't then C&lt;bind_columns&gt; will</td></tr>
<tr><td class="h"><a name="6167"></a>6167</td><td></td><td></td><td></td><td></td><td class="s">bind the elements given, upto the number of columns, and then return an error.</td></tr>
<tr><td class="h"><a name="6168"></a>6168</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6169"></a>6169</td><td></td><td></td><td></td><td></td><td class="s">For maximum portability between drivers, bind_columns() should be called</td></tr>
<tr><td class="h"><a name="6170"></a>6170</td><td></td><td></td><td></td><td></td><td class="s">after execute() and not before.</td></tr>
<tr><td class="h"><a name="6171"></a>6171</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6172"></a>6172</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="6173"></a>6173</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6174"></a>6174</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{RaiseError} = 1; # do this, or check every call for errors</td></tr>
<tr><td class="h"><a name="6175"></a>6175</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(q{ SELECT region, sales FROM sales_by_region });</td></tr>
<tr><td class="h"><a name="6176"></a>6176</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="6177"></a>6177</td><td></td><td></td><td></td><td></td><td class="s">  my ($region, $sales);</td></tr>
<tr><td class="h"><a name="6178"></a>6178</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6179"></a>6179</td><td></td><td></td><td></td><td></td><td class="s">  # Bind Perl variables to columns:</td></tr>
<tr><td class="h"><a name="6180"></a>6180</td><td></td><td></td><td></td><td></td><td class="s">  $rv = $sth-&gt;bind_columns(\$region, \$sales);</td></tr>
<tr><td class="h"><a name="6181"></a>6181</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6182"></a>6182</td><td></td><td></td><td></td><td></td><td class="s">  # you can also use Perl's \(...) syntax (see perlref docs):</td></tr>
<tr><td class="h"><a name="6183"></a>6183</td><td></td><td></td><td></td><td></td><td class="s">  #     $sth-&gt;bind_columns(\($region, $sales));</td></tr>
<tr><td class="h"><a name="6184"></a>6184</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6185"></a>6185</td><td></td><td></td><td></td><td></td><td class="s">  # Column binding is the most efficient way to fetch data</td></tr>
<tr><td class="h"><a name="6186"></a>6186</td><td></td><td></td><td></td><td></td><td class="s">  while ($sth-&gt;fetch) {</td></tr>
<tr><td class="h"><a name="6187"></a>6187</td><td></td><td></td><td></td><td></td><td class="s">      print &quot;$region: $sales\n&quot;;</td></tr>
<tr><td class="h"><a name="6188"></a>6188</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6189"></a>6189</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6190"></a>6190</td><td></td><td></td><td></td><td></td><td class="s">For compatibility with old scripts, the first parameter will be</td></tr>
<tr><td class="h"><a name="6191"></a>6191</td><td></td><td></td><td></td><td></td><td class="s">ignored if it is C&lt;undef&gt; or a hash reference.</td></tr>
<tr><td class="h"><a name="6192"></a>6192</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6193"></a>6193</td><td></td><td></td><td></td><td></td><td class="s">Here's a more fancy example that binds columns to the values I&lt;inside&gt;</td></tr>
<tr><td class="h"><a name="6194"></a>6194</td><td></td><td></td><td></td><td></td><td class="s">a hash (thanks to H.Merijn Brand):</td></tr>
<tr><td class="h"><a name="6195"></a>6195</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6196"></a>6196</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="6197"></a>6197</td><td></td><td></td><td></td><td></td><td class="s">  my %row;</td></tr>
<tr><td class="h"><a name="6198"></a>6198</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;bind_columns( \( @row{ @{$sth-&gt;{NAME_lc} } } ));</td></tr>
<tr><td class="h"><a name="6199"></a>6199</td><td></td><td></td><td></td><td></td><td class="s">  while ($sth-&gt;fetch) {</td></tr>
<tr><td class="h"><a name="6200"></a>6200</td><td></td><td></td><td></td><td></td><td class="s">      print &quot;$row{region}: $row{sales}\n&quot;;</td></tr>
<tr><td class="h"><a name="6201"></a>6201</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6202"></a>6202</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6203"></a>6203</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6204"></a>6204</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;dump_results&gt;</td></tr>
<tr><td class="h"><a name="6205"></a>6205</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6206"></a>6206</td><td></td><td></td><td></td><td></td><td class="s">  $rows = $sth-&gt;dump_results($maxlen, $lsep, $fsep, $fh);</td></tr>
<tr><td class="h"><a name="6207"></a>6207</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6208"></a>6208</td><td></td><td></td><td></td><td></td><td class="s">Fetches all the rows from C&lt;$sth&gt;, calls C&lt;DBI::neat_list&gt; for each row, and</td></tr>
<tr><td class="h"><a name="6209"></a>6209</td><td></td><td></td><td></td><td></td><td class="s">prints the results to C&lt;$fh&gt; (defaults to C&lt;STDOUT&gt;) separated by C&lt;$lsep&gt;</td></tr>
<tr><td class="h"><a name="6210"></a>6210</td><td></td><td></td><td></td><td></td><td class="s">(default C&lt;&quot;\n&quot;&gt;). C&lt;$fsep&gt; defaults to C&lt;&quot;, &quot;&gt; and C&lt;$maxlen&gt; defaults to 35.</td></tr>
<tr><td class="h"><a name="6211"></a>6211</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6212"></a>6212</td><td></td><td></td><td></td><td></td><td class="s">This method is designed as a handy utility for prototyping and</td></tr>
<tr><td class="h"><a name="6213"></a>6213</td><td></td><td></td><td></td><td></td><td class="s">testing queries. Since it uses L&lt;/neat_list&gt; to</td></tr>
<tr><td class="h"><a name="6214"></a>6214</td><td></td><td></td><td></td><td></td><td class="s">format and edit the string for reading by humans, it is not recomended</td></tr>
<tr><td class="h"><a name="6215"></a>6215</td><td></td><td></td><td></td><td></td><td class="s">for data transfer applications.</td></tr>
<tr><td class="h"><a name="6216"></a>6216</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6217"></a>6217</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6218"></a>6218</td><td></td><td></td><td></td><td></td><td class="s">=head2 Statement Handle Attributes</td></tr>
<tr><td class="h"><a name="6219"></a>6219</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6220"></a>6220</td><td></td><td></td><td></td><td></td><td class="s">This section describes attributes specific to statement handles. Most</td></tr>
<tr><td class="h"><a name="6221"></a>6221</td><td></td><td></td><td></td><td></td><td class="s">of these attributes are read-only.</td></tr>
<tr><td class="h"><a name="6222"></a>6222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6223"></a>6223</td><td></td><td></td><td></td><td></td><td class="s">Changes to these statement handle attributes do not affect any other</td></tr>
<tr><td class="h"><a name="6224"></a>6224</td><td></td><td></td><td></td><td></td><td class="s">existing or future statement handles.</td></tr>
<tr><td class="h"><a name="6225"></a>6225</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6226"></a>6226</td><td></td><td></td><td></td><td></td><td class="s">Attempting to set or get the value of an unknown attribute generates a warning,</td></tr>
<tr><td class="h"><a name="6227"></a>6227</td><td></td><td></td><td></td><td></td><td class="s">except for private driver specific attributes (which all have names</td></tr>
<tr><td class="h"><a name="6228"></a>6228</td><td></td><td></td><td></td><td></td><td class="s">starting with a lowercase letter).</td></tr>
<tr><td class="h"><a name="6229"></a>6229</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6230"></a>6230</td><td></td><td></td><td></td><td></td><td class="s">Example:</td></tr>
<tr><td class="h"><a name="6231"></a>6231</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6232"></a>6232</td><td></td><td></td><td></td><td></td><td class="s">  ... = $h-&gt;{NUM_OF_FIELDS};        # get/read</td></tr>
<tr><td class="h"><a name="6233"></a>6233</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6234"></a>6234</td><td></td><td></td><td></td><td></td><td class="s">Some drivers cannot provide valid values for some or all of these</td></tr>
<tr><td class="h"><a name="6235"></a>6235</td><td></td><td></td><td></td><td></td><td class="s">attributes until after C&lt;$sth-E&lt;gt&gt;execute&gt; has been successfully</td></tr>
<tr><td class="h"><a name="6236"></a>6236</td><td></td><td></td><td></td><td></td><td class="s">called. Typically the attribute will be C&lt;undef&gt; in these situations.</td></tr>
<tr><td class="h"><a name="6237"></a>6237</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6238"></a>6238</td><td></td><td></td><td></td><td></td><td class="s">Some attributes, like NAME, are not appropriate to some types of</td></tr>
<tr><td class="h"><a name="6239"></a>6239</td><td></td><td></td><td></td><td></td><td class="s">statement, like SELECT. Typically the attribute will be C&lt;undef&gt;</td></tr>
<tr><td class="h"><a name="6240"></a>6240</td><td></td><td></td><td></td><td></td><td class="s">in these situations.</td></tr>
<tr><td class="h"><a name="6241"></a>6241</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6242"></a>6242</td><td></td><td></td><td></td><td></td><td class="s">For drivers which support stored procedures and multiple result sets</td></tr>
<tr><td class="h"><a name="6243"></a>6243</td><td></td><td></td><td></td><td></td><td class="s">(see L&lt;/more_results&gt;) these attributes relate to the I&lt;current&gt; result set.</td></tr>
<tr><td class="h"><a name="6244"></a>6244</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6245"></a>6245</td><td></td><td></td><td></td><td></td><td class="s">See also L&lt;/finish&gt; to learn more about the effect it</td></tr>
<tr><td class="h"><a name="6246"></a>6246</td><td></td><td></td><td></td><td></td><td class="s">may have on some attributes.</td></tr>
<tr><td class="h"><a name="6247"></a>6247</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6248"></a>6248</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NUM_OF_FIELDS&gt;  (integer, read-only)</td></tr>
<tr><td class="h"><a name="6249"></a>6249</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6250"></a>6250</td><td></td><td></td><td></td><td></td><td class="s">Number of fields (columns) in the data the prepared statement may return.</td></tr>
<tr><td class="h"><a name="6251"></a>6251</td><td></td><td></td><td></td><td></td><td class="s">Statements that don't return rows of data, like C&lt;DELETE&gt; and C&lt;CREATE&gt;</td></tr>
<tr><td class="h"><a name="6252"></a>6252</td><td></td><td></td><td></td><td></td><td class="s">set C&lt;NUM_OF_FIELDS&gt; to 0 (though it may be undef in some drivers).</td></tr>
<tr><td class="h"><a name="6253"></a>6253</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6254"></a>6254</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6255"></a>6255</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NUM_OF_PARAMS&gt;  (integer, read-only)</td></tr>
<tr><td class="h"><a name="6256"></a>6256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6257"></a>6257</td><td></td><td></td><td></td><td></td><td class="s">The number of parameters (placeholders) in the prepared statement.</td></tr>
<tr><td class="h"><a name="6258"></a>6258</td><td></td><td></td><td></td><td></td><td class="s">See SUBSTITUTION VARIABLES below for more details.</td></tr>
<tr><td class="h"><a name="6259"></a>6259</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6260"></a>6260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6261"></a>6261</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6262"></a>6262</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6263"></a>6263</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array of field names for each column. The</td></tr>
<tr><td class="h"><a name="6264"></a>6264</td><td></td><td></td><td></td><td></td><td class="s">names may contain spaces but should not be truncated or have any</td></tr>
<tr><td class="h"><a name="6265"></a>6265</td><td></td><td></td><td></td><td></td><td class="s">trailing space. Note that the names have the letter case (upper, lower</td></tr>
<tr><td class="h"><a name="6266"></a>6266</td><td></td><td></td><td></td><td></td><td class="s">or mixed) as returned by the driver being used. Portable applications</td></tr>
<tr><td class="h"><a name="6267"></a>6267</td><td></td><td></td><td></td><td></td><td class="s">should use L&lt;/NAME_lc&gt; or L&lt;/NAME_uc&gt;.</td></tr>
<tr><td class="h"><a name="6268"></a>6268</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6269"></a>6269</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;First column name: $sth-&gt;{NAME}-&gt;[0]\n&quot;;</td></tr>
<tr><td class="h"><a name="6270"></a>6270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6271"></a>6271</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME_lc&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6272"></a>6272</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6273"></a>6273</td><td></td><td></td><td></td><td></td><td class="s">Like L&lt;/NAME&gt; but always returns lowercase names.</td></tr>
<tr><td class="h"><a name="6274"></a>6274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6275"></a>6275</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME_uc&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6276"></a>6276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6277"></a>6277</td><td></td><td></td><td></td><td></td><td class="s">Like L&lt;/NAME&gt; but always returns uppercase names.</td></tr>
<tr><td class="h"><a name="6278"></a>6278</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6279"></a>6279</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME_hash&gt;  (hash-ref, read-only)</td></tr>
<tr><td class="h"><a name="6280"></a>6280</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6281"></a>6281</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME_lc_hash&gt;  (hash-ref, read-only)</td></tr>
<tr><td class="h"><a name="6282"></a>6282</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6283"></a>6283</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NAME_uc_hash&gt;  (hash-ref, read-only)</td></tr>
<tr><td class="h"><a name="6284"></a>6284</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6285"></a>6285</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;NAME_hash&gt;, C&lt;NAME_lc_hash&gt;, and C&lt;NAME_uc_hash&gt; attributes</td></tr>
<tr><td class="h"><a name="6286"></a>6286</td><td></td><td></td><td></td><td></td><td class="s">return column name information as a reference to a hash.</td></tr>
<tr><td class="h"><a name="6287"></a>6287</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6288"></a>6288</td><td></td><td></td><td></td><td></td><td class="s">The keys of the hash are the names of the columns.  The letter case of</td></tr>
<tr><td class="h"><a name="6289"></a>6289</td><td></td><td></td><td></td><td></td><td class="s">the keys corresponds to the letter case returned by the C&lt;NAME&gt;,</td></tr>
<tr><td class="h"><a name="6290"></a>6290</td><td></td><td></td><td></td><td></td><td class="s">C&lt;NAME_lc&gt;, and C&lt;NAME_uc&gt; attributes respectively (as described above).</td></tr>
<tr><td class="h"><a name="6291"></a>6291</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6292"></a>6292</td><td></td><td></td><td></td><td></td><td class="s">The value of each hash entry is the perl index number of the</td></tr>
<tr><td class="h"><a name="6293"></a>6293</td><td></td><td></td><td></td><td></td><td class="s">corresponding column (counting from 0). For example:</td></tr>
<tr><td class="h"><a name="6294"></a>6294</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6295"></a>6295</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;select Id, Name from table&quot;);</td></tr>
<tr><td class="h"><a name="6296"></a>6296</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute;</td></tr>
<tr><td class="h"><a name="6297"></a>6297</td><td></td><td></td><td></td><td></td><td class="s">  @row = $sth-&gt;fetchrow_array;</td></tr>
<tr><td class="h"><a name="6298"></a>6298</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;Name $row[ $sth-&gt;{NAME_lc_hash}{name} ]\n&quot;;</td></tr>
<tr><td class="h"><a name="6299"></a>6299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6300"></a>6300</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6301"></a>6301</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;TYPE&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6302"></a>6302</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6303"></a>6303</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array of integer values for each</td></tr>
<tr><td class="h"><a name="6304"></a>6304</td><td></td><td></td><td></td><td></td><td class="s">column. The value indicates the data type of the corresponding column.</td></tr>
<tr><td class="h"><a name="6305"></a>6305</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6306"></a>6306</td><td></td><td></td><td></td><td></td><td class="s">The values correspond to the international standards (ANSI X3.135</td></tr>
<tr><td class="h"><a name="6307"></a>6307</td><td></td><td></td><td></td><td></td><td class="s">and ISO/IEC 9075) which, in general terms, means ODBC. Driver-specific</td></tr>
<tr><td class="h"><a name="6308"></a>6308</td><td></td><td></td><td></td><td></td><td class="s">types that don't exactly match standard types should generally return</td></tr>
<tr><td class="h"><a name="6309"></a>6309</td><td></td><td></td><td></td><td></td><td class="s">the same values as an ODBC driver supplied by the makers of the</td></tr>
<tr><td class="h"><a name="6310"></a>6310</td><td></td><td></td><td></td><td></td><td class="s">database. That might include private type numbers in ranges the vendor</td></tr>
<tr><td class="h"><a name="6311"></a>6311</td><td></td><td></td><td></td><td></td><td class="s">has officially registered with the ISO working group:</td></tr>
<tr><td class="h"><a name="6312"></a>6312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6313"></a>6313</td><td></td><td></td><td></td><td></td><td class="s">  ftp://sqlstandards.org/SC32/SQL_Registry/</td></tr>
<tr><td class="h"><a name="6314"></a>6314</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6315"></a>6315</td><td></td><td></td><td></td><td></td><td class="s">Where there's no vendor-supplied ODBC driver to be compatible with,</td></tr>
<tr><td class="h"><a name="6316"></a>6316</td><td></td><td></td><td></td><td></td><td class="s">the DBI driver can use type numbers in the range that is now</td></tr>
<tr><td class="h"><a name="6317"></a>6317</td><td></td><td></td><td></td><td></td><td class="s">officially reserved for use by the DBI: -9999 to -9000.</td></tr>
<tr><td class="h"><a name="6318"></a>6318</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6319"></a>6319</td><td></td><td></td><td></td><td></td><td class="s">All possible values for C&lt;TYPE&gt; should have at least one entry in the</td></tr>
<tr><td class="h"><a name="6320"></a>6320</td><td></td><td></td><td></td><td></td><td class="s">output of the C&lt;type_info_all&gt; method (see L&lt;/type_info_all&gt;).</td></tr>
<tr><td class="h"><a name="6321"></a>6321</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6322"></a>6322</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;PRECISION&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6323"></a>6323</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6324"></a>6324</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array of integer values for each column.</td></tr>
<tr><td class="h"><a name="6325"></a>6325</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6326"></a>6326</td><td></td><td></td><td></td><td></td><td class="s">For numeric columns, the value is the maximum number of digits</td></tr>
<tr><td class="h"><a name="6327"></a>6327</td><td></td><td></td><td></td><td></td><td class="s">(without considering a sign character or decimal point). Note that</td></tr>
<tr><td class="h"><a name="6328"></a>6328</td><td></td><td></td><td></td><td></td><td class="s">the &quot;display size&quot; for floating point types (REAL, FLOAT, DOUBLE)</td></tr>
<tr><td class="h"><a name="6329"></a>6329</td><td></td><td></td><td></td><td></td><td class="s">can be up to 7 characters greater than the precision (for the</td></tr>
<tr><td class="h"><a name="6330"></a>6330</td><td></td><td></td><td></td><td></td><td class="s">sign + decimal point + the letter E + a sign + 2 or 3 digits).</td></tr>
<tr><td class="h"><a name="6331"></a>6331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6332"></a>6332</td><td></td><td></td><td></td><td></td><td class="s">For any character type column the value is the OCTET_LENGTH,</td></tr>
<tr><td class="h"><a name="6333"></a>6333</td><td></td><td></td><td></td><td></td><td class="s">in other words the number of bytes, not characters.</td></tr>
<tr><td class="h"><a name="6334"></a>6334</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6335"></a>6335</td><td></td><td></td><td></td><td></td><td class="s">(More recent standards refer to this as COLUMN_SIZE but we stick</td></tr>
<tr><td class="h"><a name="6336"></a>6336</td><td></td><td></td><td></td><td></td><td class="s">with PRECISION for backwards compatibility.)</td></tr>
<tr><td class="h"><a name="6337"></a>6337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6338"></a>6338</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;SCALE&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6339"></a>6339</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6340"></a>6340</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array of integer values for each column.</td></tr>
<tr><td class="h"><a name="6341"></a>6341</td><td></td><td></td><td></td><td></td><td class="s">NULL (C&lt;undef&gt;) values indicate columns where scale is not applicable.</td></tr>
<tr><td class="h"><a name="6342"></a>6342</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6343"></a>6343</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;NULLABLE&gt;  (array-ref, read-only)</td></tr>
<tr><td class="h"><a name="6344"></a>6344</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6345"></a>6345</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to an array indicating the possibility of each</td></tr>
<tr><td class="h"><a name="6346"></a>6346</td><td></td><td></td><td></td><td></td><td class="s">column returning a null.  Possible values are C&lt;0&gt;</td></tr>
<tr><td class="h"><a name="6347"></a>6347</td><td></td><td></td><td></td><td></td><td class="s">(or an empty string) = no, C&lt;1&gt; = yes, C&lt;2&gt; = unknown.</td></tr>
<tr><td class="h"><a name="6348"></a>6348</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6349"></a>6349</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;First column may return NULL\n&quot; if $sth-&gt;{NULLABLE}-&gt;[0];</td></tr>
<tr><td class="h"><a name="6350"></a>6350</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6351"></a>6351</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6352"></a>6352</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;CursorName&gt;  (string, read-only)</td></tr>
<tr><td class="h"><a name="6353"></a>6353</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6354"></a>6354</td><td></td><td></td><td></td><td></td><td class="s">Returns the name of the cursor associated with the statement handle, if</td></tr>
<tr><td class="h"><a name="6355"></a>6355</td><td></td><td></td><td></td><td></td><td class="s">available. If not available or if the database driver does not support the</td></tr>
<tr><td class="h"><a name="6356"></a>6356</td><td></td><td></td><td></td><td></td><td class="s">C&lt;&quot;where current of ...&quot;&gt; SQL syntax, then it returns C&lt;undef&gt;.</td></tr>
<tr><td class="h"><a name="6357"></a>6357</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6358"></a>6358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6359"></a>6359</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Database&gt;  (dbh, read-only)</td></tr>
<tr><td class="h"><a name="6360"></a>6360</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6361"></a>6361</td><td></td><td></td><td></td><td></td><td class="s">Returns the parent $dbh of the statement handle.</td></tr>
<tr><td class="h"><a name="6362"></a>6362</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6363"></a>6363</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6364"></a>6364</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ParamValues&gt;  (hash ref, read-only)</td></tr>
<tr><td class="h"><a name="6365"></a>6365</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6366"></a>6366</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to a hash containing the values currently bound</td></tr>
<tr><td class="h"><a name="6367"></a>6367</td><td></td><td></td><td></td><td></td><td class="s">to placeholders.  The keys of the hash are the 'names' of the</td></tr>
<tr><td class="h"><a name="6368"></a>6368</td><td></td><td></td><td></td><td></td><td class="s">placeholders, typically integers starting at 1.  Returns undef if</td></tr>
<tr><td class="h"><a name="6369"></a>6369</td><td></td><td></td><td></td><td></td><td class="s">not supported by the driver.</td></tr>
<tr><td class="h"><a name="6370"></a>6370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6371"></a>6371</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/ShowErrorStatement&gt; for an example of how this is used.</td></tr>
<tr><td class="h"><a name="6372"></a>6372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6373"></a>6373</td><td></td><td></td><td></td><td></td><td class="s">If the driver supports C&lt;ParamValues&gt; but no values have been bound</td></tr>
<tr><td class="h"><a name="6374"></a>6374</td><td></td><td></td><td></td><td></td><td class="s">yet then the driver should return a hash with placeholders names</td></tr>
<tr><td class="h"><a name="6375"></a>6375</td><td></td><td></td><td></td><td></td><td class="s">in the keys but all the values undef, but some drivers may return</td></tr>
<tr><td class="h"><a name="6376"></a>6376</td><td></td><td></td><td></td><td></td><td class="s">a ref to an empty hash.</td></tr>
<tr><td class="h"><a name="6377"></a>6377</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6378"></a>6378</td><td></td><td></td><td></td><td></td><td class="s">It is possible that the values in the hash returned by C&lt;ParamValues&gt;</td></tr>
<tr><td class="h"><a name="6379"></a>6379</td><td></td><td></td><td></td><td></td><td class="s">are not I&lt;exactly&gt; the same as those passed to bind_param() or execute().</td></tr>
<tr><td class="h"><a name="6380"></a>6380</td><td></td><td></td><td></td><td></td><td class="s">The driver may have slightly modified values in some way based on the</td></tr>
<tr><td class="h"><a name="6381"></a>6381</td><td></td><td></td><td></td><td></td><td class="s">TYPE the value was bound with. For example a floating point value</td></tr>
<tr><td class="h"><a name="6382"></a>6382</td><td></td><td></td><td></td><td></td><td class="s">bound as an SQL_INTEGER type may be returned as an integer.</td></tr>
<tr><td class="h"><a name="6383"></a>6383</td><td></td><td></td><td></td><td></td><td class="s">The values returned by C&lt;ParamValues&gt; can be passed to another</td></tr>
<tr><td class="h"><a name="6384"></a>6384</td><td></td><td></td><td></td><td></td><td class="s">bind_param() method with the same TYPE and will be seen by the</td></tr>
<tr><td class="h"><a name="6385"></a>6385</td><td></td><td></td><td></td><td></td><td class="s">database as the same value.</td></tr>
<tr><td class="h"><a name="6386"></a>6386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6387"></a>6387</td><td></td><td></td><td></td><td></td><td class="s">It is also possible that the keys in the hash returned by C&lt;ParamValues&gt;</td></tr>
<tr><td class="h"><a name="6388"></a>6388</td><td></td><td></td><td></td><td></td><td class="s">are not exactly the same as those implied by the prepared statement.</td></tr>
<tr><td class="h"><a name="6389"></a>6389</td><td></td><td></td><td></td><td></td><td class="s">For example, DBD::Oracle translates 'C&lt;?&gt;' placeholders into 'C&lt;:pN&gt;'</td></tr>
<tr><td class="h"><a name="6390"></a>6390</td><td></td><td></td><td></td><td></td><td class="s">where N is a sequence number starting at 1.</td></tr>
<tr><td class="h"><a name="6391"></a>6391</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6392"></a>6392</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ParamValues&gt; attribute was added in DBI 1.28.</td></tr>
<tr><td class="h"><a name="6393"></a>6393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6394"></a>6394</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ParamArrays&gt;  (hash ref, read-only)</td></tr>
<tr><td class="h"><a name="6395"></a>6395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6396"></a>6396</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to a hash containing the values currently bound to</td></tr>
<tr><td class="h"><a name="6397"></a>6397</td><td></td><td></td><td></td><td></td><td class="s">placeholders with L&lt;/execute_array&gt; or L&lt;/bind_param_array&gt;.  The</td></tr>
<tr><td class="h"><a name="6398"></a>6398</td><td></td><td></td><td></td><td></td><td class="s">keys of the hash are the 'names' of the placeholders, typically</td></tr>
<tr><td class="h"><a name="6399"></a>6399</td><td></td><td></td><td></td><td></td><td class="s">integers starting at 1.  Returns undef if not supported by the driver</td></tr>
<tr><td class="h"><a name="6400"></a>6400</td><td></td><td></td><td></td><td></td><td class="s">or no arrays of parameters are bound.</td></tr>
<tr><td class="h"><a name="6401"></a>6401</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6402"></a>6402</td><td></td><td></td><td></td><td></td><td class="s">Each key value is an array reference containing a list of the bound</td></tr>
<tr><td class="h"><a name="6403"></a>6403</td><td></td><td></td><td></td><td></td><td class="s">parameters for that column.</td></tr>
<tr><td class="h"><a name="6404"></a>6404</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6405"></a>6405</td><td></td><td></td><td></td><td></td><td class="s">For example:</td></tr>
<tr><td class="h"><a name="6406"></a>6406</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6407"></a>6407</td><td></td><td></td><td></td><td></td><td class="s">  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (id, name) values (?,?)&quot;);</td></tr>
<tr><td class="h"><a name="6408"></a>6408</td><td></td><td></td><td></td><td></td><td class="s">  $sth-&gt;execute_array({},[1,2], ['fred','dave']);</td></tr>
<tr><td class="h"><a name="6409"></a>6409</td><td></td><td></td><td></td><td></td><td class="s">  if ($sth-&gt;{ParamArrays}) {</td></tr>
<tr><td class="h"><a name="6410"></a>6410</td><td></td><td></td><td></td><td></td><td class="s">      foreach $param (keys %{$sth-&gt;{ParamArrays}}) {</td></tr>
<tr><td class="h"><a name="6411"></a>6411</td><td></td><td></td><td></td><td></td><td class="s">          printf &quot;Parameters for %s : %s\n&quot;, $param,</td></tr>
<tr><td class="h"><a name="6412"></a>6412</td><td></td><td></td><td></td><td></td><td class="s">          join(&quot;,&quot;, @{$sth-&gt;{ParamArrays}-&gt;{$param}});</td></tr>
<tr><td class="h"><a name="6413"></a>6413</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="6414"></a>6414</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6415"></a>6415</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6416"></a>6416</td><td></td><td></td><td></td><td></td><td class="s">It is possible that the values in the hash returned by C&lt;ParamArrays&gt;</td></tr>
<tr><td class="h"><a name="6417"></a>6417</td><td></td><td></td><td></td><td></td><td class="s">are not I&lt;exactly&gt; the same as those passed to L&lt;/bind_param_array&gt; or</td></tr>
<tr><td class="h"><a name="6418"></a>6418</td><td></td><td></td><td></td><td></td><td class="s">L&lt;/execute_array&gt;.  The driver may have slightly modified values in some</td></tr>
<tr><td class="h"><a name="6419"></a>6419</td><td></td><td></td><td></td><td></td><td class="s">way based on the TYPE the value was bound with. For example a floating</td></tr>
<tr><td class="h"><a name="6420"></a>6420</td><td></td><td></td><td></td><td></td><td class="s">point value bound as an SQL_INTEGER type may be returned as an</td></tr>
<tr><td class="h"><a name="6421"></a>6421</td><td></td><td></td><td></td><td></td><td class="s">integer.</td></tr>
<tr><td class="h"><a name="6422"></a>6422</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6423"></a>6423</td><td></td><td></td><td></td><td></td><td class="s">It is also possible that the keys in the hash returned by</td></tr>
<tr><td class="h"><a name="6424"></a>6424</td><td></td><td></td><td></td><td></td><td class="s">C&lt;ParamArrays&gt; are not exactly the same as those implied by the</td></tr>
<tr><td class="h"><a name="6425"></a>6425</td><td></td><td></td><td></td><td></td><td class="s">prepared statement.  For example, DBD::Oracle translates 'C&lt;?&gt;'</td></tr>
<tr><td class="h"><a name="6426"></a>6426</td><td></td><td></td><td></td><td></td><td class="s">placeholders into 'C&lt;:pN&gt;' where N is a sequence number starting at 1.</td></tr>
<tr><td class="h"><a name="6427"></a>6427</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6428"></a>6428</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;ParamTypes&gt;  (hash ref, read-only)</td></tr>
<tr><td class="h"><a name="6429"></a>6429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6430"></a>6430</td><td></td><td></td><td></td><td></td><td class="s">Returns a reference to a hash containing the type information</td></tr>
<tr><td class="h"><a name="6431"></a>6431</td><td></td><td></td><td></td><td></td><td class="s">currently bound to placeholders.  The keys of the hash are the</td></tr>
<tr><td class="h"><a name="6432"></a>6432</td><td></td><td></td><td></td><td></td><td class="s">'names' of the placeholders: either integers starting at 1, or,</td></tr>
<tr><td class="h"><a name="6433"></a>6433</td><td></td><td></td><td></td><td></td><td class="s">for drivers that support named placeholders, the actual parameter</td></tr>
<tr><td class="h"><a name="6434"></a>6434</td><td></td><td></td><td></td><td></td><td class="s">name string. The hash values are hashrefs of type information in</td></tr>
<tr><td class="h"><a name="6435"></a>6435</td><td></td><td></td><td></td><td></td><td class="s">the same form as that provided to the various bind_param() methods</td></tr>
<tr><td class="h"><a name="6436"></a>6436</td><td></td><td></td><td></td><td></td><td class="s">(See L&lt;/bind_param&gt; for the format and values),</td></tr>
<tr><td class="h"><a name="6437"></a>6437</td><td></td><td></td><td></td><td></td><td class="s">plus anything else that was passed as the third argument to bind_param().</td></tr>
<tr><td class="h"><a name="6438"></a>6438</td><td></td><td></td><td></td><td></td><td class="s">Returns undef if not supported by the driver.</td></tr>
<tr><td class="h"><a name="6439"></a>6439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6440"></a>6440</td><td></td><td></td><td></td><td></td><td class="s">If the driver supports C&lt;ParamTypes&gt;, but no values have been bound</td></tr>
<tr><td class="h"><a name="6441"></a>6441</td><td></td><td></td><td></td><td></td><td class="s">yet, then the driver should return a hash with the placeholder name</td></tr>
<tr><td class="h"><a name="6442"></a>6442</td><td></td><td></td><td></td><td></td><td class="s">keys, but all the values undef; however, some drivers may return</td></tr>
<tr><td class="h"><a name="6443"></a>6443</td><td></td><td></td><td></td><td></td><td class="s">a ref to an empty hash, or, alternately, may provide type</td></tr>
<tr><td class="h"><a name="6444"></a>6444</td><td></td><td></td><td></td><td></td><td class="s">information supplied by the database (only a few databases can do that).</td></tr>
<tr><td class="h"><a name="6445"></a>6445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6446"></a>6446</td><td></td><td></td><td></td><td></td><td class="s">It is possible that the values in the hash returned by C&lt;ParamTypes&gt;</td></tr>
<tr><td class="h"><a name="6447"></a>6447</td><td></td><td></td><td></td><td></td><td class="s">are not I&lt;exactly&gt; the same as those passed to bind_param() or execute().</td></tr>
<tr><td class="h"><a name="6448"></a>6448</td><td></td><td></td><td></td><td></td><td class="s">The driver may have modified the type information in some way based</td></tr>
<tr><td class="h"><a name="6449"></a>6449</td><td></td><td></td><td></td><td></td><td class="s">on the bound values, other hints provided by the prepare()'d</td></tr>
<tr><td class="h"><a name="6450"></a>6450</td><td></td><td></td><td></td><td></td><td class="s">SQL statement, or alternate type mappings required by the driver or target</td></tr>
<tr><td class="h"><a name="6451"></a>6451</td><td></td><td></td><td></td><td></td><td class="s">database system.</td></tr>
<tr><td class="h"><a name="6452"></a>6452</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6453"></a>6453</td><td></td><td></td><td></td><td></td><td class="s">It is also possible that the keys in the hash returned by C&lt;ParamTypes&gt;</td></tr>
<tr><td class="h"><a name="6454"></a>6454</td><td></td><td></td><td></td><td></td><td class="s">are not exactly the same as those implied by the prepared statement.</td></tr>
<tr><td class="h"><a name="6455"></a>6455</td><td></td><td></td><td></td><td></td><td class="s">For example, DBD::Oracle translates 'C&lt;?&gt;' placeholders into 'C&lt;:pN&gt;'</td></tr>
<tr><td class="h"><a name="6456"></a>6456</td><td></td><td></td><td></td><td></td><td class="s">where N is a sequence number starting at 1.</td></tr>
<tr><td class="h"><a name="6457"></a>6457</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6458"></a>6458</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;ParamTypes&gt; attribute was added in DBI 1.49. Implementation</td></tr>
<tr><td class="h"><a name="6459"></a>6459</td><td></td><td></td><td></td><td></td><td class="s">is the responsibility of individual drivers; the DBI layer default</td></tr>
<tr><td class="h"><a name="6460"></a>6460</td><td></td><td></td><td></td><td></td><td class="s">implementation simply returns undef.</td></tr>
<tr><td class="h"><a name="6461"></a>6461</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6462"></a>6462</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6463"></a>6463</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;Statement&gt;  (string, read-only)</td></tr>
<tr><td class="h"><a name="6464"></a>6464</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6465"></a>6465</td><td></td><td></td><td></td><td></td><td class="s">Returns the statement string passed to the L&lt;/prepare&gt; method.</td></tr>
<tr><td class="h"><a name="6466"></a>6466</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6467"></a>6467</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6468"></a>6468</td><td></td><td></td><td></td><td></td><td class="s">=head3 C&lt;RowsInCache&gt;  (integer, read-only)</td></tr>
<tr><td class="h"><a name="6469"></a>6469</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6470"></a>6470</td><td></td><td></td><td></td><td></td><td class="s">If the driver supports a local row cache for C&lt;SELECT&gt; statements, then</td></tr>
<tr><td class="h"><a name="6471"></a>6471</td><td></td><td></td><td></td><td></td><td class="s">this attribute holds the number of un-fetched rows in the cache. If the</td></tr>
<tr><td class="h"><a name="6472"></a>6472</td><td></td><td></td><td></td><td></td><td class="s">driver doesn't, then it returns C&lt;undef&gt;. Note that some drivers pre-fetch</td></tr>
<tr><td class="h"><a name="6473"></a>6473</td><td></td><td></td><td></td><td></td><td class="s">rows on execute, whereas others wait till the first fetch.</td></tr>
<tr><td class="h"><a name="6474"></a>6474</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6475"></a>6475</td><td></td><td></td><td></td><td></td><td class="s">See also the L&lt;/RowCacheSize&gt; database handle attribute.</td></tr>
<tr><td class="h"><a name="6476"></a>6476</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6477"></a>6477</td><td></td><td></td><td></td><td></td><td class="s">=head1 FURTHER INFORMATION</td></tr>
<tr><td class="h"><a name="6478"></a>6478</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6479"></a>6479</td><td></td><td></td><td></td><td></td><td class="s">=head2 Catalog Methods</td></tr>
<tr><td class="h"><a name="6480"></a>6480</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6481"></a>6481</td><td></td><td></td><td></td><td></td><td class="s">An application can retrieve metadata information from the DBMS by issuing</td></tr>
<tr><td class="h"><a name="6482"></a>6482</td><td></td><td></td><td></td><td></td><td class="s">appropriate queries on the views of the Information Schema. Unfortunately,</td></tr>
<tr><td class="h"><a name="6483"></a>6483</td><td></td><td></td><td></td><td></td><td class="s">C&lt;INFORMATION_SCHEMA&gt; views are seldom supported by the DBMS.</td></tr>
<tr><td class="h"><a name="6484"></a>6484</td><td></td><td></td><td></td><td></td><td class="s">Special methods (catalog methods) are available to return result sets</td></tr>
<tr><td class="h"><a name="6485"></a>6485</td><td></td><td></td><td></td><td></td><td class="s">for a small but important portion of that metadata:</td></tr>
<tr><td class="h"><a name="6486"></a>6486</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6487"></a>6487</td><td></td><td></td><td></td><td></td><td class="s">  column_info</td></tr>
<tr><td class="h"><a name="6488"></a>6488</td><td></td><td></td><td></td><td></td><td class="s">  foreign_key_info</td></tr>
<tr><td class="h"><a name="6489"></a>6489</td><td></td><td></td><td></td><td></td><td class="s">  primary_key_info</td></tr>
<tr><td class="h"><a name="6490"></a>6490</td><td></td><td></td><td></td><td></td><td class="s">  table_info</td></tr>
<tr><td class="h"><a name="6491"></a>6491</td><td></td><td></td><td></td><td></td><td class="s">  statistics_info</td></tr>
<tr><td class="h"><a name="6492"></a>6492</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6493"></a>6493</td><td></td><td></td><td></td><td></td><td class="s">All catalog methods accept arguments in order to restrict the result sets.</td></tr>
<tr><td class="h"><a name="6494"></a>6494</td><td></td><td></td><td></td><td></td><td class="s">Passing C&lt;undef&gt; to an optional argument does not constrain the search for</td></tr>
<tr><td class="h"><a name="6495"></a>6495</td><td></td><td></td><td></td><td></td><td class="s">that argument.</td></tr>
<tr><td class="h"><a name="6496"></a>6496</td><td></td><td></td><td></td><td></td><td class="s">However, an empty string ('') is treated as a regular search criteria</td></tr>
<tr><td class="h"><a name="6497"></a>6497</td><td></td><td></td><td></td><td></td><td class="s">and will only match an empty value.</td></tr>
<tr><td class="h"><a name="6498"></a>6498</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6499"></a>6499</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Note&gt;: SQL/CLI and ODBC differ in the handling of empty strings. An</td></tr>
<tr><td class="h"><a name="6500"></a>6500</td><td></td><td></td><td></td><td></td><td class="s">empty string will not restrict the result set in SQL/CLI.</td></tr>
<tr><td class="h"><a name="6501"></a>6501</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6502"></a>6502</td><td></td><td></td><td></td><td></td><td class="s">Most arguments in the catalog methods accept only I&lt;ordinary values&gt;, e.g.</td></tr>
<tr><td class="h"><a name="6503"></a>6503</td><td></td><td></td><td></td><td></td><td class="s">the arguments of C&lt;primary_key_info()&gt;.</td></tr>
<tr><td class="h"><a name="6504"></a>6504</td><td></td><td></td><td></td><td></td><td class="s">Such arguments are treated as a literal string, i.e. the case is significant</td></tr>
<tr><td class="h"><a name="6505"></a>6505</td><td></td><td></td><td></td><td></td><td class="s">and quote characters are taken literally.</td></tr>
<tr><td class="h"><a name="6506"></a>6506</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6507"></a>6507</td><td></td><td></td><td></td><td></td><td class="s">Some arguments in the catalog methods accept I&lt;search patterns&gt; (strings</td></tr>
<tr><td class="h"><a name="6508"></a>6508</td><td></td><td></td><td></td><td></td><td class="s">containing '_' and/or '%'), e.g. the C&lt;$table&gt; argument of C&lt;column_info()&gt;.</td></tr>
<tr><td class="h"><a name="6509"></a>6509</td><td></td><td></td><td></td><td></td><td class="s">Passing '%' is equivalent to leaving the argument C&lt;undef&gt;.</td></tr>
<tr><td class="h"><a name="6510"></a>6510</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6511"></a>6511</td><td></td><td></td><td></td><td></td><td class="s">B&lt;Caveat&gt;: The underscore ('_') is valid and often used in SQL identifiers.</td></tr>
<tr><td class="h"><a name="6512"></a>6512</td><td></td><td></td><td></td><td></td><td class="s">Passing such a value to a search pattern argument may return more rows than</td></tr>
<tr><td class="h"><a name="6513"></a>6513</td><td></td><td></td><td></td><td></td><td class="s">expected!</td></tr>
<tr><td class="h"><a name="6514"></a>6514</td><td></td><td></td><td></td><td></td><td class="s">To include pattern characters as literals, they must be preceded by an</td></tr>
<tr><td class="h"><a name="6515"></a>6515</td><td></td><td></td><td></td><td></td><td class="s">escape character which can be achieved with</td></tr>
<tr><td class="h"><a name="6516"></a>6516</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6517"></a>6517</td><td></td><td></td><td></td><td></td><td class="s">  $esc = $dbh-&gt;get_info( 14 );  # SQL_SEARCH_PATTERN_ESCAPE</td></tr>
<tr><td class="h"><a name="6518"></a>6518</td><td></td><td></td><td></td><td></td><td class="s">  $search_pattern =~ s/([_%])/$esc$1/g;</td></tr>
<tr><td class="h"><a name="6519"></a>6519</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6520"></a>6520</td><td></td><td></td><td></td><td></td><td class="s">The ODBC and SQL/CLI specifications define a way to change the default</td></tr>
<tr><td class="h"><a name="6521"></a>6521</td><td></td><td></td><td></td><td></td><td class="s">behaviour described above: All arguments (except I&lt;list value arguments&gt;)</td></tr>
<tr><td class="h"><a name="6522"></a>6522</td><td></td><td></td><td></td><td></td><td class="s">are treated as I&lt;identifier&gt; if the C&lt;SQL_ATTR_METADATA_ID&gt; attribute is</td></tr>
<tr><td class="h"><a name="6523"></a>6523</td><td></td><td></td><td></td><td></td><td class="s">set to C&lt;SQL_TRUE&gt;.</td></tr>
<tr><td class="h"><a name="6524"></a>6524</td><td></td><td></td><td></td><td></td><td class="s">I&lt;Quoted identifiers&gt; are very similar to I&lt;ordinary values&gt;, i.e. their</td></tr>
<tr><td class="h"><a name="6525"></a>6525</td><td></td><td></td><td></td><td></td><td class="s">body (the string within the quotes) is interpreted literally.</td></tr>
<tr><td class="h"><a name="6526"></a>6526</td><td></td><td></td><td></td><td></td><td class="s">I&lt;Unquoted identifiers&gt; are compared in UPPERCASE.</td></tr>
<tr><td class="h"><a name="6527"></a>6527</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6528"></a>6528</td><td></td><td></td><td></td><td></td><td class="s">The DBI (currently) does not support the C&lt;SQL_ATTR_METADATA_ID&gt; attribute,</td></tr>
<tr><td class="h"><a name="6529"></a>6529</td><td></td><td></td><td></td><td></td><td class="s">i.e. it behaves like an ODBC driver where C&lt;SQL_ATTR_METADATA_ID&gt; is set to</td></tr>
<tr><td class="h"><a name="6530"></a>6530</td><td></td><td></td><td></td><td></td><td class="s">C&lt;SQL_FALSE&gt;.</td></tr>
<tr><td class="h"><a name="6531"></a>6531</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6532"></a>6532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6533"></a>6533</td><td></td><td></td><td></td><td></td><td class="s">=head2 Transactions</td></tr>
<tr><td class="h"><a name="6534"></a>6534</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6535"></a>6535</td><td></td><td></td><td></td><td></td><td class="s">Transactions are a fundamental part of any robust database system. They</td></tr>
<tr><td class="h"><a name="6536"></a>6536</td><td></td><td></td><td></td><td></td><td class="s">protect against errors and database corruption by ensuring that sets of</td></tr>
<tr><td class="h"><a name="6537"></a>6537</td><td></td><td></td><td></td><td></td><td class="s">related changes to the database take place in atomic (indivisible,</td></tr>
<tr><td class="h"><a name="6538"></a>6538</td><td></td><td></td><td></td><td></td><td class="s">all-or-nothing) units.</td></tr>
<tr><td class="h"><a name="6539"></a>6539</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6540"></a>6540</td><td></td><td></td><td></td><td></td><td class="s">This section applies to databases that support transactions and where</td></tr>
<tr><td class="h"><a name="6541"></a>6541</td><td></td><td></td><td></td><td></td><td class="s">C&lt;AutoCommit&gt; is off.  See L&lt;/AutoCommit&gt; for details of using C&lt;AutoCommit&gt;</td></tr>
<tr><td class="h"><a name="6542"></a>6542</td><td></td><td></td><td></td><td></td><td class="s">with various types of databases.</td></tr>
<tr><td class="h"><a name="6543"></a>6543</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6544"></a>6544</td><td></td><td></td><td></td><td></td><td class="s">The recommended way to implement robust transactions in Perl</td></tr>
<tr><td class="h"><a name="6545"></a>6545</td><td></td><td></td><td></td><td></td><td class="s">applications is to use C&lt;RaiseError&gt; and S&lt;C&lt;eval { ... }&gt;&gt;</td></tr>
<tr><td class="h"><a name="6546"></a>6546</td><td></td><td></td><td></td><td></td><td class="s">(which is very fast, unlike S&lt;C&lt;eval &quot;...&quot;&gt;&gt;). For example:</td></tr>
<tr><td class="h"><a name="6547"></a>6547</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6548"></a>6548</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{AutoCommit} = 0;  # enable transactions, if possible</td></tr>
<tr><td class="h"><a name="6549"></a>6549</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;{RaiseError} = 1;</td></tr>
<tr><td class="h"><a name="6550"></a>6550</td><td></td><td></td><td></td><td></td><td class="s">  eval {</td></tr>
<tr><td class="h"><a name="6551"></a>6551</td><td></td><td></td><td></td><td></td><td class="s">      foo(...)        # do lots of work here</td></tr>
<tr><td class="h"><a name="6552"></a>6552</td><td></td><td></td><td></td><td></td><td class="s">      bar(...)        # including inserts</td></tr>
<tr><td class="h"><a name="6553"></a>6553</td><td></td><td></td><td></td><td></td><td class="s">      baz(...)        # and updates</td></tr>
<tr><td class="h"><a name="6554"></a>6554</td><td></td><td></td><td></td><td></td><td class="s">      $dbh-&gt;commit;   # commit the changes if we get this far</td></tr>
<tr><td class="h"><a name="6555"></a>6555</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="6556"></a>6556</td><td></td><td></td><td></td><td></td><td class="s">  if ($@) {</td></tr>
<tr><td class="h"><a name="6557"></a>6557</td><td></td><td></td><td></td><td></td><td class="s">      warn &quot;Transaction aborted because $@&quot;;</td></tr>
<tr><td class="h"><a name="6558"></a>6558</td><td></td><td></td><td></td><td></td><td class="s">      # now rollback to undo the incomplete changes</td></tr>
<tr><td class="h"><a name="6559"></a>6559</td><td></td><td></td><td></td><td></td><td class="s">      # but do it in an eval{} as it may also fail</td></tr>
<tr><td class="h"><a name="6560"></a>6560</td><td></td><td></td><td></td><td></td><td class="s">      eval { $dbh-&gt;rollback };</td></tr>
<tr><td class="h"><a name="6561"></a>6561</td><td></td><td></td><td></td><td></td><td class="s">      # add other application on-error-clean-up code here</td></tr>
<tr><td class="h"><a name="6562"></a>6562</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6563"></a>6563</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6564"></a>6564</td><td></td><td></td><td></td><td></td><td class="s">If the C&lt;RaiseError&gt; attribute is not set, then DBI calls would need to be</td></tr>
<tr><td class="h"><a name="6565"></a>6565</td><td></td><td></td><td></td><td></td><td class="s">manually checked for errors, typically like this:</td></tr>
<tr><td class="h"><a name="6566"></a>6566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6567"></a>6567</td><td></td><td></td><td></td><td></td><td class="s">  $h-&gt;method(@args) or die $h-&gt;errstr;</td></tr>
<tr><td class="h"><a name="6568"></a>6568</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6569"></a>6569</td><td></td><td></td><td></td><td></td><td class="s">With C&lt;RaiseError&gt; set, the DBI will automatically C&lt;die&gt; if any DBI method</td></tr>
<tr><td class="h"><a name="6570"></a>6570</td><td></td><td></td><td></td><td></td><td class="s">call on that handle (or a child handle) fails, so you don't have to</td></tr>
<tr><td class="h"><a name="6571"></a>6571</td><td></td><td></td><td></td><td></td><td class="s">test the return value of each method call. See L&lt;/RaiseError&gt; for more</td></tr>
<tr><td class="h"><a name="6572"></a>6572</td><td></td><td></td><td></td><td></td><td class="s">details.</td></tr>
<tr><td class="h"><a name="6573"></a>6573</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6574"></a>6574</td><td></td><td></td><td></td><td></td><td class="s">A major advantage of the C&lt;eval&gt; approach is that the transaction will be</td></tr>
<tr><td class="h"><a name="6575"></a>6575</td><td></td><td></td><td></td><td></td><td class="s">properly rolled back if I&lt;any&gt; code (not just DBI calls) in the inner</td></tr>
<tr><td class="h"><a name="6576"></a>6576</td><td></td><td></td><td></td><td></td><td class="s">application dies for any reason. The major advantage of using the</td></tr>
<tr><td class="h"><a name="6577"></a>6577</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$h-E&lt;gt&gt;{RaiseError}&gt; attribute is that all DBI calls will be checked</td></tr>
<tr><td class="h"><a name="6578"></a>6578</td><td></td><td></td><td></td><td></td><td class="s">automatically. Both techniques are strongly recommended.</td></tr>
<tr><td class="h"><a name="6579"></a>6579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6580"></a>6580</td><td></td><td></td><td></td><td></td><td class="s">After calling C&lt;commit&gt; or C&lt;rollback&gt; many drivers will not let you</td></tr>
<tr><td class="h"><a name="6581"></a>6581</td><td></td><td></td><td></td><td></td><td class="s">fetch from a previously active C&lt;SELECT&gt; statement handle that's a child</td></tr>
<tr><td class="h"><a name="6582"></a>6582</td><td></td><td></td><td></td><td></td><td class="s">of the same database handle. A typical way round this is to connect the</td></tr>
<tr><td class="h"><a name="6583"></a>6583</td><td></td><td></td><td></td><td></td><td class="s">the database twice and use one connection for C&lt;SELECT&gt; statements.</td></tr>
<tr><td class="h"><a name="6584"></a>6584</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6585"></a>6585</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/AutoCommit&gt; and L&lt;/disconnect&gt; for other important information</td></tr>
<tr><td class="h"><a name="6586"></a>6586</td><td></td><td></td><td></td><td></td><td class="s">about transactions.</td></tr>
<tr><td class="h"><a name="6587"></a>6587</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6588"></a>6588</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6589"></a>6589</td><td></td><td></td><td></td><td></td><td class="s">=head2 Handling BLOB / LONG / Memo Fields</td></tr>
<tr><td class="h"><a name="6590"></a>6590</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6591"></a>6591</td><td></td><td></td><td></td><td></td><td class="s">Many databases support &quot;blob&quot; (binary large objects), &quot;long&quot;, or similar</td></tr>
<tr><td class="h"><a name="6592"></a>6592</td><td></td><td></td><td></td><td></td><td class="s">datatypes for holding very long strings or large amounts of binary</td></tr>
<tr><td class="h"><a name="6593"></a>6593</td><td></td><td></td><td></td><td></td><td class="s">data in a single field. Some databases support variable length long</td></tr>
<tr><td class="h"><a name="6594"></a>6594</td><td></td><td></td><td></td><td></td><td class="s">values over 2,000,000,000 bytes in length.</td></tr>
<tr><td class="h"><a name="6595"></a>6595</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6596"></a>6596</td><td></td><td></td><td></td><td></td><td class="s">Since values of that size can't usually be held in memory, and because</td></tr>
<tr><td class="h"><a name="6597"></a>6597</td><td></td><td></td><td></td><td></td><td class="s">databases can't usually know in advance the length of the longest long</td></tr>
<tr><td class="h"><a name="6598"></a>6598</td><td></td><td></td><td></td><td></td><td class="s">that will be returned from a C&lt;SELECT&gt; statement (unlike other data</td></tr>
<tr><td class="h"><a name="6599"></a>6599</td><td></td><td></td><td></td><td></td><td class="s">types), some special handling is required.</td></tr>
<tr><td class="h"><a name="6600"></a>6600</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6601"></a>6601</td><td></td><td></td><td></td><td></td><td class="s">In this situation, the value of the C&lt;$h-E&lt;gt&gt;{LongReadLen}&gt;</td></tr>
<tr><td class="h"><a name="6602"></a>6602</td><td></td><td></td><td></td><td></td><td class="s">attribute is used to determine how much buffer space to allocate</td></tr>
<tr><td class="h"><a name="6603"></a>6603</td><td></td><td></td><td></td><td></td><td class="s">when fetching such fields.  The C&lt;$h-E&lt;gt&gt;{LongTruncOk}&gt; attribute</td></tr>
<tr><td class="h"><a name="6604"></a>6604</td><td></td><td></td><td></td><td></td><td class="s">is used to determine how to behave if a fetched value can't fit</td></tr>
<tr><td class="h"><a name="6605"></a>6605</td><td></td><td></td><td></td><td></td><td class="s">into the buffer.</td></tr>
<tr><td class="h"><a name="6606"></a>6606</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6607"></a>6607</td><td></td><td></td><td></td><td></td><td class="s">See the description of L&lt;/LongReadLen&gt; for more information.</td></tr>
<tr><td class="h"><a name="6608"></a>6608</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6609"></a>6609</td><td></td><td></td><td></td><td></td><td class="s">When trying to insert long or binary values, placeholders should be used</td></tr>
<tr><td class="h"><a name="6610"></a>6610</td><td></td><td></td><td></td><td></td><td class="s">since there are often limits on the maximum size of an C&lt;INSERT&gt;</td></tr>
<tr><td class="h"><a name="6611"></a>6611</td><td></td><td></td><td></td><td></td><td class="s">statement and the L&lt;/quote&gt; method generally can't cope with binary</td></tr>
<tr><td class="h"><a name="6612"></a>6612</td><td></td><td></td><td></td><td></td><td class="s">data.  See L&lt;/Placeholders and Bind Values&gt;.</td></tr>
<tr><td class="h"><a name="6613"></a>6613</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6614"></a>6614</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6615"></a>6615</td><td></td><td></td><td></td><td></td><td class="s">=head2 Simple Examples</td></tr>
<tr><td class="h"><a name="6616"></a>6616</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6617"></a>6617</td><td></td><td></td><td></td><td></td><td class="s">Here's a complete example program to select and fetch some data:</td></tr>
<tr><td class="h"><a name="6618"></a>6618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6619"></a>6619</td><td></td><td></td><td></td><td></td><td class="s">  my $data_source = &quot;dbi::DriverName:db_name&quot;;</td></tr>
<tr><td class="h"><a name="6620"></a>6620</td><td></td><td></td><td></td><td></td><td class="s">  my $dbh = DBI-&gt;connect($data_source, $user, $password)</td></tr>
<tr><td class="h"><a name="6621"></a>6621</td><td></td><td></td><td></td><td></td><td class="s">      or die &quot;Can't connect to $data_source: $DBI::errstr&quot;;</td></tr>
<tr><td class="h"><a name="6622"></a>6622</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6623"></a>6623</td><td></td><td></td><td></td><td></td><td class="s">  my $sth = $dbh-&gt;prepare( q{</td></tr>
<tr><td class="h"><a name="6624"></a>6624</td><td></td><td></td><td></td><td></td><td class="s">          SELECT name, phone</td></tr>
<tr><td class="h"><a name="6625"></a>6625</td><td></td><td></td><td></td><td></td><td class="s">          FROM mytelbook</td></tr>
<tr><td class="h"><a name="6626"></a>6626</td><td></td><td></td><td></td><td></td><td class="s">  }) or die &quot;Can't prepare statement: $DBI::errstr&quot;;</td></tr>
<tr><td class="h"><a name="6627"></a>6627</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6628"></a>6628</td><td></td><td></td><td></td><td></td><td class="s">  my $rc = $sth-&gt;execute</td></tr>
<tr><td class="h"><a name="6629"></a>6629</td><td></td><td></td><td></td><td></td><td class="s">      or die &quot;Can't execute statement: $DBI::errstr&quot;;</td></tr>
<tr><td class="h"><a name="6630"></a>6630</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6631"></a>6631</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;Query will return $sth-&gt;{NUM_OF_FIELDS} fields.\n\n&quot;;</td></tr>
<tr><td class="h"><a name="6632"></a>6632</td><td></td><td></td><td></td><td></td><td class="s">  print &quot;Field names: @{ $sth-&gt;{NAME} }\n&quot;;</td></tr>
<tr><td class="h"><a name="6633"></a>6633</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6634"></a>6634</td><td></td><td></td><td></td><td></td><td class="s">  while (($name, $phone) = $sth-&gt;fetchrow_array) {</td></tr>
<tr><td class="h"><a name="6635"></a>6635</td><td></td><td></td><td></td><td></td><td class="s">      print &quot;$name: $phone\n&quot;;</td></tr>
<tr><td class="h"><a name="6636"></a>6636</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6637"></a>6637</td><td></td><td></td><td></td><td></td><td class="s">  # check for problems which may have terminated the fetch early</td></tr>
<tr><td class="h"><a name="6638"></a>6638</td><td></td><td></td><td></td><td></td><td class="s">  die $sth-&gt;errstr if $sth-&gt;err;</td></tr>
<tr><td class="h"><a name="6639"></a>6639</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6640"></a>6640</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;disconnect;</td></tr>
<tr><td class="h"><a name="6641"></a>6641</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6642"></a>6642</td><td></td><td></td><td></td><td></td><td class="s">Here's a complete example program to insert some data from a file.</td></tr>
<tr><td class="h"><a name="6643"></a>6643</td><td></td><td></td><td></td><td></td><td class="s">(This example uses C&lt;RaiseError&gt; to avoid needing to check each call).</td></tr>
<tr><td class="h"><a name="6644"></a>6644</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6645"></a>6645</td><td></td><td></td><td></td><td></td><td class="s">  my $dbh = DBI-&gt;connect(&quot;dbi:DriverName:db_name&quot;, $user, $password, {</td></tr>
<tr><td class="h"><a name="6646"></a>6646</td><td></td><td></td><td></td><td></td><td class="s">      RaiseError =&gt; 1, AutoCommit =&gt; 0</td></tr>
<tr><td class="h"><a name="6647"></a>6647</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="6648"></a>6648</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6649"></a>6649</td><td></td><td></td><td></td><td></td><td class="s">  my $sth = $dbh-&gt;prepare( q{</td></tr>
<tr><td class="h"><a name="6650"></a>6650</td><td></td><td></td><td></td><td></td><td class="s">      INSERT INTO table (name, phone) VALUES (?, ?)</td></tr>
<tr><td class="h"><a name="6651"></a>6651</td><td></td><td></td><td></td><td></td><td class="s">  });</td></tr>
<tr><td class="h"><a name="6652"></a>6652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6653"></a>6653</td><td></td><td></td><td></td><td></td><td class="s">  open FH, &quot;&lt;phone.csv&quot; or die &quot;Unable to open phone.csv: $!&quot;;</td></tr>
<tr><td class="h"><a name="6654"></a>6654</td><td></td><td></td><td></td><td></td><td class="s">  while (&lt;FH&gt;) {</td></tr>
<tr><td class="h"><a name="6655"></a>6655</td><td></td><td></td><td></td><td></td><td class="s">      chomp;</td></tr>
<tr><td class="h"><a name="6656"></a>6656</td><td></td><td></td><td></td><td></td><td class="s">      my ($name, $phone) = split /,/;</td></tr>
<tr><td class="h"><a name="6657"></a>6657</td><td></td><td></td><td></td><td></td><td class="s">      $sth-&gt;execute($name, $phone);</td></tr>
<tr><td class="h"><a name="6658"></a>6658</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6659"></a>6659</td><td></td><td></td><td></td><td></td><td class="s">  close FH;</td></tr>
<tr><td class="h"><a name="6660"></a>6660</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6661"></a>6661</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;commit;</td></tr>
<tr><td class="h"><a name="6662"></a>6662</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;disconnect;</td></tr>
<tr><td class="h"><a name="6663"></a>6663</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6664"></a>6664</td><td></td><td></td><td></td><td></td><td class="s">Here's how to convert fetched NULLs (undefined values) into empty strings:</td></tr>
<tr><td class="h"><a name="6665"></a>6665</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6666"></a>6666</td><td></td><td></td><td></td><td></td><td class="s">  while($row = $sth-&gt;fetchrow_arrayref) {</td></tr>
<tr><td class="h"><a name="6667"></a>6667</td><td></td><td></td><td></td><td></td><td class="s">    # this is a fast and simple way to deal with nulls:</td></tr>
<tr><td class="h"><a name="6668"></a>6668</td><td></td><td></td><td></td><td></td><td class="s">    foreach (@$row) { $_ = '' unless defined }</td></tr>
<tr><td class="h"><a name="6669"></a>6669</td><td></td><td></td><td></td><td></td><td class="s">    print &quot;@$row\n&quot;;</td></tr>
<tr><td class="h"><a name="6670"></a>6670</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6671"></a>6671</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6672"></a>6672</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;q{...}&gt; style quoting used in these examples avoids clashing with</td></tr>
<tr><td class="h"><a name="6673"></a>6673</td><td></td><td></td><td></td><td></td><td class="s">quotes that may be used in the SQL statement. Use the double-quote like</td></tr>
<tr><td class="h"><a name="6674"></a>6674</td><td></td><td></td><td></td><td></td><td class="s">C&lt;qq{...}&gt; operator if you want to interpolate variables into the string.</td></tr>
<tr><td class="h"><a name="6675"></a>6675</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;perlop/&quot;Quote and Quote-like Operators&quot;&gt; for more details.</td></tr>
<tr><td class="h"><a name="6676"></a>6676</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6677"></a>6677</td><td></td><td></td><td></td><td></td><td class="s">=head2 Threads and Thread Safety</td></tr>
<tr><td class="h"><a name="6678"></a>6678</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6679"></a>6679</td><td></td><td></td><td></td><td></td><td class="s">Perl 5.7 and later support a new threading model called iThreads.</td></tr>
<tr><td class="h"><a name="6680"></a>6680</td><td></td><td></td><td></td><td></td><td class="s">(The old &quot;5.005 style&quot; threads are not supported by the DBI.)</td></tr>
<tr><td class="h"><a name="6681"></a>6681</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6682"></a>6682</td><td></td><td></td><td></td><td></td><td class="s">In the iThreads model each thread has it's own copy of the perl</td></tr>
<tr><td class="h"><a name="6683"></a>6683</td><td></td><td></td><td></td><td></td><td class="s">interpreter.  When a new thread is created the original perl</td></tr>
<tr><td class="h"><a name="6684"></a>6684</td><td></td><td></td><td></td><td></td><td class="s">interpreter is 'cloned' to create a new copy for the new thread.</td></tr>
<tr><td class="h"><a name="6685"></a>6685</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6686"></a>6686</td><td></td><td></td><td></td><td></td><td class="s">If the DBI and drivers are loaded and handles created before the</td></tr>
<tr><td class="h"><a name="6687"></a>6687</td><td></td><td></td><td></td><td></td><td class="s">thread is created then it will get a cloned copy of the DBI, the</td></tr>
<tr><td class="h"><a name="6688"></a>6688</td><td></td><td></td><td></td><td></td><td class="s">drivers and the handles.</td></tr>
<tr><td class="h"><a name="6689"></a>6689</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6690"></a>6690</td><td></td><td></td><td></td><td></td><td class="s">However, the internal pointer data within the handles will refer</td></tr>
<tr><td class="h"><a name="6691"></a>6691</td><td></td><td></td><td></td><td></td><td class="s">to the DBI and drivers in the original interpreter. Using those</td></tr>
<tr><td class="h"><a name="6692"></a>6692</td><td></td><td></td><td></td><td></td><td class="s">handles in the new interpreter thread is not safe, so the DBI detects</td></tr>
<tr><td class="h"><a name="6693"></a>6693</td><td></td><td></td><td></td><td></td><td class="s">this and croaks on any method call using handles that don't belong</td></tr>
<tr><td class="h"><a name="6694"></a>6694</td><td></td><td></td><td></td><td></td><td class="s">to the current thread (except for DESTROY).</td></tr>
<tr><td class="h"><a name="6695"></a>6695</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6696"></a>6696</td><td></td><td></td><td></td><td></td><td class="s">Because of this (possibly temporary) restriction, newly created</td></tr>
<tr><td class="h"><a name="6697"></a>6697</td><td></td><td></td><td></td><td></td><td class="s">threads must make their own connctions to the database. Handles</td></tr>
<tr><td class="h"><a name="6698"></a>6698</td><td></td><td></td><td></td><td></td><td class="s">can't be shared across threads.</td></tr>
<tr><td class="h"><a name="6699"></a>6699</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6700"></a>6700</td><td></td><td></td><td></td><td></td><td class="s">But BEWARE, some underlying database APIs (the code the DBD driver</td></tr>
<tr><td class="h"><a name="6701"></a>6701</td><td></td><td></td><td></td><td></td><td class="s">uses to talk to the database, often supplied by the database vendor)</td></tr>
<tr><td class="h"><a name="6702"></a>6702</td><td></td><td></td><td></td><td></td><td class="s">are not thread safe. If it's not thread safe, then allowing more</td></tr>
<tr><td class="h"><a name="6703"></a>6703</td><td></td><td></td><td></td><td></td><td class="s">than one thread to enter the code at the same time may cause</td></tr>
<tr><td class="h"><a name="6704"></a>6704</td><td></td><td></td><td></td><td></td><td class="s">subtle/serious problems. In some cases allowing more than</td></tr>
<tr><td class="h"><a name="6705"></a>6705</td><td></td><td></td><td></td><td></td><td class="s">one thread to enter the code, even if I&lt;not&gt; at the same time,</td></tr>
<tr><td class="h"><a name="6706"></a>6706</td><td></td><td></td><td></td><td></td><td class="s">can cause problems. You have been warned.</td></tr>
<tr><td class="h"><a name="6707"></a>6707</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6708"></a>6708</td><td></td><td></td><td></td><td></td><td class="s">Using DBI with perl threads is not yet recommended for production</td></tr>
<tr><td class="h"><a name="6709"></a>6709</td><td></td><td></td><td></td><td></td><td class="s">environments. For more information see</td></tr>
<tr><td class="h"><a name="6710"></a>6710</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://www.perlmonks.org/index.pl?node_id=288022&gt;</td></tr>
<tr><td class="h"><a name="6711"></a>6711</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6712"></a>6712</td><td></td><td></td><td></td><td></td><td class="s">Note: There is a bug in perl 5.8.2 when configured with threads</td></tr>
<tr><td class="h"><a name="6713"></a>6713</td><td></td><td></td><td></td><td></td><td class="s">and debugging enabled (bug #24463) which causes a DBI test to fail.</td></tr>
<tr><td class="h"><a name="6714"></a>6714</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6715"></a>6715</td><td></td><td></td><td></td><td></td><td class="s">=head2 Signal Handling and Canceling Operations</td></tr>
<tr><td class="h"><a name="6716"></a>6716</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6717"></a>6717</td><td></td><td></td><td></td><td></td><td class="s">[The following only applies to systems with unix-like signal handling.</td></tr>
<tr><td class="h"><a name="6718"></a>6718</td><td></td><td></td><td></td><td></td><td class="s">I'd welcome additions for other systems, especially Windows.]</td></tr>
<tr><td class="h"><a name="6719"></a>6719</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6720"></a>6720</td><td></td><td></td><td></td><td></td><td class="s">The first thing to say is that signal handling in Perl versions less</td></tr>
<tr><td class="h"><a name="6721"></a>6721</td><td></td><td></td><td></td><td></td><td class="s">than 5.8 is I&lt;not&gt; safe. There is always a small risk of Perl</td></tr>
<tr><td class="h"><a name="6722"></a>6722</td><td></td><td></td><td></td><td></td><td class="s">crashing and/or core dumping when, or after, handling a signal</td></tr>
<tr><td class="h"><a name="6723"></a>6723</td><td></td><td></td><td></td><td></td><td class="s">because the signal could arrive and be handled while internal data</td></tr>
<tr><td class="h"><a name="6724"></a>6724</td><td></td><td></td><td></td><td></td><td class="s">structures are being changed. If the signal handling code</td></tr>
<tr><td class="h"><a name="6725"></a>6725</td><td></td><td></td><td></td><td></td><td class="s">used those same internal data structures it could cause all manner</td></tr>
<tr><td class="h"><a name="6726"></a>6726</td><td></td><td></td><td></td><td></td><td class="s">of subtle and not-so-subtle problems.  The risk was reduced with</td></tr>
<tr><td class="h"><a name="6727"></a>6727</td><td></td><td></td><td></td><td></td><td class="s">5.4.4 but was still present in all perls up through 5.8.0.</td></tr>
<tr><td class="h"><a name="6728"></a>6728</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6729"></a>6729</td><td></td><td></td><td></td><td></td><td class="s">Beginning in perl 5.8.0 perl implements 'safe' signal handling if</td></tr>
<tr><td class="h"><a name="6730"></a>6730</td><td></td><td></td><td></td><td></td><td class="s">your system has the POSIX sigaction() routine. Now when a signal</td></tr>
<tr><td class="h"><a name="6731"></a>6731</td><td></td><td></td><td></td><td></td><td class="s">is delivered perl just makes a note of it but does I&lt;not&gt; run the</td></tr>
<tr><td class="h"><a name="6732"></a>6732</td><td></td><td></td><td></td><td></td><td class="s">%SIG handler. The handling is 'defered' until a 'safe' moment.</td></tr>
<tr><td class="h"><a name="6733"></a>6733</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6734"></a>6734</td><td></td><td></td><td></td><td></td><td class="s">Although this change made signal handling safe, it also lead to</td></tr>
<tr><td class="h"><a name="6735"></a>6735</td><td></td><td></td><td></td><td></td><td class="s">a problem with signals being defered for longer than you'd like.</td></tr>
<tr><td class="h"><a name="6736"></a>6736</td><td></td><td></td><td></td><td></td><td class="s">If a signal arrived while executing a system call, such as waiting</td></tr>
<tr><td class="h"><a name="6737"></a>6737</td><td></td><td></td><td></td><td></td><td class="s">for data on a network connection, the signal is noted and then the</td></tr>
<tr><td class="h"><a name="6738"></a>6738</td><td></td><td></td><td></td><td></td><td class="s">system call that was executing returns with an EINTR error code</td></tr>
<tr><td class="h"><a name="6739"></a>6739</td><td></td><td></td><td></td><td></td><td class="s">to indicate that it was interrupted. All fine so far.</td></tr>
<tr><td class="h"><a name="6740"></a>6740</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6741"></a>6741</td><td></td><td></td><td></td><td></td><td class="s">The problem comes when the code that made the system call sees the</td></tr>
<tr><td class="h"><a name="6742"></a>6742</td><td></td><td></td><td></td><td></td><td class="s">EINTR code and decides it's going to call it again. Perl doesn't</td></tr>
<tr><td class="h"><a name="6743"></a>6743</td><td></td><td></td><td></td><td></td><td class="s">do that, but database code sometimes does. If that happens then the</td></tr>
<tr><td class="h"><a name="6744"></a>6744</td><td></td><td></td><td></td><td></td><td class="s">signal handler doesn't get called untill later. Maybe much later.</td></tr>
<tr><td class="h"><a name="6745"></a>6745</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6746"></a>6746</td><td></td><td></td><td></td><td></td><td class="s">Fortunately there are ways around this which we'll discuss below.</td></tr>
<tr><td class="h"><a name="6747"></a>6747</td><td></td><td></td><td></td><td></td><td class="s">Unfortunately they make signals unsafe again.</td></tr>
<tr><td class="h"><a name="6748"></a>6748</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6749"></a>6749</td><td></td><td></td><td></td><td></td><td class="s">The two most common uses of signals in relation to the DBI are for</td></tr>
<tr><td class="h"><a name="6750"></a>6750</td><td></td><td></td><td></td><td></td><td class="s">canceling operations when the user types Ctrl-C (interrupt), and for</td></tr>
<tr><td class="h"><a name="6751"></a>6751</td><td></td><td></td><td></td><td></td><td class="s">implementing a timeout using C&lt;alarm()&gt; and C&lt;$SIG{ALRM}&gt;.</td></tr>
<tr><td class="h"><a name="6752"></a>6752</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6753"></a>6753</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="6754"></a>6754</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6755"></a>6755</td><td></td><td></td><td></td><td></td><td class="s">=item Cancel</td></tr>
<tr><td class="h"><a name="6756"></a>6756</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6757"></a>6757</td><td></td><td></td><td></td><td></td><td class="s">The DBI provides a C&lt;cancel&gt; method for statement handles. The</td></tr>
<tr><td class="h"><a name="6758"></a>6758</td><td></td><td></td><td></td><td></td><td class="s">C&lt;cancel&gt; method should abort the current operation and is designed</td></tr>
<tr><td class="h"><a name="6759"></a>6759</td><td></td><td></td><td></td><td></td><td class="s">to be called from a signal handler.  For example:</td></tr>
<tr><td class="h"><a name="6760"></a>6760</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6761"></a>6761</td><td></td><td></td><td></td><td></td><td class="s">  $SIG{INT} = sub { $sth-&gt;cancel };</td></tr>
<tr><td class="h"><a name="6762"></a>6762</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6763"></a>6763</td><td></td><td></td><td></td><td></td><td class="s">However, few drivers implement this (the DBI provides a default</td></tr>
<tr><td class="h"><a name="6764"></a>6764</td><td></td><td></td><td></td><td></td><td class="s">method that just returns C&lt;undef&gt;) and, even if implemented, there</td></tr>
<tr><td class="h"><a name="6765"></a>6765</td><td></td><td></td><td></td><td></td><td class="s">is still a possibility that the statement handle, and even the</td></tr>
<tr><td class="h"><a name="6766"></a>6766</td><td></td><td></td><td></td><td></td><td class="s">parent database handle, will not be usable afterwards.</td></tr>
<tr><td class="h"><a name="6767"></a>6767</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6768"></a>6768</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;cancel&gt; returns true, then it has successfully</td></tr>
<tr><td class="h"><a name="6769"></a>6769</td><td></td><td></td><td></td><td></td><td class="s">invoked the database engine's own cancel function.  If it returns false,</td></tr>
<tr><td class="h"><a name="6770"></a>6770</td><td></td><td></td><td></td><td></td><td class="s">then C&lt;cancel&gt; failed. If it returns C&lt;undef&gt;, then the database</td></tr>
<tr><td class="h"><a name="6771"></a>6771</td><td></td><td></td><td></td><td></td><td class="s">driver does not have cancel implemented - very few do.</td></tr>
<tr><td class="h"><a name="6772"></a>6772</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6773"></a>6773</td><td></td><td></td><td></td><td></td><td class="s">=item Timeout</td></tr>
<tr><td class="h"><a name="6774"></a>6774</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6775"></a>6775</td><td></td><td></td><td></td><td></td><td class="s">The traditional way to implement a timeout is to set C&lt;$SIG{ALRM}&gt;</td></tr>
<tr><td class="h"><a name="6776"></a>6776</td><td></td><td></td><td></td><td></td><td class="s">to refer to some code that will be executed when an ALRM signal</td></tr>
<tr><td class="h"><a name="6777"></a>6777</td><td></td><td></td><td></td><td></td><td class="s">arrives and then to call alarm($seconds) to schedule an ALRM signal</td></tr>
<tr><td class="h"><a name="6778"></a>6778</td><td></td><td></td><td></td><td></td><td class="s">to be delivered $seconds in the future. For example:</td></tr>
<tr><td class="h"><a name="6779"></a>6779</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6780"></a>6780</td><td></td><td></td><td></td><td></td><td class="s">  eval {</td></tr>
<tr><td class="h"><a name="6781"></a>6781</td><td></td><td></td><td></td><td></td><td class="s">    local $SIG{ALRM} = sub { die &quot;TIMEOUT\n&quot; };</td></tr>
<tr><td class="h"><a name="6782"></a>6782</td><td></td><td></td><td></td><td></td><td class="s">    alarm($seconds);</td></tr>
<tr><td class="h"><a name="6783"></a>6783</td><td></td><td></td><td></td><td></td><td class="s">    ... code to execute with timeout here ...</td></tr>
<tr><td class="h"><a name="6784"></a>6784</td><td></td><td></td><td></td><td></td><td class="s">    alarm(0);  # cancel alarm (if code ran fast)</td></tr>
<tr><td class="h"><a name="6785"></a>6785</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="6786"></a>6786</td><td></td><td></td><td></td><td></td><td class="s">  alarm(0);    # cancel alarm (if eval failed)</td></tr>
<tr><td class="h"><a name="6787"></a>6787</td><td></td><td></td><td></td><td></td><td class="s">  if ( $@ eq &quot;TIMEOUT\n&quot; ) { ... }</td></tr>
<tr><td class="h"><a name="6788"></a>6788</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6789"></a>6789</td><td></td><td></td><td></td><td></td><td class="s">Unfortunately, as described above, this won't always work as expected,</td></tr>
<tr><td class="h"><a name="6790"></a>6790</td><td></td><td></td><td></td><td></td><td class="s">depending on your perl version and the underlying database code.</td></tr>
<tr><td class="h"><a name="6791"></a>6791</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6792"></a>6792</td><td></td><td></td><td></td><td></td><td class="s">With Oracle for instance (DBD::Oracle), if the system which hosts</td></tr>
<tr><td class="h"><a name="6793"></a>6793</td><td></td><td></td><td></td><td></td><td class="s">the database is down the DBI-&gt;connect() call will hang for several</td></tr>
<tr><td class="h"><a name="6794"></a>6794</td><td></td><td></td><td></td><td></td><td class="s">minutes before returning an error.</td></tr>
<tr><td class="h"><a name="6795"></a>6795</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6796"></a>6796</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="6797"></a>6797</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6798"></a>6798</td><td></td><td></td><td></td><td></td><td class="s">The solution on these systems is to use the C&lt;POSIX::sigaction()&gt;</td></tr>
<tr><td class="h"><a name="6799"></a>6799</td><td></td><td></td><td></td><td></td><td class="s">routine to gain low level access to how the signal handler is installed.</td></tr>
<tr><td class="h"><a name="6800"></a>6800</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6801"></a>6801</td><td></td><td></td><td></td><td></td><td class="s">The code would look something like this (for the DBD-Oracle connect()):</td></tr>
<tr><td class="h"><a name="6802"></a>6802</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6803"></a>6803</td><td></td><td></td><td></td><td></td><td class="s">   use POSIX ':signal_h';</td></tr>
<tr><td class="h"><a name="6804"></a>6804</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6805"></a>6805</td><td></td><td></td><td></td><td></td><td class="s">   my $mask = POSIX::SigSet-&gt;new( SIGALRM ); # signals to mask in the handler</td></tr>
<tr><td class="h"><a name="6806"></a>6806</td><td></td><td></td><td></td><td></td><td class="s">   my $action = POSIX::SigAction-&gt;new(</td></tr>
<tr><td class="h"><a name="6807"></a>6807</td><td></td><td></td><td></td><td></td><td class="s">       sub { die &quot;connect timeout&quot; },        # the handler code ref</td></tr>
<tr><td class="h"><a name="6808"></a>6808</td><td></td><td></td><td></td><td></td><td class="s">       $mask,</td></tr>
<tr><td class="h"><a name="6809"></a>6809</td><td></td><td></td><td></td><td></td><td class="s">       # not using (perl 5.8.2 and later) 'safe' switch or sa_flags</td></tr>
<tr><td class="h"><a name="6810"></a>6810</td><td></td><td></td><td></td><td></td><td class="s">   );</td></tr>
<tr><td class="h"><a name="6811"></a>6811</td><td></td><td></td><td></td><td></td><td class="s">   my $oldaction = POSIX::SigAction-&gt;new();</td></tr>
<tr><td class="h"><a name="6812"></a>6812</td><td></td><td></td><td></td><td></td><td class="s">   sigaction( 'ALRM', $action, $oldaction );</td></tr>
<tr><td class="h"><a name="6813"></a>6813</td><td></td><td></td><td></td><td></td><td class="s">   my $dbh;</td></tr>
<tr><td class="h"><a name="6814"></a>6814</td><td></td><td></td><td></td><td></td><td class="s">   eval {</td></tr>
<tr><td class="h"><a name="6815"></a>6815</td><td></td><td></td><td></td><td></td><td class="s">      alarm(5); # seconds before time out</td></tr>
<tr><td class="h"><a name="6816"></a>6816</td><td></td><td></td><td></td><td></td><td class="s">      $dbh = DBI-&gt;connect(&quot;dbi:Oracle:$dsn&quot; ... );</td></tr>
<tr><td class="h"><a name="6817"></a>6817</td><td></td><td></td><td></td><td></td><td class="s">      alarm(0); # cancel alarm (if connect worked fast)</td></tr>
<tr><td class="h"><a name="6818"></a>6818</td><td></td><td></td><td></td><td></td><td class="s">   };</td></tr>
<tr><td class="h"><a name="6819"></a>6819</td><td></td><td></td><td></td><td></td><td class="s">   alarm(0);    # cancel alarm (if eval failed)</td></tr>
<tr><td class="h"><a name="6820"></a>6820</td><td></td><td></td><td></td><td></td><td class="s">   sigaction( 'ALRM', $oldaction );  # restore original signal handler</td></tr>
<tr><td class="h"><a name="6821"></a>6821</td><td></td><td></td><td></td><td></td><td class="s">   if ( $@ ) ....</td></tr>
<tr><td class="h"><a name="6822"></a>6822</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6823"></a>6823</td><td></td><td></td><td></td><td></td><td class="s">Similar techniques can be used for canceling statement execution.</td></tr>
<tr><td class="h"><a name="6824"></a>6824</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6825"></a>6825</td><td></td><td></td><td></td><td></td><td class="s">Unfortunately, this solution is somewhat messy, and it does I&lt;not&gt; work with</td></tr>
<tr><td class="h"><a name="6826"></a>6826</td><td></td><td></td><td></td><td></td><td class="s">perl versions less than perl 5.8 where C&lt;POSIX::sigaction()&gt; appears to be broken.</td></tr>
<tr><td class="h"><a name="6827"></a>6827</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6828"></a>6828</td><td></td><td></td><td></td><td></td><td class="s">For a cleaner implementation that works across perl versions, see Lincoln Baxter's</td></tr>
<tr><td class="h"><a name="6829"></a>6829</td><td></td><td></td><td></td><td></td><td class="s">Sys::SigAction module at L&lt;http://search.cpan.org/~lbaxter/Sys-SigAction/&gt;.</td></tr>
<tr><td class="h"><a name="6830"></a>6830</td><td></td><td></td><td></td><td></td><td class="s">The documentation for Sys::SigAction includes an longer discussion</td></tr>
<tr><td class="h"><a name="6831"></a>6831</td><td></td><td></td><td></td><td></td><td class="s">of this problem, and a DBD::Oracle test script.</td></tr>
<tr><td class="h"><a name="6832"></a>6832</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6833"></a>6833</td><td></td><td></td><td></td><td></td><td class="s">Be sure to read all the signal handling sections of the L&lt;perlipc&gt; manual.</td></tr>
<tr><td class="h"><a name="6834"></a>6834</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6835"></a>6835</td><td></td><td></td><td></td><td></td><td class="s">And finally, two more points to keep firmly in mind. Firstly,</td></tr>
<tr><td class="h"><a name="6836"></a>6836</td><td></td><td></td><td></td><td></td><td class="s">remember that what we've done here is essentially revert to old</td></tr>
<tr><td class="h"><a name="6837"></a>6837</td><td></td><td></td><td></td><td></td><td class="s">style I&lt;unsafe&gt; handling of these signals. So do as little as</td></tr>
<tr><td class="h"><a name="6838"></a>6838</td><td></td><td></td><td></td><td></td><td class="s">possible in the handler.  Ideally just die(). Secondly, the handles</td></tr>
<tr><td class="h"><a name="6839"></a>6839</td><td></td><td></td><td></td><td></td><td class="s">in use at the time the signal is handled may not be safe to use</td></tr>
<tr><td class="h"><a name="6840"></a>6840</td><td></td><td></td><td></td><td></td><td class="s">afterwards.</td></tr>
<tr><td class="h"><a name="6841"></a>6841</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6842"></a>6842</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6843"></a>6843</td><td></td><td></td><td></td><td></td><td class="s">=head2 Subclassing the DBI</td></tr>
<tr><td class="h"><a name="6844"></a>6844</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6845"></a>6845</td><td></td><td></td><td></td><td></td><td class="s">DBI can be subclassed and extended just like any other object</td></tr>
<tr><td class="h"><a name="6846"></a>6846</td><td></td><td></td><td></td><td></td><td class="s">oriented module.  Before we talk about how to do that, it's important</td></tr>
<tr><td class="h"><a name="6847"></a>6847</td><td></td><td></td><td></td><td></td><td class="s">to be clear about the various DBI classes and how they work together.</td></tr>
<tr><td class="h"><a name="6848"></a>6848</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6849"></a>6849</td><td></td><td></td><td></td><td></td><td class="s">By default C&lt;$dbh = DBI-E&lt;gt&gt;connect(...)&gt; returns a $dbh blessed</td></tr>
<tr><td class="h"><a name="6850"></a>6850</td><td></td><td></td><td></td><td></td><td class="s">into the C&lt;DBI::db&gt; class.  And the C&lt;$dbh-E&lt;gt&gt;prepare&gt; method</td></tr>
<tr><td class="h"><a name="6851"></a>6851</td><td></td><td></td><td></td><td></td><td class="s">returns an $sth blessed into the C&lt;DBI::st&gt; class (actually it</td></tr>
<tr><td class="h"><a name="6852"></a>6852</td><td></td><td></td><td></td><td></td><td class="s">simply changes the last four characters of the calling handle class</td></tr>
<tr><td class="h"><a name="6853"></a>6853</td><td></td><td></td><td></td><td></td><td class="s">to be C&lt;::st&gt;).</td></tr>
<tr><td class="h"><a name="6854"></a>6854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6855"></a>6855</td><td></td><td></td><td></td><td></td><td class="s">The leading 'C&lt;DBI&gt;' is known as the 'root class' and the extra</td></tr>
<tr><td class="h"><a name="6856"></a>6856</td><td></td><td></td><td></td><td></td><td class="s">'C&lt;::db&gt;' or 'C&lt;::st&gt;' are the 'handle type suffixes'. If you want</td></tr>
<tr><td class="h"><a name="6857"></a>6857</td><td></td><td></td><td></td><td></td><td class="s">to subclass the DBI you'll need to put your overriding methods into</td></tr>
<tr><td class="h"><a name="6858"></a>6858</td><td></td><td></td><td></td><td></td><td class="s">the appropriate classes.  For example, if you want to use a root class</td></tr>
<tr><td class="h"><a name="6859"></a>6859</td><td></td><td></td><td></td><td></td><td class="s">of C&lt;MySubDBI&gt; and override the do(), prepare() and execute() methods,</td></tr>
<tr><td class="h"><a name="6860"></a>6860</td><td></td><td></td><td></td><td></td><td class="s">then your do() and prepare() methods should be in the C&lt;MySubDBI::db&gt;</td></tr>
<tr><td class="h"><a name="6861"></a>6861</td><td></td><td></td><td></td><td></td><td class="s">class and the execute() method should be in the C&lt;MySubDBI::st&gt; class.</td></tr>
<tr><td class="h"><a name="6862"></a>6862</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6863"></a>6863</td><td></td><td></td><td></td><td></td><td class="s">To setup the inheritance hierarchy the @ISA variable in C&lt;MySubDBI::db&gt;</td></tr>
<tr><td class="h"><a name="6864"></a>6864</td><td></td><td></td><td></td><td></td><td class="s">should include C&lt;DBI::db&gt; and the @ISA variable in C&lt;MySubDBI::st&gt;</td></tr>
<tr><td class="h"><a name="6865"></a>6865</td><td></td><td></td><td></td><td></td><td class="s">should include C&lt;DBI::st&gt;.  The C&lt;MySubDBI&gt; root class itself isn't</td></tr>
<tr><td class="h"><a name="6866"></a>6866</td><td></td><td></td><td></td><td></td><td class="s">currently used for anything visible and so, apart from setting @ISA</td></tr>
<tr><td class="h"><a name="6867"></a>6867</td><td></td><td></td><td></td><td></td><td class="s">to include C&lt;DBI&gt;, it can be left empty.</td></tr>
<tr><td class="h"><a name="6868"></a>6868</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6869"></a>6869</td><td></td><td></td><td></td><td></td><td class="s">So, having put your overriding methods into the right classes, and</td></tr>
<tr><td class="h"><a name="6870"></a>6870</td><td></td><td></td><td></td><td></td><td class="s">setup the inheritance hierarchy, how do you get the DBI to use them?</td></tr>
<tr><td class="h"><a name="6871"></a>6871</td><td></td><td></td><td></td><td></td><td class="s">You have two choices, either a static method call using the name</td></tr>
<tr><td class="h"><a name="6872"></a>6872</td><td></td><td></td><td></td><td></td><td class="s">of your subclass:</td></tr>
<tr><td class="h"><a name="6873"></a>6873</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6874"></a>6874</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = MySubDBI-&gt;connect(...);</td></tr>
<tr><td class="h"><a name="6875"></a>6875</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6876"></a>6876</td><td></td><td></td><td></td><td></td><td class="s">or specifying a C&lt;RootClass&gt; attribute:</td></tr>
<tr><td class="h"><a name="6877"></a>6877</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6878"></a>6878</td><td></td><td></td><td></td><td></td><td class="s">  $dbh = DBI-&gt;connect(..., { RootClass =&gt; 'MySubDBI' });</td></tr>
<tr><td class="h"><a name="6879"></a>6879</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6880"></a>6880</td><td></td><td></td><td></td><td></td><td class="s">If both forms are used then the attribute takes precedence.</td></tr>
<tr><td class="h"><a name="6881"></a>6881</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6882"></a>6882</td><td></td><td></td><td></td><td></td><td class="s">The only differences between the two are that using an explicit</td></tr>
<tr><td class="h"><a name="6883"></a>6883</td><td></td><td></td><td></td><td></td><td class="s">RootClass attribute will a) make the DBI automatically attempt to load</td></tr>
<tr><td class="h"><a name="6884"></a>6884</td><td></td><td></td><td></td><td></td><td class="s">a module by that name if the class doesn't exist, and b) won't call</td></tr>
<tr><td class="h"><a name="6885"></a>6885</td><td></td><td></td><td></td><td></td><td class="s">your MySubDBI::connect() method, if you have one.</td></tr>
<tr><td class="h"><a name="6886"></a>6886</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6887"></a>6887</td><td></td><td></td><td></td><td></td><td class="s">When subclassing is being used then, after a successful new</td></tr>
<tr><td class="h"><a name="6888"></a>6888</td><td></td><td></td><td></td><td></td><td class="s">connect, the DBI-&gt;connect method automatically calls:</td></tr>
<tr><td class="h"><a name="6889"></a>6889</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6890"></a>6890</td><td></td><td></td><td></td><td></td><td class="s">  $dbh-&gt;connected($dsn, $user, $pass, \%attr);</td></tr>
<tr><td class="h"><a name="6891"></a>6891</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6892"></a>6892</td><td></td><td></td><td></td><td></td><td class="s">The default method does nothing. The call is made just to simplify</td></tr>
<tr><td class="h"><a name="6893"></a>6893</td><td></td><td></td><td></td><td></td><td class="s">any post-connection setup that your subclass may want to perform.</td></tr>
<tr><td class="h"><a name="6894"></a>6894</td><td></td><td></td><td></td><td></td><td class="s">The parameters are the same as passed to DBI-&gt;connect.</td></tr>
<tr><td class="h"><a name="6895"></a>6895</td><td></td><td></td><td></td><td></td><td class="s">If your subclass supplies a connected method, it should be part of the</td></tr>
<tr><td class="h"><a name="6896"></a>6896</td><td></td><td></td><td></td><td></td><td class="s">MySubDBI::db package.</td></tr>
<tr><td class="h"><a name="6897"></a>6897</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6898"></a>6898</td><td></td><td></td><td></td><td></td><td class="s">One more thing to note: you must let the DBI do the handle creation.  If you</td></tr>
<tr><td class="h"><a name="6899"></a>6899</td><td></td><td></td><td></td><td></td><td class="s">want to override the connect() method in your *::dr class then it must still</td></tr>
<tr><td class="h"><a name="6900"></a>6900</td><td></td><td></td><td></td><td></td><td class="s">call SUPER::connect to get a $dbh to work with. Similarly, an overridden</td></tr>
<tr><td class="h"><a name="6901"></a>6901</td><td></td><td></td><td></td><td></td><td class="s">prepare() method in *::db must still call SUPER::prepare to get a $sth.</td></tr>
<tr><td class="h"><a name="6902"></a>6902</td><td></td><td></td><td></td><td></td><td class="s">If you try to create your own handles using bless() then you'll find the DBI</td></tr>
<tr><td class="h"><a name="6903"></a>6903</td><td></td><td></td><td></td><td></td><td class="s">will reject them with an &quot;is not a DBI handle (has no magic)&quot; error.</td></tr>
<tr><td class="h"><a name="6904"></a>6904</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6905"></a>6905</td><td></td><td></td><td></td><td></td><td class="s">Here's a brief example of a DBI subclass.  A more thorough example</td></tr>
<tr><td class="h"><a name="6906"></a>6906</td><td></td><td></td><td></td><td></td><td class="s">can be found in F&lt;t/subclass.t&gt; in the DBI distribution.</td></tr>
<tr><td class="h"><a name="6907"></a>6907</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6908"></a>6908</td><td></td><td></td><td></td><td></td><td class="s">  package MySubDBI;</td></tr>
<tr><td class="h"><a name="6909"></a>6909</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6910"></a>6910</td><td></td><td></td><td></td><td></td><td class="s">  use strict;</td></tr>
<tr><td class="h"><a name="6911"></a>6911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6912"></a>6912</td><td></td><td></td><td></td><td></td><td class="s">  use DBI;</td></tr>
<tr><td class="h"><a name="6913"></a>6913</td><td></td><td></td><td></td><td></td><td class="s">  use vars qw(@ISA);</td></tr>
<tr><td class="h"><a name="6914"></a>6914</td><td></td><td></td><td></td><td></td><td class="s">  @ISA = qw(DBI);</td></tr>
<tr><td class="h"><a name="6915"></a>6915</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6916"></a>6916</td><td></td><td></td><td></td><td></td><td class="s">  package MySubDBI::db;</td></tr>
<tr><td class="h"><a name="6917"></a>6917</td><td></td><td></td><td></td><td></td><td class="s">  use vars qw(@ISA);</td></tr>
<tr><td class="h"><a name="6918"></a>6918</td><td></td><td></td><td></td><td></td><td class="s">  @ISA = qw(DBI::db);</td></tr>
<tr><td class="h"><a name="6919"></a>6919</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6920"></a>6920</td><td></td><td></td><td></td><td></td><td class="s">  sub prepare {</td></tr>
<tr><td class="h"><a name="6921"></a>6921</td><td></td><td></td><td></td><td></td><td class="s">    my ($dbh, @args) = @_;</td></tr>
<tr><td class="h"><a name="6922"></a>6922</td><td></td><td></td><td></td><td></td><td class="s">    my $sth = $dbh-&gt;SUPER::prepare(@args)</td></tr>
<tr><td class="h"><a name="6923"></a>6923</td><td></td><td></td><td></td><td></td><td class="s">        or return;</td></tr>
<tr><td class="h"><a name="6924"></a>6924</td><td></td><td></td><td></td><td></td><td class="s">    $sth-&gt;{private_mysubdbi_info} = { foo =&gt; 'bar' };</td></tr>
<tr><td class="h"><a name="6925"></a>6925</td><td></td><td></td><td></td><td></td><td class="s">    return $sth;</td></tr>
<tr><td class="h"><a name="6926"></a>6926</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6927"></a>6927</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6928"></a>6928</td><td></td><td></td><td></td><td></td><td class="s">  package MySubDBI::st;</td></tr>
<tr><td class="h"><a name="6929"></a>6929</td><td></td><td></td><td></td><td></td><td class="s">  use vars qw(@ISA);</td></tr>
<tr><td class="h"><a name="6930"></a>6930</td><td></td><td></td><td></td><td></td><td class="s">  @ISA = qw(DBI::st);</td></tr>
<tr><td class="h"><a name="6931"></a>6931</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6932"></a>6932</td><td></td><td></td><td></td><td></td><td class="s">  sub fetch {</td></tr>
<tr><td class="h"><a name="6933"></a>6933</td><td></td><td></td><td></td><td></td><td class="s">    my ($sth, @args) = @_;</td></tr>
<tr><td class="h"><a name="6934"></a>6934</td><td></td><td></td><td></td><td></td><td class="s">    my $row = $sth-&gt;SUPER::fetch(@args)</td></tr>
<tr><td class="h"><a name="6935"></a>6935</td><td></td><td></td><td></td><td></td><td class="s">        or return;</td></tr>
<tr><td class="h"><a name="6936"></a>6936</td><td></td><td></td><td></td><td></td><td class="s">    do_something_magical_with_row_data($row)</td></tr>
<tr><td class="h"><a name="6937"></a>6937</td><td></td><td></td><td></td><td></td><td class="s">        or return $sth-&gt;set_err(1234, &quot;The magic failed&quot;, undef, &quot;fetch&quot;);</td></tr>
<tr><td class="h"><a name="6938"></a>6938</td><td></td><td></td><td></td><td></td><td class="s">    return $row;</td></tr>
<tr><td class="h"><a name="6939"></a>6939</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="6940"></a>6940</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6941"></a>6941</td><td></td><td></td><td></td><td></td><td class="s">When calling a SUPER::method that returns a handle, be careful to</td></tr>
<tr><td class="h"><a name="6942"></a>6942</td><td></td><td></td><td></td><td></td><td class="s">check the return value before trying to do other things with it in</td></tr>
<tr><td class="h"><a name="6943"></a>6943</td><td></td><td></td><td></td><td></td><td class="s">your overridden method. This is especially important if you want to</td></tr>
<tr><td class="h"><a name="6944"></a>6944</td><td></td><td></td><td></td><td></td><td class="s">set a hash attribute on the handle, as Perl's autovivification will</td></tr>
<tr><td class="h"><a name="6945"></a>6945</td><td></td><td></td><td></td><td></td><td class="s">bite you by (in)conveniently creating an unblessed hashref, which your</td></tr>
<tr><td class="h"><a name="6946"></a>6946</td><td></td><td></td><td></td><td></td><td class="s">method will then return with usually baffling results later on like</td></tr>
<tr><td class="h"><a name="6947"></a>6947</td><td></td><td></td><td></td><td></td><td class="s">the error &quot;dbih_getcom handle HASH(0xa4451a8) is not a DBI handle (has</td></tr>
<tr><td class="h"><a name="6948"></a>6948</td><td></td><td></td><td></td><td></td><td class="s">no magic&quot;.  It's best to check right after the call and return undef</td></tr>
<tr><td class="h"><a name="6949"></a>6949</td><td></td><td></td><td></td><td></td><td class="s">immediately on error, just like DBI would and just like the example</td></tr>
<tr><td class="h"><a name="6950"></a>6950</td><td></td><td></td><td></td><td></td><td class="s">above.</td></tr>
<tr><td class="h"><a name="6951"></a>6951</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6952"></a>6952</td><td></td><td></td><td></td><td></td><td class="s">If your method needs to record an error it should call the set_err()</td></tr>
<tr><td class="h"><a name="6953"></a>6953</td><td></td><td></td><td></td><td></td><td class="s">method with the error code and error string, as shown in the example</td></tr>
<tr><td class="h"><a name="6954"></a>6954</td><td></td><td></td><td></td><td></td><td class="s">above. The error code and error string will be recorded in the</td></tr>
<tr><td class="h"><a name="6955"></a>6955</td><td></td><td></td><td></td><td></td><td class="s">handle and available via C&lt;$h-E&lt;gt&gt;err&gt; and C&lt;$DBI::errstr&gt; etc.</td></tr>
<tr><td class="h"><a name="6956"></a>6956</td><td></td><td></td><td></td><td></td><td class="s">The set_err() method always returns an undef or empty list as</td></tr>
<tr><td class="h"><a name="6957"></a>6957</td><td></td><td></td><td></td><td></td><td class="s">approriate. Since your method should nearly always return an undef</td></tr>
<tr><td class="h"><a name="6958"></a>6958</td><td></td><td></td><td></td><td></td><td class="s">or empty list as soon as an error is detected it's handy to simply</td></tr>
<tr><td class="h"><a name="6959"></a>6959</td><td></td><td></td><td></td><td></td><td class="s">return what set_err() returns, as shown in the example above.</td></tr>
<tr><td class="h"><a name="6960"></a>6960</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6961"></a>6961</td><td></td><td></td><td></td><td></td><td class="s">If the handle has C&lt;RaiseError&gt;, C&lt;PrintError&gt;, or C&lt;HandleError&gt;</td></tr>
<tr><td class="h"><a name="6962"></a>6962</td><td></td><td></td><td></td><td></td><td class="s">etc. set then the set_err() method will honour them. This means</td></tr>
<tr><td class="h"><a name="6963"></a>6963</td><td></td><td></td><td></td><td></td><td class="s">that if C&lt;RaiseError&gt; is set then set_err() won't return in the</td></tr>
<tr><td class="h"><a name="6964"></a>6964</td><td></td><td></td><td></td><td></td><td class="s">normal way but will 'throw an exception' that can be caught with</td></tr>
<tr><td class="h"><a name="6965"></a>6965</td><td></td><td></td><td></td><td></td><td class="s">an C&lt;eval&gt; block.</td></tr>
<tr><td class="h"><a name="6966"></a>6966</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6967"></a>6967</td><td></td><td></td><td></td><td></td><td class="s">You can stash private data into DBI handles</td></tr>
<tr><td class="h"><a name="6968"></a>6968</td><td></td><td></td><td></td><td></td><td class="s">via C&lt;$h-E&lt;gt&gt;{private_..._*}&gt;.  See the entry under L&lt;/ATTRIBUTES</td></tr>
<tr><td class="h"><a name="6969"></a>6969</td><td></td><td></td><td></td><td></td><td class="s">COMMON TO ALL HANDLES&gt; for info and important caveats.</td></tr>
<tr><td class="h"><a name="6970"></a>6970</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6971"></a>6971</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6972"></a>6972</td><td></td><td></td><td></td><td></td><td class="s">=head1 TRACING</td></tr>
<tr><td class="h"><a name="6973"></a>6973</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6974"></a>6974</td><td></td><td></td><td></td><td></td><td class="s">The DBI has a powerful tracing mechanism built in. It enables you</td></tr>
<tr><td class="h"><a name="6975"></a>6975</td><td></td><td></td><td></td><td></td><td class="s">to see what's going on 'behind the scenes', both within the DBI and</td></tr>
<tr><td class="h"><a name="6976"></a>6976</td><td></td><td></td><td></td><td></td><td class="s">the drivers you're using.</td></tr>
<tr><td class="h"><a name="6977"></a>6977</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6978"></a>6978</td><td></td><td></td><td></td><td></td><td class="s">=head2 Trace Settings</td></tr>
<tr><td class="h"><a name="6979"></a>6979</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6980"></a>6980</td><td></td><td></td><td></td><td></td><td class="s">Which details are written to the trace output is controlled by a</td></tr>
<tr><td class="h"><a name="6981"></a>6981</td><td></td><td></td><td></td><td></td><td class="s">combination of a I&lt;trace level&gt;, an integer from 0 to 15, and a set</td></tr>
<tr><td class="h"><a name="6982"></a>6982</td><td></td><td></td><td></td><td></td><td class="s">of I&lt;trace flags&gt; that are either on or off. Together these are known</td></tr>
<tr><td class="h"><a name="6983"></a>6983</td><td></td><td></td><td></td><td></td><td class="s">as the I&lt;trace settings&gt; and are stored together in a single integer.</td></tr>
<tr><td class="h"><a name="6984"></a>6984</td><td></td><td></td><td></td><td></td><td class="s">For normal use you only need to set the trace level, and generally</td></tr>
<tr><td class="h"><a name="6985"></a>6985</td><td></td><td></td><td></td><td></td><td class="s">only to a value between 1 and 4.</td></tr>
<tr><td class="h"><a name="6986"></a>6986</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6987"></a>6987</td><td></td><td></td><td></td><td></td><td class="s">Each handle has it's own trace settings, and so does the DBI.</td></tr>
<tr><td class="h"><a name="6988"></a>6988</td><td></td><td></td><td></td><td></td><td class="s">When you call a method the DBI merges the handles settings into its</td></tr>
<tr><td class="h"><a name="6989"></a>6989</td><td></td><td></td><td></td><td></td><td class="s">own for the duration of the call: the trace flags of the handle are</td></tr>
<tr><td class="h"><a name="6990"></a>6990</td><td></td><td></td><td></td><td></td><td class="s">OR'd into the trace flags of the DBI, and if the handle has a higher</td></tr>
<tr><td class="h"><a name="6991"></a>6991</td><td></td><td></td><td></td><td></td><td class="s">trace level then the DBI trace level is raised to match it.</td></tr>
<tr><td class="h"><a name="6992"></a>6992</td><td></td><td></td><td></td><td></td><td class="s">The previous DBI trace setings are restored when the called method</td></tr>
<tr><td class="h"><a name="6993"></a>6993</td><td></td><td></td><td></td><td></td><td class="s">returns.</td></tr>
<tr><td class="h"><a name="6994"></a>6994</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6995"></a>6995</td><td></td><td></td><td></td><td></td><td class="s">=head2 Trace Levels</td></tr>
<tr><td class="h"><a name="6996"></a>6996</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6997"></a>6997</td><td></td><td></td><td></td><td></td><td class="s">Trace I&lt;levels&gt; are as follows:</td></tr>
<tr><td class="h"><a name="6998"></a>6998</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6999"></a>6999</td><td></td><td></td><td></td><td></td><td class="s">  0 - Trace disabled.</td></tr>
<tr><td class="h"><a name="7000"></a>7000</td><td></td><td></td><td></td><td></td><td class="s">  1 - Trace top-level DBI method calls returning with results or errors.</td></tr>
<tr><td class="h"><a name="7001"></a>7001</td><td></td><td></td><td></td><td></td><td class="s">  2 - As above, adding tracing of top-level method entry with parameters.</td></tr>
<tr><td class="h"><a name="7002"></a>7002</td><td></td><td></td><td></td><td></td><td class="s">  3 - As above, adding some high-level information from the driver</td></tr>
<tr><td class="h"><a name="7003"></a>7003</td><td></td><td></td><td></td><td></td><td class="s">      and some internal information from the DBI.</td></tr>
<tr><td class="h"><a name="7004"></a>7004</td><td></td><td></td><td></td><td></td><td class="s">  4 - As above, adding more detailed information from the driver.</td></tr>
<tr><td class="h"><a name="7005"></a>7005</td><td></td><td></td><td></td><td></td><td class="s">      This is the first level to trace all the rows being fetched.</td></tr>
<tr><td class="h"><a name="7006"></a>7006</td><td></td><td></td><td></td><td></td><td class="s">  5 to 15 - As above but with more and more internal information.</td></tr>
<tr><td class="h"><a name="7007"></a>7007</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7008"></a>7008</td><td></td><td></td><td></td><td></td><td class="s">Trace level 1 is best for a simple overview of what's happening.</td></tr>
<tr><td class="h"><a name="7009"></a>7009</td><td></td><td></td><td></td><td></td><td class="s">Trace levels 2 thru 4 a good choice for general purpose tracing.</td></tr>
<tr><td class="h"><a name="7010"></a>7010</td><td></td><td></td><td></td><td></td><td class="s">Levels 5 and above are best reserved for investigating a specific</td></tr>
<tr><td class="h"><a name="7011"></a>7011</td><td></td><td></td><td></td><td></td><td class="s">problem, when you need to see &quot;inside&quot; the driver and DBI.</td></tr>
<tr><td class="h"><a name="7012"></a>7012</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7013"></a>7013</td><td></td><td></td><td></td><td></td><td class="s">The trace output is detailed and typically very useful. Much of the</td></tr>
<tr><td class="h"><a name="7014"></a>7014</td><td></td><td></td><td></td><td></td><td class="s">trace output is formatted using the L&lt;/neat&gt; function, so strings</td></tr>
<tr><td class="h"><a name="7015"></a>7015</td><td></td><td></td><td></td><td></td><td class="s">in the trace output may be edited and truncated by that function.</td></tr>
<tr><td class="h"><a name="7016"></a>7016</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7017"></a>7017</td><td></td><td></td><td></td><td></td><td class="s">=head2 Trace Flags</td></tr>
<tr><td class="h"><a name="7018"></a>7018</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7019"></a>7019</td><td></td><td></td><td></td><td></td><td class="s">Trace I&lt;flags&gt; are used to enable tracing of specific activities</td></tr>
<tr><td class="h"><a name="7020"></a>7020</td><td></td><td></td><td></td><td></td><td class="s">within the DBI and drivers. The DBI defines some trace flags and</td></tr>
<tr><td class="h"><a name="7021"></a>7021</td><td></td><td></td><td></td><td></td><td class="s">drivers can define others. DBI trace flag names begin with a capital</td></tr>
<tr><td class="h"><a name="7022"></a>7022</td><td></td><td></td><td></td><td></td><td class="s">letter and driver specific names begin with a lowercase letter, as</td></tr>
<tr><td class="h"><a name="7023"></a>7023</td><td></td><td></td><td></td><td></td><td class="s">usual.</td></tr>
<tr><td class="h"><a name="7024"></a>7024</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7025"></a>7025</td><td></td><td></td><td></td><td></td><td class="s">Curently the DBI only defines two trace flags:</td></tr>
<tr><td class="h"><a name="7026"></a>7026</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7027"></a>7027</td><td></td><td></td><td></td><td></td><td class="s">  ALL - turn on all DBI and driver flags (not recommended)</td></tr>
<tr><td class="h"><a name="7028"></a>7028</td><td></td><td></td><td></td><td></td><td class="s">  SQL - trace SQL statements executed (not yet implemented)</td></tr>
<tr><td class="h"><a name="7029"></a>7029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7030"></a>7030</td><td></td><td></td><td></td><td></td><td class="s">The L&lt;/parse_trace_flags&gt; and L&lt;/parse_trace_flag&gt; methods are used</td></tr>
<tr><td class="h"><a name="7031"></a>7031</td><td></td><td></td><td></td><td></td><td class="s">to convert trace flag names into the coresponding integer bit flags.</td></tr>
<tr><td class="h"><a name="7032"></a>7032</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7033"></a>7033</td><td></td><td></td><td></td><td></td><td class="s">=head2 Enabling Trace</td></tr>
<tr><td class="h"><a name="7034"></a>7034</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7035"></a>7035</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$h-E&lt;gt&gt;trace&gt; method sets the trace settings for a handle</td></tr>
<tr><td class="h"><a name="7036"></a>7036</td><td></td><td></td><td></td><td></td><td class="s">and C&lt;DBI-E&lt;gt&gt;trace&gt; does the same for the DBI.</td></tr>
<tr><td class="h"><a name="7037"></a>7037</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7038"></a>7038</td><td></td><td></td><td></td><td></td><td class="s">In addition to the L&lt;/trace&gt; method, you can enable the same trace</td></tr>
<tr><td class="h"><a name="7039"></a>7039</td><td></td><td></td><td></td><td></td><td class="s">information, and direct the output to a file, by setting the</td></tr>
<tr><td class="h"><a name="7040"></a>7040</td><td></td><td></td><td></td><td></td><td class="s">C&lt;DBI_TRACE&gt; environment variable before starting Perl.</td></tr>
<tr><td class="h"><a name="7041"></a>7041</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/DBI_TRACE&gt; for more information.</td></tr>
<tr><td class="h"><a name="7042"></a>7042</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7043"></a>7043</td><td></td><td></td><td></td><td></td><td class="s">Finally, you can set, or get, the trace settings for a handle using</td></tr>
<tr><td class="h"><a name="7044"></a>7044</td><td></td><td></td><td></td><td></td><td class="s">the C&lt;TraceLevel&gt; attribute.</td></tr>
<tr><td class="h"><a name="7045"></a>7045</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7046"></a>7046</td><td></td><td></td><td></td><td></td><td class="s">All of those methods use parse_trace_flags() and so allow you set</td></tr>
<tr><td class="h"><a name="7047"></a>7047</td><td></td><td></td><td></td><td></td><td class="s">both the trace level and multiple trace flags by using a string</td></tr>
<tr><td class="h"><a name="7048"></a>7048</td><td></td><td></td><td></td><td></td><td class="s">containing the trace level and/or flag names separated by vertical</td></tr>
<tr><td class="h"><a name="7049"></a>7049</td><td></td><td></td><td></td><td></td><td class="s">bar (&quot;C&lt;|&gt;&quot;) or comma (&quot;C&lt;,&gt;&quot;) characters. For example:</td></tr>
<tr><td class="h"><a name="7050"></a>7050</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7051"></a>7051</td><td></td><td></td><td></td><td></td><td class="s">  local $h-&gt;{TraceLevel} = &quot;3|SQL|foo&quot;;</td></tr>
<tr><td class="h"><a name="7052"></a>7052</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7053"></a>7053</td><td></td><td></td><td></td><td></td><td class="s">=head2 Trace Output</td></tr>
<tr><td class="h"><a name="7054"></a>7054</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7055"></a>7055</td><td></td><td></td><td></td><td></td><td class="s">Initially trace output is written to C&lt;STDERR&gt;.  Both the</td></tr>
<tr><td class="h"><a name="7056"></a>7056</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$h-E&lt;gt&gt;trace&gt; and C&lt;DBI-E&lt;gt&gt;trace&gt; methods take an optional</td></tr>
<tr><td class="h"><a name="7057"></a>7057</td><td></td><td></td><td></td><td></td><td class="s">$trace_file parameter, which may be either the name of a file to be</td></tr>
<tr><td class="h"><a name="7058"></a>7058</td><td></td><td></td><td></td><td></td><td class="s">openned by DBI in append mode, or a reference to an existing writable</td></tr>
<tr><td class="h"><a name="7059"></a>7059</td><td></td><td></td><td></td><td></td><td class="s">(possibly layered) filehandle. If $trace_file is a filename,</td></tr>
<tr><td class="h"><a name="7060"></a>7060</td><td></td><td></td><td></td><td></td><td class="s">and can be opened in append mode, or $trace_file is a writable</td></tr>
<tr><td class="h"><a name="7061"></a>7061</td><td></td><td></td><td></td><td></td><td class="s">filehandle, then I&lt;all&gt; trace output (currently including that from</td></tr>
<tr><td class="h"><a name="7062"></a>7062</td><td></td><td></td><td></td><td></td><td class="s">other handles) is redirected to that file. A warning is generated</td></tr>
<tr><td class="h"><a name="7063"></a>7063</td><td></td><td></td><td></td><td></td><td class="s">if $trace_file can't be opened or is not writable.</td></tr>
<tr><td class="h"><a name="7064"></a>7064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7065"></a>7065</td><td></td><td></td><td></td><td></td><td class="s">Further calls to trace() without $trace_file do not alter where</td></tr>
<tr><td class="h"><a name="7066"></a>7066</td><td></td><td></td><td></td><td></td><td class="s">the trace output is sent. If $trace_file is undefined, then</td></tr>
<tr><td class="h"><a name="7067"></a>7067</td><td></td><td></td><td></td><td></td><td class="s">trace output is sent to C&lt;STDERR&gt; and, if the prior trace was openned with</td></tr>
<tr><td class="h"><a name="7068"></a>7068</td><td></td><td></td><td></td><td></td><td class="s">$trace_file as a filename, the previous trace file is closed; if $trace_file was</td></tr>
<tr><td class="h"><a name="7069"></a>7069</td><td></td><td></td><td></td><td></td><td class="s">a filehandle, the filehandle is B&lt;not&gt; closed.</td></tr>
<tr><td class="h"><a name="7070"></a>7070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7071"></a>7071</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NOTE&gt;: If $trace_file is specified as a filehandle, the filehandle</td></tr>
<tr><td class="h"><a name="7072"></a>7072</td><td></td><td></td><td></td><td></td><td class="s">should not be closed until all DBI operations are completed, or the</td></tr>
<tr><td class="h"><a name="7073"></a>7073</td><td></td><td></td><td></td><td></td><td class="s">application has reset the trace file via another call to</td></tr>
<tr><td class="h"><a name="7074"></a>7074</td><td></td><td></td><td></td><td></td><td class="s">C&lt;trace()&gt; that changes the trace file.</td></tr>
<tr><td class="h"><a name="7075"></a>7075</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7076"></a>7076</td><td></td><td></td><td></td><td></td><td class="s">=head2 Tracing to Layered Filehandles</td></tr>
<tr><td class="h"><a name="7077"></a>7077</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7078"></a>7078</td><td></td><td></td><td></td><td></td><td class="s">B&lt;NOTE&gt;:</td></tr>
<tr><td class="h"><a name="7079"></a>7079</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7080"></a>7080</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="7081"></a>7081</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7082"></a>7082</td><td></td><td></td><td></td><td></td><td class="s">=item *</td></tr>
<tr><td class="h"><a name="7083"></a>7083</td><td></td><td></td><td></td><td></td><td class="s">Tied filehandles are not currently supported, as</td></tr>
<tr><td class="h"><a name="7084"></a>7084</td><td></td><td></td><td></td><td></td><td class="s">tie operations are not available to the PerlIO</td></tr>
<tr><td class="h"><a name="7085"></a>7085</td><td></td><td></td><td></td><td></td><td class="s">methods used by the DBI.</td></tr>
<tr><td class="h"><a name="7086"></a>7086</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7087"></a>7087</td><td></td><td></td><td></td><td></td><td class="s">=item *</td></tr>
<tr><td class="h"><a name="7088"></a>7088</td><td></td><td></td><td></td><td></td><td class="s">PerlIO layer support requires Perl version 5.8 or higher.</td></tr>
<tr><td class="h"><a name="7089"></a>7089</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7090"></a>7090</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="7091"></a>7091</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7092"></a>7092</td><td></td><td></td><td></td><td></td><td class="s">As of version 5.8, Perl provides the ability to layer various</td></tr>
<tr><td class="h"><a name="7093"></a>7093</td><td></td><td></td><td></td><td></td><td class="s">&quot;disciplines&quot; on an open filehandle via the L&lt;PerlIO&gt; module.</td></tr>
<tr><td class="h"><a name="7094"></a>7094</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7095"></a>7095</td><td></td><td></td><td></td><td></td><td class="s">A simple example of using PerlIO layers is to use a scalar as the output:</td></tr>
<tr><td class="h"><a name="7096"></a>7096</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7097"></a>7097</td><td></td><td></td><td></td><td></td><td class="s">    my $scalar = '';</td></tr>
<tr><td class="h"><a name="7098"></a>7098</td><td></td><td></td><td></td><td></td><td class="s">    open( my $fh, &quot;+&gt;:scalar&quot;, \$scalar );</td></tr>
<tr><td class="h"><a name="7099"></a>7099</td><td></td><td></td><td></td><td></td><td class="s">    $dbh-&gt;trace( 2, $fh );</td></tr>
<tr><td class="h"><a name="7100"></a>7100</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7101"></a>7101</td><td></td><td></td><td></td><td></td><td class="s">Now all trace output is simply appended to $scalar.</td></tr>
<tr><td class="h"><a name="7102"></a>7102</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7103"></a>7103</td><td></td><td></td><td></td><td></td><td class="s">A more complex application of tracing to a layered filehandle is the</td></tr>
<tr><td class="h"><a name="7104"></a>7104</td><td></td><td></td><td></td><td></td><td class="s">use of a custom layer (I&lt;Refer to &gt;L&lt;Perlio::via&gt; I&lt;for details</td></tr>
<tr><td class="h"><a name="7105"></a>7105</td><td></td><td></td><td></td><td></td><td class="s">on creating custom PerlIO layers.&gt;). Consider an application with the</td></tr>
<tr><td class="h"><a name="7106"></a>7106</td><td></td><td></td><td></td><td></td><td class="s">following logger module:</td></tr>
<tr><td class="h"><a name="7107"></a>7107</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7108"></a>7108</td><td></td><td></td><td></td><td></td><td class="s">    package MyFancyLogger;</td></tr>
<tr><td class="h"><a name="7109"></a>7109</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7110"></a>7110</td><td></td><td></td><td></td><td></td><td class="s">    sub new</td></tr>
<tr><td class="h"><a name="7111"></a>7111</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="7112"></a>7112</td><td></td><td></td><td></td><td></td><td class="s">        my $self = {};</td></tr>
<tr><td class="h"><a name="7113"></a>7113</td><td></td><td></td><td></td><td></td><td class="s">        my $fh;</td></tr>
<tr><td class="h"><a name="7114"></a>7114</td><td></td><td></td><td></td><td></td><td class="s">        open $fh, '&gt;', 'fancylog.log';</td></tr>
<tr><td class="h"><a name="7115"></a>7115</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{_fh} = $fh;</td></tr>
<tr><td class="h"><a name="7116"></a>7116</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{_buf} = '';</td></tr>
<tr><td class="h"><a name="7117"></a>7117</td><td></td><td></td><td></td><td></td><td class="s">        return bless $self, shift;</td></tr>
<tr><td class="h"><a name="7118"></a>7118</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7119"></a>7119</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7120"></a>7120</td><td></td><td></td><td></td><td></td><td class="s">    sub log</td></tr>
<tr><td class="h"><a name="7121"></a>7121</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="7122"></a>7122</td><td></td><td></td><td></td><td></td><td class="s">        my $self = shift;</td></tr>
<tr><td class="h"><a name="7123"></a>7123</td><td></td><td></td><td></td><td></td><td class="s">        return unless exists $self-&gt;{_fh};</td></tr>
<tr><td class="h"><a name="7124"></a>7124</td><td></td><td></td><td></td><td></td><td class="s">        my $fh = $self-&gt;{_fh};</td></tr>
<tr><td class="h"><a name="7125"></a>7125</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{_buf} .= shift;</td></tr>
<tr><td class="h"><a name="7126"></a>7126</td><td></td><td></td><td></td><td></td><td class="s">    #</td></tr>
<tr><td class="h"><a name="7127"></a>7127</td><td></td><td></td><td></td><td></td><td class="s">    # DBI feeds us pieces at a time, so accumulate a complete line</td></tr>
<tr><td class="h"><a name="7128"></a>7128</td><td></td><td></td><td></td><td></td><td class="s">    # before outputing</td></tr>
<tr><td class="h"><a name="7129"></a>7129</td><td></td><td></td><td></td><td></td><td class="s">    #</td></tr>
<tr><td class="h"><a name="7130"></a>7130</td><td></td><td></td><td></td><td></td><td class="s">        print $fh &quot;At &quot;, scalar localtime(), ':', $self-&gt;{_buf}, &quot;\n&quot; and</td></tr>
<tr><td class="h"><a name="7131"></a>7131</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{_buf} = ''</td></tr>
<tr><td class="h"><a name="7132"></a>7132</td><td></td><td></td><td></td><td></td><td class="s">            if $self-&gt;{_buf}=~tr/\n//;</td></tr>
<tr><td class="h"><a name="7133"></a>7133</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7134"></a>7134</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7135"></a>7135</td><td></td><td></td><td></td><td></td><td class="s">    sub close {</td></tr>
<tr><td class="h"><a name="7136"></a>7136</td><td></td><td></td><td></td><td></td><td class="s">        my $self = shift;</td></tr>
<tr><td class="h"><a name="7137"></a>7137</td><td></td><td></td><td></td><td></td><td class="s">        return unless exists $self-&gt;{_fh};</td></tr>
<tr><td class="h"><a name="7138"></a>7138</td><td></td><td></td><td></td><td></td><td class="s">        my $fh = $self-&gt;{_fh};</td></tr>
<tr><td class="h"><a name="7139"></a>7139</td><td></td><td></td><td></td><td></td><td class="s">        print $fh &quot;At &quot;, scalar localtime(), ':', $self-&gt;{_buf}, &quot;\n&quot; and</td></tr>
<tr><td class="h"><a name="7140"></a>7140</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{_buf} = ''</td></tr>
<tr><td class="h"><a name="7141"></a>7141</td><td></td><td></td><td></td><td></td><td class="s">            if $self-&gt;{_buf};</td></tr>
<tr><td class="h"><a name="7142"></a>7142</td><td></td><td></td><td></td><td></td><td class="s">        close $fh;</td></tr>
<tr><td class="h"><a name="7143"></a>7143</td><td></td><td></td><td></td><td></td><td class="s">        delete $self-&gt;{_fh};</td></tr>
<tr><td class="h"><a name="7144"></a>7144</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7145"></a>7145</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7146"></a>7146</td><td></td><td></td><td></td><td></td><td class="s">    1;</td></tr>
<tr><td class="h"><a name="7147"></a>7147</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7148"></a>7148</td><td></td><td></td><td></td><td></td><td class="s">To redirect DBI traces to this logger requires creating</td></tr>
<tr><td class="h"><a name="7149"></a>7149</td><td></td><td></td><td></td><td></td><td class="s">a package for the layer:</td></tr>
<tr><td class="h"><a name="7150"></a>7150</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7151"></a>7151</td><td></td><td></td><td></td><td></td><td class="s">    package PerlIO::via::MyFancyLogLayer;</td></tr>
<tr><td class="h"><a name="7152"></a>7152</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7153"></a>7153</td><td></td><td></td><td></td><td></td><td class="s">    sub PUSHED</td></tr>
<tr><td class="h"><a name="7154"></a>7154</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="7155"></a>7155</td><td></td><td></td><td></td><td></td><td class="s">        my ($class,$mode,$fh) = @_;</td></tr>
<tr><td class="h"><a name="7156"></a>7156</td><td></td><td></td><td></td><td></td><td class="s">        my $logger;</td></tr>
<tr><td class="h"><a name="7157"></a>7157</td><td></td><td></td><td></td><td></td><td class="s">        return bless \$logger,$class;</td></tr>
<tr><td class="h"><a name="7158"></a>7158</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7159"></a>7159</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7160"></a>7160</td><td></td><td></td><td></td><td></td><td class="s">    sub OPEN {</td></tr>
<tr><td class="h"><a name="7161"></a>7161</td><td></td><td></td><td></td><td></td><td class="s">        my ($self, $path, $mode, $fh) = @_;</td></tr>
<tr><td class="h"><a name="7162"></a>7162</td><td></td><td></td><td></td><td></td><td class="s">        #</td></tr>
<tr><td class="h"><a name="7163"></a>7163</td><td></td><td></td><td></td><td></td><td class="s">        # $path is actually our logger object</td></tr>
<tr><td class="h"><a name="7164"></a>7164</td><td></td><td></td><td></td><td></td><td class="s">        #</td></tr>
<tr><td class="h"><a name="7165"></a>7165</td><td></td><td></td><td></td><td></td><td class="s">        $$self = $path;</td></tr>
<tr><td class="h"><a name="7166"></a>7166</td><td></td><td></td><td></td><td></td><td class="s">        return 1;</td></tr>
<tr><td class="h"><a name="7167"></a>7167</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7168"></a>7168</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7169"></a>7169</td><td></td><td></td><td></td><td></td><td class="s">    sub WRITE</td></tr>
<tr><td class="h"><a name="7170"></a>7170</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="7171"></a>7171</td><td></td><td></td><td></td><td></td><td class="s">        my ($self, $buf, $fh) = @_;</td></tr>
<tr><td class="h"><a name="7172"></a>7172</td><td></td><td></td><td></td><td></td><td class="s">        $$self-&gt;log($buf);</td></tr>
<tr><td class="h"><a name="7173"></a>7173</td><td></td><td></td><td></td><td></td><td class="s">        return length($buf);</td></tr>
<tr><td class="h"><a name="7174"></a>7174</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7175"></a>7175</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7176"></a>7176</td><td></td><td></td><td></td><td></td><td class="s">    sub CLOSE {</td></tr>
<tr><td class="h"><a name="7177"></a>7177</td><td></td><td></td><td></td><td></td><td class="s">        my $self = shift;</td></tr>
<tr><td class="h"><a name="7178"></a>7178</td><td></td><td></td><td></td><td></td><td class="s">        $$self-&gt;close();</td></tr>
<tr><td class="h"><a name="7179"></a>7179</td><td></td><td></td><td></td><td></td><td class="s">        return 0;</td></tr>
<tr><td class="h"><a name="7180"></a>7180</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="7181"></a>7181</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7182"></a>7182</td><td></td><td></td><td></td><td></td><td class="s">    1;</td></tr>
<tr><td class="h"><a name="7183"></a>7183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7184"></a>7184</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7185"></a>7185</td><td></td><td></td><td></td><td></td><td class="s">The application can then cause DBI traces to be routed to the</td></tr>
<tr><td class="h"><a name="7186"></a>7186</td><td></td><td></td><td></td><td></td><td class="s">logger using</td></tr>
<tr><td class="h"><a name="7187"></a>7187</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7188"></a>7188</td><td></td><td></td><td></td><td></td><td class="s">    use PerlIO::via::MyFancyLogLayer;</td></tr>
<tr><td class="h"><a name="7189"></a>7189</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7190"></a>7190</td><td></td><td></td><td></td><td></td><td class="s">    open my $fh, '&gt;:via(MyFancyLogLayer)', MyFancyLogger-&gt;new();</td></tr>
<tr><td class="h"><a name="7191"></a>7191</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7192"></a>7192</td><td></td><td></td><td></td><td></td><td class="s">    $dbh-&gt;trace('SQL', $fh);</td></tr>
<tr><td class="h"><a name="7193"></a>7193</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7194"></a>7194</td><td></td><td></td><td></td><td></td><td class="s">Now all trace output will be processed by MyFancyLogger's</td></tr>
<tr><td class="h"><a name="7195"></a>7195</td><td></td><td></td><td></td><td></td><td class="s">log() method.</td></tr>
<tr><td class="h"><a name="7196"></a>7196</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7197"></a>7197</td><td></td><td></td><td></td><td></td><td class="s">=head2 Trace Content</td></tr>
<tr><td class="h"><a name="7198"></a>7198</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7199"></a>7199</td><td></td><td></td><td></td><td></td><td class="s">Many of the values embeded in trace output are formatted using the neat()</td></tr>
<tr><td class="h"><a name="7200"></a>7200</td><td></td><td></td><td></td><td></td><td class="s">utility function. This means they may be quoted, sanitized, and possibly</td></tr>
<tr><td class="h"><a name="7201"></a>7201</td><td></td><td></td><td></td><td></td><td class="s">truncated if longer than C&lt;$DBI::neat_maxlen&gt;. See L&lt;/neat&gt; for more details.</td></tr>
<tr><td class="h"><a name="7202"></a>7202</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7203"></a>7203</td><td></td><td></td><td></td><td></td><td class="s">=head2 Tracing Tips</td></tr>
<tr><td class="h"><a name="7204"></a>7204</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7205"></a>7205</td><td></td><td></td><td></td><td></td><td class="s">You can add tracing to your own application code using the L&lt;/trace_msg&gt; method.</td></tr>
<tr><td class="h"><a name="7206"></a>7206</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7207"></a>7207</td><td></td><td></td><td></td><td></td><td class="s">It can sometimes be handy to compare trace files from two different runs of the</td></tr>
<tr><td class="h"><a name="7208"></a>7208</td><td></td><td></td><td></td><td></td><td class="s">same script. However using a tool like C&lt;diff&gt; on the original log output</td></tr>
<tr><td class="h"><a name="7209"></a>7209</td><td></td><td></td><td></td><td></td><td class="s">doesn't work well because the trace file is full of object addresses that may</td></tr>
<tr><td class="h"><a name="7210"></a>7210</td><td></td><td></td><td></td><td></td><td class="s">differ on each run.</td></tr>
<tr><td class="h"><a name="7211"></a>7211</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7212"></a>7212</td><td></td><td></td><td></td><td></td><td class="s">The DBI includes a handy utility called dbilogstrip that can be used to</td></tr>
<tr><td class="h"><a name="7213"></a>7213</td><td></td><td></td><td></td><td></td><td class="s">'normalize' the log content. It can be used as a filter like this:</td></tr>
<tr><td class="h"><a name="7214"></a>7214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7215"></a>7215</td><td></td><td></td><td></td><td></td><td class="s">    DBI_TRACE=2 perl yourscript.pl ...args1... 2&gt;&amp;1 | dbilogstrip &gt; dbitrace1.log</td></tr>
<tr><td class="h"><a name="7216"></a>7216</td><td></td><td></td><td></td><td></td><td class="s">    DBI_TRACE=2 perl yourscript.pl ...args2... 2&gt;&amp;1 | dbilogstrip &gt; dbitrace2.log</td></tr>
<tr><td class="h"><a name="7217"></a>7217</td><td></td><td></td><td></td><td></td><td class="s">    diff -u dbitrace1.log dbitrace2.log</td></tr>
<tr><td class="h"><a name="7218"></a>7218</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7219"></a>7219</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;dbilogstrip&gt; for more information.</td></tr>
<tr><td class="h"><a name="7220"></a>7220</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7221"></a>7221</td><td></td><td></td><td></td><td></td><td class="s">=head1 DBI ENVIRONMENT VARIABLES</td></tr>
<tr><td class="h"><a name="7222"></a>7222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7223"></a>7223</td><td></td><td></td><td></td><td></td><td class="s">The DBI module recognizes a number of environment variables, but most of</td></tr>
<tr><td class="h"><a name="7224"></a>7224</td><td></td><td></td><td></td><td></td><td class="s">them should not be used most of the time.</td></tr>
<tr><td class="h"><a name="7225"></a>7225</td><td></td><td></td><td></td><td></td><td class="s">It is better to be explicit about what you are doing to avoid the need</td></tr>
<tr><td class="h"><a name="7226"></a>7226</td><td></td><td></td><td></td><td></td><td class="s">for environment variables, especially in a web serving system where web</td></tr>
<tr><td class="h"><a name="7227"></a>7227</td><td></td><td></td><td></td><td></td><td class="s">servers are stingy about which environment variables are available.</td></tr>
<tr><td class="h"><a name="7228"></a>7228</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7229"></a>7229</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_DSN</td></tr>
<tr><td class="h"><a name="7230"></a>7230</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7231"></a>7231</td><td></td><td></td><td></td><td></td><td class="s">The DBI_DSN environment variable is used by DBI-&gt;connect if you do not</td></tr>
<tr><td class="h"><a name="7232"></a>7232</td><td></td><td></td><td></td><td></td><td class="s">specify a data source when you issue the connect.</td></tr>
<tr><td class="h"><a name="7233"></a>7233</td><td></td><td></td><td></td><td></td><td class="s">It should have a format such as &quot;dbi:Driver:databasename&quot;.</td></tr>
<tr><td class="h"><a name="7234"></a>7234</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7235"></a>7235</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_DRIVER</td></tr>
<tr><td class="h"><a name="7236"></a>7236</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7237"></a>7237</td><td></td><td></td><td></td><td></td><td class="s">The DBI_DRIVER environment variable is used to fill in the database</td></tr>
<tr><td class="h"><a name="7238"></a>7238</td><td></td><td></td><td></td><td></td><td class="s">driver name in DBI-&gt;connect if the data source string starts &quot;dbi::&quot;</td></tr>
<tr><td class="h"><a name="7239"></a>7239</td><td></td><td></td><td></td><td></td><td class="s">(thereby omitting the driver).</td></tr>
<tr><td class="h"><a name="7240"></a>7240</td><td></td><td></td><td></td><td></td><td class="s">If DBI_DSN omits the driver name, DBI_DRIVER can fill the gap.</td></tr>
<tr><td class="h"><a name="7241"></a>7241</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7242"></a>7242</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_AUTOPROXY</td></tr>
<tr><td class="h"><a name="7243"></a>7243</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7244"></a>7244</td><td></td><td></td><td></td><td></td><td class="s">The DBI_AUTOPROXY environment variable takes a string value that starts</td></tr>
<tr><td class="h"><a name="7245"></a>7245</td><td></td><td></td><td></td><td></td><td class="s">&quot;dbi:Proxy:&quot; and is typically followed by &quot;hostname=...;port=...&quot;.</td></tr>
<tr><td class="h"><a name="7246"></a>7246</td><td></td><td></td><td></td><td></td><td class="s">It is used to alter the behaviour of DBI-&gt;connect.</td></tr>
<tr><td class="h"><a name="7247"></a>7247</td><td></td><td></td><td></td><td></td><td class="s">For full details, see DBI::Proxy documentation.</td></tr>
<tr><td class="h"><a name="7248"></a>7248</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7249"></a>7249</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_USER</td></tr>
<tr><td class="h"><a name="7250"></a>7250</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7251"></a>7251</td><td></td><td></td><td></td><td></td><td class="s">The DBI_USER environment variable takes a string value that is used as</td></tr>
<tr><td class="h"><a name="7252"></a>7252</td><td></td><td></td><td></td><td></td><td class="s">the user name if the DBI-&gt;connect call is given undef (as distinct from</td></tr>
<tr><td class="h"><a name="7253"></a>7253</td><td></td><td></td><td></td><td></td><td class="s">an empty string) as the username argument.</td></tr>
<tr><td class="h"><a name="7254"></a>7254</td><td></td><td></td><td></td><td></td><td class="s">Be wary of the security implications of using this.</td></tr>
<tr><td class="h"><a name="7255"></a>7255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7256"></a>7256</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_PASS</td></tr>
<tr><td class="h"><a name="7257"></a>7257</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7258"></a>7258</td><td></td><td></td><td></td><td></td><td class="s">The DBI_PASS environment variable takes a string value that is used as</td></tr>
<tr><td class="h"><a name="7259"></a>7259</td><td></td><td></td><td></td><td></td><td class="s">the password if the DBI-&gt;connect call is given undef (as distinct from</td></tr>
<tr><td class="h"><a name="7260"></a>7260</td><td></td><td></td><td></td><td></td><td class="s">an empty string) as the password argument.</td></tr>
<tr><td class="h"><a name="7261"></a>7261</td><td></td><td></td><td></td><td></td><td class="s">Be extra wary of the security implications of using this.</td></tr>
<tr><td class="h"><a name="7262"></a>7262</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7263"></a>7263</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_DBNAME (obsolete)</td></tr>
<tr><td class="h"><a name="7264"></a>7264</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7265"></a>7265</td><td></td><td></td><td></td><td></td><td class="s">The DBI_DBNAME environment variable takes a string value that is used only when the</td></tr>
<tr><td class="h"><a name="7266"></a>7266</td><td></td><td></td><td></td><td></td><td class="s">obsolescent style of DBI-&gt;connect (with driver name as fourth parameter) is used, and</td></tr>
<tr><td class="h"><a name="7267"></a>7267</td><td></td><td></td><td></td><td></td><td class="s">when no value is provided for the first (database name) argument.</td></tr>
<tr><td class="h"><a name="7268"></a>7268</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7269"></a>7269</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_TRACE</td></tr>
<tr><td class="h"><a name="7270"></a>7270</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7271"></a>7271</td><td></td><td></td><td></td><td></td><td class="s">The DBI_TRACE environment variable specifies the global default</td></tr>
<tr><td class="h"><a name="7272"></a>7272</td><td></td><td></td><td></td><td></td><td class="s">trace settings for the DBI at startup. Can also be used to direct</td></tr>
<tr><td class="h"><a name="7273"></a>7273</td><td></td><td></td><td></td><td></td><td class="s">trace output to a file. When the DBI is loaded it does:</td></tr>
<tr><td class="h"><a name="7274"></a>7274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7275"></a>7275</td><td></td><td></td><td></td><td></td><td class="s">  DBI-&gt;trace(split /=/, $ENV{DBI_TRACE}, 2) if $ENV{DBI_TRACE};</td></tr>
<tr><td class="h"><a name="7276"></a>7276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7277"></a>7277</td><td></td><td></td><td></td><td></td><td class="s">So if C&lt;DBI_TRACE&gt; contains an &quot;C&lt;=&gt;&quot; character then what follows</td></tr>
<tr><td class="h"><a name="7278"></a>7278</td><td></td><td></td><td></td><td></td><td class="s">it is used as the name of the file to append the trace to.</td></tr>
<tr><td class="h"><a name="7279"></a>7279</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7280"></a>7280</td><td></td><td></td><td></td><td></td><td class="s">output appended to that file. If the name begins with a number</td></tr>
<tr><td class="h"><a name="7281"></a>7281</td><td></td><td></td><td></td><td></td><td class="s">followed by an equal sign (C&lt;=&gt;), then the number and the equal sign are</td></tr>
<tr><td class="h"><a name="7282"></a>7282</td><td></td><td></td><td></td><td></td><td class="s">stripped off from the name, and the number is used to set the trace</td></tr>
<tr><td class="h"><a name="7283"></a>7283</td><td></td><td></td><td></td><td></td><td class="s">level. For example:</td></tr>
<tr><td class="h"><a name="7284"></a>7284</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7285"></a>7285</td><td></td><td></td><td></td><td></td><td class="s">  DBI_TRACE=1=dbitrace.log perl your_test_script.pl</td></tr>
<tr><td class="h"><a name="7286"></a>7286</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7287"></a>7287</td><td></td><td></td><td></td><td></td><td class="s">On Unix-like systems using a Bourne-like shell, you can do this easily</td></tr>
<tr><td class="h"><a name="7288"></a>7288</td><td></td><td></td><td></td><td></td><td class="s">on the command line:</td></tr>
<tr><td class="h"><a name="7289"></a>7289</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7290"></a>7290</td><td></td><td></td><td></td><td></td><td class="s">  DBI_TRACE=2 perl your_test_script.pl</td></tr>
<tr><td class="h"><a name="7291"></a>7291</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7292"></a>7292</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;/TRACING&gt; for more information.</td></tr>
<tr><td class="h"><a name="7293"></a>7293</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7294"></a>7294</td><td></td><td></td><td></td><td></td><td class="s">=head2 PERL_DBI_DEBUG (obsolete)</td></tr>
<tr><td class="h"><a name="7295"></a>7295</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7296"></a>7296</td><td></td><td></td><td></td><td></td><td class="s">An old variable that should no longer be used; equivalent to DBI_TRACE.</td></tr>
<tr><td class="h"><a name="7297"></a>7297</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7298"></a>7298</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_PROFILE</td></tr>
<tr><td class="h"><a name="7299"></a>7299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7300"></a>7300</td><td></td><td></td><td></td><td></td><td class="s">The DBI_PROFILE environment variable can be used to enable profiling</td></tr>
<tr><td class="h"><a name="7301"></a>7301</td><td></td><td></td><td></td><td></td><td class="s">of DBI method calls. See L&lt;DBI::Profile&gt; for more information.</td></tr>
<tr><td class="h"><a name="7302"></a>7302</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7303"></a>7303</td><td></td><td></td><td></td><td></td><td class="s">=head2 DBI_PUREPERL</td></tr>
<tr><td class="h"><a name="7304"></a>7304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7305"></a>7305</td><td></td><td></td><td></td><td></td><td class="s">The DBI_PUREPERL environment variable can be used to enable the</td></tr>
<tr><td class="h"><a name="7306"></a>7306</td><td></td><td></td><td></td><td></td><td class="s">use of DBI::PurePerl.  See L&lt;DBI::PurePerl&gt; for more information.</td></tr>
<tr><td class="h"><a name="7307"></a>7307</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7308"></a>7308</td><td></td><td></td><td></td><td></td><td class="s">=head1 WARNING AND ERROR MESSAGES</td></tr>
<tr><td class="h"><a name="7309"></a>7309</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7310"></a>7310</td><td></td><td></td><td></td><td></td><td class="s">=head2 Fatal Errors</td></tr>
<tr><td class="h"><a name="7311"></a>7311</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7312"></a>7312</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="7313"></a>7313</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7314"></a>7314</td><td></td><td></td><td></td><td></td><td class="s">=item Can't call method &quot;prepare&quot; without a package or object reference</td></tr>
<tr><td class="h"><a name="7315"></a>7315</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7316"></a>7316</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$dbh&gt; handle you're using to call C&lt;prepare&gt; is probably undefined because</td></tr>
<tr><td class="h"><a name="7317"></a>7317</td><td></td><td></td><td></td><td></td><td class="s">the preceding C&lt;connect&gt; failed. You should always check the return status of</td></tr>
<tr><td class="h"><a name="7318"></a>7318</td><td></td><td></td><td></td><td></td><td class="s">DBI methods, or use the L&lt;/RaiseError&gt; attribute.</td></tr>
<tr><td class="h"><a name="7319"></a>7319</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7320"></a>7320</td><td></td><td></td><td></td><td></td><td class="s">=item Can't call method &quot;execute&quot; without a package or object reference</td></tr>
<tr><td class="h"><a name="7321"></a>7321</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7322"></a>7322</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;$sth&gt; handle you're using to call C&lt;execute&gt; is probably undefined because</td></tr>
<tr><td class="h"><a name="7323"></a>7323</td><td></td><td></td><td></td><td></td><td class="s">the preceeding C&lt;prepare&gt; failed. You should always check the return status of</td></tr>
<tr><td class="h"><a name="7324"></a>7324</td><td></td><td></td><td></td><td></td><td class="s">DBI methods, or use the L&lt;/RaiseError&gt; attribute.</td></tr>
<tr><td class="h"><a name="7325"></a>7325</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7326"></a>7326</td><td></td><td></td><td></td><td></td><td class="s">=item DBI/DBD internal version mismatch</td></tr>
<tr><td class="h"><a name="7327"></a>7327</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7328"></a>7328</td><td></td><td></td><td></td><td></td><td class="s">The DBD driver module was built with a different version of DBI than</td></tr>
<tr><td class="h"><a name="7329"></a>7329</td><td></td><td></td><td></td><td></td><td class="s">the one currently being used.  You should rebuild the DBD module under</td></tr>
<tr><td class="h"><a name="7330"></a>7330</td><td></td><td></td><td></td><td></td><td class="s">the current version of DBI.</td></tr>
<tr><td class="h"><a name="7331"></a>7331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7332"></a>7332</td><td></td><td></td><td></td><td></td><td class="s">(Some rare platforms require &quot;static linking&quot;. On those platforms, there</td></tr>
<tr><td class="h"><a name="7333"></a>7333</td><td></td><td></td><td></td><td></td><td class="s">may be an old DBI or DBD driver version actually embedded in the Perl</td></tr>
<tr><td class="h"><a name="7334"></a>7334</td><td></td><td></td><td></td><td></td><td class="s">executable being used.)</td></tr>
<tr><td class="h"><a name="7335"></a>7335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7336"></a>7336</td><td></td><td></td><td></td><td></td><td class="s">=item DBD driver has not implemented the AutoCommit attribute</td></tr>
<tr><td class="h"><a name="7337"></a>7337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7338"></a>7338</td><td></td><td></td><td></td><td></td><td class="s">The DBD driver implementation is incomplete. Consult the author.</td></tr>
<tr><td class="h"><a name="7339"></a>7339</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7340"></a>7340</td><td></td><td></td><td></td><td></td><td class="s">=item Can't [sg]et %s-&gt;{%s}: unrecognised attribute</td></tr>
<tr><td class="h"><a name="7341"></a>7341</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7342"></a>7342</td><td></td><td></td><td></td><td></td><td class="s">You attempted to set or get an unknown attribute of a handle.  Make</td></tr>
<tr><td class="h"><a name="7343"></a>7343</td><td></td><td></td><td></td><td></td><td class="s">sure you have spelled the attribute name correctly; case is significant</td></tr>
<tr><td class="h"><a name="7344"></a>7344</td><td></td><td></td><td></td><td></td><td class="s">(e.g., &quot;Autocommit&quot; is not the same as &quot;AutoCommit&quot;).</td></tr>
<tr><td class="h"><a name="7345"></a>7345</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7346"></a>7346</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="7347"></a>7347</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7348"></a>7348</td><td></td><td></td><td></td><td></td><td class="s">=head1 Pure-Perl DBI</td></tr>
<tr><td class="h"><a name="7349"></a>7349</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7350"></a>7350</td><td></td><td></td><td></td><td></td><td class="s">A pure-perl emulation of the DBI is included in the distribution</td></tr>
<tr><td class="h"><a name="7351"></a>7351</td><td></td><td></td><td></td><td></td><td class="s">for people using pure-perl drivers who, for whatever reason, can't</td></tr>
<tr><td class="h"><a name="7352"></a>7352</td><td></td><td></td><td></td><td></td><td class="s">install the compiled DBI. See L&lt;DBI::PurePerl&gt;.</td></tr>
<tr><td class="h"><a name="7353"></a>7353</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7354"></a>7354</td><td></td><td></td><td></td><td></td><td class="s">=head1 SEE ALSO</td></tr>
<tr><td class="h"><a name="7355"></a>7355</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7356"></a>7356</td><td></td><td></td><td></td><td></td><td class="s">=head2 Driver and Database Documentation</td></tr>
<tr><td class="h"><a name="7357"></a>7357</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7358"></a>7358</td><td></td><td></td><td></td><td></td><td class="s">Refer to the documentation for the DBD driver that you are using.</td></tr>
<tr><td class="h"><a name="7359"></a>7359</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7360"></a>7360</td><td></td><td></td><td></td><td></td><td class="s">Refer to the SQL Language Reference Manual for the database engine that you are using.</td></tr>
<tr><td class="h"><a name="7361"></a>7361</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7362"></a>7362</td><td></td><td></td><td></td><td></td><td class="s">=head2 ODBC and SQL/CLI Standards Reference Information</td></tr>
<tr><td class="h"><a name="7363"></a>7363</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7364"></a>7364</td><td></td><td></td><td></td><td></td><td class="s">More detailed information about the semantics of certain DBI methods</td></tr>
<tr><td class="h"><a name="7365"></a>7365</td><td></td><td></td><td></td><td></td><td class="s">that are based on ODBC and SQL/CLI standards is available on-line</td></tr>
<tr><td class="h"><a name="7366"></a>7366</td><td></td><td></td><td></td><td></td><td class="s">via microsoft.com, for ODBC, and www.jtc1sc32.org for the SQL/CLI</td></tr>
<tr><td class="h"><a name="7367"></a>7367</td><td></td><td></td><td></td><td></td><td class="s">standard:</td></tr>
<tr><td class="h"><a name="7368"></a>7368</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7369"></a>7369</td><td></td><td></td><td></td><td></td><td class="s"> DBI method        ODBC function     SQL/CLI Working Draft</td></tr>
<tr><td class="h"><a name="7370"></a>7370</td><td></td><td></td><td></td><td></td><td class="s"> ----------        -------------     ---------------------</td></tr>
<tr><td class="h"><a name="7371"></a>7371</td><td></td><td></td><td></td><td></td><td class="s"> column_info       SQLColumns        Page 124</td></tr>
<tr><td class="h"><a name="7372"></a>7372</td><td></td><td></td><td></td><td></td><td class="s"> foreign_key_info  SQLForeignKeys    Page 163</td></tr>
<tr><td class="h"><a name="7373"></a>7373</td><td></td><td></td><td></td><td></td><td class="s"> get_info          SQLGetInfo        Page 214</td></tr>
<tr><td class="h"><a name="7374"></a>7374</td><td></td><td></td><td></td><td></td><td class="s"> primary_key_info  SQLPrimaryKeys    Page 254</td></tr>
<tr><td class="h"><a name="7375"></a>7375</td><td></td><td></td><td></td><td></td><td class="s"> table_info        SQLTables         Page 294</td></tr>
<tr><td class="h"><a name="7376"></a>7376</td><td></td><td></td><td></td><td></td><td class="s"> type_info         SQLGetTypeInfo    Page 239</td></tr>
<tr><td class="h"><a name="7377"></a>7377</td><td></td><td></td><td></td><td></td><td class="s"> statistics_info   SQLStatistics</td></tr>
<tr><td class="h"><a name="7378"></a>7378</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7379"></a>7379</td><td></td><td></td><td></td><td></td><td class="s">For example, for ODBC information on SQLColumns you'd visit:</td></tr>
<tr><td class="h"><a name="7380"></a>7380</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7381"></a>7381</td><td></td><td></td><td></td><td></td><td class="s">  http://msdn.microsoft.com/library/en-us/odbc/htm/odbcsqlcolumns.asp</td></tr>
<tr><td class="h"><a name="7382"></a>7382</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7383"></a>7383</td><td></td><td></td><td></td><td></td><td class="s">If that URL ceases to work then use the MSDN search facility at:</td></tr>
<tr><td class="h"><a name="7384"></a>7384</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7385"></a>7385</td><td></td><td></td><td></td><td></td><td class="s">  http://search.microsoft.com/us/dev/</td></tr>
<tr><td class="h"><a name="7386"></a>7386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7387"></a>7387</td><td></td><td></td><td></td><td></td><td class="s">and search for C&lt;SQLColumns returns&gt; using the exact phrase option.</td></tr>
<tr><td class="h"><a name="7388"></a>7388</td><td></td><td></td><td></td><td></td><td class="s">The link you want will probably just be called C&lt;SQLColumns&gt; and will</td></tr>
<tr><td class="h"><a name="7389"></a>7389</td><td></td><td></td><td></td><td></td><td class="s">be part of the Data Access SDK.</td></tr>
<tr><td class="h"><a name="7390"></a>7390</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7391"></a>7391</td><td></td><td></td><td></td><td></td><td class="s">And for SQL/CLI standard information on SQLColumns you'd read page 124 of</td></tr>
<tr><td class="h"><a name="7392"></a>7392</td><td></td><td></td><td></td><td></td><td class="s">the (very large) SQL/CLI Working Draft available from:</td></tr>
<tr><td class="h"><a name="7393"></a>7393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7394"></a>7394</td><td></td><td></td><td></td><td></td><td class="s">  http://jtc1sc32.org/doc/N0701-0750/32N0744T.pdf</td></tr>
<tr><td class="h"><a name="7395"></a>7395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7396"></a>7396</td><td></td><td></td><td></td><td></td><td class="s">=head2 Standards Reference Information</td></tr>
<tr><td class="h"><a name="7397"></a>7397</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7398"></a>7398</td><td></td><td></td><td></td><td></td><td class="s">A hyperlinked, browsable version of the BNF syntax for SQL92 (plus</td></tr>
<tr><td class="h"><a name="7399"></a>7399</td><td></td><td></td><td></td><td></td><td class="s">Oracle 7 SQL and PL/SQL) is available here:</td></tr>
<tr><td class="h"><a name="7400"></a>7400</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7401"></a>7401</td><td></td><td></td><td></td><td></td><td class="s">  http://cui.unige.ch/db-research/Enseignement/analyseinfo/SQL92/BNFindex.html</td></tr>
<tr><td class="h"><a name="7402"></a>7402</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7403"></a>7403</td><td></td><td></td><td></td><td></td><td class="s">A BNF syntax for SQL3 is available here:</td></tr>
<tr><td class="h"><a name="7404"></a>7404</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7405"></a>7405</td><td></td><td></td><td></td><td></td><td class="s">  http://www.sqlstandards.org/SC32/WG3/Progression_Documents/Informal_working_drafts/iso-9075-2-1999.bnf</td></tr>
<tr><td class="h"><a name="7406"></a>7406</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7407"></a>7407</td><td></td><td></td><td></td><td></td><td class="s">The following links provide further useful information about SQL.</td></tr>
<tr><td class="h"><a name="7408"></a>7408</td><td></td><td></td><td></td><td></td><td class="s">Some of these are rather dated now but may still be useful.</td></tr>
<tr><td class="h"><a name="7409"></a>7409</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7410"></a>7410</td><td></td><td></td><td></td><td></td><td class="s">  http://www.jcc.com/SQLPages/jccs_sql.htm</td></tr>
<tr><td class="h"><a name="7411"></a>7411</td><td></td><td></td><td></td><td></td><td class="s">  http://www.contrib.andrew.cmu.edu/~shadow/sql.html</td></tr>
<tr><td class="h"><a name="7412"></a>7412</td><td></td><td></td><td></td><td></td><td class="s">  http://www.altavista.com/query?q=sql+tutorial</td></tr>
<tr><td class="h"><a name="7413"></a>7413</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7414"></a>7414</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7415"></a>7415</td><td></td><td></td><td></td><td></td><td class="s">=head2 Books and Articles</td></tr>
<tr><td class="h"><a name="7416"></a>7416</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7417"></a>7417</td><td></td><td></td><td></td><td></td><td class="s">Programming the Perl DBI, by Alligator Descartes and Tim Bunce.</td></tr>
<tr><td class="h"><a name="7418"></a>7418</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://books.perl.org/book/154&gt;</td></tr>
<tr><td class="h"><a name="7419"></a>7419</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7420"></a>7420</td><td></td><td></td><td></td><td></td><td class="s">Programming Perl 3rd Ed. by Larry Wall, Tom Christiansen &amp; Jon Orwant.</td></tr>
<tr><td class="h"><a name="7421"></a>7421</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://books.perl.org/book/134&gt;</td></tr>
<tr><td class="h"><a name="7422"></a>7422</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7423"></a>7423</td><td></td><td></td><td></td><td></td><td class="s">Learning Perl by Randal Schwartz.</td></tr>
<tr><td class="h"><a name="7424"></a>7424</td><td></td><td></td><td></td><td></td><td class="s">L&lt;http://books.perl.org/book/101&gt;</td></tr>
<tr><td class="h"><a name="7425"></a>7425</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7426"></a>7426</td><td></td><td></td><td></td><td></td><td class="s">Details of many other books related to perl can be found at L&lt;http://books.perl.org&gt;</td></tr>
<tr><td class="h"><a name="7427"></a>7427</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7428"></a>7428</td><td></td><td></td><td></td><td></td><td class="s">=head2 Perl Modules</td></tr>
<tr><td class="h"><a name="7429"></a>7429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7430"></a>7430</td><td></td><td></td><td></td><td></td><td class="s">Index of DBI related modules available from CPAN:</td></tr>
<tr><td class="h"><a name="7431"></a>7431</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7432"></a>7432</td><td></td><td></td><td></td><td></td><td class="s"> http://search.cpan.org/search?mode=module&amp;query=DBIx%3A%3A</td></tr>
<tr><td class="h"><a name="7433"></a>7433</td><td></td><td></td><td></td><td></td><td class="s"> http://search.cpan.org/search?mode=doc&amp;query=DBI</td></tr>
<tr><td class="h"><a name="7434"></a>7434</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7435"></a>7435</td><td></td><td></td><td></td><td></td><td class="s">For a good comparison of RDBMS-OO mappers and some OO-RDBMS mappers</td></tr>
<tr><td class="h"><a name="7436"></a>7436</td><td></td><td></td><td></td><td></td><td class="s">(including Class::DBI, Alzabo, and DBIx::RecordSet in the former</td></tr>
<tr><td class="h"><a name="7437"></a>7437</td><td></td><td></td><td></td><td></td><td class="s">category and Tangram and SPOPS in the latter) see the Perl</td></tr>
<tr><td class="h"><a name="7438"></a>7438</td><td></td><td></td><td></td><td></td><td class="s">Object-Oriented Persistence project pages at:</td></tr>
<tr><td class="h"><a name="7439"></a>7439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7440"></a>7440</td><td></td><td></td><td></td><td></td><td class="s"> http://poop.sourceforge.net</td></tr>
<tr><td class="h"><a name="7441"></a>7441</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7442"></a>7442</td><td></td><td></td><td></td><td></td><td class="s">A similar page for Java toolkits can be found at:</td></tr>
<tr><td class="h"><a name="7443"></a>7443</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7444"></a>7444</td><td></td><td></td><td></td><td></td><td class="s"> http://c2.com/cgi-bin/wiki?ObjectRelationalToolComparison</td></tr>
<tr><td class="h"><a name="7445"></a>7445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7446"></a>7446</td><td></td><td></td><td></td><td></td><td class="s">=head2 Mailing List</td></tr>
<tr><td class="h"><a name="7447"></a>7447</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7448"></a>7448</td><td></td><td></td><td></td><td></td><td class="s">The I&lt;dbi-users&gt; mailing list is the primary means of communication among</td></tr>
<tr><td class="h"><a name="7449"></a>7449</td><td></td><td></td><td></td><td></td><td class="s">users of the DBI and its related modules. For details send email to:</td></tr>
<tr><td class="h"><a name="7450"></a>7450</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7451"></a>7451</td><td></td><td></td><td></td><td></td><td class="s"> dbi-users-help@perl.org</td></tr>
<tr><td class="h"><a name="7452"></a>7452</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7453"></a>7453</td><td></td><td></td><td></td><td></td><td class="s">There are typically between 700 and 900 messages per month.  You have</td></tr>
<tr><td class="h"><a name="7454"></a>7454</td><td></td><td></td><td></td><td></td><td class="s">to subscribe in order to be able to post. However you can opt for a</td></tr>
<tr><td class="h"><a name="7455"></a>7455</td><td></td><td></td><td></td><td></td><td class="s">'post-only' subscription.</td></tr>
<tr><td class="h"><a name="7456"></a>7456</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7457"></a>7457</td><td></td><td></td><td></td><td></td><td class="s">Mailing list archives (of variable quality) are held at:</td></tr>
<tr><td class="h"><a name="7458"></a>7458</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7459"></a>7459</td><td></td><td></td><td></td><td></td><td class="s"> http://groups.google.com/groups?group=perl.dbi.users</td></tr>
<tr><td class="h"><a name="7460"></a>7460</td><td></td><td></td><td></td><td></td><td class="s"> http://www.xray.mpe.mpg.de/mailing-lists/dbi/</td></tr>
<tr><td class="h"><a name="7461"></a>7461</td><td></td><td></td><td></td><td></td><td class="s"> http://www.mail-archive.com/dbi-users%40perl.org/</td></tr>
<tr><td class="h"><a name="7462"></a>7462</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7463"></a>7463</td><td></td><td></td><td></td><td></td><td class="s">=head2 Assorted Related WWW Links</td></tr>
<tr><td class="h"><a name="7464"></a>7464</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7465"></a>7465</td><td></td><td></td><td></td><td></td><td class="s">The DBI &quot;Home Page&quot;:</td></tr>
<tr><td class="h"><a name="7466"></a>7466</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7467"></a>7467</td><td></td><td></td><td></td><td></td><td class="s"> http://dbi.perl.org/</td></tr>
<tr><td class="h"><a name="7468"></a>7468</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7469"></a>7469</td><td></td><td></td><td></td><td></td><td class="s">Other DBI related links:</td></tr>
<tr><td class="h"><a name="7470"></a>7470</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7471"></a>7471</td><td></td><td></td><td></td><td></td><td class="s"> http://tegan.deltanet.com/~phlip/DBUIdoc.html</td></tr>
<tr><td class="h"><a name="7472"></a>7472</td><td></td><td></td><td></td><td></td><td class="s"> http://dc.pm.org/perl_db.html</td></tr>
<tr><td class="h"><a name="7473"></a>7473</td><td></td><td></td><td></td><td></td><td class="s"> http://wdvl.com/Authoring/DB/Intro/toc.html</td></tr>
<tr><td class="h"><a name="7474"></a>7474</td><td></td><td></td><td></td><td></td><td class="s"> http://www.hotwired.com/webmonkey/backend/tutorials/tutorial1.html</td></tr>
<tr><td class="h"><a name="7475"></a>7475</td><td></td><td></td><td></td><td></td><td class="s"> http://bumppo.net/lists/macperl/1999/06/msg00197.html</td></tr>
<tr><td class="h"><a name="7476"></a>7476</td><td></td><td></td><td></td><td></td><td class="s"> http://gmax.oltrelinux.com/dbirecipes.html</td></tr>
<tr><td class="h"><a name="7477"></a>7477</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7478"></a>7478</td><td></td><td></td><td></td><td></td><td class="s">Other database related links:</td></tr>
<tr><td class="h"><a name="7479"></a>7479</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7480"></a>7480</td><td></td><td></td><td></td><td></td><td class="s"> http://www.jcc.com/sql_stnd.html</td></tr>
<tr><td class="h"><a name="7481"></a>7481</td><td></td><td></td><td></td><td></td><td class="s"> http://cuiwww.unige.ch/OSG/info/FreeDB/FreeDB.home.html</td></tr>
<tr><td class="h"><a name="7482"></a>7482</td><td></td><td></td><td></td><td></td><td class="s"> http://www.connectionstrings.com/</td></tr>
<tr><td class="h"><a name="7483"></a>7483</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7484"></a>7484</td><td></td><td></td><td></td><td></td><td class="s">Security, especially the &quot;SQL Injection&quot; attack:</td></tr>
<tr><td class="h"><a name="7485"></a>7485</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7486"></a>7486</td><td></td><td></td><td></td><td></td><td class="s"> http://www.ngssoftware.com/research/papers.html</td></tr>
<tr><td class="h"><a name="7487"></a>7487</td><td></td><td></td><td></td><td></td><td class="s"> http://www.ngssoftware.com/papers/advanced_sql_injection.pdf</td></tr>
<tr><td class="h"><a name="7488"></a>7488</td><td></td><td></td><td></td><td></td><td class="s"> http://www.ngssoftware.com/papers/more_advanced_sql_injection.pdf</td></tr>
<tr><td class="h"><a name="7489"></a>7489</td><td></td><td></td><td></td><td></td><td class="s"> http://www.esecurityplanet.com/trends/article.php/2243461</td></tr>
<tr><td class="h"><a name="7490"></a>7490</td><td></td><td></td><td></td><td></td><td class="s"> http://www.spidynamics.com/papers/SQLInjectionWhitePaper.pdf</td></tr>
<tr><td class="h"><a name="7491"></a>7491</td><td></td><td></td><td></td><td></td><td class="s"> http://www.imperva.com/application_defense_center/white_papers/blind_sql_server_injection.html</td></tr>
<tr><td class="h"><a name="7492"></a>7492</td><td></td><td></td><td></td><td></td><td class="s"> http://online.securityfocus.com/infocus/1644</td></tr>
<tr><td class="h"><a name="7493"></a>7493</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7494"></a>7494</td><td></td><td></td><td></td><td></td><td class="s">Commercial and Data Warehouse Links</td></tr>
<tr><td class="h"><a name="7495"></a>7495</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7496"></a>7496</td><td></td><td></td><td></td><td></td><td class="s"> http://www.dwinfocenter.org</td></tr>
<tr><td class="h"><a name="7497"></a>7497</td><td></td><td></td><td></td><td></td><td class="s"> http://www.datawarehouse.com</td></tr>
<tr><td class="h"><a name="7498"></a>7498</td><td></td><td></td><td></td><td></td><td class="s"> http://www.datamining.org</td></tr>
<tr><td class="h"><a name="7499"></a>7499</td><td></td><td></td><td></td><td></td><td class="s"> http://www.olapcouncil.org</td></tr>
<tr><td class="h"><a name="7500"></a>7500</td><td></td><td></td><td></td><td></td><td class="s"> http://www.idwa.org</td></tr>
<tr><td class="h"><a name="7501"></a>7501</td><td></td><td></td><td></td><td></td><td class="s"> http://www.knowledgecenters.org/dwcenter.asp</td></tr>
<tr><td class="h"><a name="7502"></a>7502</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7503"></a>7503</td><td></td><td></td><td></td><td></td><td class="s">Recommended Perl Programming Links</td></tr>
<tr><td class="h"><a name="7504"></a>7504</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7505"></a>7505</td><td></td><td></td><td></td><td></td><td class="s"> http://language.perl.com/style/</td></tr>
<tr><td class="h"><a name="7506"></a>7506</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7507"></a>7507</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7508"></a>7508</td><td></td><td></td><td></td><td></td><td class="s">=head2 FAQ</td></tr>
<tr><td class="h"><a name="7509"></a>7509</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7510"></a>7510</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;http://faq.dbi-support.com/&gt;</td></tr>
<tr><td class="h"><a name="7511"></a>7511</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7512"></a>7512</td><td></td><td></td><td></td><td></td><td class="s">=head1 AUTHORS</td></tr>
<tr><td class="h"><a name="7513"></a>7513</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7514"></a>7514</td><td></td><td></td><td></td><td></td><td class="s">DBI by Tim Bunce, L&lt;http://www.tim.bunce.name&gt;</td></tr>
<tr><td class="h"><a name="7515"></a>7515</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7516"></a>7516</td><td></td><td></td><td></td><td></td><td class="s">This pod text by Tim Bunce, J. Douglas Dunlop, Jonathan Leffler and others.</td></tr>
<tr><td class="h"><a name="7517"></a>7517</td><td></td><td></td><td></td><td></td><td class="s">Perl by Larry Wall and the C&lt;perl5-porters&gt;.</td></tr>
<tr><td class="h"><a name="7518"></a>7518</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7519"></a>7519</td><td></td><td></td><td></td><td></td><td class="s">=head1 COPYRIGHT</td></tr>
<tr><td class="h"><a name="7520"></a>7520</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7521"></a>7521</td><td></td><td></td><td></td><td></td><td class="s">The DBI module is Copyright (c) 1994-2008 Tim Bunce. Ireland.</td></tr>
<tr><td class="h"><a name="7522"></a>7522</td><td></td><td></td><td></td><td></td><td class="s">All rights reserved.</td></tr>
<tr><td class="h"><a name="7523"></a>7523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7524"></a>7524</td><td></td><td></td><td></td><td></td><td class="s">You may distribute under the terms of either the GNU General Public</td></tr>
<tr><td class="h"><a name="7525"></a>7525</td><td></td><td></td><td></td><td></td><td class="s">License or the Artistic License, as specified in the Perl README file.</td></tr>
<tr><td class="h"><a name="7526"></a>7526</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7527"></a>7527</td><td></td><td></td><td></td><td></td><td class="s">=head1 SUPPORT / WARRANTY</td></tr>
<tr><td class="h"><a name="7528"></a>7528</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7529"></a>7529</td><td></td><td></td><td></td><td></td><td class="s">The DBI is free Open Source software. IT COMES WITHOUT WARRANTY OF ANY KIND.</td></tr>
<tr><td class="h"><a name="7530"></a>7530</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7531"></a>7531</td><td></td><td></td><td></td><td></td><td class="s">=head2 Support</td></tr>
<tr><td class="h"><a name="7532"></a>7532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7533"></a>7533</td><td></td><td></td><td></td><td></td><td class="s">My consulting company, Data Plan Services, offers annual and</td></tr>
<tr><td class="h"><a name="7534"></a>7534</td><td></td><td></td><td></td><td></td><td class="s">multi-annual support contracts for the DBI. These provide sustained</td></tr>
<tr><td class="h"><a name="7535"></a>7535</td><td></td><td></td><td></td><td></td><td class="s">support for DBI development, and sustained value for you in return.</td></tr>
<tr><td class="h"><a name="7536"></a>7536</td><td></td><td></td><td></td><td></td><td class="s">Contact me for details.</td></tr>
<tr><td class="h"><a name="7537"></a>7537</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7538"></a>7538</td><td></td><td></td><td></td><td></td><td class="s">=head2 Sponsor Enhancements</td></tr>
<tr><td class="h"><a name="7539"></a>7539</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7540"></a>7540</td><td></td><td></td><td></td><td></td><td class="s">The DBI Roadmap is available at L&lt;http://search.cpan.org/~timb/DBI/Roadmap.pod&gt;</td></tr>
<tr><td class="h"><a name="7541"></a>7541</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7542"></a>7542</td><td></td><td></td><td></td><td></td><td class="s">If your company would benefit from a specific new DBI feature,</td></tr>
<tr><td class="h"><a name="7543"></a>7543</td><td></td><td></td><td></td><td></td><td class="s">please consider sponsoring its development.  Work is performed</td></tr>
<tr><td class="h"><a name="7544"></a>7544</td><td></td><td></td><td></td><td></td><td class="s">rapidly, and usually on a fixed-price payment-on-delivery basis.</td></tr>
<tr><td class="h"><a name="7545"></a>7545</td><td></td><td></td><td></td><td></td><td class="s">Contact me for details.</td></tr>
<tr><td class="h"><a name="7546"></a>7546</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7547"></a>7547</td><td></td><td></td><td></td><td></td><td class="s">Using such targeted financing allows you to contribute to DBI</td></tr>
<tr><td class="h"><a name="7548"></a>7548</td><td></td><td></td><td></td><td></td><td class="s">development, and rapidly get something specific and valuable in return.</td></tr>
<tr><td class="h"><a name="7549"></a>7549</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7550"></a>7550</td><td></td><td></td><td></td><td></td><td class="s">=head1 ACKNOWLEDGEMENTS</td></tr>
<tr><td class="h"><a name="7551"></a>7551</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7552"></a>7552</td><td></td><td></td><td></td><td></td><td class="s">I would like to acknowledge the valuable contributions of the many</td></tr>
<tr><td class="h"><a name="7553"></a>7553</td><td></td><td></td><td></td><td></td><td class="s">people I have worked with on the DBI project, especially in the early</td></tr>
<tr><td class="h"><a name="7554"></a>7554</td><td></td><td></td><td></td><td></td><td class="s">years (1992-1994). In no particular order: Kevin Stock, Buzz Moschetti,</td></tr>
<tr><td class="h"><a name="7555"></a>7555</td><td></td><td></td><td></td><td></td><td class="s">Kurt Andersen, Ted Lemon, William Hails, Garth Kennedy, Michael Peppler,</td></tr>
<tr><td class="h"><a name="7556"></a>7556</td><td></td><td></td><td></td><td></td><td class="s">Neil S. Briscoe, Jeff Urlwin, David J. Hughes, Jeff Stander,</td></tr>
<tr><td class="h"><a name="7557"></a>7557</td><td></td><td></td><td></td><td></td><td class="s">Forrest D Whitcher, Larry Wall, Jeff Fried, Roy Johnson, Paul Hudson,</td></tr>
<tr><td class="h"><a name="7558"></a>7558</td><td></td><td></td><td></td><td></td><td class="s">Georg Rehfeld, Steve Sizemore, Ron Pool, Jon Meek, Tom Christiansen,</td></tr>
<tr><td class="h"><a name="7559"></a>7559</td><td></td><td></td><td></td><td></td><td class="s">Steve Baumgarten, Randal Schwartz, and a whole lot more.</td></tr>
<tr><td class="h"><a name="7560"></a>7560</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7561"></a>7561</td><td></td><td></td><td></td><td></td><td class="s">Then, of course, there are the poor souls who have struggled through</td></tr>
<tr><td class="h"><a name="7562"></a>7562</td><td></td><td></td><td></td><td></td><td class="s">untold and undocumented obstacles to actually implement DBI drivers.</td></tr>
<tr><td class="h"><a name="7563"></a>7563</td><td></td><td></td><td></td><td></td><td class="s">Among their ranks are Jochen Wiedmann, Alligator Descartes, Jonathan</td></tr>
<tr><td class="h"><a name="7564"></a>7564</td><td></td><td></td><td></td><td></td><td class="s">Leffler, Jeff Urlwin, Michael Peppler, Henrik Tougaard, Edwin Pratomo,</td></tr>
<tr><td class="h"><a name="7565"></a>7565</td><td></td><td></td><td></td><td></td><td class="s">Davide Migliavacca, Jan Pazdziora, Peter Haworth, Edmund Mergl, Steve</td></tr>
<tr><td class="h"><a name="7566"></a>7566</td><td></td><td></td><td></td><td></td><td class="s">Williams, Thomas Lowery, and Phlip Plumlee. Without them, the DBI would</td></tr>
<tr><td class="h"><a name="7567"></a>7567</td><td></td><td></td><td></td><td></td><td class="s">not be the practical reality it is today.  I'm also especially grateful</td></tr>
<tr><td class="h"><a name="7568"></a>7568</td><td></td><td></td><td></td><td></td><td class="s">to Alligator Descartes for starting work on the first edition of the</td></tr>
<tr><td class="h"><a name="7569"></a>7569</td><td></td><td></td><td></td><td></td><td class="s">&quot;Programming the Perl DBI&quot; book and letting me jump on board.</td></tr>
<tr><td class="h"><a name="7570"></a>7570</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7571"></a>7571</td><td></td><td></td><td></td><td></td><td class="s">The DBI and DBD::Oracle were originally developed while I was Technical</td></tr>
<tr><td class="h"><a name="7572"></a>7572</td><td></td><td></td><td></td><td></td><td class="s">Director (CTO) of Ingeneering in the UK (L&lt;http://www.ig.co.uk&gt;) (formerly known as the</td></tr>
<tr><td class="h"><a name="7573"></a>7573</td><td></td><td></td><td></td><td></td><td class="s">Paul Ingram Group).  So I'd especially like to thank Paul for his generosity</td></tr>
<tr><td class="h"><a name="7574"></a>7574</td><td></td><td></td><td></td><td></td><td class="s">and vision in supporting this work for many years.</td></tr>
<tr><td class="h"><a name="7575"></a>7575</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7576"></a>7576</td><td></td><td></td><td></td><td></td><td class="s">A couple of specific DBI features have been sponsored by enlightened companies:</td></tr>
<tr><td class="h"><a name="7577"></a>7577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7578"></a>7578</td><td></td><td></td><td></td><td></td><td class="s">The development of the swap_inner_handle() method was sponsored by BizRate.com (L&lt;http://BizRate.com&gt;)</td></tr>
<tr><td class="h"><a name="7579"></a>7579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7580"></a>7580</td><td></td><td></td><td></td><td></td><td class="s">The development of DBD::Gofer and related modules was sponsored by</td></tr>
<tr><td class="h"><a name="7581"></a>7581</td><td></td><td></td><td></td><td></td><td class="s">Shopzilla.com (L&lt;http://Shopzilla.com&gt;), where I currently work.</td></tr>
<tr><td class="h"><a name="7582"></a>7582</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7583"></a>7583</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7584"></a>7584</td><td></td><td></td><td></td><td></td><td class="s">=head1 CONTRIBUTING</td></tr>
<tr><td class="h"><a name="7585"></a>7585</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7586"></a>7586</td><td></td><td></td><td></td><td></td><td class="s">As you can see above, many people have contributed to the DBI and</td></tr>
<tr><td class="h"><a name="7587"></a>7587</td><td></td><td></td><td></td><td></td><td class="s">drivers in many ways over many years.</td></tr>
<tr><td class="h"><a name="7588"></a>7588</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7589"></a>7589</td><td></td><td></td><td></td><td></td><td class="s">If you'd like to help then see L&lt;http://dbi.perl.org/contributing&gt;</td></tr>
<tr><td class="h"><a name="7590"></a>7590</td><td></td><td></td><td></td><td></td><td class="s">and L&lt;http://search.cpan.org/~timb/DBI/Roadmap.pod&gt;</td></tr>
<tr><td class="h"><a name="7591"></a>7591</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7592"></a>7592</td><td></td><td></td><td></td><td></td><td class="s">If you'd like the DBI to do something new or different then a good way</td></tr>
<tr><td class="h"><a name="7593"></a>7593</td><td></td><td></td><td></td><td></td><td class="s">to make that happen is to do it yourself and send me a patch to the</td></tr>
<tr><td class="h"><a name="7594"></a>7594</td><td></td><td></td><td></td><td></td><td class="s">source code that shows the changes. (But read &quot;Speak before you patch&quot;</td></tr>
<tr><td class="h"><a name="7595"></a>7595</td><td></td><td></td><td></td><td></td><td class="s">below.)</td></tr>
<tr><td class="h"><a name="7596"></a>7596</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7597"></a>7597</td><td></td><td></td><td></td><td></td><td class="s">=head2 Browsing the source code repository</td></tr>
<tr><td class="h"><a name="7598"></a>7598</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7599"></a>7599</td><td></td><td></td><td></td><td></td><td class="s">Use http://svn.perl.org/modules/dbi/trunk (basic)</td></tr>
<tr><td class="h"><a name="7600"></a>7600</td><td></td><td></td><td></td><td></td><td class="s">or  http://svn.perl.org/viewcvs/modules/ (more useful)</td></tr>
<tr><td class="h"><a name="7601"></a>7601</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7602"></a>7602</td><td></td><td></td><td></td><td></td><td class="s">=head2 How to create a patch using Subversion</td></tr>
<tr><td class="h"><a name="7603"></a>7603</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7604"></a>7604</td><td></td><td></td><td></td><td></td><td class="s">The DBI source code is maintained using Subversion (a replacement</td></tr>
<tr><td class="h"><a name="7605"></a>7605</td><td></td><td></td><td></td><td></td><td class="s">for CVS, see L&lt;http://subversion.tigris.org/&gt;). To access the source</td></tr>
<tr><td class="h"><a name="7606"></a>7606</td><td></td><td></td><td></td><td></td><td class="s">you'll need to install a Subversion client. Then, to get the source</td></tr>
<tr><td class="h"><a name="7607"></a>7607</td><td></td><td></td><td></td><td></td><td class="s">code, do:</td></tr>
<tr><td class="h"><a name="7608"></a>7608</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7609"></a>7609</td><td></td><td></td><td></td><td></td><td class="s">  svn checkout http://svn.perl.org/modules/dbi/trunk</td></tr>
<tr><td class="h"><a name="7610"></a>7610</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7611"></a>7611</td><td></td><td></td><td></td><td></td><td class="s">If it prompts for a username and password use your perl.org account</td></tr>
<tr><td class="h"><a name="7612"></a>7612</td><td></td><td></td><td></td><td></td><td class="s">if you have one, else just 'guest' and 'guest'. The source code will</td></tr>
<tr><td class="h"><a name="7613"></a>7613</td><td></td><td></td><td></td><td></td><td class="s">be in a new subdirectory called C&lt;trunk&gt;.</td></tr>
<tr><td class="h"><a name="7614"></a>7614</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7615"></a>7615</td><td></td><td></td><td></td><td></td><td class="s">To keep informed about changes to the source you can send an empty email</td></tr>
<tr><td class="h"><a name="7616"></a>7616</td><td></td><td></td><td></td><td></td><td class="s">to svn-commit-modules-dbi-subscribe@perl.org after which you'll get an email</td></tr>
<tr><td class="h"><a name="7617"></a>7617</td><td></td><td></td><td></td><td></td><td class="s">with the change log message and diff of each change checked-in to the source.</td></tr>
<tr><td class="h"><a name="7618"></a>7618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7619"></a>7619</td><td></td><td></td><td></td><td></td><td class="s">After making your changes you can generate a patch file, but before</td></tr>
<tr><td class="h"><a name="7620"></a>7620</td><td></td><td></td><td></td><td></td><td class="s">you do, make sure your source is still upto date using:</td></tr>
<tr><td class="h"><a name="7621"></a>7621</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7622"></a>7622</td><td></td><td></td><td></td><td></td><td class="s">  svn update</td></tr>
<tr><td class="h"><a name="7623"></a>7623</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7624"></a>7624</td><td></td><td></td><td></td><td></td><td class="s">If you get any conflicts reported you'll need to fix them first.</td></tr>
<tr><td class="h"><a name="7625"></a>7625</td><td></td><td></td><td></td><td></td><td class="s">Then generate the patch file from within the C&lt;trunk&gt; directory using:</td></tr>
<tr><td class="h"><a name="7626"></a>7626</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7627"></a>7627</td><td></td><td></td><td></td><td></td><td class="s">  svn diff &gt; foo.patch</td></tr>
<tr><td class="h"><a name="7628"></a>7628</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7629"></a>7629</td><td></td><td></td><td></td><td></td><td class="s">Read the patch file, as a sanity check, and then email it to dbi-dev@perl.org.</td></tr>
<tr><td class="h"><a name="7630"></a>7630</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7631"></a>7631</td><td></td><td></td><td></td><td></td><td class="s">=head2 How to create a patch without Subversion</td></tr>
<tr><td class="h"><a name="7632"></a>7632</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7633"></a>7633</td><td></td><td></td><td></td><td></td><td class="s">Unpack a fresh copy of the distribution:</td></tr>
<tr><td class="h"><a name="7634"></a>7634</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7635"></a>7635</td><td></td><td></td><td></td><td></td><td class="s">  tar xfz DBI-1.40.tar.gz</td></tr>
<tr><td class="h"><a name="7636"></a>7636</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7637"></a>7637</td><td></td><td></td><td></td><td></td><td class="s">Rename the newly created top level directory:</td></tr>
<tr><td class="h"><a name="7638"></a>7638</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7639"></a>7639</td><td></td><td></td><td></td><td></td><td class="s">  mv DBI-1.40 DBI-1.40.your_foo</td></tr>
<tr><td class="h"><a name="7640"></a>7640</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7641"></a>7641</td><td></td><td></td><td></td><td></td><td class="s">Edit the contents of DBI-1.40.your_foo/* till it does what you want.</td></tr>
<tr><td class="h"><a name="7642"></a>7642</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7643"></a>7643</td><td></td><td></td><td></td><td></td><td class="s">Test your changes and then remove all temporary files:</td></tr>
<tr><td class="h"><a name="7644"></a>7644</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7645"></a>7645</td><td></td><td></td><td></td><td></td><td class="s">  make test &amp;&amp; make distclean</td></tr>
<tr><td class="h"><a name="7646"></a>7646</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7647"></a>7647</td><td></td><td></td><td></td><td></td><td class="s">Go back to the directory you originally unpacked the distribution:</td></tr>
<tr><td class="h"><a name="7648"></a>7648</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7649"></a>7649</td><td></td><td></td><td></td><td></td><td class="s">  cd ..</td></tr>
<tr><td class="h"><a name="7650"></a>7650</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7651"></a>7651</td><td></td><td></td><td></td><td></td><td class="s">Unpack I&lt;another&gt; copy of the original distribution you started with:</td></tr>
<tr><td class="h"><a name="7652"></a>7652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7653"></a>7653</td><td></td><td></td><td></td><td></td><td class="s">  tar xfz DBI-1.40.tar.gz</td></tr>
<tr><td class="h"><a name="7654"></a>7654</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7655"></a>7655</td><td></td><td></td><td></td><td></td><td class="s">Then create a patch file by performing a recursive C&lt;diff&gt; on the two</td></tr>
<tr><td class="h"><a name="7656"></a>7656</td><td></td><td></td><td></td><td></td><td class="s">top level directories:</td></tr>
<tr><td class="h"><a name="7657"></a>7657</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7658"></a>7658</td><td></td><td></td><td></td><td></td><td class="s">  diff -r -u DBI-1.40 DBI-1.40.your_foo &gt; DBI-1.40.your_foo.patch</td></tr>
<tr><td class="h"><a name="7659"></a>7659</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7660"></a>7660</td><td></td><td></td><td></td><td></td><td class="s">=head2 Speak before you patch</td></tr>
<tr><td class="h"><a name="7661"></a>7661</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7662"></a>7662</td><td></td><td></td><td></td><td></td><td class="s">For anything non-trivial or possibly controversial it's a good idea</td></tr>
<tr><td class="h"><a name="7663"></a>7663</td><td></td><td></td><td></td><td></td><td class="s">to discuss (on dbi-dev@perl.org) the changes you propose before</td></tr>
<tr><td class="h"><a name="7664"></a>7664</td><td></td><td></td><td></td><td></td><td class="s">actually spending time working on them. Otherwise you run the risk</td></tr>
<tr><td class="h"><a name="7665"></a>7665</td><td></td><td></td><td></td><td></td><td class="s">of them being rejected because they don't fit into some larger plans</td></tr>
<tr><td class="h"><a name="7666"></a>7666</td><td></td><td></td><td></td><td></td><td class="s">you may not be aware of.</td></tr>
<tr><td class="h"><a name="7667"></a>7667</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7668"></a>7668</td><td></td><td></td><td></td><td></td><td class="s">=head1 TRANSLATIONS</td></tr>
<tr><td class="h"><a name="7669"></a>7669</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7670"></a>7670</td><td></td><td></td><td></td><td></td><td class="s">A German translation of this manual (possibly slightly out of date) is</td></tr>
<tr><td class="h"><a name="7671"></a>7671</td><td></td><td></td><td></td><td></td><td class="s">available, thanks to O'Reilly, at:</td></tr>
<tr><td class="h"><a name="7672"></a>7672</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7673"></a>7673</td><td></td><td></td><td></td><td></td><td class="s">  http://www.oreilly.de/catalog/perldbiger/</td></tr>
<tr><td class="h"><a name="7674"></a>7674</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7675"></a>7675</td><td></td><td></td><td></td><td></td><td class="s">Some other translations:</td></tr>
<tr><td class="h"><a name="7676"></a>7676</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7677"></a>7677</td><td></td><td></td><td></td><td></td><td class="s"> http://cronopio.net/perl/                              - Spanish</td></tr>
<tr><td class="h"><a name="7678"></a>7678</td><td></td><td></td><td></td><td></td><td class="s"> http://member.nifty.ne.jp/hippo2000/dbimemo.htm        - Japanese</td></tr>
<tr><td class="h"><a name="7679"></a>7679</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7680"></a>7680</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7681"></a>7681</td><td></td><td></td><td></td><td></td><td class="s">=head1 TRAINING</td></tr>
<tr><td class="h"><a name="7682"></a>7682</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7683"></a>7683</td><td></td><td></td><td></td><td></td><td class="s">References to DBI related training resources. No recommendation implied.</td></tr>
<tr><td class="h"><a name="7684"></a>7684</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7685"></a>7685</td><td></td><td></td><td></td><td></td><td class="s">  http://www.treepax.co.uk/</td></tr>
<tr><td class="h"><a name="7686"></a>7686</td><td></td><td></td><td></td><td></td><td class="s">  http://www.keller.com/dbweb/</td></tr>
<tr><td class="h"><a name="7687"></a>7687</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7688"></a>7688</td><td></td><td></td><td></td><td></td><td class="s">(If you offer professional DBI related training services,</td></tr>
<tr><td class="h"><a name="7689"></a>7689</td><td></td><td></td><td></td><td></td><td class="s">please send me your details so I can add them here.)</td></tr>
<tr><td class="h"><a name="7690"></a>7690</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7691"></a>7691</td><td></td><td></td><td></td><td></td><td class="s">=head1 OTHER RELATED WORK AND PERL MODULES</td></tr>
<tr><td class="h"><a name="7692"></a>7692</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7693"></a>7693</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="7694"></a>7694</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7695"></a>7695</td><td></td><td></td><td></td><td></td><td class="s">=item Apache::DBI by E.Mergl@bawue.de</td></tr>
<tr><td class="h"><a name="7696"></a>7696</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7697"></a>7697</td><td></td><td></td><td></td><td></td><td class="s">To be used with the Apache daemon together with an embedded Perl</td></tr>
<tr><td class="h"><a name="7698"></a>7698</td><td></td><td></td><td></td><td></td><td class="s">interpreter like C&lt;mod_perl&gt;. Establishes a database connection which</td></tr>
<tr><td class="h"><a name="7699"></a>7699</td><td></td><td></td><td></td><td></td><td class="s">remains open for the lifetime of the HTTP daemon. This way the CGI</td></tr>
<tr><td class="h"><a name="7700"></a>7700</td><td></td><td></td><td></td><td></td><td class="s">connect and disconnect for every database access becomes superfluous.</td></tr>
<tr><td class="h"><a name="7701"></a>7701</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7702"></a>7702</td><td></td><td></td><td></td><td></td><td class="s">=item SQL Parser</td></tr>
<tr><td class="h"><a name="7703"></a>7703</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7704"></a>7704</td><td></td><td></td><td></td><td></td><td class="s">See also the L&lt;SQL::Statement&gt; module, SQL parser and engine.</td></tr>
<tr><td class="h"><a name="7705"></a>7705</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7706"></a>7706</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="7707"></a>7707</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="7708"></a>7708</td><td></td><td></td><td></td><td></td><td class="s">=cut</td></tr>
<tr><td class="h"><a name="DBD_____common__trace_msg"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9&micro;s within DBD::_::common::trace_msg which was called
#    once (9&micro;s+0s) by DBI::END at <a href="DBI-pm-block.html#506">line 506 of DBI.pm</a></div></div>sub DBD::_::common::trace_msg; # xsub<br />        </td></tr>
<tr><td class="h"><a name="DBI__CORE_match"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 75&micro;s within DBI::CORE:match which was called 117 times, avg 638ns/call:
# 117 times (75&micro;s+0s) by DBI::BEGIN at <a href="DBI-pm-block.html#259">line 259 of DBI.pm</a>, avg 638ns/call</div></div>sub DBI::CORE:match; # xsub<br />        </td></tr>
<tr><td class="h"><a name="DBI__CORE_subst"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 11&micro;s within DBI::CORE:subst which was called 3 times, avg 4&micro;s/call:
# 2 times (10&micro;s+0s) by DBI::connect at <a href="DBI-pm-block.html#576">line 576 of DBI.pm</a>, avg 5&micro;s/call
#    once (1&micro;s+0s) by DBI::install_driver at <a href="DBI-pm-block.html#735">line 735 of DBI.pm</a></div></div>sub DBI::CORE:subst; # xsub<br />        </td></tr>
<tr><td class="h"><a name="DBI___install_method"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 339&micro;s within DBI::_install_method which was called 88 times, avg 4&micro;s/call:
# 88 times (339&micro;s+0s) by main::BEGIN at <a href="DBI-pm-block.html#489">line 489 of DBI.pm</a>, avg 4&micro;s/call</div></div>sub DBI::_install_method; # xsub<br />        </td></tr>
<tr><td class="h"><a name="DBI___new_handle"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 317&micro;s within DBI::_new_handle which was called 18 times, avg 18&micro;s/call:
# 15 times (214&micro;s+0s) by DBI::_new_sth at <a href="DBI-pm-block.html#1252">line 1252 of DBI.pm</a>, avg 14&micro;s/call
#  2 times (56&micro;s+0s) by DBI::_new_dbh at <a href="DBI-pm-block.html#1242">line 1242 of DBI.pm</a>, avg 28&micro;s/call
#     once (47&micro;s+0s) by DBI::_new_drh at <a href="DBI-pm-block.html#1212">line 1212 of DBI.pm</a></div></div>sub DBI::_new_handle; # xsub<br />        </td></tr>
<tr><td class="h"><a name="DBI__bootstrap"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 256&micro;s within DBI::bootstrap which was called
#    once (256&micro;s+0s) by DynaLoader::bootstrap at <a href="DynaLoader-pm-block.html#219">line 219 of DynaLoader.pm</a></div></div>sub DBI::bootstrap; # xsub<br />        </td></tr>
</tbody></table></div>
        
            <script type="text/javascript"> $(document).ready(function() { 

        $("#subs_table").tablesorter({
            sortList: [[3,1]],
            headers: {
                3: { sorter: 'fmt_time' },
                4: { sorter: 'fmt_time' }
            }
        });
    
 } ); </script>
        
        <div class="footer">Report produced by the
        <a href="http://search.cpan.org/dist/Devel-NYTProf/">NYTProf 3.11</a>
        Perl profiler, developed by
        <a href="http://www.linkedin.com/in/timbunce">Tim Bunce</a> and
        <a href="http://code.nytimes.com">Adam Kaplan</a>.
        </div>
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    </body></html>